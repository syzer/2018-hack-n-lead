/*! amazon-dtb-javascript-api - apstag - v7.6.1 - 2018-06-14 17:16:33 */
!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e.GDPR=function(t,e,n,s){t=o({},t);var c=void 0,d=50,u=[1,1,3,5],l=0,f=!1,p="crfgL0cSt0r",m=!1,g="cmp-timeout";try{!function(){e=n.wrapFunction(e,"GdprCallback");var _=function(t){try{if(!s.hasLocalStorage())return;window.localStorage.setItem(a,"0"),!1!==m&&m.enabled===t.enabled&&m.consent===t.consent||(window.localStorage.setItem(a,"2"),window.localStorage.setItem(p,JSON.stringify({enabled:t.enabled,consent:t.consent})),!1!==m&&(y.lsStatus="cmp-override",window.localStorage.setItem(a,"1"))),window.document.cookie=p+"=true;max-age=604800"}catch(t){return void n.reportError(t,"__gdpr_save__")}},b=function(t){try{t=o({},t),Object.keys(t.log).map(function(e){"string"==typeof t.log[e]&&-1!==t.log[e].indexOf("/")&&(t.log[e]=encodeURIComponent(t.log[e]))}),t.log=JSON.stringify(t.log)}catch(t){n.reportError(t,"__gdpr_stringify_log__")}e(t)};"object"===(void 0===t?"undefined":r(t))&&null!==t||(t={});var y={cmpGlobal:t.cmpGlobal,cmpTimeout:t.cmpTimeout,enabled:t.enabled};s.hasLocalStorage()&&(m=function(){try{var t=window.localStorage.getItem(p);return null!==t&&JSON.parse(t)}catch(t){return n.reportError(t,"__gdpr_parse_ls__"),!1}}()),!1!==m&&(void 0===window.document.cookie||-1===window.document.cookie.indexOf(p+"=true")?(m=!1,y.lsStatus="invalid"):(y.lsStatus="present",d=50,g="cmp-timeout-cfb")),"string"!=typeof t.cmpGlobal&&(t.cmpGlobal="__cmp"),Number.isInteger(t.cmpTimeout)||(t.cmpTimeout=d);var h,I,D=(I={log:y},void 0===(h=t).enabled?I:!1===h.enabled?(I.enabled=0,I):(Number.isInteger(h.enabled)?I.enabled=h.enabled:I.enabled=1,"string"==typeof h.consent&&(I.consent=h.consent),I));!1!==m&&(D=o({},m,D)),!1===m||m.enabled===D.enabled&&m.consent===D.consent||(y.lsStatus="pub-override"),function t(e,r){if(!s.winHasProp(e.cmpGlobal)||"function"!=typeof window[e.cmpGlobal])return r({error:"no-cmp"}),void(l<u.length&&(setTimeout(t,1e3*u[l],e,r),l++));setTimeout(r,e.cmpTimeout,{timeout:!0},!0),c=Date.now();try{window[e.cmpGlobal]("getConsentData",null,r)}catch(t){r({error:"cmp-internal-error"}),n.reportError(t,"__gdpr_cmp__")}}(t,function(t,e,o){if(!f||"object"!==(void 0===e?"undefined":r(e))||null===e||!e.timeout){f=!0;try{return"object"===(void 0===e?"undefined":r(e))&&null!==e&&void 0!==e.error?(y.status=e.error,void b(t)):o&&"object"===(void 0===e?"undefined":r(e))&&null!==e?e.timeout?(y.status=g,void b(t)):(function(t){if(s.hasLocalStorage())try{var e=window.localStorage.getItem(i);(e=null!==e?JSON.parse(e):[]).push(t),window.localStorage.setItem(i,JSON.stringify(e))}catch(t){n.reportError(t,"__gdpr_save_time__")}}(Date.now()-c),y.status="success",e.gdprApplies?(t.enabled=1,t.consent=e.consentData,_(t),void b(t)):(t.enabled=0,delete t.consent,_(t),void b(t))):(y.status="cmp-error",void b(t))}catch(e){return n.reportError(e,"__gdpr_cmp_callback__"),y.status="func-error",void b(t)}}}.bind(null,D))}()}catch(t){f||e({log:'{"status":"global-func-error"}'}),f=!0,n.reportError(t,"__gdpr_global_func__")}},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t};var i=e.cmpResponseKey="cmpRTimesA",a=e.cmpLocalStorageChanged="crfgL0cSt0rC"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n,r){var o=this;this.testId=t.getRand(),r.sample=void 0===r.sample?1:r.sample,r.delay=void 0===r.delay?5e3:r.delay;var i=function(t){a("pixeling"),t._type=encodeURIComponent(r.name+"-tst"),Object.keys(r.cases).length>1&&(t._case=encodeURIComponent(o.runningCase)),e.noBidCacheIDPixel(t),a("done")},a=function(t){o.status=t,n.dispatch({type:"UPDATE_TEST",id:o.testId,status:o.status,name:o.name,case:o.runningCase})};this.name=r.name,this.sampleRate=r.sample,this.runningCase="",this.status="",a("config"),t.shouldSample(r.sample)?(a("waiting"),setTimeout(function(){a("setup"),o.runningCase=t.getRandomArrayElement(Object.keys(r.cases)),a("running"),r.run(i,r.cases[o.runningCase])},r.delay)):a("nosample")}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=n(1),a=c(i),s=n(0);function c(t){return t&&t.__esModule?t:{default:t}}function u(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l=[],f=!1,p="7.6.1",m=_(10),g;function _(t){try{var e=parseInt(t,10);if(!isNaN(e)){if(0===e)return!1;if(100===e)return!0;if(100*Math.random()<=e)return!0}return!1}catch(t){return y(t,"__error-shouldSampleLatency__"),!1}}function b(t){return t.replace(/\\.{1}/g,"")}function y(t,e,n,r,o,i){try{if(!m)return;var a={lv:p,ts:Date.now(),url:encodeURIComponent(window.document.documentURI),r:encodeURIComponent(window.document.referrer),_type:"apstagError",e:{et:t.name,el:e,msg:t.message}};void 0!==n&&(n?(a.src=r,a.pubid=o):a.src=o);var s=(i=i||document.location.protocol+"//aax.amazon-adsystem.com/x/px/")+"p/PH/"+encodeURIComponent(b(JSON.stringify(a)));s&&(f?(new Image).src=s:l.push(s))}catch(t){}}function h(t){return Object.prototype.hasOwnProperty.call(window,t)}function I(t,e){return t&&t.hasOwnProperty(e)&&void 0!==t[e]&&""!==t[e]}try{var D=(g=!1,h("apstag")&&window.apstag.hasOwnProperty("debug")&&(g=!0),g);D||function(){var t=h("performance"),e=ot(),n=qt("navigationStart"),i="apstagDEBUG",c="apstagDebug",m="apstagDebugConsole",g="apstagCfg",D=0,E=0,v=Gt(),S={amznbid:"testBid",amzniid:"testImpression",amznp:"testP",crid:"testCrid"},w={video:"v"},R=["amznbid","amzniid","amznsz","amznp"],O=["amznbid","amzniid","amznp","r_amznbid","r_amzniid","r_amznp"],T=["amznbid","amznp"],P={new:"NEW",exposed:"EXPOSED",set:"SET",rendered:"RENDERED"},z={__apsid:{urlParam:"ck"},__aps_id_p:{urlParam:"ckp"}},A={noRequest:"0",bidInFlight:"1",noBid:"2"},q="apstagConsoleEnabled",C="apstagConsoleDisabled",x="cr",B="600",N=(L=!1,"function"==typeof XMLHttpRequest&&void 0!==(new XMLHttpRequest).withCredentials&&(L=!0),L),L,k=function(){var t="amzn_lsTest";try{return window.localStorage.setItem(t,t),window.localStorage.removeItem(t),!0}catch(t){return!1}}(),F=!(!k||"true"!==window.localStorage.getItem(c)),U=!(!k||window.localStorage.getItem(m)!==q),j,M=function(){var t,e=arguments.length<=0||void 0===arguments[0]?{AAXReqs:[],bidReqs:{},bidConfigs:{},bsPixels:{},cfg:{},cmpFired:!1,config:{},DFP:{slots:[],noBidSlotIDs:[]},eventLog:[],experiments:{},gdpr:null,gdprQue:[],slotBids:{},targetingKeys:{},aaxViewabilityEnabled:!1,curSlotImps:{},curDFPViewability:{},allDFPViewability:[],tests:{}}:arguments[0],n=arguments[1];switch(n.type){case"ADD_CHUNKED_REQUESTS":return o({},e,{bidReqs:o({},e.bidReqs,d({},n.fid,o({},e.bidReqs[n.fid],{networkReqs:new Array(n.numChunks)})))});case"LOG_EVENT":return o({},e,{eventLog:[].concat(u(e.eventLog),[n.event])});case"NEW_FETCH_BID_REQUEST":return o({},e,{bidReqs:o({},e.bidReqs,d({},n.fid,{pto:n.pto,hasCallbackExecuted:!1}))});case"RECORD_NETWORK_EXCHANGE":return o({},e,{bidReqs:o({},e.bidReqs,d({},n.fid,o({},e.bidReqs[n.fid],{networkReqs:o([].concat(u(e.bidReqs[n.fid].networkReqs)),d({},n.networkID,o({},e.bidReqs[n.fid].networkReqs[n.networkID],(t={},d(t,n.exchangeType+"Time",n.timestamp),d(t,"inFlight","request"===n.exchangeType),t))))})))});case"RECORD_CALLBACK":return o({},e,{bidReqs:o({},e.bidReqs,d({},n.fid,o({},e.bidReqs[n.fid],{hasCallbackExecuted:!0})))});case"RECORD_TIMEOUT":return o({},e,{bidReqs:o({},e.bidReqs,d({},n.fid,o({},e.bidReqs[n.fid],{networkReqs:e.bidReqs[n.fid].networkReqs.map(function(t){return t.inFlight?o({},t,{timeOut:n.timeOut}):t})})))});case"SET_CONFIG":var r=o({},n.config);return r.isSelfServPub=!1,r.pubID&&r.pubID.length>=5&&(r.isSelfServPub=!0),r.gdpr=r.gdpr||{},r.gdpr.cmpTimeout=r.gdpr.cmpTimeout||e.cfg.GDPR_CMP_TIMEOUT,o({},e,{config:r});case"SET_Q":return o({},e,{Q:n.Q});case"SET_VIEWABILITY":return o({},e,{aaxViewabilityEnabled:n.viewability});case"CMP_FIRED":return o({},e,{cmpFired:!0});case"ENABLE_DEBUG":return o({},e,{debugEnabled:!0});case"DISABLE_DEBUG":return o({},e,{debugEnabled:!1});case"RECORD_AAX_REQUEST":return o({},e,{AAXReqs:[].concat(u(e.AAXReqs),[n.data])});case"RECORD_AAX_RESPONSE_PROP":return o({},e,{AAXReqs:e.AAXReqs.map(function(t){return t.bidReqID===n.bidReqID&&(t[n.key]=n.value),t})});case"UPDATE_SLOT_BIDS":return o({},e,{slotBids:o({},e.slotBids,n.bids.reduce(function(t,n){return e.slotBids.hasOwnProperty(n.slotID)?t[n.slotID]=[].concat(u(e.slotBids[n.slotID]),[n]):t[n.slotID]=[n],t},{})),targetingKeys:o({},e.targetingKeys,n.bids.reduce(function(t,n){return e.targetingKeys.hasOwnProperty(n.slotID)?t[n.slotID]=e.targetingKeys[n.slotID].concat(n.targeting?n.targeting.filter(function(t){return-1===e.targetingKeys[n.slotID].indexOf(t)}):[]):t[n.slotID]=n.targeting?n.targeting:Kn("display"),t},{}))});case"UPDATE_BID_INFO_PROP":return void 0===e.slotBids[n.slotID]||e.slotBids[n.slotID].filter(function(t){return t.amzniid===n.iid}).length<1?o({},e):o({},e,{slotBids:o({},e.slotBids,d({},n.slotID,e.slotBids[n.slotID].map(function(t){return(t=o({},t)).amzniid===n.iid&&(t[n.key]=n.value),t})))});case"RECORD_BID_INFO_SENT":return o({},e,{bsPixels:o({},e.bsPixels,d({},n.bidInfo.iid,n.bidInfo.state))});case"DFP_SLOT_RENDER_ENDED_SET":return o({},e,{DFP:o({},e.DFP,{slotRenderEndedSet:!0})});case"BID_STATE_CHANGE":return o({},e,{slotBids:o({},e.slotBids,d({},n.slotID,e.slotBids[n.slotID].map(function(t){if(ie(t,n.bidID,n.dealId)){var e={bidState:n.bidState};return n.bidState===P.rendered?e.renderTime=Date.now():n.bidState===P.set&&(e.setAtTimes=t.hasOwnProperty("setAtTime")?[].concat(u(t.setAtTimes),[Date.now()]):[Date.now()]),o({},t,e)}return t})))});case"STORE_IMPRESSION_DOC_REF":return o({},e,{slotBids:o({},e.slotBids,d({},n.slotID,e.slotBids[n.slotID].map(function(t){return ie(t,n.bidID,n.dealId)?o({},t,{doc:n.doc}):t})))});case"NO_BID_ON_DFP_SLOTS":return o({},e,{DFP:o({},e.DFP,{noBidSlotIDs:e.DFP.noBidSlotIDs.concat(n.slotIDs)})});case"REQUESTED_BID_FOR_DFP_SLOTS":return o({},e,{DFP:o({},e.DFP,{noBidSlotIDs:e.DFP.noBidSlotIDs.filter(function(t){return le(n.slotIDs,t)})})});case"SET_CFG":return o({},e,{cfg:n.cfg});case"SHOULD_SAMPLE_LATENCY":return o({},e,{shouldSampleLatency:_(tt)});case"SHOULD_CHUNK_REQUESTS":return e.shouldSampleLatency&&W&&!e.experiments.hasOwnProperty("chunkRequests")?o({},e,{experiments:o({},e.experiments,{chunkRequests:_(W)})}):e;case"RECORD_ORIGINAL_BID_CONFIG":return o({},e,{bidConfigs:o({},e.bidConfigs,d({},n.bidConfig.bidReqID,n.bidConfig))});case"SLOT_IMP_CHANGE":return o({},e,{curSlotImps:o({},e.curSlotImps,d({},n.slotID,{iid:n.iid,ts:n.ts,slotRendered:!1}))});case"SLOT_RENDERED":return o({},e,{curSlotImps:o({},e.curSlotImps,d({},n.slotID,o({},e.curSlotImps[n.slotID],{slotRendered:!0})))});case"SET_DFP_VIEWABILITY_PROPERTY":return o({},e,{curDFPViewability:o({},e.curDFPViewability,d({},n.slotID,o({},e.curDFPViewability[n.slotID],d({},n.prop,n.val))))});case"SAVE_DFP_VIEWABILITY":return o({},e,{allDFPViewability:[].concat(u(e.allDFPViewability),[o({},e.curDFPViewability[n.slotID],{slotID:n.slotID})]),curDFPViewability:o({},e.curDFPViewability,d({},n.slotID,{}))});case"UPDATE_TEST":return o({},e,{tests:o({},e.tests,d({},n.id,{name:n.name,status:n.status,case:n.case}))});case"SET_GDPR_CONFIG":return o({},e,{gdpr:n.config});case"ADD_GDPR_QUE_ITEM":return o({},e,{gdprQue:[].concat(u(e.gdprQue),[n.func])});case"CLEAR_GDPR_QUE":return o({},e,{gdprQue:[]});default:return e}},G=!(!F||!h("__REDUX_DEVTOOLS_EXTENSION__"))||null,X;G&&(X=window.__REDUX_DEVTOOLS_EXTENSION__(M),X.subscribe(function(){j=X.getState()}));var H=function(t){G?X.dispatch(t):j=M(j,t)};H({type:"NOOP"}),function(){if(k){var t=localStorage.getItem(g);if(t&&"undefined"!==t){var e=JSON.parse(t);H({type:"SET_CFG",cfg:e})}}}();var V=j.cfg.DEFAULT_AAX_HOST||"aax.amazon-adsystem.com",Q=j.cfg.CSM_JS||"//c.amazon-adsystem.com/aax2/csm.js.gz",K=j.cfg.CSM_RTB_COMMUNICATOR_JS||"//c.amazon-adsystem.com/bao-csm/aps-comm/aps_csm.js",W=j.cfg.CHUNK_BID_REQUESTS_PROPORTION,Y=j.cfg.DEBUG_APP_HTML||"//c.amazon-adsystem.com/aax2/debugApp.html",J=j.cfg.DEFAULT_TIMEOUT||2e3,Z=j.cfg.DTB_PATH||"/e/dtb",$=j.cfg.PIXEL_PATH||"/x/px/",tt=j.cfg.LATENCY_SAMPLING_RATE||1,et=j.cfg.COOKIE_MATCH_DELAY||0,nt=j.cfg.MAX_SLOTS_PER_REQUEST||1;function rt(t){var e;return h(i)&&window[i].hasOwnProperty(t)&&(e=window[i][t]),e}function ot(){var t=document.location.protocol;return"h"===t[0]?t+"//":"https://"}function it(){var t=V;return rt("host")&&(t=window[i].host),t}function at(){try{return window.top!==window.self?encodeURIComponent(document.referrer):""}catch(t){return Ke(t,"__error-detectIframeAndGetURL__"),encodeURIComponent(document.documentURI)}}function st(){var t,e;try{try{e=window.top.document.referrer}catch(t){Ke(t,"__error-getPageReferrerURL-1__"),e=window.document.referrer}t=encodeURIComponent(e)}catch(t){Ke(t,"__error-getPageReferrerURL-2__")}return t}function ct(){var t;if(rt("url"))return t=window[i].url,encodeURIComponent(t);var e=encodeURIComponent(document.documentURI);try{(e=encodeURIComponent(window.top.location.href))&&void 0!==e||(e=at())}catch(t){Ke(t,"__error-getReferrerURL__"),e=at()}return e}function ut(){return k?j.hasOwnProperty("cfg")&&j.cfg.hasOwnProperty("v")?j.cfg.v:null:D}function dt(t){t&&(f?(new Image).src=t:l.push(t))}function lt(){return""+e+it()+$}function ft(t){return encodeURIComponent(JSON.stringify(t))}function pt(t){return encodeURIComponent(b(JSON.stringify(t)))}var mt=(gt={},_t=Date.now(),bt=0,{addTimer:function(t,e){e||(e=Date.now()),gt[t]=e-_t},set:function(t,e){gt[t]=e},schedule:function(t,e){t||(t=5e3),e||(e="PH"),e+="/",setTimeout(function(){var t;gt.i=bt,gt.t0=_t,gt.site=((t=decodeURIComponent(ct())).indexOf("://")>-1?t.split("/")[2]:t.split("/")[0]).split(":")[0],dt(en(gt)),gt={},_t=Date.now(),bt++},t)}}),gt,_t,bt;function yt(t){k&&window.localStorage.setItem(c,t)}function ht(t){k&&window.localStorage.setItem(m,t)}function It(t){t.ts=Date.now(),H({type:"LOG_EVENT",event:t})}function Dt(t){function e(t){if(!j.cmpFired){H({type:"CMP_FIRED"});var e=document.createElement("iframe");e.style.display="none",e.src=t,document.body.appendChild(e)}}document.readyState&&"loading"===document.readyState?document.addEventListener?document.addEventListener("DOMContentLoaded",function(){e(t)},!1):document.attachEvent&&document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&e(t)}):e(t)}function Et(t){At(t)}function vt(t){try{var e=j.cfg.COOKIE_MATCH_DELAY||et;window.setTimeout(function(){try{t&&t.cmp&&""!==t.cmp&&void 0!==t.cmp?Dt(t.cmp):t&&t.cmpjs&&""!==t.cmpjs&&void 0!==t.cmpjs&&Et(t.cmpjs)}catch(t){Ke(t,"__error-tryCookieMatch-1__")}},e)}catch(t){Ke(t,"__error-tryCookieMatch-2__")}}function St(t){if(!t)return!1;try{var e=~~Number(t);if(e>E)return e}catch(t){return Ke(t,"__error-getValidMilliseconds__"),!1}return!1}function wt(t,e,n){try{e&&"function"==typeof e&&(t.readyState?t.onreadystatechange=function(){"loaded"!==t.readyState&&"complete"!==t.readyState||(t.onreadystatechange=null,e.apply(null,n))}:t.onload=function(){e.apply(null,n)})}catch(t){Ke(t,"__error-safeOnload__")}}function Rt(t){return!j.experiments.chunkRequests||0===j.bidReqs[t.split("-")[0]].networkReqs.filter(function(t){return t.inFlight}).length}function Ot(t,e){!j.bidReqs[t[0]].hasCallbackExecuted&&Rt(t[0])&&(H({type:"RECORD_CALLBACK",fid:t[0]}),e())}function Tt(t){j.experiments.chunkRequests&&H({type:"RECORD_NETWORK_EXCHANGE",fid:t[0],timestamp:Date.now(),exchangeType:"response",networkID:t[1]})}function Pt(t){try{var e=new XMLHttpRequest;e.onload=t.onload.bind(null,e),e.onerror=t.onerror,t.ontimeout&&(e.ontimeout=t.ontimeout),t.withCredentials&&(e.withCredentials=!0),e.open("GET",t.url),e.send(null)}catch(t){Ke(t,"__error-xhr__")}}function zt(t,e,n){var r=n.split("-"),o={url:t,withCredentials:!0};try{o.onload=function(t){Tt(r),eval(t.responseText),Ot(r,e)},o.onerror=function(){Tt(r),Ot(r,e)},Pt(o)}catch(t){Ke(t,"__error-xhrBid__"),Tt(r),Ot(r,e)}}function At(t,e,n){if(n||(n=document),t||!e||"function"!=typeof e){var r=n.getElementsByTagName("script")[0],o=n.createElement("script");o.type="text/javascript",o.async=!0,o.src=t,e&&wt(o,e),r.parentNode.insertBefore(o,r)}else e(!0)}function qt(e){try{if(t)return performance.timing[e]}catch(t){Ke(t,"__error-getWindowsPerformanceTiming__")}return 0}function Ct(e){try{return t&&I(performance,"getEntriesByType")?performance.getEntriesByType("resource").filter(function(t){return t.name.indexOf(e)>-1})[0]:null}catch(t){return Ke(t,"__error-getPerformanceObject__"),null}}function xt(t,e){try{return t&&e in t?parseInt(t[e]+n,10):0}catch(t){return Ke(t,"__error-getPerfObjectTSFromMSMeasurement__"),0}}function Bt(t){return xt(t,"fetchStart")}function Nt(t){return xt(t,"responseEnd")}function Lt(){var t,e;return document.cookie.split("; ").forEach(function(n){(e=n.split("="))[0]in z&&(t+="&"+z[e[0]].urlParam+"="+e[1])}),t}function kt(t){var e=new Date;return e.setTime(e.getTime()+1e3*t),e.toGMTString()}function Ft(t){if(t[x])try{t[x].forEach(function(t){document.cookie=t.k+"="+t.v+";expires="+kt(t.exp)+";"})}catch(t){Ke(t,"__error-setFirstPartyCookies__")}}function Ut(t){t.hasOwnProperty("cb")&&(H({type:"RECORD_AAX_RESPONSE_PROP",bidReqID:t.cb,key:"resTs",value:Date.now()}),H({type:"RECORD_AAX_RESPONSE_PROP",bidReqID:t.cb,key:"perf",value:Ct(t.cb)})),t.hasOwnProperty("cfg")&&H({type:"SET_CFG",cfg:t.cfg}),mt.addTimer("br"),mt.set("brs",t.punt?"0":"1"),t.hasOwnProperty("rm")&&mt.schedule(t.to,t.id),$t()&&je(t)}function jt(t){vt(t),Ft(t),t.hasOwnProperty("cfg")&&localStorage.setItem(g,JSON.stringify(t.cfg)),t.punt||f||(f=!0,l.forEach(function(t){return dt(t)}))}function Mt(t,e){var n=!1,r=null,o=function(e){if(!n){try{t(e),r&&clearTimeout(r)}catch(t){Ke(t,"__error-wrapCallback__")}n=!0}},i=St(e);return r=window.setTimeout(o.bind(null,!0),i||J),o.bind(null,!1)}function Gt(){return""+Math.round(1e12*Math.random())+Date.now()}function Xt(){try{return(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)+"x"+(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)}catch(t){Ke(t,"__error-getWindowsDimensions__")}return"x"}function Ht(t){if("string"==typeof t&&t.length>0)return!0;if(Array.isArray(t)){for(var e=0;e<t.length;e++){if("string"!=typeof t[e])return!1;if(0===t[e].length)return!1}return!0}return!1}function Vt(t){return ft(t.map(function(t){if(t.hasOwnProperty("mediaType")&&"video"===t.mediaType)return{id:t.slotID,mt:w.video};if(t.hasOwnProperty("sizes")){var e={sd:t.slotID,s:t.sizes.filter(function(t){return fe(t)}).map(function(t){return t.join("x")})};return t.hasOwnProperty("slotName")&&t.slotName!==t.slotID&&(e.sn=t.slotName),t.hasOwnProperty("params")&&t.params&&(e.kv={},Object.keys(t.params).forEach(function(n){Ht(t.params[n])&&(e.kv[n]=t.params[n])})),e}return o({},t,{id:"error"})}).filter(function(t){return"error"!==t.id}))}function Qt(t){var e,n=t.blockedBidders&&fe(t.blockedBidders)?t.blockedBidders:j.config.blockedBidders;return n&&fe(n)&&(e=JSON.stringify(n)),e}function Kt(t,n){var a,c,d,u,l=it(),f=Z,m=j.config.pubID,g=v,_=ct(),b=st(),y=Xt(),h=p,I=Lt(),E=Qt(t),S=ut();if(H({type:"RECORD_AAX_REQUEST",data:{bidConfig:t,timeout:n,bidReqID:t.bidReqID,ws:y,url:_,rqTs:Date.now()}}),j.experiments.chunkRequests){var w=t.bidReqID.split("-");H({type:"RECORD_NETWORK_EXCHANGE",fid:w[0],networkID:w[1],timestamp:Date.now(),exchangeType:"request"})}return a=j.config.isSelfServPub?"src=600&pubid="+m:"src="+m,a+="&u="+_+"&pid="+g+"&cb="+t.bidReqID+"&ws="+y+"&v="+h+"&t="+n,t.hasOwnProperty("slots")&&(a+="&slots="+Vt(t.slots)),(j.config.hasOwnProperty("params")||Object.keys(j.experiments).length>0)&&(c=o({},j.config.params,{apse:j.experiments}),a+="&pj="+ft(c)),I&&(a+=I),(S||S===D)&&(a+="&cfgv="+S),rt("bidParams")&&Object.keys(window[i].bidParams).forEach(function(t){a+="&"+t+"="+window[i].bidParams[t]}),b&&""!==b&&(a+="&pr="+b),E&&(a+="&bb="+E),"object"===r(j.gdpr)&&null!==j.gdpr&&(d=o({},j.gdpr),u={enabled:"gdpre",consent:"gdprc",log:"gdprl"},Object.keys(u).filter(function(t){return void 0!==d[t]}).map(function(t){switch(t){case"log":if(k){var e=window.localStorage.getItem(s.cmpResponseKey);if(null!==e){try{e=JSON.parse(e)}catch(t){e=null}window.localStorage.removeItem(s.cmpResponseKey)}null!==e&&(d.log=JSON.stringify(o({},JSON.parse(d.log),{rtimes:e})));var n=window.localStorage.getItem(s.cmpLocalStorageChanged);null!==n&&(window.localStorage.removeItem(s.cmpLocalStorageChanged),d.log=JSON.stringify(o({},JSON.parse(d.log),{cc:n})))}}a+="&"+u[t]+"="+encodeURIComponent(d[t])})),""+e+l+f+"/bid?"+a}function Wt(){j&&j.hasOwnProperty("Q")&&j.Q.forEach(function(t){"i"===t[0]?window.apstag.init.apply(null,t[1]):window.apstag.fetchBids.apply(null,t[1])})}function Yt(t){return H({type:"SET_GDPR_CONFIG",config:null}),H({type:"SET_CONFIG",config:t}),"success"}function Jt(){return j.hasOwnProperty("config")&&j.config.hasOwnProperty("deals")&&!0===j.config.deals}function Zt(){return j.hasOwnProperty("config")&&j.config.hasOwnProperty("adServer")&&"oas"===j.config.adServer}function $t(){return j.hasOwnProperty("config")&&j.config.hasOwnProperty("adServer")&&"googletag"===j.config.adServer}function te(){return"undefined"!=typeof googletag&&googletag.hasOwnProperty("apiReady")&&!0===googletag.apiReady}function ee(){return"undefined"!=typeof googletag&&void 0!==googletag.cmd}function ne(t){var e=t.slotID;t.hasOwnProperty("mediaType")&&"video"===t.mediaType||h("googletag")&&ee()&&(te()?re(e)&&De(t):googletag.cmd.push(function(){ne(t)}))}function re(t){var e;try{e=me().filter(function(e){return e.getSlotElementId()===t})[0]}catch(t){Ke(t,"__error-getGoogletagSlot__")}return e}function oe(t){return t.hasOwnProperty("amzniid")?t.amzniid:t.amzniid_sp}function ie(t,e,n){return t.amzniid===e||t[n+"amzniid"]===e||t.amzniid_sp===e}function ae(t){try{var e=j.targetingKeys[t];if(te()&&fe(e)){var n=re(t);e.forEach(function(t){return n.clearTargeting(t)})}}catch(t){Ke(t,"__error-clearTargetingFromGPTSlot__")}}function se(t){var e;try{var n=j.slotBids;n.hasOwnProperty(t)&&n[t].forEach(function(t){t.bidState===P.set&&(e=oe(t))})}catch(t){Ke(t,"__error-findBidIDSetBySlotID__")}return e}function ce(t){try{if(j.slotBids.hasOwnProperty(t)){var e=j.slotBids[t].filter(function(t){return t.bidState===P.set})[0];e&&e.bidState===P.set&&H({type:"BID_STATE_CHANGE",slotID:t,bidID:se(t),bidState:P.exposed})}}catch(t){Ke(t,"__error-clearbidSetOnSlot__")}}function ue(t,e,n){H({type:"SLOT_IMP_CHANGE",slotID:t,iid:e,ts:n})}function de(t,e){return decodeURIComponent(t).split("?")[0].split("#")[0]===decodeURIComponent(e).split("?")[0].split("#")[0]}function le(t,e){return t.indexOf(e)>-1}function fe(t){return"[object Array]"===Object.prototype.toString.call(t)}function pe(t,e){return t.map(function(t){return le(e,t)}).filter(function(t){return t}).length===t.length}function me(){var t=[];try{te()&&(t=googletag.pubads().getSlots())}catch(t){Ke(t,"__error-googletagSlots__")}return t}function ge(){var t={};try{Object.keys(j.slotBids).forEach(function(e){var n=j.slotBids[e];if(!(n.filter(function(t){return t.bidState===P.set}).length>0)){var r=n.filter(function(t){return Date.now()-j.AAXReqs.filter(function(e){return e.bidReqID===t.bidReqID})[0].rqTs<24e4}).filter(function(t){return de(ct(),j.AAXReqs.filter(function(e){return e.bidReqID===t.bidReqID})[0].url)}).filter(function(t){return t.bidState!==P.rendered});r.length>0&&(t[e]=r.map(function(t){var e=j.AAXReqs.filter(function(e){return e.bidReqID===t.bidReqID})[0].rqTs;return o({},t,{rqTs:e})}).reduce(function(t,e){return t.rqTs>e.rqTs?t:e}))}})}catch(t){Ke(t,"__error-getCurrentSlotBids__")}return t}function _e(t,e){return fe(j.targetingKeys[t])?e?["amzniid_sp"]:j.targetingKeys[t].filter(function(t){return t.indexOf("amzniid")>-1&&t.indexOf("amzniid_sp")<0}):["amzniid"]}function be(t,e){var n,r;try{var o=j.slotBids;Object.keys(o).forEach(function(i){o[i].forEach(function(o){_e(i,e).forEach(function(e){o[e]===t&&(n=o,"amzniid_sp"===e?r="sp":"amzniid"!==e&&(r=e.substr(0,e.indexOf("amzniid"))))})})})}catch(t){Ke(t,"__error-findSlotBidByBidID__")}return{slotBid:n,dealId:r}}function ye(t,e,n){var r;return e[n+"amzniid"]===t&&(r=n.split("_").pop().trim()),r}function he(t){var e={};return t.slots.forEach(function(t){"video"!==t.mediaType?e[t.slotID]=t:(t.slotID.indexOf("rsv-")>=0&&(t={slotID:t.slotID.substring(4),r_amznbid:t.amznbid,r_amzniid:t.amzniid,r_amznp:t.amznp,mediaType:"video",targeting:["r_amznbid","r_amzniid","r_amznp"]}),e[t.slotID]?(t.targeting=t.targeting.concat(e[t.slotID].targeting),e[t.slotID]=o({},e[t.slotID],t)):e[t.slotID]=t)}),Object.keys(e).map(function(t){return e[t]})}function Ie(t){var e,n=he(t),r=["host","ev","cb","cmp"];try{e=n.map(function(e){var n={bidState:P.new};return e.hasOwnProperty("amznsz")||(n.amznsz=e.size),r.forEach(function(e){if(t.hasOwnProperty(e)){var r=t[e],o=e;"cb"===e&&(o="bidReqID"),n[o]=r}}),o({},e,n)})}catch(t){Ke(t,"__error-convertAAXResponse__")}return e}function De(t){try{var e,n=t.slotID,r=oe(t),o=t.targeting?t.targeting:Kn("display");(e=re(n))&&(Object.keys(t).filter(function(t){return le(o,t)}).forEach(function(n){return e.setTargeting(n,t[n])}),H({type:"BID_STATE_CHANGE",slotID:n,bidID:r,bidState:P.set}))}catch(t){Ke(t,"__error-applyTargetingToGPTSlot__")}}function Ee(t){var e=ge();t.forEach(function(t){e[t]&&ne(e[t])})}function ve(){var t=ge();Object.keys(t).forEach(function(e){ne(t[e])})}function Se(t){try{t?Ee(t):ve(),j.DFP.slotRenderEndedSet||(googletag.cmd.push(function(){googletag.pubads().addEventListener("slotRenderEnded",function(t){ae(t.slot.getSlotElementId()),ce(t.slot.getSlotElementId())})}),H({type:"DFP_SLOT_RENDER_ENDED_SET"}))}catch(t){Ke(t,"__error-applyGPTSlotTargeting__")}}function we(t){var e="?b="+t.bidID+"&rnd="+Gt(),n=""+t.host+Z+"/imp";return I(t,"pp")&&(e+="&pp="+t.pp),I(t,"amznp")&&(e+="&p="+t.amznp),I(t,"crID")&&(e+="&crid="+t.crID),"1"===t.fif?n+"j"+e:n+"i"+e}function Re(t){var e=t.doc.createElement("iframe");return e.frameBorder=0,e.marginHeight=0,e.marginWidth=0,e.topMargin=0,e.leftMargin=0,e.scrolling="no",e.allowTransparency=!0,e.width=t.sizes[0]+"px",e.height=t.sizes[1]+"px",e}function Oe(t){Pe({bidID:t.amzniid,doc:t.document,pp:t.amznbid.split("_").pop(),host:t.amznhost,adID:"amznad"+Math.round(1e6*Math.random()),sizes:t.amznsz.split("x"),fif:!1,isAmp:!0,amznp:t.amznp})}function Te(t){var e=Re(t);e.id="apstag-f-iframe-"+Gt(),e.srcdoc=t.html,t.doc.body.appendChild(e)}function Pe(t,e){var n=Re(t);if(n.id=t.adID,n.sandbox="allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation",F){var r='<body style="background-color: #FF9900;">'+(t.sizes[1]>50?"<h3>apstag Test Creative</h3>":"")+"<h4>amzniid - "+t.bidID+" | amznbid: "+t.pp+" | size: "+t.sizes.join("x")+"</h4></body>";n.src="javascript:'"+r+"'"}else n.src=we(t);t.doc.body.appendChild(n),e&&wt(t.doc.getElementById(t.adID),function(){return e(t.doc,t.bidID,n)})}function ze(t,e,n){var r;h("amzncsm")?r=window.amzncsm:t.defaultView.hasOwnProperty("amzncsm")&&(r=t.defaultView.amzncsm),r&&(r.host=it(),r.rmD(n,e,t.defaultView,t,j.config.pubID))}function Ae(t){var e=t.map(Ue),n={};return Object.keys(j.slotBids).forEach(function(t){var r=j.slotBids[t].filter(function(t){return t.bidState===P.new})[0];r&&le(e,t)&&(n[t]=r,H({type:"BID_STATE_CHANGE",slotID:t,bidID:oe(r),bidState:P.exposed}))}),n}function qe(t,e){var n="0x0";return Jt()?{slotID:t,size:n,mediaType:"banner",targeting:{amznbid:e,amzniid:"",amznp:e,amznsz:n},helpers:{targetingKeys:["amznbid","amzniid","amznp","amznsz"]}}:{slotID:t,amzniid:"",amznbid:e,amznp:e,amznsz:n,size:n}}function Ce(t,e){var n="";return t.targeting.forEach(function(e){n+="&"+e+"="+t[e]}),!0===e&&(n=encodeURIComponent(n)),n}function xe(t,e,n){var r,o=e.slots.filter(Rn).map(Ue),i=t.map(Ue);return r=n?o.map(function(t){return qe(t,A.bidInFlight)}):o.reduce(function(t,e){return le(i,e)||t.push(qe(e,A.noBid)),t},[]),t.concat(r)}function Be(t,e){return function(n){var r=Ae(e.slots),o=Object.keys(r),i=[];n&&(H({type:"RECORD_AAX_RESPONSE_PROP",bidReqID:e.bidReqID,key:"timedOutAt",value:Date.now()}),j.experiments.chunkRequests&&H({type:"RECORD_TIMEOUT",fid:e.bidReqID,timeOut:Date.now()})),o.forEach(function(t){if(r.hasOwnProperty(t)){var e=r[t],n={};if(Jt())e.meta.forEach(function(t){n[t]=e[t]}),n.targeting={},e.targeting.forEach(function(t){n.targeting[t]=e[t]}),n.helpers={targetingKeys:e.targeting,qsParams:Ce.bind(null,e,!1),encodedQsParams:Ce.bind(null,e,!0)};else if(e.hasOwnProperty("amznbid")){if(e.hasOwnProperty("amznp")||(e.amznp=""),n={amzniid:e.amzniid,amznbid:e.amznbid,amznp:e.amznp,slotID:t},e.hasOwnProperty("size")&&(n.size=e.size,n.amznsz=e.amznsz),"video"===e.mediaType){n.mediaType="video";var o="";e.amznbid?o+="&amzniid="+e.amzniid+"&amznbid="+e.amznbid+"&amznp="+e.amznp:(n.amznbid="",n.amzniid=""),e.r_amznbid?(n.r_amznbid=e.r_amznbid,n.r_amzniid=e.r_amzniid,n.r_amznp=e.r_amznp,o+="&r_amzniid="+e.r_amzniid+"&r_amznbid="+e.r_amznbid+"&r_amznp="+e.r_amznp):(n.r_amznbid="",n.r_amzniid="",n.r_amznp=""),n.qsParams=o,n.encodedQsParams=encodeURIComponent(o)}}else n=qe(e.slotID,A.noBid);i.push(n)}}),$t()&&(i=xe(i,e,n)),t(i,{fromTimeout:n})}}function Ne(t,e){try{var n;(n=t.defaultView&&t.defaultView.frameElement?t.defaultView.frameElement:window.frameElement).width=e[0],n.height=e[1]}catch(t){Ke(t,"__error-resizeIframe__")}}function Le(t){return t[0]+"x"+t[1]}function ke(t){return 1===t.length?Le(t[0]):Le(t[Math.floor(t.length*Math.random())])}function Fe(t,e){var n,r=it(),o=ct(),i=t.bidReqID,a=Xt(),s=rt("testBidTimeout")||200;H({type:"RECORD_AAX_REQUEST",data:{bidConfig:t,timeout:s,bidReqID:i,ws:a,url:o,rqTs:Date.now()}}),n=t.slots.map(function(t){var e={slotID:t.slotID,amzniid:S.amzniid+"-"+Gt(),amznbid:S.amznbid,amznp:S.amznp,crid:S.crid+"-"+Gt()};if(t.hasOwnProperty("sizes")){var n=ke(t.sizes);e.size=n,e.amznsz=n}else"video"===t.mediaType&&(e.mediaType="video",e.amznbid="v_"+e.amznbid);if(Jt()){e.mediaType="banner",e.meta=["slotID","mediaType","size"],e.amznbid_sp=S.amznbid+"SP",e.amznp_sp=S.amznp+"SP",e.amznsz_sp=e.size;var r="testDeal"+Gt()+"_"+e.size,o="testDealImpression-"+Gt();e.amzndeal_sp=r,e.amzndeals=[r],e[r+"amzniid"]=o,e.amzniid_sp=o,e.targeting=["amzniid","amznbid","amznp","amznsz","amzniid_sp","amznbid_sp","amznp_sp","amznsz_sp","amzndeal_sp","amzndeals",r+"amzniid"]}return e}),window.setTimeout(function(){window.apstag.bids({slots:n,host:r,status:"ok",cb:i}),e(!0)},s)}function Ue(t){return t.slotID}function je(t){var e=j.AAXReqs.filter(function(e){return e.bidReqID===t.cb})[0];if(e&&e.bidConfig&&e.bidConfig.slots){var n=e.bidConfig.slots.filter(Rn).map(function(t){return t.slotID}),r=t.hasOwnProperty("slots")?t.slots.map(function(t){return t.slotID}):[],o=n.filter(function(t){return!le(r,t)});H({type:"NO_BID_ON_DFP_SLOTS",slotIDs:o}),te()?Xe():ee()&&googletag.cmd.push(function(){Xe()})}}function Me(t){return le(j.AAXReqs.filter(function(t){return!t.resTs}).map(function(t){return t.bidConfig.slots}).reduce(function(t,e){return t.concat(e)},[]).map(Ue),t)}function Ge(t){var e=t.getTargeting("amznbid");return e.length>0&&e[0].length>2}function Xe(){$t()&&(te()&&"1"===googletag.pubads().getTargeting("amznbid")[0]&&Ve(),me().forEach(function(t){!le(j.DFP.noBidSlotIDs,t.getSlotElementId())||Me(t.getSlotElementId())||Ge(t)||"2"===t.getTargeting("amznbid")[0]||He(t,"noBid")}))}function He(t,e){T.forEach(function(n){return t.setTargeting(n,A[e])})}function Ve(){T.forEach(function(t){return googletag.pubads().clearTargeting(t)})}function Qe(t){var e={_type:"dupePixel",dd:Date.now()-t.renderTime};dt(tn(t.amzniid,e))}function Ke(t,e){void 0===j||void 0===j.config?y(t,e):y(t,e,j.config.isSelfServPub,B,j.config.pubID,lt())}function We(){var t=Ct("apstag"),e=en({pid:v,ns:n,fs:Bt(t),re:Nt(t)});window.setTimeout(function(){dt(e)},1e3)}function Ye(){try{window.setTimeout(function(){var t=an().filter(function(t){return!j.bsPixels.hasOwnProperty(t.iid)||t.state!==j.bsPixels[t.iid]});t&&t.length&&t.length>0&&(t.forEach(function(t){dt(tn(t.iid,rn(t)))}),nn(t));var e={fetchStart:"a",domainLookupStart:"b",domainLookupEnd:"c",connectStart:"d",secureConnectionStart:"e",connectEnd:"f",requestStart:"g",responseStart:"h",responseEnd:"i",resTs:"j"};Object.keys(j.slotBids).forEach(function(t){j.slotBids[t].filter(function(t){return void 0!==t.amzniid}).forEach(function(n){if(!n.pixelSent){var o=j.AAXReqs.filter(function(t){return t.bidReqID===n.bidReqID})[0];if("object"===(void 0===o?"undefined":r(o))&&null!==o){var i={pid:v,lv:p,ns:o.bidConfig.slots.length,fid:n.bidReqID,fbrq:o.rqTs,_type:"latencyBd"};"object"===r(o.perf)&&null!==o.perf&&Object.keys(e).forEach(function(t){"object"===r(o.perf)&&void 0!==o.perf[t]&&0!==o.perf[t]&&0!==xt(o.perf,t)&&(i[e[t]]=xt(o.perf,t)-o.rqTs)}),i[e.resTs]=o.resTs-o.rqTs,ln.bidCacheIdPixel(n.amzniid,i),H({type:"UPDATE_BID_INFO_PROP",slotID:t,iid:n.amzniid,key:"pixelSent",value:!0})}}})}),Ye()},5e3)}catch(t){Ke(t,"__error-bidSetPixel__")}}function Je(){return Object.keys(j.curDFPViewability).forEach(function(t){H({type:"SAVE_DFP_VIEWABILITY",slotID:t})}),en({pid:v,ns:n,pl:qt("loadEventStart"),pe:Date.now(),n:j.allDFPViewability.length,_type:"DFPViewability",slots:j.allDFPViewability})}function Ze(){dt(Je())}function $e(){googletag.cmd.push(function(){googletag.pubads().addEventListener("slotOnload",function(t){try{H({type:"SET_DFP_VIEWABILITY_PROPERTY",slotID:t.slot.getSlotElementId(),prop:"loadTs",val:Date.now()})}catch(t){}}),googletag.pubads().addEventListener("impressionViewable",function(t){try{H({type:"SET_DFP_VIEWABILITY_PROPERTY",slotID:t.slot.getSlotElementId(),prop:"viewTs",val:Date.now()})}catch(t){}}),googletag.pubads().addEventListener("slotRenderEnded",function(t){try{var e=t.slot.getSlotElementId();j.curSlotImps.hasOwnProperty(e)&&!j.curSlotImps[e].slotRendered||ue(e,null,null),H({type:"SLOT_RENDERED",slotID:e});var n=j.curSlotImps[e].iid,r=j.curSlotImps[e].ts;j.curDFPViewability.hasOwnProperty(e)&&H({type:"SAVE_DFP_VIEWABILITY",slotID:e}),H({type:"SET_DFP_VIEWABILITY_PROPERTY",slotID:e,prop:"iid",val:n}),H({type:"SET_DFP_VIEWABILITY_PROPERTY",slotID:e,prop:"renderStartTs",val:r})}catch(t){}})}),window.addEventListener("beforeunload",Ze)}function tn(t,e){return e._tl="aps-tag",""+lt()+t+"/"+pt(e)}function en(t){return t._tl="aps-tag",lt()+"p/PH/"+pt(t)}function nn(t){t.forEach(function(t){return H({type:"RECORD_BID_INFO_SENT",bidInfo:t})})}function rn(t){var e={};try{var n=on(t.fid);(e={status:t.state,pubid:j.config.pubID,_type:"bidSetPixel"}).toa=n.req.hasOwnProperty("timedOutAt")?n.req.timedOutAt:"0",e.fbrq=n.req.rqTs,e.pto=n.req.timeout,e.ns=n.req.bidConfig.slots.length,e.bla=n.req.resTs-n.req.rqTs,e.reqindex=n.index,e.fid=t.fid,W&&(e.eid=j.experiments.chunkRequests?2:1,e.fbindex=n.fbIndex,e.fbns=j.bidConfigs[t.fid.split("-")[0]].slots.length),t.delta&&(e.delay=t.delta)}catch(t){Ke(t,"__error-mapBidInfoToPixel__")}return e}function on(t){var e={req:j.AAXReqs.filter(function(e){return e.bidReqID===t})[0]};return e.index=j.AAXReqs.indexOf(e.req)+1,j.experiments.chunkRequests?e.fbIndex=j.AAXReqs.filter(function(t){return-1===t.bidReqID.indexOf("-")||"0"===t.bidReqID.split("-")[1]}).map(function(t){return t.bidReqID.split("-")[0]}).indexOf(t.split("-")[0])+1:e.fbIndex=e.index,e}function an(){var t=dn(),e=[];return t?(Object.keys(j.slotBids).forEach(function(n){"video"!==j.slotBids[n][0].mediaType&&j.slotBids[n].filter(function(t){return void 0!==t.amzniid}).forEach(function(r){var o={slotID:n,iid:r.amzniid,fid:r.bidReqID},i=[],a=[];if(n in t&&(i=t[n].fetchedAt.filter(function(t){return t.AAXReqInfo&&t.AAXReqInfo.bidReqID===r.bidReqID}),a=t[n].targetedAt.filter(function(t){return t.targeting===r.amzniid})),i.length>0?i.length>0&&a.length>=i.length&&i.slice(i.length-1)[0].ts>a.slice(i.length-1)[0].ts?1===t[n].fetchWithIID.filter(function(t){return t===r.amzniid}).length?o.state=1:o.state=4:-1!==t[n].fetchWithIID.indexOf(r.amzniid)?o.state=3:o.state=2:o.state=0,1===o.state||2===o.state){var s=j.AAXReqs.filter(function(t){return t.bidReqID===r.bidReqID})[0].resTs,c=sn(s,t[n].fetchedAt,2===o.state);c&&c.hasOwnProperty("ts")&&(o.delta=s-c.ts)}e.push(o)})}),e):e}function sn(t,e,n){return e[cn(e.map(function(e){var r=t-e.ts;return n?r>=0?r:null:r<=0?-r:null}))]}function cn(t){for(var e,n,r,o=0;o<t.length;o++)"number"==typeof(e=t[o])&&("number"!=typeof r||e<n)&&(r=o,n=e);return r}function un(t,e){return j.AAXReqs.filter(function(t){return t.bidConfig.slots.map(function(t){return t.slotID}).indexOf(e)>-1})[t]}function dn(){if(!te())return null;var t=googletag.debug_log.getAllEvents().map(function(t){var e=t.getMessage(),n=t.getSlot();return{id:e.getMessageId(),args:e.getMessageArgs(),slotID:n?n.getSlotElementId():null,ts:t.getTimestamp().getTime()}}).filter(function(t){return 17===t.id&&"amzniid"===t.args[0]||103===t.id&&"amzniid"===t.args[0]||3===t.id}).reduce(function(t,e){t.hasOwnProperty(e.slotID)||(t[e.slotID]={fetchedAt:[],targetedAt:[]});var n=t[e.slotID];return 3===e.id?n.fetchedAt.push({ts:e.ts,AAXReqInfo:un(t[e.slotID].fetchedAt.length,e.slotID)}):17===e.id?n.targetedAt.push({ts:e.ts,targeting:e.args[1]}):103===e.id&&n.targetedAt.push({ts:e.ts,targeting:""}),t},{});return Object.keys(t).forEach(function(e){var n=t[e];n.fetchWithIID=n.fetchedAt.map(function(t){var e=sn(t.ts,n.targetedAt,!0);return e?e.targeting:0}),t[e]=n}),t}var ln={noBidCacheIDPixel:function(t){return dt(en(t))},bidCacheIdPixel:function(t,e){return dt(tn(t,e))}},fn={shouldSample:_,getRandomArrayElement:function(t){return Dn(t)[0]},getRand:Gt,winHasProp:h,hasLocalStorage:function(){return k}},pn={wrapFunction:function(t,e){return function(){try{return t.apply(null,arguments)}catch(t){return Ke(t,e),null}}},reportError:Ke},mn={dispatch:H},gn;function _n(){bn(),yn()}function bn(){"http://"===ot()&&new a.default(fn,ln,mn,{run:hn.bind(null,["http","https"]),cases:{aax:["http://d29a6k4186aqcx.cloudfront.net/2k.txt","https://d29a6k4186aqcx.cloudfront.net/2k.txt"],cf:["http://d29a6k4186aqcx.cloudfront.net/2k.txt","https://d29a6k4186aqcx.cloudfront.net/2k.txt"]},name:"https"})}function yn(){new a.default(fn,ln,mn,{run:hn.bind(null,["aax","cf"]),cases:{tst:["https://d29a6k4186aqcx.cloudfront.net/2k.txt","https://d29a6k4186aqcx.cloudfront.net/2k.txt"]},name:"edge-server"})}function hn(t,e,n){vn(Dn(n=In(n)),function(){var r;return e((d(r={pubID:j.config?j.config.pubID:null},t[0],En(n[0])),d(r,t[1],En(n[1])),r))})}function In(t){return t.map(function(t){return t+(-1===t.indexOf("?")?"?":"&")+"cb="+Gt()})}function Dn(t){var e,n,r=t.length;for(t=[].concat(u(t));0!==r;)n=Math.floor(Math.random()*r),e=t[r-=1],t[r]=t[n],t[n]=e;return t}function En(t){try{var e=Ct(t);return Nt(e)-Bt(e)}catch(t){return Ke(t,"__getRoundTripTime-error__"),0}}function vn(t,e){var n={requests:{},callback:!1};t.map(function(t){n.requests[t]=!1});var r=function(t){n.requests[t]=!0,!n.callback&&Sn(n.requests)&&e()};t.map(function(t){Pt({url:t,onload:r.bind(null,t),onerror:r.bind(null,t,!0)})})}function Sn(t){var e=Object.keys(t);return e.map(function(e){return t[e]}).filter(function(t){return t}).length===e.length}function wn(){$t()&&(te()?He(googletag.pubads(),"noRequest"):ee()&&(googletag.cmd=[function(){He(googletag.pubads(),"noRequest")}].concat(u(googletag.cmd))))}function Rn(t){return"video"!==t.mediaType}function On(t){$t()&&ee()&&(H({type:"REQUESTED_BID_FOR_DFP_SLOTS",slotIDs:t}),H({type:"REQUESTED_BID_FOR_PMP_ONLY_DFP_SLOTS",slotIDs:t}),googletag.cmd.push(function(){var e=me();"0"===googletag.pubads().getTargeting("amznbid")[0]&&Ve(),pe(t,e.map(function(t){return t.getSlotElementId()}))?e.forEach(function(e){le(t,e.getSlotElementId())&&!Ge(e)&&He(e,"bidInFlight")}):googletag.cmd.push(function(){He(googletag.pubads(),"bidInFlight")})}))}function Tn(t){switch(t){case"getLog":return j.eventLog;case"getState":return j;case"enable":return yt(!0),"DEBUG MODE ENABLED";case"disable":return yt(!1),"DEBUG MODE DISABLED";case"enableConsole":return ht(q),"Debug console enabled";case"disableConsole":return ht(C),"Debug console disabled";default:return"unknown debug argument"}}function Pn(t){return t.split("x").map(function(t){return parseInt(t,10)})}function zn(t,e){var n=Date.now();if(t.type&&"amp"===t.type)Oe(t);else{var r=!1;e&&"string"==typeof e&&0===e.indexOf("sp|")&&(e=e.substring(3),r=!0);var o,i=e||t.amzniid,a=be(i,r),s=a.slotBid,c=a.dealId;if(o=c&&c.length>=1?Pn("sp"===c?s.amznsz_sp:ye(i,s,c)):Pn(s.size),1!==arguments.length){if(s){s.bidState===P.rendered&&Qe(s),H({type:"BID_STATE_CHANGE",slotID:s.slotID,bidID:e,bidState:P.rendered,dealId:c}),j.shouldSampleLatency&&ue(s.slotID,i,n),mt.addTimer("imp");var d=s.host,u="amznad"+Math.round(1e6*Math.random()),l=An("amznbid",s,c),f=An("amznp",s,c),p=An("crid",s,c),m={bidID:e,doc:t,pp:l,host:d,adID:u,sizes:o,amznp:f,crID:p,fif:!1,dealId:c};"1"===s.fif?(m.fif="1",H({type:"STORE_IMPRESSION_DOC_REF",slotID:s.slotID,bidID:e,doc:t,dealId:c}),At(we(m),null,document)):j.aaxViewabilityEnabled?Zt()&&"loading"===t.readyState?t.addEventListener("DOMContentLoaded",function(){qn(m,t)}):qn(m,t):Pe(m),Ne(t,o)}}else Te({doc:s.doc,sizes:o,html:t.html})}}function An(t,e,n){return n&&n.length>=1?"sp"===n?e[t+"_sp"]:"":e[t]?e[t]:""}function qn(t,e){var n=e.createElement("script");n.type="text/javascript",n.async=!0,e.body.appendChild(n),wt(n,function(){Pe(t,ze)}),n.src=Q}function Cn(t){Ut(t),H({type:"UPDATE_SLOT_BIDS",bids:Ie(t)}),t.hasOwnProperty("ev")&&H({type:"SET_VIEWABILITY",viewability:t.ev}),jt(t)}function xn(){return"number"==typeof nt&&nt>0}function Bn(t,e){var n=Mn.bind(null,t,e);void 0===j.gdpr||null===j.gdpr?(H({type:"ADD_GDPR_QUE_ITEM",func:n}),1===j.gdprQue.length&&(0,s.GDPR)(j.config.gdpr,Nn,pn,fn)):n()}function Nn(t){H({type:"SET_GDPR_CONFIG",config:t}),j.gdprQue.map(function(t){try{t()}catch(t){Ke(t,"__gdpr_que__")}}),H({type:"CLEAR_GDPR_QUE"})}function Ln(t){var e=["300,250","300,600","160,600","320,50","728,90","970,90"],n="";return t.filter(function(t){return n=t.join(","),e.indexOf(n)>=0})}function kn(t){if("fluid"===t[0])return[];var e=t.map(function(t){return[t.getWidth(),t.getHeight()]});return j.config.isSelfServPub?Ln(e):e}function Fn(t){var e=Xt().split("x");return{slotID:t.getSlotElementId(),slotName:t.getAdUnitPath(),sizes:kn(t.getSizes(Number(e[0]),Number(e[1])))}}function Un(t){return t.filter(function(t){return 0!==t.sizes.length})}function jn(t){return t||(t=me()),Un(t.map(function(t){return Fn(t)}))}function Mn(t,e){var n=Object.keys(t).length,r=j.config.simplerGPT;!0!==r||!I(t,"timeout")||1!==n&&0!==n||(t.slots=jn()),!0===r&&I(t,"slots")&&t.slots[0]&&!t.slots[0].hasOwnProperty("slotID")&&(t.slots=jn(t.slots));var o,i,a,s=Xn(t.slots);s&&(t.slots=s);try{i=t.timeout||j.config.bidTimeout||J,"function"!=typeof e&&(e=function(){}),t.bidReqID=Gt(),o=Mt(Be(e,t),i)}catch(t){Ke(t,"__error-fetchBids__")}if(0===t.slots.length)return Ke(new Error("No slots provided for bid request"),"__error-no_slots_provided_bid_request__"),void setTimeout(e.bind(null,[]),10);if(On(t.slots.filter(Rn).map(Ue)),H({type:"NEW_FETCH_BID_REQUEST",fid:t.bidReqID,pto:i}),H({type:"RECORD_ORIGINAL_BID_CONFIG",bidConfig:t}),F)Fe(t,o);else if(N)if(H({type:"SHOULD_CHUNK_REQUESTS"}),j.experiments.chunkRequests&&xn()){a=Gn(t);for(var c=0;c<a.length;c++)a[c].bidReqID=t.bidReqID+"-"+c;H({type:"ADD_CHUNKED_REQUESTS",fid:t.bidReqID,numChunks:a.length}),a.forEach(function(t){zt(Kt(t,i),o,t.bidReqID)})}else zt(Kt(t,i),o,t.bidReqID);else At(Kt(t,i),o)}function Gn(t){for(var e=Math.ceil(t.slots.length/nt),n=new Array(e),r=0;r<e;r++){var i=r*nt;n[r]={slots:t.slots.slice(i,i+nt)}}return n.map(function(e){return o({},t,e)})}function Xn(t){try{return t.map(function(t){return t.sizes&&fe(t.sizes)&&!fe(t.sizes[0])?o({},t,{sizes:[t.sizes]}):t})}catch(t){Ke(t,"__error-adjustSlotArraySizes__")}return!1}function Hn(t){t.punt=!0,Ut(t),jt(t)}function Vn(t){j.config.hasOwnProperty("adServer")&&$t()&&(Se(t),Xe())}function Qn(t,e){var n=Yt(t);wn(),"success"===n&&"function"==typeof e&&e()}function Kn(){var t=arguments.length<=0||void 0===arguments[0]?"display":arguments[0];switch(t){case"display":return R;case"video":return O;default:return Jt()&&fe(j.targetingKeys[t])?j.targetingKeys[t]:"unknown targeting type "+t}}function Wn(){var t=new XMLHttpRequest,e=Y;t.open("GET",e,!0),t.onreadystatechange=function(){t.readyState===XMLHttpRequest.DONE&&200===t.status&&Yn(t.responseText)},t.send()}function Yn(t){var e=document.createElement("iframe");e.frameBorder=0,e.marginHeight=0,e.marginWidth=0,e.topMargin=0,e.leftMargin=0,e.scrolling="no",e.allowTransparency=!0,e.width="100%;",e.height="200px",e.id="apstag-debug-iframe",e.srcdoc=t,e.style="background: #eaeded; z-index: 2147483647; line-height: 1; text-align: center; font-size: 12px; font-family: sans-serif; font-weight: bold; bottom: 0; position: fixed !important;",document.body.appendChild(e)}function Jn(t,e){var n=e;return function(){return It({method:t,args:arguments}),n.apply(void 0,arguments)}}function Zn(t){return function(){try{return t.apply(void 0,arguments)}catch(e){return Ke(e,t.name),null}}}mt.addTimer("tlt");try{Object.prototype.hasOwnProperty.call(window,"apstag")&&Object.prototype.hasOwnProperty.call(window.apstag,"_Q")&&window.apstag._Q.length>0&&H({type:"SET_Q",Q:window.apstag._Q})}catch(t){Ke(t,"__error-storeApstagQ__")}window.apstag=(gn={punt:Hn,init:Qn,debug:Tn,targetingKeys:Kn,fetchBids:Bn,setDisplayBids:Vn,renderImp:zn,bids:Cn},U&&(Object.keys(gn).forEach(function(t){gn[t]=Jn(t,gn[t])}),Wn()),Object.keys(gn).forEach(function(t){gn[t]=Zn(gn[t])}),gn),function(){try{H({type:"SHOULD_SAMPLE_LATENCY"}),j.shouldSampleLatency&&(We(),Ye(),$e()),_(0)&&_n()}catch(t){Ke(t,"__error-sampleLatency__")}try{Wt()}catch(t){Ke(t,"__error-doLast__")}try{var t={};t.url=K;var e=function(t){t&&"object"!==(void 0===t?"undefined":r(t))||(t="Request Timeout or Error"),Ke({message:"csm-rtb-comm-js loading failed",name:t},"__csm-rtb-comm-js__")};t.onload=function(t){t.readyState===XMLHttpRequest.DONE&&200===t.status?eval(t.responseText):e(JSON.stringify({status:t.statusText,response:t.responseXML}))},t.onerror=e,t.ontimeout=e,Pt(t)}catch(t){Ke(t,"__load-csm-rtb-comm-js__")}}()}()}catch(t){y(t,"__error-global__")}},function(t,e,n){t.exports=n(2)}]);
//# sourceMappingURL=apstag.js.map