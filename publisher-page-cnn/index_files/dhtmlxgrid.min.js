function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop?window.dhtmlDragAndDrop:(this.lastLanding=0,this.dragNode=0,this.dragStartNode=0,this.dragStartObject=0,this.tempDOMU=null,this.tempDOMM=null,this.waitDrag=0,window.dhtmlDragAndDrop=this,this)}function dhtmlxEvent(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,i)}function dataProcessor(t){return this.serverProcessor=t,this.action_param="!nativeeditor_status",this.object=null,this.updatedRows=[],this.autoUpdate=!0,this.updateMode="cell",this._tMode="GET",this._headers=null,this._payload=null,this.post_delim="_",this._waitMode=0,this._in_progress={},this._invalid={},this.mandatoryFields=[],this.messages=[],this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",error:"color:red;",clear:"font-weight:normal;text-decoration:none;"},this.enableUTFencoding(!0),dhx4._eventable(this),this.connector_init&&(this.setTransactionMode("POST",!0),this.serverProcessor+=(this.serverProcessor.indexOf("?")!=-1?"&":"?")+"editing=true"),this}function dhtmlXCalendarObject(t,e){this.i={};var i=null;if("string"==typeof t)var s=document.getElementById(t);else var s=t;s&&"object"==typeof s&&s.tagName&&"input"!=String(s.tagName).toLowerCase()&&(i=s),s=null,"object"==typeof t&&t.length||(t=[t]);for(var l=0;l<t.length;l++)"string"==typeof t[l]&&(t[l]=document.getElementById(t[l])||null),null!=t[l]&&t[l].tagName&&"input"==String(t[l].tagName).toLowerCase()?this.i[window.dhx4.newId()]={input:t[l]}:t[l]instanceof Array||!(t[l]instanceof Object)||null==t[l].input&&null==t[l].button||(null!=t[l].input&&"string"==typeof t[l].input&&(t[l].input=document.getElementById(t[l].input)),null!=t[l].button&&"string"==typeof t[l].button&&(t[l].button=document.getElementById(t[l].button)),this.i[window.dhx4.newId()]=t[l]),t[l]=null;this.conf={skin:e||window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhtmlxcalendar")||"dhx_skyblue",zi:window.dhx4.newId(),touch:!window.dhx4.isIE,time:!0,today:!1,ws_first:!0},this.setSkin=function(t,e){(this.conf.skin!=t||e)&&(this.conf.skin=t,this.base.className="dhtmlxcalendar_"+this.conf.skin,this._ifrSize())},this.base=document.createElement("DIV"),this.base.style.display="none",this.base.appendChild(document.createElement("DIV")),null!=i?(this._hasParent=!0,i.appendChild(this.base),i=null):document.body.appendChild(this.base),this.setParent=function(t){this._hasParent&&("object"==typeof t?t.appendChild(this.base):"string"==typeof t&&document.getElementById(t).appendChild(this.base))},this.setSkin(this.conf.skin,!0),this.base.onclick=function(t){t=t||event,t.preventDefault&&t.preventDefault(),t.cancelBubble=!0},this.base.onmousedown=function(){return!1},this.conf.touch&&(this.base.ontouchstart=this.base.onclick),this.loadUserLanguage=function(t){if(this.langData[t]&&(this.lang=t,this.setWeekStartDay(this.langData[this.lang].weekstart),this.setDateFormat(this.langData[this.lang].dateformat||"%Y-%m-%d"),this.msCont))for(var e=0,i=0;i<this.msCont.childNodes.length;i++)for(var s=0;s<this.msCont.childNodes[i].childNodes.length;s++)this.msCont.childNodes[i].childNodes[s].innerHTML=this.langData[this.lang].monthesSNames[e++]},this.contMonth=document.createElement("DIV"),this.contMonth.className="dhtmlxcalendar_month_cont",this.contMonth.onselectstart=function(t){return t=t||event,t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},this.base.firstChild.appendChild(this.contMonth);var n=document.createElement("UL");n.className="dhtmlxcalendar_line",this.contMonth.appendChild(n);var o=document.createElement("LI");o.className="dhtmlxcalendar_cell dhtmlxcalendar_month_hdr",o.innerHTML="<div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left\";'></div><span></span><div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right\";'></div>",n.appendChild(o);var r=this;o.onclick=function(t){t=t||event,"touchstart"==t.type&&null!=t.preventDefault&&t.preventDefault();var e=t.target||t.srcElement;if(e.className&&0===e.className.indexOf("dhtmlxcalendar_month_arrow")){r._hideSelector();var i=e.parentNode.firstChild==e?-1:1,s=new Date(r._activeMonth);return r._drawMonth(new Date(r._activeMonth.getFullYear(),r._activeMonth.getMonth()+i,1,0,0,0,0)),void r._evOnArrowClick([s,new Date(r._activeMonth)])}return e.className&&"dhtmlxcalendar_month_label_month"==e.className?(t.cancelBubble=!0,void r._showSelector("month",Math.round(e.offsetLeft+e.offsetWidth/2),e.offsetTop+e.offsetHeight+2,"selector_month",!0)):e.className&&"dhtmlxcalendar_month_label_year"==e.className?(t.cancelBubble=!0,void r._showSelector("year",Math.round(e.offsetLeft+e.offsetWidth/2),e.offsetTop+e.offsetHeight+2,"selector_year",!0)):void r._hideSelector()},1==this.conf.touch&&(o.ontouchstart=o.onclick),this.contDays=document.createElement("DIV"),this.contDays.className="dhtmlxcalendar_days_cont",this.base.firstChild.appendChild(this.contDays),this.setWeekStartDay=function(t){0==t&&(t=7),this._wStart=Math.min(Math.max(isNaN(t)?1:t,1),7),this._drawDaysOfWeek()},this._drawDaysOfWeek=function(){if(0==this.contDays.childNodes.length){var t=document.createElement("UL");t.className="dhtmlxcalendar_line",this.contDays.appendChild(t)}else var t=this.contDays.firstChild;var e=this._wStart,i=this.langData[this.lang].daysSNames;i.push(String(this.langData[this.lang].daysSNames[0]).valueOf());for(var s=0;s<8;s++){if(null==t.childNodes[s]){var l=document.createElement("LI");t.appendChild(l)}else var l=t.childNodes[s];0==s?(l.className="dhtmlxcalendar_cell_wn",l.innerHTML="<div class='dhtmlxcalendar_label'>"+(this.langData[this.lang].weekname||"w")+"</div>"):(l.className="dhtmlxcalendar_cell"+(e>=6?" dhtmlxcalendar_day_weekday_cell":"")+(1==s?"_first":""),l.innerHTML=i[e],++e>7&&(e=1))}null!=this._activeMonth&&this._drawMonth(this._activeMonth)},this._wStart=this.langData[this.lang].weekstart,this.setWeekStartDay(this._wStart),this.contDates=document.createElement("DIV"),this.contDates.className="dhtmlxcalendar_dates_cont",this.base.firstChild.appendChild(this.contDates),this.contDates.onclick=function(t){t=t||event,"touchstart"==t.type&&null!=t.preventDefault&&t.preventDefault();var e=t.target||t.srcElement;if(null!=e.parentNode&&null!=e.parentNode._date&&(e=e.parentNode),null!=e._date&&!e._css_dis){var i=r._activeDate.getHours(),s=r._activeDate.getMinutes(),l=e._date;if(r.checkEvent("onBeforeChange")&&!r.callEvent("onBeforeChange",[new Date(e._date.getFullYear(),e._date.getMonth(),e._date.getDate(),i,s)]))return;null!=r._activeDateCell&&(r._activeDateCell._css_date=!1,r._updateCellStyle(r._activeDateCell._q,r._activeDateCell._w));var n=r._activeDate.getFullYear()+"_"+r._activeDate.getMonth()!=l.getFullYear()+"_"+l.getMonth();r._nullDate=!1,r._activeDate=new Date(l.getFullYear(),l.getMonth(),l.getDate(),i,s),r._activeDateCell=e,r._activeDateCell._css_date=!0,r._activeDateCell._css_hover=!1,r._updateCellStyle(r._activeDateCell._q,r._activeDateCell._w),n&&r._drawMonth(r._activeDate),r._activeInp&&r.i[r._activeInp]&&null!=r.i[r._activeInp].input&&(r.i[r._activeInp].input.value=r._dateToStr(new Date(r._activeDate.getTime()))),r._hasParent||("touchstart"==t.type?window.setTimeout(function(){r._hide()},400):r._hide()),r._evOnClick([new Date(r._activeDate.getTime())])}},1==this.conf.touch&&(this.contDates.ontouchstart=this.contDates.onclick),this.contDates.onmouseover=function(t){t=t||event;var e=t.target||t.srcElement;if(null!=e.parentNode&&null!=e.parentNode._date&&(e=e.parentNode),null!=e._date){if(r._lastHover==e||e._css_hover)return;e._css_hover=!0,r._updateCellStyle(e._q,e._w),r._lastHover=e,r._evOnMouseOver([new Date(e._date.getFullYear(),e._date.getMonth(),e._date.getDate(),0,0,0,0),t]),e=null}},this.contDates.onmouseout=function(t){r._clearDayHover(t||event)},this._lastHover=null,this._clearDayHover=function(t){this._lastHover&&(this._lastHover._css_hover=!1,this._updateCellStyle(this._lastHover._q,this._lastHover._w),null!=t&&r._evOnMouseOut([new Date(this._lastHover._date.getFullYear(),this._lastHover._date.getMonth(),this._lastHover._date.getDate(),0,0,0,0),t]),this._lastHover=null)};for(var l=0;l<6;l++){var n=document.createElement("UL");n.className="dhtmlxcalendar_line",this.contDates.appendChild(n);for(var h=0;h<=7;h++){var o=document.createElement("LI");0==h?o.className="dhtmlxcalendar_cell_wn":o.className="dhtmlxcalendar_cell",n.appendChild(o)}}this.contTime=document.createElement("DIV"),this.contTime.className="dhtmlxcalendar_time_cont",this.contTime.style.display="none",this.base.firstChild.appendChild(this.contTime),this.showTime=function(){1!=this.conf.time&&(this.conf.time=!0,this._adjustTimeCont())},this.hideTime=function(){1==this.conf.time&&(this.conf.time=!1,this._adjustTimeCont())},this.showToday=function(){1!=this.conf.today&&(this.conf.today=!0,this._adjustTimeCont())},this.hideToday=function(){1==this.conf.today&&(this.conf.today=!1,this._adjustTimeCont())},this._adjustTimeCont=function(){var t="";1==this.conf.time&&(t+="_time"),1==this.conf.today&&(t+="_today"),""==t?this.contTime.style.display="none":(this.contTime.className="dhtmlxcalendar_time_cont dhtmlxcalendar_mode"+t,this.contTime.style.display=""),this._ifrSize()},this._adjustTimeCont();var n=document.createElement("UL");n.className="dhtmlxcalendar_line",this.contTime.appendChild(n);var o=document.createElement("LI");o.className="dhtmlxcalendar_cell dhtmlxcalendar_time_hdr",o.innerHTML="<div class='dhtmlxcalendar_time_img'></div><span class='dhtmlxcalendar_label_hours'></span><span class='dhtmlxcalendar_label_colon'> : </span><span class='dhtmlxcalendar_label_minutes'></span><span class='dhtmlxcalendar_label_clear'>Clear</span><span class='dhtmlxcalendar_label_today'>Today</span>",n.appendChild(o),o.onclick=function(t){t=t||event,"touchstart"==t.type&&null!=t.preventDefault&&t.preventDefault();var e=t.target||t.srcElement;if(null!=e.tagName&&"span"==e.tagName.toLowerCase()&&1==e._par&&null!=e.parentNode&&(e=e.parentNode),e.className&&"dhtmlxcalendar_label_hours"==e.className){t.cancelBubble=!0;var i=r.contMonth.offsetHeight+r.contDays.offsetHeight+r.contDates.offsetHeight+e.offsetTop;return void r._showSelector("hours",Math.round(e.offsetLeft+e.offsetWidth/2),i-2,"selector_hours",!0)}if(e.className&&"dhtmlxcalendar_label_minutes"==e.className){if(t.cancelBubble=!0,1==r._minutesInterval){var s=r.getFormatedDate("%i");e.innerHTML="<span class='dhtmlxcalendar_selected_date'>"+s.charAt(0)+"</span>"+s.charAt(1),e.firstChild._par=!0,r._selectorMode=1}var i=r.contMonth.offsetHeight+r.contDays.offsetHeight+r.contDates.offsetHeight+e.offsetTop;return void r._showSelector("minutes",Math.round(e.offsetLeft+e.offsetWidth/2),i-2,"selector_minutes",!0)}if(r._hideSelector(),e.className&&"dhtmlxcalendar_label_today"==e.className){var s=new Date;s.setHours(r._activeDate.getHours()),s.setMinutes(r._activeDate.getMinutes()),s.setSeconds(r._activeDate.getSeconds()),r.setDate(s)}e.className&&"dhtmlxcalendar_label_clear"==e.className&&(r._nullDate=!0,r._drawMonth(new Date))},1==this.conf.touch&&(o.ontouchstart=o.onclick),this._activeMonth=null,this._activeDate=new Date,this._activeDateCell=null,this.setDate=function(t){window.dhx4.temp_calendar={tz:null},this._nullDate="undefined"==typeof t||""===t||!t,t instanceof Date||(t=this._strToDate(String(t||"")),"Invalid Date"==t?t=new Date:this.conf.tz=window.dhx4.temp_calendar.tz,window.dhx4.temp_calendar=null),null==this.conf.tz&&(this.conf.tz=window.dhx4.date2str(t,"%P"));var e=t.getTime();this._isOutOfRange(e)||(this._activeDate=new Date(e),this._drawMonth(this._nullDate?new Date:this._activeDate),this._updateVisibleHours(),this._updateVisibleMinutes())},this.getDate=function(t){if(this._nullDate)return null;var e=new Date(this._activeDate.getTime());if(t){window.dhx4.temp_calendar={tz:this.conf.tz};var i=this._dateToStr(e);return window.dhx4.temp_calendar=null,i}return e},this._drawMonth=function(t){if(t instanceof Date){isNaN(t.getFullYear())&&(t=new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),1,0,0,0,0)),this._activeMonth=new Date(t.getFullYear(),t.getMonth(),1,0,0,0,0),this._activeDateCell=null;var e=new Date(this._activeMonth.getTime()),i=e.getDay(),s=i-this._wStart;s<0&&(s+=7),e.setDate(e.getDate()-s);for(var l=t.getMonth(),n=new Date(this._activeDate.getFullYear(),this._activeDate.getMonth(),this._activeDate.getDate(),0,0,0,0).getTime(),o=0,r=0;r<6;r++)for(var h=this._wStart,a=0;a<=7;a++)if(0==a){var d=this.getWeekNumber(new Date(e.getFullYear(),e.getMonth(),e.getDate()+o,0,0,0,0));if(d>=52&&1==this.conf.ws_first&&0==this._activeMonth.getMonth()){var c=this.getWeekNumber(new Date(e.getFullYear(),e.getMonth(),e.getDate()+o+7,0,0,0,0));c<d&&c>1&&(d=1)}this.contDates.childNodes[r].childNodes[a].innerHTML="<div class='dhtmlxcalendar_label'>"+d+"</div>"}else{var u=new Date(e.getFullYear(),e.getMonth(),e.getDate()+o,0,0,0,0);if(0!=u.getHours()){var f=u.getHours()>12?24-u.getHours():u.getHours();u.setTime(u.getTime()+36e5*f)}var _=(u.getDay(),u.getTime()),p="dhtmlxcalendar_label";null!=this._tipData[_]?(this._tipData[_].usePopup&&"function"==typeof window.dhtmlXPopup?(this.contDates.childNodes[r].childNodes[a].removeAttribute("title"),this._initTooltipPopup()):this.contDates.childNodes[r].childNodes[a].setAttribute("title",this._tipData[_].text),this._tipData[_].showIcon&&(p+=" dhtmlxcalendar_label_title")):this.contDates.childNodes[r].childNodes[a].removeAttribute("title"),this.contDates.childNodes[r].childNodes[a].innerHTML="<div class='"+p+"'>"+u.getDate()+"</div>",this.contDates.childNodes[r].childNodes[a]._date=new Date(_),this.contDates.childNodes[r].childNodes[a]._q=r,this.contDates.childNodes[r].childNodes[a]._w=a,this.contDates.childNodes[r].childNodes[a]._css_month=u.getMonth()==l,this.contDates.childNodes[r].childNodes[a]._css_date=!this._nullDate&&_==n,this.contDates.childNodes[r].childNodes[a]._css_weekend=h>=6,this.contDates.childNodes[r].childNodes[a]._css_dis=this._isOutOfRange(_),this.contDates.childNodes[r].childNodes[a]._css_holiday=1==this._holidays[_],this._updateCellStyle(r,a),_==n&&(this._activeDateCell=this.contDates.childNodes[r].childNodes[a]),++h>7&&(h=1),o++}this.contMonth.firstChild.firstChild.childNodes[1].innerHTML=this._buildMonthHdr(t)}},this._updateCellStyle=function(t,e){var i=this.contDates.childNodes[t].childNodes[e],s="dhtmlxcalendar_cell dhtmlxcalendar_cell";s+=i._css_month?"_month":"",s+=i._css_date?"_date":"",s+=i._css_weekend?"_weekend":"",s+=i._css_holiday?"_holiday":"",s+=i._css_dis?"_dis":"",s+=i._css_hover&&!i._css_dis?"_hover":"",i.className=s,i=null},this._minutesInterval=5,this._initSelector=function(t,e){if(this._selCover||(this._selCover=document.createElement("DIV"),this._selCover.className="dhtmlxcalendar_selector_cover",this.base.firstChild.appendChild(this._selCover)),this._sel||(this._sel=document.createElement("DIV"),this._sel.className="dhtmlxcalendar_selector_obj",this.base.firstChild.appendChild(this._sel),this._sel.appendChild(document.createElement("TABLE")),this._sel.firstChild.className="dhtmlxcalendar_selector_table",this._sel.firstChild.cellSpacing=0,this._sel.firstChild.cellPadding=0,this._sel.firstChild.border=0,this._sel.firstChild.appendChild(document.createElement("TBODY")),this._sel.firstChild.firstChild.appendChild(document.createElement("TR")),this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD")),this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD")),this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD")),this._sel.firstChild.firstChild.firstChild.childNodes[0].className="dhtmlxcalendar_selector_cell_left",this._sel.firstChild.firstChild.firstChild.childNodes[1].className="dhtmlxcalendar_selector_cell_middle",this._sel.firstChild.firstChild.firstChild.childNodes[2].className="dhtmlxcalendar_selector_cell_right",this._sel.firstChild.firstChild.firstChild.childNodes[0].innerHTML="&nbsp;",this._sel.firstChild.firstChild.firstChild.childNodes[2].innerHTML="&nbsp;",this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseover=function(){this.className="dhtmlxcalendar_selector_cell_left dhtmlxcalendar_selector_cell_left_hover"},this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseout=function(){this.className="dhtmlxcalendar_selector_cell_left"},this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseover=function(){this.className="dhtmlxcalendar_selector_cell_right dhtmlxcalendar_selector_cell_right_hover"},this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseout=function(){this.className="dhtmlxcalendar_selector_cell_right"},this._sel.onmouseover=function(t){t=t||event;var e=t.target||t.srcElement;e._cell===!0&&(r._selHover!=e&&r._clearSelHover(),null!=String(e.className).match(/^\s{0,}dhtmlxcalendar_selector_cell\s{0,}$/gi)&&(e.className+=" dhtmlxcalendar_selector_cell_hover",r._selHover=e))},this._sel.onmouseout=function(){r._clearSelHover()},this._sel.firstChild.firstChild.firstChild.childNodes[0].onclick=function(t){t=t||event,"touchstart"==t.type&&null!=t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,r._scrollYears(-1)},this._sel.firstChild.firstChild.firstChild.childNodes[2].onclick=function(t){t=t||event,"touchstart"==t.type&&null!=t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,r._scrollYears(1)},1==this.conf.touch&&(this._sel.firstChild.firstChild.firstChild.childNodes[0].ontouchstart=this._sel.firstChild.firstChild.firstChild.childNodes[0].onclick,this._sel.firstChild.firstChild.firstChild.childNodes[2].ontouchstart=this._sel.firstChild.firstChild.firstChild.childNodes[2].onclick),this._sel._ta={},this._selHover=null,this._sel.appendChild(document.createElement("DIV")),this._sel.lastChild.className="dhtmlxcalendar_selector_obj_arrow"),1!=this._sel._ta[t]){if("month"==t){this._msCells={},this.msCont=document.createElement("DIV"),this.msCont.className="dhtmlxcalendar_area_"+e,this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.msCont);for(var i=0,s=0;s<4;s++){var l=document.createElement("UL");l.className="dhtmlxcalendar_selector_line",this.msCont.appendChild(l);for(var n=0;n<3;n++){var o=document.createElement("LI");o.innerHTML=this.langData[this.lang].monthesSNames[i],o.className="dhtmlxcalendar_selector_cell",l.appendChild(o),o._month=i,o._cell=!0,this._msCells[i++]=o}}this.msCont.onclick=function(t){t=t||event,"touchstart"==t.type&&null!=t.preventDefault&&t.preventDefault(),t.cancelBubble=!0;var e=t.target||t.srcElement;null!=e._month&&(r._hideSelector(),r._updateActiveMonth(),r._drawMonth(new Date(r._activeMonth.getFullYear(),e._month,1,0,0,0,0)),r._doOnSelectorChange())},1==this.conf.touch&&(this.msCont.ontouchstart=this.msCont.onclick)}if("year"==t){this._ysCells={},this.ysCont=document.createElement("DIV"),this.ysCont.className="dhtmlxcalendar_area_"+e,this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.ysCont);for(var s=0;s<4;s++){var l=document.createElement("UL");l.className="dhtmlxcalendar_selector_line",this.ysCont.appendChild(l);for(var n=0;n<3;n++){var o=document.createElement("LI");o.className="dhtmlxcalendar_selector_cell",o._cell=!0,l.appendChild(o)}}this.ysCont.onclick=function(t){t=t||event,"touchstart"==t.type&&null!=t.preventDefault&&t.preventDefault(),t.cancelBubble=!0;var e=t.target||t.srcElement;null!=e._year&&(r._hideSelector(),r._drawMonth(new Date(e._year,r._activeMonth.getMonth(),1,0,0,0,0)),r._doOnSelectorChange())},1==this.conf.touch&&(this.ysCont.ontouchstart=this.ysCont.onclick)}if("hours"==t){this._hsCells={},this.hsCont=document.createElement("DIV"),this.hsCont.className="dhtmlxcalendar_area_"+e,this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.hsCont);for(var i=0,s=0;s<4;s++){var l=document.createElement("UL");l.className="dhtmlxcalendar_selector_line",this.hsCont.appendChild(l);for(var n=0;n<6;n++){var o=document.createElement("LI");o.innerHTML=this._fixLength(i,2),o.className="dhtmlxcalendar_selector_cell",l.appendChild(o),o._hours=i,o._cell=!0,this._hsCells[i++]=o}}this.hsCont.onclick=function(t){t=t||event,"touchstart"==t.type&&null!=t.preventDefault&&t.preventDefault(),t.cancelBubble=!0;var e=t.target||t.srcElement;null!=e._hours&&(r._hideSelector(),r._activeDate.setHours(e._hours),r._updateActiveHours(),r._updateVisibleHours(),r._doOnSelectorChange(),r.callEvent("onTimeChange",[new Date(r._activeDate.getTime())]))},1==this.conf.touch&&(this.hsCont.ontouchstart=this.hsCont.onclick)}if("minutes"==t){var h=4,a=3,d=2;1==this._minutesInterval&&(1==this._selectorMode?(h=2,a=3,d=1):(h=2,a=5,d=1,e+="5")),10==this._minutesInterval&&(h=2),15==this._minutesInterval&&(h=1,a=4,e+="4"),this._rsCells={},this.rsCont=document.createElement("DIV"),this.rsCont.className="dhtmlxcalendar_area_"+e,this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.rsCont);for(var i=0,s=0;s<h;s++){var l=document.createElement("UL");l.className="dhtmlxcalendar_selector_line",this.rsCont.appendChild(l);for(var n=0;n<a;n++){var o=document.createElement("LI");o.innerHTML=d>1?this._fixLength(i,d):i,o.className="dhtmlxcalendar_selector_cell",l.appendChild(o),o._minutes=i,o._cell=!0,this._rsCells[i]=o,i+=this._minutesInterval}}this.rsCont.onclick=function(t){t=t||event,"touchstart"==t.type&&null!=t.preventDefault&&t.preventDefault(),t.cancelBubble=!0;var e=t.target||t.srcElement;if(null!=e._minutes){if(1==r._minutesInterval){var i=r.getFormatedDate("%i");if(i=1==r._selectorMode?e._minutes.toString()+i.charAt(1):i.charAt(0)+e._minutes.toString(),r._activeDate.setMinutes(Number(i)),r.callEvent("onTimeChange",[new Date(r._activeDate.getTime())]),r._hideSelector(),1==r._selectorMode)return r._updateVisibleMinutes(!0),r._selectorMode=2,r._showSelector("minutes",r._sel._x,r._sel._y,"selector_minutes",!0),void r._updateActiveMinutes();r._selectorMode=1}else r._hideSelector(),r._activeDate.setMinutes(e._minutes),r._updateActiveMinutes(),r.callEvent("onTimeChange",[new Date(r._activeDate.getTime())]);r._updateVisibleMinutes(),r._doOnSelectorChange()}},1==this.conf.touch&&(this.rsCont.ontouchstart=this.rsCont.onclick)}this._sel._ta[t]=!0}},this._showSelector=function(t,e,i,s,l){if(l===!0&&null!=this._sel&&this._isSelectorVisible()&&t==this._sel._t)return void this._hideSelector();"dhx_terrace"==this.conf.skin&&(e+=12),this._sel&&this._sel._ta[t]||this._initSelector(t,s),t!=this._sel._t&&"minutes"==this._sel._t&&1==this._minutesInterval&&(this.contTime.firstChild.firstChild.childNodes[3].innerHTML=this.getFormatedDate("%i")),this._sel._x=e,this._sel._y=i,this._sel.style.visibility="hidden",this._sel.style.display="",this._selCover.style.width=this.base.offsetWidth-2+"px",this._selCover.style.top=this.contMonth.offsetHeight+"px",this._selCover.style.height=this.contDates.offsetHeight+this.contDays.offsetHeight-1+"px",this._selCover.style.display="",this._sel._t=t,this._sel.className="dhtmlxcalendar_selector_obj dhtmlxcalendar_"+s+("hours"==t&&1==this.conf.today?"2":""),this._sel.childNodes[0].firstChild.firstChild.childNodes[0].style.display=this._sel.childNodes[0].firstChild.firstChild.childNodes[2].style.display="year"==t?"":"none";var n=Math.max(0,e-Math.round(this._sel.offsetWidth/2));n+this._sel.offsetWidth>this._sel.parentNode.offsetWidth&&(n=this._sel.parentNode.offsetWidth-this._sel.offsetWidth),this._sel.style.left=n+"px","hours"==t||"minutes"==t?this._sel.style.top=i-this._sel.offsetHeight+"px":this._sel.style.top=i+"px",this._sel.childNodes[1].style.width=this._sel.childNodes[0].offsetWidth+"px",this._sel.style.visibility="visible",this._doOnSelectorShow(t)},this._doOnSelectorShow=function(t){"month"==t&&this._updateActiveMonth(),"year"==t&&this._updateYearsList(this._activeMonth),"hours"==t&&this._updateActiveHours(),"minutes"==t&&this._updateActiveMinutes()},this._hideSelector=function(t){this._sel&&(this._sel.style.display="none",this._sel.style.visible="hidden",this._selCover.style.display="none","minutes"==this._sel._t&&1==this._minutesInterval&&(this.contTime.firstChild.firstChild.childNodes[3].innerHTML=this.getFormatedDate("%i"),this._unloadSelector("minutes")))},this._isSelectorVisible=function(){return!!this._sel&&"none"!=this._sel.style.display},this._doOnSelectorChange=function(t){this.callEvent("onChange",[new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),this._activeDate.getDate(),this._activeDate.getHours(),this._activeDate.getMinutes(),this._activeDate.getSeconds()),t===!0])},this._clearSelHover=function(){this._selHover&&(this._selHover.className=String(this._selHover.className.replace(/dhtmlxcalendar_selector_cell_hover/gi,"")),this._selHover=null)},this._unloadSelector=function(t){if(this._sel&&this._sel._ta[t]){if("month"==t){this.msCont.onclick=this.msCont.ontouchstart=null,this._msActive=null;for(var e in this._msCells)this._msCells[e]._cell=null,this._msCells[e]._month=null,this._msCells[e].parentNode.removeChild(this._msCells[e]),this._msCells[e]=null;for(this._msCells=null;this.msCont.childNodes.length>0;)this.msCont.removeChild(this.msCont.lastChild);this.msCont.parentNode.removeChild(this.msCont),this.msCont=null}if("year"==t){this.ysCont.onclick=this.ysCont.ontouchstart=null;for(var e in this._ysCells)this._ysCells[e]._cell=null,this._ysCells[e]._year=null,this._ysCells[e].parentNode.removeChild(this._ysCells[e]),this._ysCells[e]=null;for(this._ysCells=null;this.ysCont.childNodes.length>0;)this.ysCont.removeChild(this.ysCont.lastChild);this.ysCont.parentNode.removeChild(this.ysCont),this.ysCont=null}if("hours"==t){this.hsCont.onclick=this.hsCont.ontouchstart=null,this._hsActive=null;for(var e in this._hsCells)this._hsCells[e]._cell=null,this._hsCells[e]._hours=null,this._hsCells[e].parentNode.removeChild(this._hsCells[e]),this._hsCells[e]=null;for(this._hsCells=null;this.hsCont.childNodes.length>0;)this.hsCont.removeChild(this.hsCont.lastChild);this.hsCont.parentNode.removeChild(this.hsCont),this.hsCont=null}if("minutes"==t){this.rsCont.onclick=this.rsCont.ontouchstart=null,this._rsActive=null;for(var e in this._rsCells)this._rsCells[e]._cell=null,this._rsCells[e]._minutes=null,this._rsCells[e].parentNode.removeChild(this._rsCells[e]),this._rsCells[e]=null;for(this._rsCells=null;this.rsCont.childNodes.length>0;)this.rsCont.removeChild(this.rsCont.lastChild);this.rsCont.parentNode.removeChild(this.rsCont),this.rsCont=null}this._sel._ta[t]=null}},this.setMinutesInterval=function(t){1!=t&&5!=t&&10!=t&&15!=t||(this._minutesInterval=t,this._unloadSelector("minutes"))},this._updateActiveMonth=function(){"undefined"!=typeof this._msActive&&"undefined"!=typeof this._msCells[this._msActive]&&(this._msCells[this._msActive].className="dhtmlxcalendar_selector_cell"),this._msActive=this._activeMonth.getMonth(),this._msCells[this._msActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"},this._updateActiveYear=function(){var t=this._activeMonth.getFullYear();this._ysCells[t]&&(this._ysCells[t].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active")},this._updateYearsList=function(t){for(var e in this._ysCells)this._ysCells[e]=null,delete this._ysCells[e];for(var i=12*Math.floor(t.getFullYear()/12),s=0;s<4;s++)for(var l=0;l<3;l++)this.ysCont.childNodes[s].childNodes[l].innerHTML=i,this.ysCont.childNodes[s].childNodes[l]._year=i,this.ysCont.childNodes[s].childNodes[l].className="dhtmlxcalendar_selector_cell",this._ysCells[i++]=this.ysCont.childNodes[s].childNodes[l];this._updateActiveYear()},this._scrollYears=function(t){var e=(t<0?this.ysCont.firstChild.firstChild._year:this.ysCont.lastChild.lastChild._year)+t,i=new Date(e,this._activeMonth.getMonth(),1,0,0,0,0);this._updateYearsList(i)},this._updateActiveHours=function(){"undefined"!=typeof this._hsActive&&"undefined"!=typeof this._hsCells[this._hsActive]&&(this._hsCells[this._hsActive].className="dhtmlxcalendar_selector_cell"),this._hsActive=this._activeDate.getHours(),this._hsCells[this._hsActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"},this._updateVisibleHours=function(){this.contTime.firstChild.firstChild.childNodes[1].innerHTML=this._fixLength(this._activeDate.getHours(),2)},this._updateActiveMinutes=function(){null!=this._rsActive&&"undefined"!=typeof this._rsActive&&"undefined"!=typeof this._rsCells[this._rsActive]&&(this._rsCells[this._rsActive].className="dhtmlxcalendar_selector_cell"),1==this._minutesInterval?this._rsActive=this.getFormatedDate("%i").toString().charAt(1==this._selectorMode?0:1):this._rsActive=this._activeDate.getMinutes(),"undefined"!=typeof this._rsCells[this._rsActive]&&(this._rsCells[this._rsActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active")},this._updateVisibleMinutes=function(t){var e=this._fixLength(this._activeDate.getMinutes(),2).toString();1==t&&(e=e.charAt(0)+"<span class='dhtmlxcalendar_selected_date'>"+e.charAt(1)+"</span>"),this.contTime.firstChild.firstChild.childNodes[3].innerHTML=e,1==t&&(this.contTime.firstChild.firstChild.childNodes[3].lastChild._par=!0)},this._fixLength=function(t,e){for(;String(t).length<e;)t="0"+String(t);return t},this._dateFormat="",this._dateFormatRE=null,this.setDateFormat=function(t){var e={};if(null!=this._strToDate)for(var i in this.i)if(null!=this.i[i].input&&this.i[i].input.value.length>0){var s=this._strToDate(this.i[i].input.value,this._dateFormat||this.langData[this.lang].dateformat||"%Y-%m-%d");s instanceof Date&&(e[i]=s)}this._dateFormat=t;var l=String(this._dateFormat).replace(/%[a-zA-Z]+/g,function(t){var e=t.replace(/%/,"");switch(e){case"n":case"h":case"j":case"g":case"G":return"\\d{1,2}";case"m":case"d":case"H":case"i":case"s":case"y":return"\\d{2}";case"Y":return"\\d{4}";case"M":return"("+r.langData[r.lang].monthesSNames.join("|").toLowerCase()+"){1,}";case"F":return"("+r.langData[r.lang].monthesFNames.join("|").toLowerCase()+"){1,}";case"D":return"[a-z]{2}";case"a":case"A":return"AM|PM";case"u":return"\\d{1,6}";case"P":return"[\\+\\-]\\d{1,2}\\:\\d{1,2}"}return t});this._dateFormatRE=new RegExp(l,"i");for(var i in e)this.i[i].input.value=this._dateToStr(e[i]);e=null},this.setDateFormat(this.langData[this.lang].dateformat||"%Y-%m-%d"),this._updateDateStr=function(t){if(this._dateFormatRE&&t.match(this._dateFormatRE)&&t!=this.getFormatedDate()){var e=this._strToDate(t);if(e instanceof Date){if(this.checkEvent("onBeforeChange")&&!this.callEvent("onBeforeChange",[new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds())]))return void(null!=this.i&&null!=this._activeInp&&null!=this.i[this._activeInp]&&null!=this.i[this._activeInp].input&&(this.i[this._activeInp].input.value=this.getFormatedDate()));this._nullDate=!1,this._activeDate=e,this._drawMonth(this._nullDate?new Date:this._activeDate),this._updateVisibleMinutes(),this._updateVisibleHours(),this._sel&&this._isSelectorVisible()&&this._doOnSelectorShow(this._sel._t),this._doOnSelectorChange(!0)}}},this.showMonth=function(t){"string"==typeof t&&(t=this._strToDate(t)),t instanceof Date&&this._drawMonth(t)},this.setFormatedDate=function(t,e,i,s){var l=this._strToDate(e,t);return s?l:void this.setDate(l)},this.getFormatedDate=function(t,e){if(!(e&&e instanceof Date)){if(this._nullDate)return"";e=new Date(this._activeDate)}return this._dateToStr(e,t)},this.getWeekNumber=function(t){if("string"==typeof t&&(t=this._strToDate(t)),!(t instanceof Date))return"Invalid Date";"undefined"==typeof this._ftDay&&(this._ftDay=4);
var e=this._wStart,i=4,s=new Date(t.getFullYear(),0,1,0,0,0,0),l=s.getDay();0==l&&(l=7),i<e&&(i+=7,l+=7);var n=0;l>=e&&l<=i||(n=1);var o=l-e,r=new Date(t.getFullYear(),0,1-o+7*n,0,0,0,0),h=6048e5,a=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,0,0),d=Math.ceil((a.getTime()-r.getTime())/h);if(0==d){var c=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),u=c.getDay()-this._wStart;u<0&&(u+=7),c.setDate(c.getDate()-u),d=this.getWeekNumber(c)}return d},this.showWeekNumbers=function(){this.base.firstChild.className="dhtmlxcalendar_wn"},this.hideWeekNumbers=function(){this.base.firstChild.className=""},this.show=function(t){if(!t&&this._hasParent)return void this._show();if("object"==typeof t&&"undefined"!=typeof t._dhtmlxcalendar_uid&&this.i[t._dhtmlxcalendar_uid]==t)return void this._show(t._dhtmlxcalendar_uid);if("undefined"==typeof t)for(var e in this.i)t||(t=e);t&&this._show(t)},this.hide=function(){this._isVisible()&&this._hide()},this.isVisible=function(){return this._isVisible()},this._activeInp=null,this.pos="bottom",this.setPosition=function(t,e){this._px=null,this._py=null,"right"==t||"bottom"==t?this.pos=t:(this.pos="int","undefined"==typeof t||isNaN(t)||(this.base.style.left=t+"px",this._px=t),"undefined"==typeof e||isNaN(e)||(this.base.style.top=e+"px",this._py=e),this._ifrSize())},this._show=function(t,e){if(e===!0&&this._activeInp==t&&this._isVisible())return void this._hide();if(this.base.style.visibility="hidden",this.base.style.display="",t){this.base.className.indexOf("dhtmlxcalendar_in_input")==-1&&(this.base.className+=" dhtmlxcalendar_in_input");var i=this.i[t].input||this.i[t].button,s=window.dhx4.screenDim(),l={top:window.dhx4.absTop(i),left:window.dhx4.absLeft(i)};if("right"==this.pos)this.base.style.left=l.left+i.offsetWidth+"px",this.base.style.top=Math.min(l.top,s.bottom-this.base.offsetHeight)+"px";else if("bottom"==this.pos){var n=l.top+i.offsetHeight+1;if(n+this.base.offsetHeight>s.bottom){var o=l.top-this.base.offsetHeight;o>=-20&&(n=o)}var r=l.left;r+this.base.offsetWidth>s.right&&(r=Math.max(0,l.left+i.offsetWidth-this.base.offsetWidth)),this.base.style.left=r+"px",this.base.style.top=n+"px"}else this.base.style.left=(this._px||0)+"px",this.base.style.top=(this._py||0)+"px";this._activeInp=t,i=null}else null!=this._px&&null!=this._py?(this.base.style.left=this._px+"px",this.base.style.top=this._py+"px"):(this.base.style.left="0px",this.base.style.top="0px");this._hideSelector(),this.base.style.visibility="visible",this.base.style.zIndex=window.dhx4.zim.reserve(this.conf.zi),this._ifrSize(),this._ifr&&(this._ifr.style.display=""),this.callEvent("onShow",[])},this._hide=function(){null!=this._lastHover&&this._clearDayHover(),this._hideSelector(),this.base.style.display="none",window.dhx4.zim.clear(this.conf.zi),this.base.className.indexOf("dhtmlxcalendar_in_input")>=0&&(this.base.className=this.base.className.replace(/\s{0,}dhtmlxcalendar_in_input/gi,"")),this._activeInp=null,this._ifr&&(this._ifr.style.display="none"),this.callEvent("onHide",[])},this._isVisible=function(){return"none"!=this.base.style.display},this._rangeActive=!1,this._rangeFrom=null,this._rangeTo=null,this._rangeSet={},this.setInsensitiveDays=function(t){for(var e=this._extractDates(t),i=0;i<e.length;i++)this._rangeSet[new Date(e[i].getFullYear(),e[i].getMonth(),e[i].getDate(),0,0,0,0).getTime()]=!0;this._drawMonth(this._activeMonth)},this.clearInsensitiveDays=function(){this._clearRangeSet(),this._drawMonth(this._activeMonth)},this._holidays={},this.setHolidays=function(t){if(null==t)this._clearHolidays();else if(null!=t)for(var e=this._extractDates(t),i=0;i<e.length;i++)this._holidays[new Date(e[i].getFullYear(),e[i].getMonth(),e[i].getDate(),0,0,0,0).getTime()]=!0;this._drawMonth(this._activeMonth)},this._extractDates=function(t){("string"==typeof t||t instanceof Date)&&(t=[t]);for(var e=[],i=0;i<t.length;i++)if("string"==typeof t[i])for(var s=t[i].split(","),l=0;l<s.length;l++)e.push(this._strToDate(s[l]));else t[i]instanceof Date&&e.push(t[i]);return e},this._clearRange=function(){this._rangeActive=!1,this._rangeType=null,this._rangeFrom=null,this._rangeTo=null},this._clearRangeSet=function(){for(var t in this._rangeSet)this._rangeSet[t]=null,delete this._rangeSet[t]},this._clearHolidays=function(){for(var t in this._holidays)this._holidays[t]=null,delete this._holidays[t]},this._isOutOfRange=function(t){if(1==this._rangeSet[t])return!0;if(this._rangeActive){if("in"==this._rangeType&&(t<this._rangeFrom||t>this._rangeTo))return!0;if("out"==this._rangeType&&t>=this._rangeFrom&&t<=this._rangeTo)return!0;if("from"==this._rangeType&&t<this._rangeFrom)return!0;if("to"==this._rangeType&&t>this._rangeTo)return!0}var e=new Date(t);return!(!this._rangeWeek||this._rangeWeekData[e.getDay()]!==!0)||(!(!this._rangeMonth||this._rangeMonthData[e.getDate()]!==!0)||!(!this._rangeYear||this._rangeYearData[e.getMonth()+"_"+e.getDate()]!==!0))},this.clearSensitiveRange=function(){this._clearRange(),this._drawMonth(this._activeMonth)},this.setSensitiveRange=function(t,e,i){var s=!1;if(null!=t&&null!=e){if(t instanceof Date||(t=this._strToDate(t)),e instanceof Date||(e=this._strToDate(e)),t.getTime()>e.getTime())return;this._rangeFrom=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0).getTime(),this._rangeTo=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0).getTime(),this._rangeActive=!0,this._rangeType="in",s=!0}s||null==t||null!=e||(t instanceof Date||(t=this._strToDate(t)),this._rangeFrom=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0).getTime(),this._rangeTo=null,i===!0&&this._rangeFrom++,this._rangeActive=!0,this._rangeType="from",s=!0),s||null!=t||null==e||(e instanceof Date||(e=this._strToDate(e)),this._rangeFrom=null,this._rangeTo=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0).getTime(),i===!0&&this._rangeTo--,this._rangeActive=!0,this._rangeType="to",s=!0),s&&this._drawMonth(this._activeMonth)},this.setInsensitiveRange=function(t,e){if(null!=t&&null!=e){if(t instanceof Date||(t=this._strToDate(t)),e instanceof Date||(e=this._strToDate(e)),t.getTime()>e.getTime())return;return this._rangeFrom=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0).getTime(),this._rangeTo=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0).getTime(),this._rangeActive=!0,this._rangeType="out",void this._drawMonth(this._activeMonth)}return null!=t&&null==e?void this.setSensitiveRange(null,t,!0):null==t&&null!=e?void this.setSensitiveRange(e,null,!0):void 0},this.disableDays=function(t,e){if("week"==t){"object"!=typeof e&&"undefined"==typeof e.length&&(e=[e]),this._rangeWeekData||(this._rangeWeekData={});for(var i in this._rangeWeekData)this._rangeWeekData[i]=!1,delete this._rangeWeekData[i];for(var s=0;s<e.length;s++)this._rangeWeekData[e[s]]=!0,7==e[s]&&(this._rangeWeekData[0]=!0);this._rangeWeek=!0}if("month"==t){"object"!=typeof e&&"undefined"==typeof e.length&&(e=[e]),this._rangeMonthData||(this._rangeMonthData={});for(var i in this._rangeMonthData)this._rangeMonthData[i]=!1,delete this._rangeMonthData[i];for(var s=0;s<e.length;s++)this._rangeMonthData[e[s]]=!0;this._rangeMonth=!0}if("year"==t){var l=this._extractDates(e);this._rangeYearData||(this._rangeYearData={});for(var i in this._rangeYearData)this._rangeYearData[i]=!1,delete this._rangeYearData[i];for(var s=0;s<l.length;s++)this._rangeYearData[l[s].getMonth()+"_"+l[s].getDate()]=!0;this._rangeYear=!0}this._drawMonth(this._activeMonth)},this.enableDays=function(t){"week"==t&&(this._rangeWeek=!1),"month"==t&&(this._rangeMonth=!1),"year"==t&&(this._rangeYear=!1),this._drawMonth(this._activeMonth)},this._tipData={},this._tipTM=null,this._tipTMTime=400,this._tipEvs=!1,this._tipPopup=null,this._tipCellDate=null,this._tipCellDim=null,this.setTooltip=function(t,e,i,s){for(var l=this._extractDates(t),n=0;n<l.length;n++){var o=new Date(l[n].getFullYear(),l[n].getMonth(),l[n].getDate(),0,0,0,0).getTime();this._tipData[o]={text:e,showIcon:i,usePopup:s}}this._drawMonth(this._activeMonth)},this.clearTooltip=function(t){for(var e=this._extractDates(t),i=0;i<e.length;i++){var s=new Date(e[i].getFullYear(),e[i].getMonth(),e[i].getDate(),0,0,0,0).getTime();this._tipData[s]=null,delete this._tipData[s]}this._drawMonth(this._activeMonth)},this._initTooltipPopup=function(){this._tipEvs||(this.attachEvent("onMouseOver",function(t){var e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0).getTime();null!=this._tipData[e]&&(this._tipTM&&window.clearTimeout(this._tipTM),this._tipCellDate=t,this._tipCellDim=this.getCellDimension(t),this._tipText=this._tipData[e].text,this._tipTM=window.setTimeout(this._showTooltipPopup,this._tipTMTime))}),this.attachEvent("onMouseOut",this._hideTooltipPopup),this._tipEvs=!0)},this._showTooltipPopup=function(t,e,i,s,l){r._tipPopup||(r._tipPopup=new dhtmlXPopup({mode:"top"})),r._tipPopup.attachHTML(r._tipText),r._tipPopup.show(r._tipCellDim.x,r._tipCellDim.y,r._tipCellDim.w,r._tipCellDim.h),r.callEvent("onPopupShow",[r._tipCellDate])},this._hideTooltipPopup=function(){this._tipTM&&window.clearTimeout(this._tipTM),null!=this._tipPopup&&this._tipPopup.isVisible()&&(this._tipPopup.hide(),this.callEvent("onPopupHide",[this._tipCellDate]))},this.getPopup=function(){return this._tipPopup},this.getCellDimension=function(t){if("string"==typeof t&&(t=this._strToDate(t)),!(t instanceof Date))return null;for(var e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0).getTime(),i=null,s=0;s<this.contDates.childNodes.length;s++)for(var l=0;l<this.contDates.childNodes[s].childNodes.length;l++){var n=this.contDates.childNodes[s].childNodes[l];null!=n._date&&n._date.getTime()==e&&(i={x:window.dhx4.absLeft(n),y:window.dhx4.absTop(n),w:n.offsetWidth,h:n.offsetHeight}),n=null}return i},this._updateFromInput=function(t){if(this._nullInInput&&0==t.value.replace(/\s/g,"").length){if(this.checkEvent("onBeforeChange")&&!this.callEvent("onBeforeChange",[null]))return void(null!=this.i&&null!=this._activeInp&&null!=this.i[this._activeInp]&&null!=this.i[this._activeInp].input&&(this.i[this._activeInp].input.value=this.getFormatedDate()));this.setDate(null)}else this._updateDateStr(t.value);t=null},this._doOnClick=function(t){t=t||event;var e=t.target||t.srcElement;return e._dhtmlxcalendar_uid&&e._dhtmlxcalendar_uid!=r._activeInp&&r._isVisible()&&r._activeInp?void r._hide():void(e._dhtmlxcalendar_uid&&r.i[e._dhtmlxcalendar_uid]||(r._isSelectorVisible()?r._hideSelector():!r._hasParent&&r._isVisible()&&r._hide()))},this._doOnKeyDown=function(t){t=t||event,27!=t.keyCode&&13!=t.keyCode||(r._isSelectorVisible()?r._hideSelector():r._isVisible()&&!r._hasParent&&r._hide())},this._doOnInpClick=function(t){t=t||event,"touchstart"==t.type&&null!=t.preventDefault&&t.preventDefault();var e=t.target||t.srcElement;e._dhtmlxcalendar_uid&&(r._listenerEnabled||r._updateFromInput(e),r._show(e._dhtmlxcalendar_uid,!0))},this._doOnInpKeyUp=function(t){t=t||event;var e=t.target||t.srcElement;13!=t.keyCode&&e._dhtmlxcalendar_uid&&(r._listenerEnabled||r._updateFromInput(e))},this._doOnBtnClick=function(t){t=t||event,"touchstart"==t.type&&null!=t.preventDefault&&t.preventDefault();var e=t.target||t.srcElement;e._dhtmlxcalendar_uid&&(null!=r.i[e._dhtmlxcalendar_uid].input&&r._updateFromInput(r.i[e._dhtmlxcalendar_uid].input),r._show(e._dhtmlxcalendar_uid,!0))},this._doOnUnload=function(){r&&r.unload&&r.unload()},"function"==typeof window.addEventListener?(document.body.addEventListener("click",r._doOnClick,!1),window.addEventListener("keydown",r._doOnKeyDown,!1),window.addEventListener("unload",r._doOnUnload,!1),1==this.conf.touch&&document.body.addEventListener("touchstart",r._doOnClick,!1)):(document.body.attachEvent("onclick",r._doOnClick),document.body.attachEvent("onkeydown",r._doOnKeyDown),window.attachEvent("onunload",r._doOnUnload)),this.attachObj=function(t){var e=window.dhx4.newId();return"string"==typeof t?this.i[e]={input:document.getElementById(t)}:"undefined"!=typeof t.tagName?this.i[e]={input:t}:"object"!=typeof t||null==t.input&&null==t.button||(this.i[e]={},null!=t.input&&(this.i[e].input="string"==typeof t.input?document.getElementById(t.input):t.input),null!=t.button&&(this.i[e].button="string"==typeof t.button?document.getElementById(t.button):t.button)),this._attachEventsToObject(e),e},this.detachObj=function(t){var e=null;if(null!=this.i[t]?e=t:"string"==typeof t?(t=document.getElementById(t),e=t._dhtmlxcalendar_uid):"undefined"!=typeof t.tagName?e=t._dhtmlxcalendar_uid:"object"!=typeof t||null==t.input&&null==t.button||(null==e&&null!=t.input&&(e=("string"==typeof t.input?document.getElementById(t.input):t.input)._dhtmlxcalendar_uid),null==e&&null!=t.button&&(e=("string"==typeof t.button?document.getElementById(t.button):t.button)._dhtmlxcalendar_uid)),null!=e&&null!=this.i[e]){this._detachEventsFromObject(e);for(var i in this.i[i])this.i[e][i]._dhtmlxcalendar_uid=null,this.i[e][i]=null,delete this.i[e][i];return this.i[e]=null,delete this.i[e],!0}return!1},this._attachEventsToObject=function(t){null!=this.i[t].button?(this.i[t].button._dhtmlxcalendar_uid=t,"function"==typeof window.addEventListener?(this.i[t].button.addEventListener("click",r._doOnBtnClick,!1),1==this.conf.touch&&this.i[t].button.addEventListener("touchstart",r._doOnBtnClick,!1)):this.i[t].button.attachEvent("onclick",r._doOnBtnClick)):null!=this.i[t].input&&(this.i[t].input._dhtmlxcalendar_uid=t,"function"==typeof window.addEventListener?(this.i[t].input.addEventListener("click",r._doOnInpClick,!1),this.i[t].input.addEventListener("keyup",r._doOnInpKeyUp,!1),1==this.conf.touch&&this.i[t].input.addEventListener("touchstart",r._doOnInpClick,!1)):(this.i[t].input.attachEvent("onclick",r._doOnInpClick),this.i[t].input.attachEvent("onkeyup",r._doOnInpKeyUp)))},this._detachEventsFromObject=function(t){null!=this.i[t].button?"function"==typeof window.addEventListener?(this.i[t].button.removeEventListener("click",r._doOnBtnClick,!1),1==this.conf.touch&&this.i[t].button.removeEventListener("touchstart",r._doOnBtnClick,!1)):this.i[t].button.detachEvent("onclick",r._doOnBtnClick):null!=this.i[t].input&&("function"==typeof window.addEventListener?(this.i[t].input.removeEventListener("click",r._doOnInpClick,!1),this.i[t].input.removeEventListener("keyup",r._doOnInpKeyUp,!1),1==this.conf.touch&&this.i[t].input.removeEventListener("touchstart",r._doOnInpClick,!1)):(this.i[t].input.detachEvent("onclick",r._doOnInpClick),this.i[t].input.detachEvent("onkeyup",r._doOnInpKeyUp)))},this.enableListener=function(t){t&&("function"==typeof window.addEventListener?(t.addEventListener("focus",r._listenerEvFocus,!1),t.addEventListener("blur",r._listenerEvBlur,!1)):(t.attachEvent("onfocus",r._listenerEvFocus),t.attachEvent("onblur",r._listenerEvBlur)),t=null)},this.disableListener=function(t){t&&(t._f0=!1,this._tmListener&&window.clearTimeout(this._tmListener),"function"==typeof window.addEventListener?(t.removeEventListener("focus",r._listenerEvFocus,!1),t.removeEventListener("blur",r._listenerEvBlur,!1)):(t.detachEvent("onfocus",r._listenerEvFocus),t.detachEvent("onblur",r._listenerEvBlur)),t=null)},this._startListener=function(t){this._tmListener&&window.clearTimeout(this._tmListener),"undefined"==typeof t._v1&&(t._v1=t.value),t._v1!=t.value&&(this._updateFromInput(t),t._v1=t.value),t._f0&&(this._tmListener=window.setTimeout(function(){r._startListener(t)},100))},this._listenerEvFocus=function(t){t=t||event;var e=t.target||t.srcElement;e._f0=!0,r._startListener(e),e=null},this._listenerEvBlur=function(t){t=t||event;var e=t.target||t.srcElement;e._f0=!1,e=null};for(var a in this.i)this._attachEventsToObject(a);return window.dhx4._eventable(this),this._evOnArrowClick=function(t){return this.callEvent("onArrowClick",t)},this._evOnClick=function(t){return this.callEvent("onClick",t)},this._evOnMouseOut=function(t){return this.callEvent("onMouseOut",t)},this._evOnMouseOver=function(t){return this.callEvent("onMouseOver",t)},this.unload=function(){this._activeDate=null,this._activeDateCell=null,this._activeInp=null,this._activeMonth=null,this._dateFormat=null,this._dateFormatRE=null,this._lastHover=null,this._tmListener&&window.clearTimeout(this._tmListener),this._tmListener=null,"function"==typeof window.addEventListener?(document.body.removeEventListener("click",r._doOnClick,!1),window.removeEventListener("keydown",r._doOnKeyDown,!1),window.removeEventListener("unload",r._doOnUnload,!1),1==this.conf.touch&&document.body.removeEventListener("touchstart",r._doOnClick,!1)):(document.body.detachEvent("onclick",r._doOnClick),document.body.detachEvent("onkeydown",r._doOnKeyDown),window.detachEvent("onunload",r._doOnKeyDown)),this._doOnClick=null,this._doOnKeyDown=null,this._doOnUnload=null;for(var t in this.i)this.i[t]._dhtmlxcalendar_uid=null,this._detachEventsFromObject(t),this.disableListener(this.i[t].input),this.i[t]=null,delete this.i[t];for(this.i=null,this._doOnInpClick=null,this._doOnInpKeyUp=null,window.dhx4._eventable(this,"clear"),this.contMonth.onselectstart=null,this.contMonth.firstChild.firstChild.onclick=null,this.contMonth.firstChild.firstChild.ontouchstart=null,this.contMonth.firstChild.firstChild.firstChild.onmouseover=null,this.contMonth.firstChild.firstChild.firstChild.onmouseout=null,this.contMonth.firstChild.firstChild.lastChild.onmouseover=null,this.contMonth.firstChild.firstChild.lastChild.onmouseout=null;this.contMonth.firstChild.firstChild.childNodes.length>0;)this.contMonth.firstChild.firstChild.removeChild(this.contMonth.firstChild.firstChild.lastChild);for(this.contMonth.firstChild.removeChild(this.contMonth.firstChild.firstChild),this.contMonth.removeChild(this.contMonth.firstChild),this.contMonth.parentNode.removeChild(this.contMonth),this.contMonth=null;this.contDays.firstChild.childNodes.length>0;)this.contDays.firstChild.removeChild(this.contDays.firstChild.lastChild);for(this.contDays.removeChild(this.contDays.firstChild),this.contDays.parentNode.removeChild(this.contDays),this.contDays=null,this.contDates.onclick=null,this.contDates.ontouchstart=null,this.contDates.onmouseover=null,this.contDates.onmouseout=null;this.contDates.childNodes.length>0;){for(;this.contDates.lastChild.childNodes.length>0;)this.contDates.lastChild.lastChild._css_date=null,this.contDates.lastChild.lastChild._css_month=null,this.contDates.lastChild.lastChild._css_weekend=null,this.contDates.lastChild.lastChild._css_hover=null,this.contDates.lastChild.lastChild._date=null,this.contDates.lastChild.lastChild._q=null,this.contDates.lastChild.lastChild._w=null,this.contDates.lastChild.removeChild(this.contDates.lastChild.lastChild);this.contDates.removeChild(this.contDates.lastChild)}for(this.contDates.parentNode.removeChild(this.contDates),this.contDates=null,this.contTime.firstChild.firstChild.onclick=null,this.contTime.firstChild.firstChild.ontouchstart=null;this.contTime.firstChild.firstChild.childNodes.length>0;)this.contTime.firstChild.firstChild.removeChild(this.contTime.firstChild.firstChild.lastChild);if(this.contTime.firstChild.removeChild(this.contTime.firstChild.firstChild),this.contTime.removeChild(this.contTime.firstChild),this.contTime.parentNode.removeChild(this.contTime),this.contTime=null,this._lastHover=null,this._unloadSelector("month"),this._unloadSelector("year"),this._unloadSelector("hours"),this._unloadSelector("minutes"),this._selCover&&(this._selCover.parentNode.removeChild(this._selCover),this._selCover=null),this._sel){for(var t in this._sel._ta)this._sel._ta[t]=null;for(this._sel._ta=null,this._sel._t=null,this._sel.onmouseover=null,this._sel.onmouseout=null;this._sel.firstChild.firstChild.firstChild.childNodes.length>0;)this._sel.firstChild.firstChild.firstChild.lastChild.onclick=null,this._sel.firstChild.firstChild.firstChild.lastChild.onmouseover=null,this._sel.firstChild.firstChild.firstChild.lastChild.onmouseout=null,this._sel.firstChild.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild.lastChild);for(this._sel.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild),this._sel.firstChild.removeChild(this._sel.firstChild.firstChild);this._sel.childNodes.length>0;)this._sel.removeChild(this._sel.lastChild);this._sel.parentNode.removeChild(this._sel),this._sel=null}this.base.onclick=null,this.base.onmousedown=null,this.base.ontouchstart=null,this.base.onmouseout=null,this.base.parentNode.removeChild(this.base),this.base=null,this._clearDayHover=null,this._clearSelHover=null,this._doOnSelectorChange=null,this._doOnSelectorShow=null,this._drawMonth=null,this._fixLength=null,this._ifrSize=null,this._hide=null,this._hideSelector=null,this._initSelector=null,this._isSelectorVisible=null,this._isVisible=null,this._scrollYears=null,this._show=null,this._showSelector=null,this._strToDate=null,this._updateActiveHours=null,this._updateActiveMinutes=null,this._updateActiveMonth=null,this._updateActiveYear=null,this._updateCellStyle=null,this._updateDateStr=null,this._updateVisibleHours=null,this._updateVisibleMinutes=null,this._updateYearsList=null,this.enableIframe=null,this.hide=null,this.hideTime=null,this.setDate=null,this.setDateFormat=null,this.setYearsRange=null,this.show=null,this.showTime=null,this.unload=null,null!=this._tipPopup&&(this._tipPopup.unload(),this._tipPopup=null);for(var t in this)delete this[t];t=r=null},this.setDate(this._activeDate),this}function dhtmlXCombo(t,e,i,s,l){var n=this,o=null,r=null;"object"!=typeof t||t.tagName||(o=t,t=o.parent,i=o.width,e=o.name,s=o.mode,r=o.skin),this.cont="string"==typeof t?document.getElementById(t):t,this.conf={skin:null,form_name:e||"dhxcombo",combo_width:(parseInt(i)||this.cont.offsetWidth||120)-(dhx4.isFF||dhx4.isIE||dhx4.isChrome||dhx4.isOpera?2:0),combo_image:!1,combo_focus:!1,opts_type:"string"==typeof s&&"undefined"!=typeof this.modes[s]?s:"option",opts_count:8,opts_count_min:3,opts_width:null,item_h:null,list_zi_id:window.dhx4.newId(),allow_free_text:!0,allow_empty_value:!0,free_text_empty:!1,enabled:!0,btn_left:(window.dhx4.isIE6||window.dhx4.isIE7||window.dhx4.isIE8)&&"undefined"==typeof window.addEventListener?1:0,ro_mode:!1,ro_text:"",ro_tm:null,ro_tm_time:750,img_path:"",img_def:"",img_def_dis:!0,template:{header:!0,input:"#text#",option:"#text#"},f_func:null,f_mode:!1,f_url:!1,f_cache:!1,f_cache_data:{},f_dyn:!1,f_dyn_end:!1,f_mask:"",f_ac:!0,f_ac_text:"",f_server_tm:null,f_server_last:"",f_loading:!1,s_tm:null,s_time:200,s_mode:"select",last_hover:null,last_selected:null,last_match:null,last_text:"",last_value:"",tm_hover:null,tm_confirm_blur:null,clear_click:!1,clear_blur:!1,clear_bsp:!1,clear_key:!1,sp:{dhx_skyblue:{list_ofs:1,hdr_ofs:1,scr_ofs:1},dhx_web:{list_ofs:0,hdr_ofs:1,scr_ofs:0},dhx_terrace:{list_ofs:1,hdr_ofs:1,scr_ofs:1}},col_w:null},this.conf.combo_image=1==this.modes[this.conf.opts_type].image,this.t={},this.base=document.createElement("DIV"),this.base.style.width=this.conf.combo_width+"px",this.base.innerHTML="<input type='text' class='dhxcombo_input' style='width:"+(this.conf.combo_width-24-(this.conf.combo_image?23:0))+"px;"+(this.conf.combo_image?"margin-left:23px;":"")+"' autocomplete='off'><input type='hidden' value=''><input type='hidden' value='false'><div class='dhxcombo_select_button'><div class='dhxcombo_select_img'></div></div>"+(this.conf.combo_image?"<div class='dhxcombo_top_image'>"+this.modes[this.conf.opts_type].getTopImage(null,this.conf.enabled)+"</div>":""),this.cont.appendChild(this.base),this.list=document.createElement("DIV"),this.list._listId=window.dhx4.newId(),this.list.style.display="none",document.body.insertBefore(this.list,document.body.firstChild),this._doOnListScroll=function(){null!=n.conf.s_tm&&window.clearTimeout(n.conf.s_tm),n.conf.s_tm=window.setTimeout(n._doOnListScrollAction,n.conf.s_time)},this._doOnListScrollAction=function(){n.conf.s_tm=null,"scroll"==n.conf.s_mode&&n.list.scrollHeight-n.list.scrollTop-10<n.list.clientHeight&&n._subloadRequest()},"function"==typeof window.addEventListener?this.list.addEventListener("scroll",this._doOnListScroll,!1):this.list.attachEvent("onscroll",this._doOnListScroll),this.setSkin(r||window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxcombo")||"dhx_skyblue"),this._updateTopImage=function(t){this.conf.combo_image&&(null!=t?this.base.lastChild.innerHTML=this.t[t].obj.getTopImage(this.t[t].item,this.conf.enabled):this.base.lastChild.innerHTML=this.modes[this.conf.opts_type].getTopImage(null,this.conf.enabled))},this._filterOpts=function(t){this.conf.f_server_tm&&window.clearTimeout(this.conf.f_server_tm);var e=String(this.base.firstChild.value).replace(new RegExp(this.conf.f_ac_text+"$","i"),"");if(this.conf.f_server_last==e.toLowerCase())return void this._checkForMatch();if(null!=this.conf.f_url&&this.checkEvent("onDynXLS"))return this.conf.f_server_last=e.toLowerCase(),void this.callEvent("onDynXLS",[e]);if(null!=this.conf.f_url){if(0==e.length)return this.conf.f_server_last=e.toLowerCase(),void this.clearAll();if(1==this.conf.f_cache&&null!=this.conf.f_cache_data[e]){this.clearAll(),this.conf.f_server_last=e.toLowerCase();for(var i=0;i<this.conf.f_cache_data[e].data.length;i++)this.load(this.conf.f_cache_data[e].data[i]);this.conf.f_dyn&&(this.conf.f_dyn_end=this.conf.f_cache_data[e].dyn_end,this.conf.f_mask=this.conf.f_cache_data[e].mask),t!==!0&&(this._showList(!0),this._checkForMatch())}else this.conf.f_server_tm=window.setTimeout(function(){n.conf.f_server_last=e.toLowerCase(),n.conf.f_mask=e;var i="mask="+encodeURIComponent(e);n.conf.f_dyn&&(i+="&pos=0",n.conf.f_dyn_end=!1);var s=function(i){n.conf.f_cache&&(n.conf.f_cache_data[e]||(n.conf.f_cache_data[e]={data:[],dyn_end:!1,mask:e}),n.conf.f_cache_data[e].data.push(i.xmlDoc.responseXML)),n.clearAll(),n.load(i.xmlDoc.responseXML);var l=n.base.offsetWidth>0&&n.base.offsetHeight>0;if(1==l&&1==n.conf.enabled&&1==n.conf.combo_focus&&t!==!0){if(n.conf.f_ac&&"start"==n.conf.f_mode&&0==n.conf.clear_bsp&&null!=n.list.firstChild){var o=n.list.firstChild._optId,r=String(n.t[o].obj.getText(n.list.firstChild,!0));e==n.base.firstChild.value&&0===String(r).toLowerCase().indexOf(String(e).toLowerCase())&&(n.base.firstChild.value=r,n.conf.f_ac_text=r.substr(e.length),n._selectRange(e.length,r.length))}n._showList(!0),n._checkForMatch()}s=null};"post"==window.dhx4.ajax.method?window.dhx4.ajax.post(n.conf.f_url,i,s):"get"==window.dhx4.ajax.method&&window.dhx4.ajax.get(n.conf.f_url+(String(n.conf.f_url).indexOf("?")>=0?"&":"?")+i,s)},200)}else{this.conf.f_server_last=e.toLowerCase();var s=0==e.length||new RegExp(("start"==this.conf.f_mode?"^":"")+String(e).replace(/[\\\^\$\*\+\?\.\(\)\|\{\}\[\]]/gi,"\\$&"),"i"),l=null;for(var o in this.t){var r=!1;if(s!==!0)if(null!=this.conf.f_func){var h=this._getOption(this.t[o].item._optId,i);r=1==this.conf.f_func.apply(window,[e,h])}else{var a=this.t[o].obj.getText(this.t[o].item,!0);r=1==s.test(a)}s===!0||1==r?(this.t[o].item.style.display="",null==l&&e.length>0&&(l=String(this.t[o].obj.getText(this.t[o].item,!0)))):this.t[o].item.style.display="none"}this.conf.f_ac&&"start"==this.conf.f_mode&&0==this.conf.clear_bsp&&null!=l&&(this.conf.f_ac_text=l.replace(new RegExp("^"+e,"i"),""),this.base.firstChild.value=l,this._selectRange(this.conf.f_server_last.length,this.base.firstChild.value.length)),"between"==this.conf.f_mode&&1==this.conf.clear_bsp&&this._checkForMatch(!0),t!==!0&&(this._showList(!0),this._checkForMatch())}},this._searchRO=function(t){this.conf.ro_tm&&window.clearTimeout(this.conf.ro_tm),this.conf.ro_text+=t,this._showList();for(var e=0;e<this.list.childNodes.length;e++){var i=this.list.childNodes[e]._optId,s=String(this.t[i].obj.getText(this.list.childNodes[e],!0)).toLowerCase();if(0===s.indexOf(this.conf.ro_text)){this._setSelected(i,!0,!0),this._confirmSelect("script",!1);break}}this.conf.ro_tm=window.setTimeout(function(){n.conf.ro_text=""},this.conf.ro_tm_time)},this._initObj=function(t){"undefined"!=typeof t.template&&this.setTemplate(t.template),1!=t.add&&1!=this.conf.f_loading&&this.clearAll(!1),this.addOption(t.options)},this._xmlToObj=function(t,e,i){var s={add:!1,options:[]},l=1==e?t:t.getElementsByTagName("complete");if(l.length>0){1==window.dhx4.s2b(l[0].getAttribute("add"))&&(s.add=!0);for(var n=l[0].childNodes,o=0;o<n.length;o++)if("undefined"!=typeof n[o].tagName){if("template"==String(n[o].tagName).toLowerCase()){for(var r={},h=0;h<n[o].childNodes.length;h++){var a=n[o].childNodes[h];if(null!=a.tagName){var d=a.tagName;if("undefined"!=typeof this.conf.template[d]&&(r[d]=window.dhx4._xmlNodeValue(a)),"columns"==d)for(var c=0;c<a.childNodes.length;c++){var u=a.childNodes[c];if(null!=u.tagName&&"column"==u.tagName){var f={};for(var _ in{width:1,css:1,header:1,option:1})null!=u.getAttribute(_)&&(f[_]=u.getAttribute(_));for(var _ in{header:1,option:1}){var p=u.getElementsByTagName(_);null!=p[0]&&null!=p[0].firstChild&&(f[_]=window.dhx4._xmlNodeValue(p[0]))}null==r.columns&&(r.columns=[]),r.columns.push(f)}u=null}}a=null}this.setTemplate(r)}if("option"==String(n[o].tagName).toLowerCase()){var m=!1;m=1==e?s.options.length==i:window.dhx4.s2b(n[o].getAttribute("selected"));var g={value:n[o].getAttribute("value"),text:window.dhx4._xmlNodeValue(n[o]),selected:m,checked:window.dhx4.s2b(n[o].getAttribute("checked"))};for(var _ in{img:1,img_dis:1,img_src:1,img_src_dis:1,css:1})null!=n[o].getAttribute(_)&&(g[_]=n[o].getAttribute(_));for(var h=0;h<n[o].childNodes.length;h++)if(null!=n[o].childNodes[h].tagName&&"text"==String(n[o].childNodes[h].tagName).toLowerCase()){g.text={};for(var a=n[o].childNodes[h],c=0;c<a.childNodes.length;c++)null!=a.childNodes[c].tagName&&(g.text[a.childNodes[c].tagName]=window.dhx4._xmlNodeValue(a.childNodes[c]))}s.options.push(g)}}l=n=null}return s},window.dhx4._enableDataLoading(this,"_initObj","_xmlToObj","complete",{data:!0}),window.dhx4._eventable(this),this._getNearItem=function(t,e){for(var i=null;null!=t;)t=t[e<0?"previousSibling":"nextSibling"],null==i&&null!=t&&""==t.style.display&&null!=t._optId&&(i=t,t=null);return i},this.setName(this.conf.form_name),this._doOnListMouseMove=function(t){t=t||event;for(var e=t.target||t.srcElement;null!=e&&e!=this;)"undefined"!=typeof e._optId&&(n.conf.tm_hover&&window.clearTimeout(n.conf.tm_hover),n._setSelected(e._optId,!1,!1,!0)),e=e.parentNode;e=null},this._doOnListMouseDown=function(t){t=t||event,t.cancelBubble=!0,n.conf.clear_click=!0,window.setTimeout(function(){n.base.firstChild.focus()},1)},this._doOnListMouseUp=function(t){if(t=t||event,t.button==n.conf.btn_left){for(var e=t.target||t.srcElement;null!=e&&e!=this;){if("undefined"!=typeof e._optId){var i=!0;"function"==typeof n.t[e._optId].obj.optionClick&&n.t[e._optId].obj.optionClick(e,t,n)!==!0&&(i=!1),i&&(n._setSelected(e._optId,null,!0),n._confirmSelect("click"))}e=e.parentNode}e=null}},this._doOnListMouseOut=function(t){n.conf.tm_hover&&window.clearTimeout(n.conf.tm_hover),n.conf.tm_hover=window.setTimeout(function(){var t=n.conf.last_match||n.conf.last_selected;null==n.conf.last_match&&null!=n.t[t]&&n.base.firstChild.value!=n.t[t].obj.getText(n.t[t].item,!0)&&(t=null),n._setSelected(t,null,!0,!0)},1)},this._doOnBaseMouseDown=function(t){if(n.conf.enabled&&(n.conf.clear_click=!0,t=t||event,t.button==n.conf.btn_left)){var e=t.target||t.srcElement;if(e!=this.firstChild){window.setTimeout(function(){n.base.firstChild.focus()},1);for(var i=e;i!=this&&null!=i;)if(i==this.lastChild){if("function"==typeof n.modes[n.conf.opts_type].topImageClick){var s=n.conf.last_hover||n.conf.last_selected,l=null!=s?n.t[s].item:null;if(n.modes[n.conf.opts_type].topImageClick(l,n)!==!0)return void(s=l=null)}i=null}else i=i.parentNode}n._isListVisible()?n._hideList():(e!=this.firstChild&&(n.conf.clear_blur=!0),n._showList(),n._setSelected(n.conf.last_selected,!0,!0)),e=null}},this._doOnBodyMouseDown=function(){return n.conf.clear_click?void(n.conf.clear_click=!1):void n._confirmSelect("blur")},this._doOnInputFocus=function(){n.conf.clear_blur=!1,n.conf.tm_confirm_blur&&window.clearTimeout(n.conf.tm_confirm_blur),
0==n.conf.combo_focus&&(n.conf.combo_focus=!0,n.callEvent("onFocus",[]))},this._doOnInputBlur=function(){return 1==n.conf.clear_blur?void(n.conf.clear_blur=!1):(n.conf.tm_confirm_blur&&window.clearTimeout(n.conf.tm_confirm_blur),void(n.conf.tm_confirm_blur=window.setTimeout(function(){0==n.conf.clear_click&&(n._confirmSelect("blur"),n.conf.combo_focus=!1,n.callEvent("onBlur",[]))},20)))},this._doOnInputKeyUp=function(t){return t=t||event,0!=n.conf.f_mode?(n.conf.clear_bsp=8==t.keyCode||46==t.keyCode,void n._filterOpts()):void n._checkForMatch()},this._doOnInputKeyDown=function(t){t=t||event,38!=t.keyCode&&40!=t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||(t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,n._keyOnUpDown(38==t.keyCode?-1:1)),113==t.keyCode&&(n._isListVisible()||(n._showList(),n.base.firstChild.value==n.conf.last_text?(n._setSelected(n.conf.last_selected,!0,!0),n.base.firstChild.value=n.conf.last_text,n.conf.f_server_last=n.base.firstChild.value.toLowerCase()):(n.conf.f_server_last=n.base.firstChild.value.toLowerCase(),0==n.conf.f_mode&&n._checkForMatch()))),27==t.keyCode&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,n._cancelSelect()),13==t.keyCode&&(t.preventDefault&&t.preventDefault(),n._confirmSelect("kbd")),1==n.conf.ro_mode&&(t.keyCode>=48&&t.keyCode<=57||t.keyCode>=65&&t.keyCode<=90)&&(n._searchRO(String.fromCharCode(t.keyCode).toLowerCase()),t.cancelBubble=!0),n.conf.clear_key=!0,n.callEvent("onKeyPressed",[t.keyCode||t.charCode])},this._doOnInputKeyPress=function(t){return n.conf.clear_key?void(n.conf.clear_key=!1):(t=t||event,void n.callEvent("onKeyPressed",[t.keyCode||t.charCode]))},this._keyOnUpDown=function(t){var e=null;if(this.conf.last_hover?e=this.t[this.conf.last_hover].item:this.conf.last_selected&&(e=this.t[this.conf.last_selected].item),(e||0!=this._getListVisibleCount())&&(null!=e&&""!=e.style.display&&(e=null),this._showList(),null!=e?this.t[e._optId].obj.isSelected(e)&&(e=this._getNearItem(e,t)):(e=this.list.firstChild,""!=e.style.display&&(e=this._getNearItem(e,1))),null!=e)){if(this._setSelected(e._optId,!0,!0),0==this.conf.f_mode)this.base.firstChild.value=this.t[e._optId].obj.getText(e,!0);else{var i=String(this.t[e._optId].obj.getText(e,!0));"start"==this.conf.f_mode&&1==this.conf.f_ac?0===i.toLowerCase().indexOf(this.conf.f_server_last)?(this.conf.f_ac_text=i.substring(this.conf.f_server_last.length,i.length),this.base.firstChild.value=i,this._selectRange(this.conf.f_server_last.length,this.base.firstChild.value.length)):(this.base.firstChild.value=i,this.conf.f_server_last=this.base.firstChild.value.toLowerCase(),this._selectRange(0,this.base.firstChild.value.length)):(this.base.firstChild.value=i,this.conf.f_server_last=this.base.firstChild.value.toLowerCase())}e=null}},this.conf.evs_nodes=[{node:document.body,evs:{mousedown:"_doOnBodyMouseDown"}},{node:this.base,evs:{mousedown:"_doOnBaseMouseDown"}},{node:this.base.firstChild,evs:{keyup:"_doOnInputKeyUp",keydown:"_doOnInputKeyDown",keypress:"_doOnInputKeyPress",focus:"_doOnInputFocus",blur:"_doOnInputBlur"}},{node:this.list,evs:{mousemove:"_doOnListMouseMove",mousedown:"_doOnListMouseDown",mouseup:"_doOnListMouseUp",mouseout:"_doOnListMouseOut"}}];for(var h=0;h<this.conf.evs_nodes.length;h++)for(var a in this.conf.evs_nodes[h].evs)"function"==typeof window.addEventListener?this.conf.evs_nodes[h].node.addEventListener(a,this[this.conf.evs_nodes[h].evs[a]],!1):this.conf.evs_nodes[h].node.attachEvent("on"+a,this[this.conf.evs_nodes[h].evs[a]]);return this.unload=function(){this.clearAll(),this.t=null;for(var t=0;t<this.conf.evs_nodes.length;t++){for(var e in this.conf.evs_nodes[t].evs)"function"==typeof window.addEventListener?this.conf.evs_nodes[t].node.removeEventListener(e,this[this.conf.evs_nodes[t].evs[e]],!1):this.conf.evs_nodes[t].node.detachEvent("on"+e,this[this.conf.evs_nodes[t].evs[e]]),this.conf.evs_nodes[t].evs[e]=null,delete this.conf.evs_nodes[t].evs[e];this.conf.evs_nodes[t].node=null,this.conf.evs_nodes[t].evs=null,delete this.conf.evs_nodes[t].node,delete this.conf.evs_nodes[t].evs,this.conf.evs_nodes[t]=null}window.dhx4._eventable(this,"clear"),window.dhx4._enableDataLoading(this,null,null,null,"clear"),this._mcDetachHeader(),this.DOMelem_input=this.DOMelem_button=this.DOMlist=this.DOMelem=this.DOMParent=null;for(var e in this.conf)this.conf[e]=null,delete this.conf[e];this.conf=null,"function"==typeof window.addEventListener?this.list.removeEventListener("scroll",this._doOnListScroll,!1):this.list.detachEvent("onscroll",this._doOnListScroll),this.base.parentNode.removeChild(this.base),this.list.parentNode.removeChild(this.list),this.base=this.list=this.cont=null,this.modes=null;for(var e in this)"function"==typeof this[e]&&(this[e]=null);n=null},this.DOMelem_input=this.base.firstChild,this.DOMelem_button=this.base.childNodes[this.base.childNodes.length-(this.conf.combo_image?2:1)],this.DOMlist=this.list,this.DOMelem=this.base,this.DOMParent=t,t=null,null!=o&&(null!=o.filter&&("string"==typeof o.filter?this.enableFilteringMode(!0,o.filter,window.dhx4.s2b(o.filter_cache),window.dhx4.s2b(o.filter_sub_load)):this.enableFilteringMode(!0)),null!=o.image_path&&this.setImagePath(o.image_path),null==o.default_image&&null==o.default_image_dis||this.setDefaultImage(o.default_image,o.default_image_dis),(o.items||o.options)&&this.addOption(o.items||o.options),(o.xml||o.json)&&this.load(o.xml||o.json),"undefined"!=typeof o.readonly&&this.readonly(o.readonly),o=null),this}function dhtmlXComboFromSelect(t){"string"==typeof t&&(t=document.getElementById(t));var e=t.offsetWidth,i=t.getAttribute("name")||null,s=document.createElement("SPAN");t.parentNode.insertBefore(s,t);var l=t.getAttribute("mode")||t.getAttribute("opt_type")||"option",n=new dhtmlXCombo(s,i,e,l);s=null;var o=t.getAttribute("imagePath");o&&n.setImagePath(o);var r=t.getAttribute("defaultImage"),h=t.getAttribute("defaultImageDis");1==window.dhx4.s2b(h)&&(h=!0),null==r&&null==h||n.setDefaultImage(r,h);var a=n._xmlToObj([t],!0,t.selectedIndex);return a.options.length>0&&n.addOption(a.options),a=null,t.parentNode.removeChild(t),t=null,n}function dhtmlXComboExtend(t,e){for(var i in dhtmlXCombo.prototype.modes[e])"undefined"==typeof dhtmlXCombo.prototype.modes[t][i]&&(dhtmlXCombo.prototype.modes[t][i]=dhtmlXCombo.prototype.modes[e][i])}function dhtmlXMenuObject(t,e){var i=this;if(this.conf={skin:e||window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxmenu")||"dhx_skyblue",mode:"web",align:"left",is_touched:!1,selected:-1,last_click:-1,fixed_pos:!1,rtl:!1,icons_path:"",arrow_ff_fix:navigator.userAgent.indexOf("MSIE")>=0&&"BackCompat"==document.compatMode,live_id:window.dhx4.newId(),tags:{root:"menu",item:"item",text_ext:"itemtext",userdata:"userdata",tooltip:"tooltip",hotkey:"hotkey",href:"href"},autoload:{},hide_tm:{},top_mode:!0,top_tmtime:200,v_enabled:!1,v:{x1:null,x2:null,y1:null,y2:null},dir_toplv:"bottom",dir_sublv:"right",auto_overflow:!1,overflow_limit:0,of_utm:null,of_utime:20,of_ustep:3,of_dtm:null,of_dtime:20,of_dstep:3,of_ah:{dhx_skyblue:24,dhx_web:25,dhx_terrace:27},of_ih:{dhx_skyblue:24,dhx_web:24,dhx_terrace:24},tm_sec:400,tm_handler:null,dload:!1,dload_url:"",dload_icon:!1,dload_params:{action:"loadMenu"},dload_pid:"parentId",tl_botmarg:1,tl_rmarg:0,tl_ofsleft:1,context:!1,ctx_zoneid:!1,ctx_autoshow:!0,ctx_autohide:!0,ctx_hideall:!0,ctx_zones:{},ctx_baseid:null,selected_sub:[],opened_poly:[]},"object"==typeof t&&null!=t&&"undefined"==typeof t.tagName){null==t.icons_path&&null==t.icon_path||(this.conf.icons_path=t.icons_path||t.icon_path),null!=t.skin&&(this.conf.skin=t.skin),t.visible_area&&(this.conf.v_enabled=!0,this.conf.v={x1:t.visible_area.x1,x2:t.visible_area.x2,y1:t.visible_area.y1,y2:t.visible_area.y2});for(var s in{json:1,xml:1,items:1,top_text:1,align:1,open_mode:1,overflow:1,dynamic:1,dynamic_icon:1,context:1,onload:1,onclick:1,oncheckboxclick:1,onradioclick:1})null!=t[s]&&(this.conf.autoload[s]=t[s]);t=t.parent}if(null==t)this.base=document.body;else{var l="string"==typeof t?document.getElementById(t):t;null!=l?(this.base=l,this.base.id||(this.base.id="menuBaseId_"+(new Date).getTime()),this.base.className+=" dhtmlxMenu_"+this.conf.skin+"_Middle dir_left",this.base._autoSkinUpdate=!0,this.base.oncontextmenu&&(this.base._oldContextMenuHandler=this.base.oncontextmenu),this.conf.ctx_baseid=this.base.id,this.base.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},this.base.oncontextmenu=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1}):this.base=document.body}this.idPrefix="",this.topId="dhxWebMenuTopId",this.idPull={},this.itemPull={},this.userData={},this.radio={},this.setSkin=function(t){var e=this.conf.skin;switch(this.conf.skin=t,this.conf.skin){case"dhx_skyblue":case"dhx_web":this.conf.tl_botmarg=2,this.conf.tl_rmarg=1,this.conf.tl_ofsleft=1;break;case"dhx_terrace":this.conf.tl_botmarg=0,this.conf.tl_rmarg=0,this.conf.tl_ofsleft=0}this.base._autoSkinUpdate&&(this.base.className=this.base.className.replace("dhtmlxMenu_"+e+"_Middle","")+" dhtmlxMenu_"+this.conf.skin+"_Middle");for(var i in this.idPull)this.idPull[i].className=String(this.idPull[i].className).replace(e,this.conf.skin)},this.setSkin(this.conf.skin),this._addSubItemToSelected=function(t,e){for(var i=!0,s=0;s<this.conf.selected_sub.length;s++)this.conf.selected_sub[s][0]==t&&this.conf.selected_sub[s][1]==e&&(i=!1);return 1==i&&this.conf.selected_sub.push(new Array(t,e)),i},this._removeSubItemFromSelected=function(t,e){for(var i=new Array,s=!1,l=0;l<this.conf.selected_sub.length;l++)this.conf.selected_sub[l][0]==t&&this.conf.selected_sub[l][1]==e?s=!0:i[i.length]=this.conf.selected_sub[l];return 1==s&&(this.conf.selected_sub=i),s},this._getSubItemToDeselectByPolygon=function(t){for(var e=new Array,i=0;i<this.conf.selected_sub.length;i++)if(this.conf.selected_sub[i][1]==t){e[e.length]=this.conf.selected_sub[i][0],e=e.concat(this._getSubItemToDeselectByPolygon(this.conf.selected_sub[i][0]));for(var s=!0,l=0;l<this.conf.opened_poly.length;l++)this.conf.opened_poly[l]==this.conf.selected_sub[i][0]&&(s=!1);1==s&&(this.conf.opened_poly[this.conf.opened_poly.length]=this.conf.selected_sub[i][0]),this.conf.selected_sub[i][0]=-1,this.conf.selected_sub[i][1]=-1}return e},this._hidePolygon=function(t){if(null!=this.idPull["polygon_"+t]){if(null!=this.idPull["polygon_"+t]._zId&&window.dhx4.zim.clear(this.idPull["polygon_"+t]._zId),"undefined"!=typeof this._menuEffect&&this._menuEffect!==!1)this._hidePolygonEffect("polygon_"+t);else{if("none"==this.idPull["polygon_"+t].style.display)return;this.idPull["polygon_"+t].style.display="none",null!=this.idPull["arrowup_"+t]&&(this.idPull["arrowup_"+t].style.display="none"),null!=this.idPull["arrowdown_"+t]&&(this.idPull["arrowdown_"+t].style.display="none"),this._updateItemComplexState(t,!0,!1),window.dhx4.isIE6&&null!=this.idPull["polygon_"+t+"_ie6cover"]&&(this.idPull["polygon_"+t+"_ie6cover"].style.display="none")}t=String(t).replace(this.idPrefix,""),t==this.topId&&(t=null),this.callEvent("onHide",[t]),null!=t&&"dhx_terrace"==this.conf.skin&&this.itemPull[this.idPrefix+t].parent==this.idPrefix+this.topId&&this._improveTerraceButton(this.idPrefix+t,!0)}},this._showPolygon=function(t,e){var i=this._countVisiblePolygonItems(t);if(0!=i){var s="polygon_"+t;if(null!=this.idPull[s]&&null!=this.idPull[t]){if(this.conf.top_mode&&"web"==this.conf.mode&&!this.conf.context&&!this.idPull[t]._mouseOver&&e==this.conf.dir_toplv)return;this.conf.fixed_pos||this._autoDetectVisibleArea();var l=0,n=0,o=null,r=null;if(null==this.idPull[s]._zId&&(this.idPull[s]._zId=window.dhx4.newId()),this.idPull[s]._zInd=window.dhx4.zim.reserve(this.idPull[s]._zId),this.idPull[s].style.visibility="hidden",this.idPull[s].style.left="0px",this.idPull[s].style.top="0px",this.idPull[s].style.display="",this.idPull[s].style.zIndex=this.idPull[s]._zInd,this.conf.auto_overflow)if(this.idPull[s].childNodes[1].childNodes[0].offsetHeight>this.conf.v.y2-this.conf.v.y1){var h=Math.max(Math.floor((this.conf.v.y2-this.conf.v.y1-2*this.conf.of_ah[this.conf.skin])/this.conf.of_ih[this.conf.skin]),1);this.conf.overflow_limit=h}else this.conf.overflow_limit=0,null!=this.idPull["arrowup_"+t]&&this._removeUpArrow(String(t).replace(this.idPrefix,"")),null!=this.idPull["arrowdown_"+t]&&this._removeDownArrow(String(t).replace(this.idPrefix,""));if(this.conf.overflow_limit>0&&this.conf.overflow_limit<i&&(null==this.idPull["arrowup_"+t]&&this._addUpArrow(String(t).replace(this.idPrefix,"")),null==this.idPull["arrowdown_"+t]&&this._addDownArrow(String(t).replace(this.idPrefix,"")),o=this.idPull["arrowup_"+t],o.style.display="none",r=this.idPull["arrowdown_"+t],r.style.display="none"),this.conf.overflow_limit>0&&this.conf.overflow_limit<i?(this.idPull[s].childNodes[1].style.height=this.conf.of_ih[this.conf.skin]*this.conf.overflow_limit+"px",o.style.width=r.style.width=this.idPull[s].childNodes[1].style.width=this.idPull[s].childNodes[1].childNodes[0].offsetWidth+"px",this.idPull[s].childNodes[1].scrollTop=0,o.style.display="",l=o.offsetHeight,r.style.display="",n=r.offsetHeight):(this.idPull[s].childNodes[1].style.height="",this.idPull[s].childNodes[1].style.width=""),null!=this.itemPull[t]){"polygon_"+this.itemPull[t].parent}else if(this.conf.context){this.idPull[this.idPrefix+this.topId]}var a=null!=this.idPull[t].tagName?window.dhx4.absLeft(this.idPull[t]):this.idPull[t][0],d=null!=this.idPull[t].tagName?window.dhx4.absTop(this.idPull[t]):this.idPull[t][1],c=null!=this.idPull[t].tagName?this.idPull[t].offsetWidth:0,u=null!=this.idPull[t].tagName?this.idPull[t].offsetHeight:0,f=0,_=0,p=this.idPull[s].offsetWidth,m=this.idPull[s].offsetHeight;if("bottom"==e&&(f=this.conf.rtl?a+(null!=c?c:0)-p:"right"==this.conf.align?a+c-p:a-1+(e==this.conf.dir_toplv?this.conf.tl_rmarg:0),_=d-1+u+this.conf.tl_botmarg),"right"==e&&(f=a+c-1,_=d+2),"left"==e&&(f=a-this.idPull[s].offsetWidth+2,_=d+2),"top"==e&&(f=a-1,_=d-m+2),this.conf.fixed_pos)var g=65536,b=65536;else{var g=null!=this.conf.v.x2?this.conf.v.x2:0,b=null!=this.conf.v.y2?this.conf.v.y2:0;0==g&&(window.innerWidth?(g=window.innerWidth,b=window.innerHeight):(g=document.body.offsetWidth,b=document.body.scrollHeight))}if(f+p>g&&!this.conf.rtl&&(f=a-p+2),f<this.conf.v.x1&&this.conf.rtl&&(f=a+c-2),f<0&&(f=0),_+m>b&&null!=this.conf.v.y2&&(_=Math.max(d+u-m+2,this.conf.v_enabled?this.conf.v.y1+2:2),this.conf.context&&this.idPrefix+this.topId==t&&null!=r&&(_-=2),null==this.itemPull[t]||this.conf.context||this.itemPull[t].parent==this.idPrefix+this.topId&&(_-=this.base.offsetHeight)),this.idPull[s].style.left=f+"px",this.idPull[s].style.top=_+"px","undefined"!=typeof this._menuEffect&&this._menuEffect!==!1)this._showPolygonEffect(s);else if(this.idPull[s].style.visibility="",this.conf.overflow_limit>0&&this.conf.overflow_limit<i&&(this.idPull[s].childNodes[1].scrollTop=0,this._checkArrowsState(t)),window.dhx4.isIE6){var v=s+"_ie6cover";if(null==this.idPull[v]){var w=document.createElement("IFRAME");w.className="dhtmlxMenu_IE6CoverFix_"+this.conf.skin,w.frameBorder=0,w.setAttribute("src","javascript:false;"),document.body.insertBefore(w,document.body.firstChild),this.idPull[v]=w}this.idPull[v].style.left=f+"px",this.idPull[v].style.top=_+"px",this.idPull[v].style.width=this.idPull[s].offsetWidth+"px",this.idPull[v].style.height=this.idPull[s].offsetHeight+"px",this.idPull[v].style.zIndex=this.idPull[s].style.zIndex-1,this.idPull[v].style.display=""}t=String(t).replace(this.idPrefix,""),t==this.topId&&(t=null),this.callEvent("onShow",[t]),null!=t&&"dhx_terrace"==this.conf.skin&&this.itemPull[this.idPrefix+t].parent==this.idPrefix+this.topId&&this._improveTerraceButton(this.idPrefix+t,!1)}}},this._redistribSubLevelSelection=function(t,e){for(;this.conf.opened_poly.length>0;)this.conf.opened_poly.pop();var i=this._getSubItemToDeselectByPolygon(e);this._removeSubItemFromSelected(-1,-1);for(var s=0;s<i.length;s++)null!=this.idPull[i[s]]&&i[s]!=t&&"enabled"==this.itemPull[i[s]].state&&(this.idPull[i[s]].className="sub_item");for(var s=0;s<this.conf.opened_poly.length;s++)this.conf.opened_poly[s]!=e&&this._hidePolygon(this.conf.opened_poly[s]);if("enabled"==this.itemPull[t].state){if(this.idPull[t].className="sub_item_selected",this.itemPull[t].complex&&this.conf.dload&&"no"==this.itemPull[t].loaded){1==this.conf.dload_icon&&this._updateLoaderIcon(t,!0),this.itemPull[t].loaded="get";var l=t.replace(this.idPrefix,"");this._dhxdataload.onBeforeXLS=function(){var t={params:{}};t.params[this.conf.dload_pid]=l;for(var e in this.conf.dload_params)t.params[e]=this.conf.dload_params[e];return t},this.loadStruct(this.conf.dload_url)}(this.itemPull[t].complex||this.conf.dload&&"yes"==this.itemPull[t].loaded)&&this.itemPull[t].complex&&null!=this.idPull["polygon_"+t]&&(this._updateItemComplexState(t,!0,!0),this._showPolygon(t,this.conf.dir_sublv)),this._addSubItemToSelected(t,e),this.conf.selected=t}},this._doOnClick=function(t,e,i){if(this.conf.last_click=t,null!=this.itemPull[this.idPrefix+t].href_link&&"enabled"==this.itemPull[this.idPrefix+t].state){var s=document.createElement("FORM"),l=String(this.itemPull[this.idPrefix+t].href_link).split("?");if(s.action=l[0],null!=l[1])for(var n=String(l[1]).split("&"),o=0;o<n.length;o++){var r=String(n[o]).split("="),h=document.createElement("INPUT");h.type="hidden",h.name=r[0]||"",h.value=r[1]||"",s.appendChild(h)}return null!=this.itemPull[this.idPrefix+t].href_target&&(s.target=this.itemPull[this.idPrefix+t].href_target),s.style.display="none",document.body.appendChild(s),s.submit(),void(null!=s&&(document.body.removeChild(s),s=null))}if("c"!=e.charAt(0)&&"d"!=e.charAt(1)&&"s"!=e.charAt(2)){if(this.checkEvent("onClick"))this.callEvent("onClick",[t,this.conf.ctx_zoneid,i]);else if("d"==e.charAt(1)||"win"==this.conf.mode&&"t"==e.charAt(2))return;this.conf.context&&this._isContextMenuVisible()&&this.conf.ctx_autohide?this._hideContextMenu():this._clearAndHide&&this._clearAndHide()}},this._doOnTouchMenu=function(t){0==this.conf.is_touched&&(this.conf.is_touched=!0,this.checkEvent("onTouch")&&this.callEvent("onTouch",[t]))},this._searchMenuNode=function(t,e){for(var i=new Array,s=0;s<e.length;s++)if("object"==typeof e[s]){5==e[s].length&&"object"!=typeof e[s][0]&&e[s][0].replace(this.idPrefix,"")==t&&0==s&&(i=e);var l=this._searchMenuNode(t,e[s]);l.length>0&&(i=l)}return i},this._getMenuNodes=function(t){var e=new Array;for(var i in this.itemPull)this.itemPull[i].parent==t&&(e[e.length]=i);return e},this._genStr=function(t){for(var e="dhxId_",i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",s=0;s<t;s++)e+=i.charAt(Math.round(Math.random()*(i.length-1)));return e},this.getItemType=function(t){return t=this.idPrefix+t,null==this.itemPull[t]?null:this.itemPull[t].type},this.forEachItem=function(t){for(var e in this.itemPull)t(String(e).replace(this.idPrefix,""))},this._clearAndHide=function(){for(i.conf.selected=-1,i.conf.last_click=-1;i.conf.opened_poly.length>0;)i.conf.opened_poly.pop();for(var t=0;t<i.conf.selected_sub.length;t++){var e=i.conf.selected_sub[t][0];null!=i.idPull[e]&&"enabled"==i.itemPull[e].state&&("sub_item_selected"==i.idPull[e].className&&(i.idPull[e].className="sub_item"),i.idPull[e].className=="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Selected"&&(null!=i.itemPull[e].cssNormal?i.idPull[e].className=i.itemPull[e].cssNormal:i.idPull[e].className="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Normal")),i._hidePolygon(e)}i.conf.is_touched=!1,i.conf.context&&i.conf.ctx_hideall&&i._hidePolygon(i.idPrefix+i.topId)},this._showSubLevelItem=function(t,e){null!=document.getElementById("arrow_"+this.idPrefix+t)&&(document.getElementById("arrow_"+this.idPrefix+t).style.display=e?"none":""),null!=document.getElementById("image_"+this.idPrefix+t)&&(document.getElementById("image_"+this.idPrefix+t).style.display=e?"none":""),null!=document.getElementById(this.idPrefix+t)&&(document.getElementById(this.idPrefix+t).style.display=e?"":"none")},this._hideSubLevelItem=function(t){this._showSubLevelItem(t,!0)},this.idPrefix=this._genStr(12)+"_",this._bodyClick=function(t){t=t||event,2==t.button||window.dhx4.isOpera&&1==t.ctrlKey||(i.conf.context?i.conf.ctx_autohide&&(!window.dhx4.isOpera||i._isContextMenuVisible()&&window.dhx4.isOpera)&&i._hideContextMenu():i._clearAndHide&&i._clearAndHide())},this._bodyContext=function(t){t=t||event;var e=String((t.srcElement||t.target).className);if(e.search("dhtmlxMenu")==-1||e.search("SubLevelArea")==-1){for(var s=!0,l=t.target||t.srcElement;null!=l;)null!=l.id&&i.isContextZone(l.id)&&(s=!1),l==document.body&&(s=!1),l=l.parentNode;s&&i.hideContextMenu()}},"undefined"!=typeof window.addEventListener?(window.addEventListener("click",this._bodyClick,!1),window.addEventListener("contextmenu",this._bodyContext,!1)):(document.body.attachEvent("onclick",this._bodyClick),document.body.attachEvent("oncontextmenu",this._bodyContext)),this.unload=function(){window.dhx4._eventable(this,"clear"),dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]=null;try{delete dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]}catch(t){}if(this.conf.live_id=null,"function"==typeof window.addEventListener?(window.removeEventListener("click",this._bodyClick,!1),window.removeEventListener("contextmenu",this._bodyContext,!1)):(document.body.detachEvent("onclick",this._bodyClick),document.body.detachEvent("oncontextmenu",this._bodyContext)),this._bodyClick=null,this._bodyContext=null,this.removeItem(this.idPrefix+this.topId,!0),this.itemPull=null,this.idPull=null,this.conf.context)for(var t in this.conf.ctx_zones)this.removeContextZone(t);null!=this.cont&&(this.cont.className="",this.cont.parentNode.removeChild(this.cont),this.cont=null),null!=this.base&&(this.conf.context||(this.base.className=""),this.conf.context||(this.base.oncontextmenu=this.base._oldContextMenuHandler||null),this.base.onselectstart=null,this.base=null);for(var t in this)this[t]=null;i=null},dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]=this,window.dhx4._enableDataLoading(this,"_initObj","_xmlToJson",this.conf.tags.root,{struct:!0}),window.dhx4._eventable(this),1==window.dhx4.s2b(this.conf.autoload.context)&&this.renderAsContextMenu(),null!=this.conf.autoload.dynamic?this.enableDynamicLoading(this.conf.autoload.dynamic,window.dhx4.s2b(this.conf.autoload.dynamic_icon)):null!=this.conf.autoload.items?this.loadStruct(this.conf.autoload.items,this.conf.autoload.onload):null!=this.conf.autoload.json?this.loadStruct(this.conf.autoload.json,this.conf.autoload.onload):null!=this.conf.autoload.xml&&this.loadStruct(this.conf.autoload.xml,this.conf.autoload.onload);for(var s in{onclick:1,oncheckboxclick:1,onradioclick:1})null!=this.conf.autoload[s]&&("function"==typeof this.conf.autoload[s]?this.attachEvent(s,this.conf.autoload[s]):"function"==typeof window[this.conf.autoload[s]]&&this.attachEvent(s,window[this.conf.autoload[s]]));null!=this.conf.autoload.top_text&&this.setTopText(this.conf.autoload.top_text),null!=this.conf.autoload.align&&this.setAlign(this.conf.autoload.align),null!=this.conf.autoload.open_mode&&this.setOpenMode(this.conf.autoload.open_mode),null!=this.conf.autoload.overflow&&this.setOverflowHeight(this.conf.autoload.overflow);for(var s in this.conf.autoload)this.conf.autoload[s]=null,delete this.conf.autoload[s];return this.conf.autoload=null,this}function dhtmlXToolbarObject(t,e){var i=this;for(this.conf={skin:e||window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxtoolbar")||"dhx_skyblue",align:"left",align_autostart:"left",icons_path:"",iconSize:18,sel_ofs_x:0,sel_ofs_y:0,xml_autoload:null,items_autoload:null},"object"==typeof t&&null!=t&&"undefined"==typeof t.tagName&&(null==t.icons_path&&null==t.icon_path||(this.conf.icons_path=t.icons_path||t.icon_path),null!=t.icons_size&&(this.conf.icons_size_autoload=t.icons_size),null!=t.json&&(this.conf.json_autoload=t.json),null!=t.xml&&(this.conf.xml_autoload=t.xml),null!=t.onload&&(this.conf.onload_autoload=t.onload),null==t.onclick&&null==t.onClick||(this.conf.auto_onclick=t.onclick||t.onClick),null!=t.items&&(this.conf.items_autoload=t.items),null!=t.skin&&(this.conf.skin=t.skin),null!=t.align&&(this.conf.align_autostart=t.align),t=t.parent),this.cont="object"!=typeof t?document.getElementById(t):t;this.cont.childNodes.length>0;)this.cont.removeChild(this.cont.childNodes[0]);return t=null,this.cont.dir="ltr",this.base=document.createElement("DIV"),this.base.className="dhxtoolbar_float_left",this.cont.appendChild(this.base),this.cont.ontouchstart=function(t){return t=t||event,"input"==String(t.target.tagName||"").toLowerCase()||(t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1)},this.setSkin(this.conf.skin),this.objPull={},this.anyUsed="none",this._genStr=function(t){for(var e="dhxId_",i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",s=0;s<t;s++)e+=i.charAt(Math.round(Math.random()*(i.length-1)));return e},this.rootTypes=new Array("button","buttonSelect","buttonTwoState","separator","label","slider","text","buttonInput"),this.idPrefix=this._genStr(12),window.dhx4._enableDataLoading(this,"_initObj","_xmlToJson","toolbar",{struct:!0}),window.dhx4._eventable(this),this._getObj=function(t,e){for(var i=null,s=0;s<t.childNodes.length;s++)null!=t.childNodes[s].tagName&&String(t.childNodes[s].tagName).toLowerCase()==String(e).toLowerCase()&&(i=t.childNodes[s]);return i},this._addImgObj=function(t){var e=document.createElement("IMG");return t.childNodes.length>0?t.insertBefore(e,t.childNodes[0]):t.appendChild(e),e},this._setItemImage=function(t,e,i){if(1==i?t.imgEn=e:t.imgDis=e,!(!t.state&&1==i||t.state&&0==i)){var s=this._getObj(t.obj,"img");null==s&&(s=this._addImgObj(t.obj)),s.src=this.conf.icons_path+e}},this._clearItemImage=function(t,e){if(1==e?t.imgEn="":t.imgDis="",!(!t.state&&1==e||t.state&&0==e)){var i=this._getObj(t.obj,"img");null!=i&&i.parentNode.removeChild(i)}},this._setItemText=function(t,e){var i=this._getObj(t.obj,"div");return null==e||0==e.length?void(null!=i&&i.parentNode.removeChild(i)):(null==i&&(i=document.createElement("DIV"),i.className="dhxtoolbar_text",t.obj.appendChild(i)),void(i.innerHTML=e))},this._getItemText=function(t){var e=this._getObj(t.obj,"div");return null!=e?e.innerHTML:""},this._enableItem=function(t){if(!t.state){t.state=!0,"buttonTwoState"==this.objPull[t.id].type&&1==this.objPull[t.id].obj.pressed?(t.obj.className="dhx_toolbar_btn dhxtoolbar_btn_pres",t.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over"):(t.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def",t.obj.renderAs=t.obj.className),t.arw&&(t.arw.className=String(t.obj.className).replace("btn","arw"));var e=this._getObj(t.obj,"img");""!=t.imgEn?(null==e&&(e=this._addImgObj(t.obj)),e.src=this.conf.icons_path+t.imgEn):null!=e&&e.parentNode.removeChild(e)}},this._disableItem=function(t){if(t.state){t.state=!1,t.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+("buttonTwoState"==this.objPull[t.id].type&&t.obj.pressed?"pres_":"")+"dis",t.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",t.arw&&(t.arw.className=String(t.obj.className).replace("btn","arw"));var e=this._getObj(t.obj,"img");""!=t.imgDis?(null==e&&(e=this._addImgObj(t.obj)),e.src=this.conf.icons_path+t.imgDis):null!=e&&e.parentNode.removeChild(e),null!=t.polygon&&"none"!=t.polygon.style.display&&(window.dhx4.zim.clear(t.polygon._idd),t.polygon.style.display="none",t.polygon._ie6cover&&(t.polygon._ie6cover.style.display="none"),"dhx_terrace"==this.conf.skin&&this._improveTerraceButtonSelect(t.id,!0),this.callEvent("onButtonSelectHide",[t.obj.idd])),this.anyUsed="none"}},this.clearAll=function(){for(var t in this.objPull)this._removeItem(String(t).replace(this.idPrefix,""))},this._doOnClick=function(t){i&&i.forEachItem&&i.forEachItem(function(t){if("buttonSelect"==i.objPull[i.idPrefix+t].type){var e=i.objPull[i.idPrefix+t];e.arw._skip===!0?e.arw._skip=!1:"none"!=e.polygon.style.display&&(e.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",e.obj.className=e.obj.renderAs,e.arw.className=String(e.obj.renderAs).replace("btn","arw"),i.anyUsed="none",window.dhx4.zim.clear(e.polygon._idd),e.polygon.style.display="none",e.polygon._ie6cover&&(e.polygon._ie6cover.style.display="none"),"dhx_terrace"==i.conf.skin&&i._improveTerraceButtonSelect(e.id,!0),i.callEvent("onButtonSelectHide",[e.obj.idd]))}})},"undefined"!=typeof window.addEventListener?(window.addEventListener("mousedown",this._doOnClick,!1),window.addEventListener("touchstart",this._doOnClick,!1)):document.body.attachEvent("onmousedown",this._doOnClick),null!=this.conf.icons_size_autoload&&(this.setIconSize(this.conf.icons_size_autoload),this.conf.icons_size_autoload=null),null!=this.conf.items_autoload?(this.loadStruct(this.conf.items_autoload,this.conf.onload_autoload),this.conf.items_autoload=null):null!=this.conf.json_autoload?(this.loadStruct(this.conf.json_autoload,this.conf.onload_autoload),this.conf.json_autoload=null):null!=this.conf.xml_autoload&&(this.loadStruct(this.conf.xml_autoload,this.conf.onload_autoload),this.conf.xml_autoload=null),this.conf.align_autostart!=this.conf.align&&(this.setAlign(this.conf.align_autostart),this.conf.align_autostart=null),"function"==typeof this.conf.auto_onclick?this.attachEvent("onClick",this.conf.auto_onclick):"string"==typeof this.conf.auto_onclick&&"function"==typeof window[this.conf.auto_onclick]&&this.attachEvent("onClick",window[this.conf.auto_onclick]),this}function dhtmlxArray(t){return dhtmlx.extend(t||new Array,dhtmlxArray._master)}function dhtmlXGridObject(id){if(dhtmlxEvent.initTouch&&dhtmlxEvent.initTouch(),_isIE)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(t){}id?"object"==typeof id?(this.entBox=id,this.entBox.id||(this.entBox.id="cgrid2_"+this.uid())):this.entBox=document.getElementById(id):(this.entBox=document.createElement("DIV"),this.entBox.id="cgrid2_"+this.uid()),this.entBox.innerHTML="",dhx4._eventable(this);var self=this;this._wcorr=0,this.fontWidth=7,this.cell=null,this.row=null,this.iconURL="",this.editor=null,this._f2kE=!0,this._dclE=!0,this.combos=new Array(0),this.defVal=new Array(0),this.rowsAr={},this.rowsBuffer=dhtmlxArray(),this.rowsCol=dhtmlxArray(),this._data_cache={},this._ecache={},this._ud_enabled=!0,this.xmlLoader=this.doLoadDetails,this._maskArr=[],this.selectedRows=dhtmlxArray(),this.UserData={},this._sizeFix=this._borderFix=0,this.entBox.className+=" gridbox",this.entBox.style.width=this.entBox.getAttribute("width")||(window.getComputedStyle?this.entBox.style.width||window.getComputedStyle(this.entBox,null).width:this.entBox.currentStyle?this.entBox.currentStyle.width:this.entBox.style.width||0)||"100%",this.entBox.style.height=this.entBox.getAttribute("height")||(window.getComputedStyle?this.entBox.style.height||window.getComputedStyle(this.entBox,null).height:this.entBox.currentStyle?this.entBox.currentStyle.height:this.entBox.style.height||0)||"100%",this.entBox.style.cursor="default",this.entBox.onselectstart=function(){return!1};var t_creator=function(t){var e=document.createElement("TABLE");return e.cellSpacing=e.cellPadding=0,e.style.cssText="width:100%;table-layout:fixed;",e.className=t.substr(2),e};return this.obj=t_creator("c_obj"),this.hdr=t_creator("c_hdr"),this.hdr.style.marginRight="20px",this.hdr.style.paddingRight="20px",this.objBox=document.createElement("DIV"),this.objBox.style.width="100%",this.objBox.style.overflow="auto",this.objBox.appendChild(this.obj),this.objBox.className="objbox",dhtmlx.$customScroll&&dhtmlx.CustomScroll.enable(this),this.hdrBox=document.createElement("DIV"),this.hdrBox.style.width="100%",this.hdrBox.style.height="25px",this.hdrBox.style.overflow="hidden",this.hdrBox.className="xhdr",this.preloadImagesAr=new Array(0),this.sortImg=document.createElement("DIV"),this.sortImg.style.display="none",this.hdrBox.appendChild(this.sortImg),this.hdrBox.appendChild(this.hdr),
this.hdrBox.style.position="relative",this.entBox.appendChild(this.hdrBox),this.entBox.appendChild(this.objBox),this.entBox.grid=this,this.objBox.grid=this,this.hdrBox.grid=this,this.obj.grid=this,this.hdr.grid=this,this.cellWidthPX=[],this.cellWidthPC=[],this.cellWidthType=this.entBox.cellwidthtype||"px",this.delim=this.entBox.delimiter||",",this._csvDelim=",",this.hdrLabels=[],this.columnIds=[],this.columnColor=[],this._hrrar=[],this.cellType=dhtmlxArray(),this.cellAlign=[],this.initCellWidth=[],this.fldSort=[],this._srdh=_isIE&&"BackCompat"!=document.compatMode?22:20,this.imgURL=window.dhx_globalImgPath||"",this.isActive=!1,this.isEditable=!0,this.useImagesInHeader=!1,this.pagingOn=!1,this.rowsBufferOutSize=0,dhtmlxEvent(window,"unload",function(){try{self.destructor&&self.destructor()}catch(t){}}),this.setSkin=function(t){this._srdh=window.dhx4.readFromCss("dhxgrid_rh_"+t)+4,this.skin_name=t,this._imgURL&&this.setImagePath(this._imgURL);var e=this.entBox.className.split(" gridbox")[0];switch(this.entBox.className=e+" gridbox gridbox_"+t+(_isIE?" isIE":" isModern"),this.skin_h_correction=0,this.enableAlterCss("ev_"+t,"odd_"+t,this.isTreeGrid()),this._fixAlterCss(),t){case"dhx_terrace":this._srdh=33,this.forceDivInHeader=!0;break;case"dhx_web":this.forceDivInHeader=!0,this._srdh=31;break;case"dhx_skyblue":this.forceDivInHeader=!0}if(_isIE&&this.hdr){var i=this.hdr.parentNode;i.removeChild(this.hdr),i.appendChild(this.hdr)}this.setSizes()},_isIE&&this.preventIECaching(!0),window.dhtmlDragAndDropObject&&(this.dragger=new dhtmlDragAndDropObject),this._doOnScroll=function(t,e){this.callEvent("onScroll",[this.objBox.scrollLeft,this.objBox.scrollTop]),this.doOnScroll(t,e)},this.doOnScroll=function(t,e){this.hdrBox.scrollLeft=this.objBox.scrollLeft,this.ftr&&(this.ftr.parentNode.scrollLeft=this.objBox.scrollLeft),e||this._srnd&&(this._dLoadTimer&&window.clearTimeout(this._dLoadTimer),this._dLoadTimer=window.setTimeout(function(){self._update_srnd_view&&self._update_srnd_view()},100))},this.attachToObject=function(t){t.appendChild(this.globalBox?this.globalBox:this.entBox),this.setSizes()},this.init=function(t){if(this.isTreeGrid()&&!this._h2&&(this._h2=this._createHierarchy(),this._fake&&!this._realfake&&(this._fake._h2=this._h2),this._tgc={imgURL:null}),this._hstyles){if(this.skin_name||this.setSkin(window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxgrid")||"dhx_skyblue"),this.editStop(),this.lastClicked=null,this.resized=null,this.fldSorted=this.r_fldSorted=null,this.cellWidthPX=[],this.cellWidthPC=[],this.hdr.rows.length>0){var e=this.xmlFileUrl;this.clearAll(!0),this.xmlFileUrl=e}for(var i=this.hdr.insertRow(0),s=0;s<this.hdrLabels.length;s++)i.appendChild(document.createElement("TH")),i.childNodes[s]._cellIndex=s,i.childNodes[s].style.height="0px";_isIE&&_isIE<8&&document.body.style.msTouchAction==this.undefined?i.style.position="absolute":i.style.height="auto";var i=this.hdr.insertRow(_isKHTML?2:1);i._childIndexes=new Array;for(var l=0,s=0;s<this.hdrLabels.length;s++)i._childIndexes[s]=s-l,this.hdrLabels[s]!=this.splitSign||0==s?(i.insertCell(s-l),i.childNodes[s-l]._cellIndex=s,i.childNodes[s-l]._cellIndexS=s,this.setColumnLabel(s,this.hdrLabels[s])):(_isKHTML&&i.insertCell(s-l),i.cells[s-l-1].colSpan=(i.cells[s-l-1].colSpan||1)+1,i.childNodes[s-l-1]._cellIndex++,l++,i._childIndexes[s]=s-l);0==l&&(i._childIndexes=null),this._cCount=this.hdrLabels.length,_isIE&&window.setTimeout(function(){self.setSizes&&self.setSizes()},1),this.obj.firstChild||this.obj.appendChild(document.createElement("TBODY"));var n=this.obj.firstChild;if(!n.firstChild){n.appendChild(document.createElement("TR")),n=n.firstChild,_isIE&&_isIE<8&&document.body.style.msTouchAction==this.undefined?n.style.position="absolute":n.style.height="auto";for(var s=0;s<this.hdrLabels.length;s++)n.appendChild(document.createElement("TH")),n.childNodes[s].style.height="0px"}this._c_order=null,1!=this.multiLine&&(this.obj.className+=" row20px"),this.sortImg.style.position="absolute",this.sortImg.style.display="none",this.sortImg.className="dhxgrid_sort_desc",this.sortImg.defLeft=0,this.noHeader?this.hdrBox.style.display="none":this.noHeader=!1,this._ivizcol&&this.setColHidden(),this.attachHeader(),this.attachHeader(0,0,"_aFoot"),this.setSizes(),t&&this.parseXML(),this.obj.scrollTop=0,this.dragAndDropOff&&this.dragger.addDragLanding(this.entBox,this),this._initDrF&&this._initD(),dhx4.callEvent("onGridCreated",[this])}},this.setColumnSizes=function(t){for(var e=0,i=[],s=0,l=0;l<this._cCount;l++)if("*"!=this.initCellWidth[l]||this._hrrar[l]){if("%"==this.cellWidthType){"undefined"==typeof this.cellWidthPC[l]&&(this.cellWidthPC[l]=this.initCellWidth[l]);var n=t*this.cellWidthPC[l]/100||0;s>.5&&(n++,s--);var o=this.cellWidthPX[l]=Math.floor(n),s=s+n-o}else"undefined"==typeof this.cellWidthPX[l]&&(this.cellWidthPX[l]=this.initCellWidth[l]);this._hrrar[l]||(e+=1*this.cellWidthPX[l])}else this._awdth=!1,i.push(l);if(i.length){var r=Math.floor((t-e)/i.length);r<0&&(r=1);for(var l=0;l<i.length;l++){var h=Math.max(this._drsclmW?this._drsclmW[i[l]]||0:0,r);this.cellWidthPX[i[l]]=h,e+=h}if(t>e){var a=i[i.length-1];this.cellWidthPX[a]=this.cellWidthPX[a]+(t-e),e=t}this._setAutoResize()}return this.obj.style.width=e+"px",this.hdr.style.width=e+"px",this.ftr&&(this.ftr.style.width=e+"px"),this.chngCellWidth(),e},this.setSizes=function(){if(this.hdr.rows[0]){var t=this.quirks=_isIE&&"BackCompat"==document.compatMode,e=(this.entBox.offsetWidth-this.entBox.clientWidth)/2;if(!this.dontSetSizes)if(this.globalBox){if(!this.globalBox.clientWidth)return;var i=this.globalBox.clientWidth,s=(this.globalBox.offsetWidth-i)/2;if(this._delta_x&&!this._realfake){this.globalBox.style.width=this._delta_x;var l=this.globalBox.clientWidth;this.entBox.style.width=Math.max(0,l+(t?2*s:0)-this._fake.entBox.clientWidth)+"px",l!=this._lastTimeSplitWidth&&(this._fake._correctSplit(this._fake.entBox.clientWidth),this._lastTimeSplitWidth=l)}this._delta_y&&!this._realfake&&(this.globalBox.style.height=this._delta_y,this.entBox.style.overflow=this._fake.entBox.style.overflow="hidden",this.entBox.style.height=this._fake.entBox.style.height=this.globalBox.clientHeight+(t?2*s:0)+"px")}else this._delta_x&&(this.entBox.parentNode&&"TD"==this.entBox.parentNode.tagName?(this.entBox.style.width="1px",this.entBox.style.width=parseInt(this._delta_x)*this.entBox.parentNode.clientWidth/100-2*e+"px"):this.entBox.style.width=this._delta_x),this._delta_y&&(this.entBox.style.height=this._delta_y);if(window.clearTimeout(this._sizeTime),!(this.entBox.offsetWidth||this.globalBox&&this.globalBox.offsetWidth))return void(this._sizeTime=window.setTimeout(function(){self.setSizes&&self.setSizes()},250));var n=this._wthB||!this.entBox.cmp&&!this._delta_x||0!=(this.skin_name||"").indexOf("dhx")||t?0:2,o=this._wthB||!this.entBox.cmp&&!this._delta_y||0!=(this.skin_name||"").indexOf("dhx")||t?0:2;this._sizeFix&&(n-=this._sizeFix,o-=this._sizeFix);var r=!this.parentGrid&&this.objBox.scrollHeight>this.objBox.offsetHeight,h=dhtmlx.$customScroll?0:18,a=this.entBox.clientWidth-(this.skin_h_correction||0)*(t?0:1)-n,d=this.entBox.clientWidth-(this.skin_h_correction||0)-n,c=this.entBox.clientHeight-o,u=this.setColumnSizes(d-(r?h:0)-(this._correction_x||0)),f=!this.parentGrid&&(this.objBox.scrollWidth>this.objBox.offsetWidth||"scroll"==this.objBox.style.overflowX),_=this.hdr.clientHeight,p=this.ftr?this.ftr.clientHeight:0,m=a,g=c-_-p;if(this._awdth&&this._awdth[0]&&99999==this._awdth[1]&&(f=0),this._ahgr&&(g=this._ahgrMA?this.entBox.parentNode.clientHeight-_-p:this.obj.offsetHeight+(f?h:0)+(this._correction_y||0),this._ahgrM&&(g=this._ahgrF?Math.min(this._ahgrM,g+_+p)-_-p:Math.min(this._ahgrM,g)),r&&g>=this.obj.scrollHeight+(f?h:0)&&(r=!1,this.setColumnSizes(d-(this._correction_x||0)))),this._awdth&&this._awdth[0]){"%"==this.cellWidthType&&(this.cellWidthType="px"),this._fake&&(u+=this._fake.entBox.clientWidth);var m=Math.min(Math.max(u+(r?h:0),this._awdth[2]),this._awdth[1])+(this._correction_x||0);this.objBox.style.overflowX=!r&&this.objBox.scrollWidth<=m?"hidden":"auto",this._fake&&(m-=this._fake.entBox.clientWidth)}g=Math.max(0,g),this._ff_size_delta=.1==this._ff_size_delta?.2:.1,_isFF||(this._ff_size_delta=0),this.dontSetSizes||(this.entBox.style.width=Math.max(0,m+(t?2:0)*e+this._ff_size_delta)+"px",this.entBox.style.height=g+(t?2:0)*e+_+p+"px"),this.objBox.style.height=g+(t&&!r?2:0)*e+"px",this.hdrBox.style.height=_+"px",g!=c&&this.doOnScroll(0,!this._srnd);var b=this["setSizes_"+this.skin_name];b&&b.call(this),this.setSortImgPos(),_!=this.hdr.clientHeight&&this._ahgr&&this.setSizes(),this.callEvent("onSetSizes",[])}},this.chngCellWidth=function(){_isOpera&&this.ftr&&(this.ftr.width=this.objBox.scrollWidth+"px");for(var t=this._cCount,e=0;e<t;e++)this.hdr.rows[0].cells[e].style.width=this.cellWidthPX[e]+"px",this.obj.rows[0].childNodes[e].style.width=this.cellWidthPX[e]+"px",this.ftr&&(this.ftr.rows[0].cells[e].style.width=this.cellWidthPX[e]+"px")},this.setDelimiter=function(t){this.delim=t},this.setInitWidthsP=function(t){this.cellWidthType="%",this.initCellWidth=t.split(this.delim.replace(/px/gi,"")),arguments[1]||this._setAutoResize()},this._setAutoResize=function(){if(!this._realfake){var t=(window,this);dhtmlxEvent(window,"resize",function(){window.clearTimeout(t._resize_timer),t._setAutoResize&&(t._resize_timer=window.setTimeout(function(){t.setSizes&&t.setSizes(),t._fake&&t._fake._correctSplit()},100))})}},this.setInitWidths=function(t){if(this.cellWidthType="px",this.initCellWidth=t.split(this.delim),_isFF)for(var e=0;e<this.initCellWidth.length;e++)"*"!=this.initCellWidth[e]&&(this.initCellWidth[e]=parseInt(this.initCellWidth[e]))},this.enableMultiline=function(t){this.multiLine=dhx4.s2b(t)},this.enableMultiselect=function(t){this.selMultiRows=dhx4.s2b(t)},this.setImagePath=function(t){t=t.replace(/imgs\/dhxgrid_[a-z]*\/$/,"imgs/"),this._imgURL=t,this.imgURL=t+"dhxgrid_"+(this.skin_name||"dhx_skyblue").replace("dhx_","")+"/",this.iconTree=this.imgURL+"tree/"},this.setImagesPath=this.setImagePath,this.setIconPath=function(t){this.iconURL=t},this.setIconsPath=this.setIconPath,this.changeCursorState=function(t){var e=t.target||t.srcElement;if("TD"!=e.tagName&&(e=this.getFirstParentOfType(e,"TD")),e){if("TD"==e.tagName&&this._drsclmn&&!this._drsclmn[e._cellIndex])return e.style.cursor="default";var i=(t.layerX||0)+(_isIE||"DIV"!=t.target.tagName?0:e.offsetLeft);e.offsetWidth-(t.offsetX||(parseInt(this.getPosition(e,this.hdrBox))-i)*-1)<(_isOpera?20:10)?e.style.cursor="E-resize":e.style.cursor="default",_isOpera&&(this.hdrBox.scrollLeft=this.objBox.scrollLeft)}},this.startColResize=function(t){this.resized&&this.stopColResize(),this.resized=null;var e=t.target||t.srcElement;"TD"!=e.tagName&&(e=this.getFirstParentOfType(e,"TD"));var i=t.clientX,s=this.hdr.offsetWidth,l=parseInt(e.offsetWidth);if("TD"==e.tagName&&"default"!=e.style.cursor){if(this._drsclmn&&!this._drsclmn[e._cellIndex])return;self._old_d_mm=document.body.onmousemove,self._old_d_mu=document.body.onmouseup,document.body.onmousemove=function(t){self&&self.doColResize(t||window.event,e,l,i,s)},document.body.onmouseup=function(){self&&self.stopColResize()}}},this.stopColResize=function(){document.body.onmousemove=self._old_d_mm||"",document.body.onmouseup=self._old_d_mu||"",this.setSizes(),this.doOnScroll(0,1),this.callEvent("onResizeEnd",[this])},this.doColResize=function(t,e,i,s,l){e.style.cursor="E-resize",this.resized=e;var n=i+(t.clientX-s);l+(t.clientX-s);if(this.callEvent("onResize",[e._cellIndex,n,this])){_isIE&&(this.objBox.scrollLeft=this.hdrBox.scrollLeft);var o=!1;if(e.colSpan>1){for(var r=new Array,h=0;h<e.colSpan;h++)r[h]=Math.round(n*this.hdr.rows[0].childNodes[e._cellIndexS+h].offsetWidth/e.offsetWidth);for(var h=0;h<e.colSpan;h++)o=this._setColumnSizeR(e._cellIndexS+1*h,r[h])}else o=this._setColumnSizeR(e._cellIndex,n);return this.doOnScroll(0,1),this.setSizes(),this._fake&&this._awdth&&this._fake._correctSplit(),o}},this._setColumnSizeR=function(t,e){if(!(e>(this._drsclmW&&!this._notresize?this._drsclmW[t]||10:10)))return!1;if(this.obj.rows[0].childNodes[t].style.width=e+"px",this.hdr.rows[0].childNodes[t].style.width=e+"px",this.ftr&&(this.ftr.rows[0].childNodes[t].style.width=e+"px"),"px"==this.cellWidthType)this.cellWidthPX[t]=e;else{var i=parseInt(this.entBox.offsetWidth);this.objBox.scrollHeight>this.objBox.offsetHeight&&(i-=17);var s=Math.round(e/i*100);this.cellWidthPC[t]=s}"none"!=this.sortImg.style.display&&this.setSortImgPos()},this.setSortImgState=function(t,e,i,s){if(i=(i||"asc").toLowerCase(),!dhx4.s2b(t))return this.sortImg.style.display="none",void(this.fldSorted=this.r_fldSorted=null);"asc"==i?this.sortImg.className="dhxgrid_sort_asc":this.sortImg.className="dhxgrid_sort_desc",this.sortImg.style.display="",this.fldSorted=this.hdr.rows[0].childNodes[e];var l=this.hdr.rows[s||1];if(l){for(var n=0;n<l.childNodes.length;n++)if(l.childNodes[n]._cellIndexS==e)return this.r_fldSorted=l.childNodes[n],this.setSortImgPos();return this.setSortImgState(t,e,i,(s||1)+1)}},this.setSortImgPos=function(t,e,i,s){if(!this._hrrar||!this._hrrar[this.r_fldSorted?this.r_fldSorted._cellIndex:t]){if(!s)if(t)var s=this.hdr.rows[i||0].cells[t];else var s=this.r_fldSorted;if(null!=s){var l=this.getPosition(s,this.hdrBox),n=s.offsetWidth;this.sortImg.style.left=Number(l[0]+n-13)+"px",this.sortImg.defLeft=parseInt(this.sortImg.style.left),this.sortImg.style.top=Number(l[1]+5)+"px",this.useImagesInHeader||e||(this.sortImg.style.display="inline"),this.sortImg.style.left=this.sortImg.defLeft+"px"}}},this.setActive=function(t){if(0==arguments.length)var t=!0;1==t?(globalActiveDHTMLGridObject&&globalActiveDHTMLGridObject!=this&&(globalActiveDHTMLGridObject.editStop(),globalActiveDHTMLGridObject.callEvent("onBlur",[globalActiveDHTMLGridObject])),globalActiveDHTMLGridObject=this,this.isActive=!0):(this.isActive=!1,this.callEvent("onBlur",[this]))},this._doClick=function(t){var e=0,i=this.getFirstParentOfType(_isIE?t.srcElement:t.target,"TD");if(i&&i.parentNode&&i.parentNode.idd){var s=!0;if(this.markedCells){var l=0;return(t.shiftKey||t.metaKey)&&(l=1),t.ctrlKey&&(l=2),this.doMark(i,l),!0}return 0!=this.selMultiRows&&(t.shiftKey&&null!=this.row&&this.selectedRows.length&&(e=1),(t.ctrlKey||t.metaKey)&&(e=2)),this.doClick(i,s,e,!1)}},this._doContClick=function(t){var e=this.getFirstParentOfType(_isIE?t.srcElement:t.target,"TD");if(!e||"undefined"==typeof e.parentNode.idd)return this.callEvent("onEmptyClick",[t]),!0;if(2==t.button||_isMacOS&&t.ctrlKey){if(!this.callEvent("onRightClick",[e.parentNode.idd,e._cellIndex,t])){var i=function(t){return(t||event).cancelBubble=!0,!1};return(t.srcElement||t.target).oncontextmenu=i,i(t)}if(this._ctmndx){if(!this.callEvent("onBeforeContextMenu",[e.parentNode.idd,e._cellIndex,this]))return!0;if(_isIE&&(t.srcElement.oncontextmenu=function(){return event.cancelBubble=!0,!1}),this._ctmndx.showContextMenu){var s=window.document.documentElement,l=window.document.body,n=new Array(s.scrollLeft||l.scrollLeft,s.scrollTop||l.scrollTop);if(_isIE)var o=t.clientX+n[0],r=t.clientY+n[1];else var o=t.pageX,r=t.pageY;this._ctmndx.showContextMenu(o-1,r-1),this.contextID=this._ctmndx.contextMenuZoneId=e.parentNode.idd+"_"+e._cellIndex,this._ctmndx._skip_hide=!0}else e.contextMenuId=e.parentNode.idd+"_"+e._cellIndex,e.contextMenu=this._ctmndx,e.a=this._ctmndx._contextStart,e.a(e,t),e.a=null;return t.cancelBubble=!0,!1}}else this._ctmndx&&(this._ctmndx.hideContextMenu?this._ctmndx.hideContextMenu():this._ctmndx._contextEnd());return!0},this.doClick=function(t,e,i,s){this.selMultiRows||(i=0);var l=this.row?this.row.idd:0;if(this.setActive(!0),i||(i=0),null!=this.cell&&(this.cell.className=this.cell.className.replace(/cellselected/g,"")),"TD"==t.tagName){if(this.checkEvent("onSelectStateChanged"))var n=this.getSelectedId();var o=this.row;if(1==i){var r=this.rowsCol._dhx_find(t.parentNode),h=this.rowsCol._dhx_find(this.lastClicked);if(r>h)var a=h,d=r;else var a=r,d=h;for(var c=0;c<this.rowsCol.length;c++)if(c>=a&&c<=d){if(!this.rowsCol[c]||this.rowsCol[c]._sRow)return this.clearSelection(),this.doClick(t,e,0,s);if(!this.rowsCol[c].idd)continue;this.rowsCol[c].className.indexOf("rowselected")==-1&&this.callEvent("onBeforeSelect",[this.rowsCol[c].idd,l,t._cellIndex])&&(this.rowsCol[c].className+=" rowselected",this.selectedRows[this.selectedRows.length]=this.rowsCol[c])}}else if(2==i&&t.parentNode.className.indexOf("rowselected")!=-1){t.parentNode.className=t.parentNode.className.replace(/rowselected/g,""),this.selectedRows._dhx_removeAt(this.selectedRows._dhx_find(t.parentNode));var u=!0;s=!1}if(this.editStop(),"undefined"==typeof t.parentNode.idd)return!0;if(u||t.parentNode._sRow||(this.callEvent("onBeforeSelect",[t.parentNode.idd,l,t._cellIndex])?this.getSelectedRowId()!=t.parentNode.idd?(0==i&&this.clearSelection(),this.cell=t,o==t.parentNode&&this._chRRS&&(e=!1),this.row=t.parentNode,this.row.className+=" rowselected",this.selectedRows._dhx_find(this.row)==-1&&(this.selectedRows[this.selectedRows.length]=this.row)):(this.cell=t,this.row=t.parentNode):e=!1),this.cell&&this.cell.parentNode.className.indexOf("rowselected")!=-1&&(this.cell.className=this.cell.className.replace(/cellselected/g,"")+" cellselected"),1!=i&&!this.row)return;this.lastClicked=t.parentNode;var f=this.row.idd,_=this.cell;if(e&&"undefined"!=typeof f&&_&&!u?self.onRowSelectTime=setTimeout(function(){self.callEvent&&self.callEvent("onRowSelect",[f,_._cellIndex])},100):this.callEvent("onRowSelectRSOnly",[f]),this.checkEvent("onSelectStateChanged")){var p=this.getSelectedId();n!=p&&this.callEvent("onSelectStateChanged",[p,n])}if(u)return!1}this.isActive=!0,s!==!1&&this.cell&&this.cell.parentNode.idd&&this.moveToVisible(this.cell)},this.selectAll=function(){this.clearSelection();var t=this.rowsBuffer;this.pagingOn&&(t=this.rowsCol);for(var e=0;e<t.length;e++)this.render_row(e).className+=" rowselected";this.selectedRows=dhtmlxArray([].concat(t)),this.selectedRows.length&&(this.row=this.selectedRows[0],this.cell=this.row.cells[0]),this._fake&&!this._realfake&&this._fake.selectAll()},this.selectCell=function(t,e,i,s,l,n){if(i||(i=!1),"object"!=typeof t&&(t=this.render_row(t)),!t||t==-1)return null;if(t._childIndexes)var o=t.childNodes[t._childIndexes[e]];else var o=t.childNodes[e];o||(o=t.childNodes[0]),this.markedCells?this.doMark(o,s?2:0):s?this.doClick(o,i,3,n):this.doClick(o,i,0,n),l&&this.editCell()},this.moveToVisible=function(t,e){if(this.pagingOn){var i=Math.floor(this.getRowIndex(t.parentNode.idd)/this.rowsBufferOutSize)+1;i!=this.currentPage&&this.changePage(i)}try{if(t.offsetHeight){var s=t.offsetLeft+t.offsetWidth+20,l=0;s>this.objBox.offsetWidth+this.objBox.scrollLeft?t.offsetLeft>this.objBox.scrollLeft&&(l=t.offsetLeft-(this.objBox.offsetWidth-t.offsetWidth)+5):t.offsetLeft<this.objBox.scrollLeft&&(s-=2*t.offsetWidth/3,s<this.objBox.scrollLeft&&(l=t.offsetLeft-5)),l&&!e&&(this.objBox.scrollLeft=l)}if(t.offsetHeight)s=t.offsetTop;else{var n=this._realfake?this._fake.rowsAr[t.parentNode.idd]:t.parentNode;s=this.rowsBuffer._dhx_find(n)*this._srdh}var o=s+t.offsetHeight+38;if(o>this.objBox.offsetHeight+this.objBox.scrollTop)var r=s;else if(s<this.objBox.scrollTop)var r=s-5;r&&(this.objBox.scrollTop=r)}catch(t){}},this.editCell=function(){if(!this.editor||this.cell!=this.editor.cell){if(this.editStop(),1!=this.isEditable||!this.cell)return!1;var t=this.cell;if(t.parentNode._locked)return!1;if(this.editor=this.cells4(t),null!=this.editor){if(this.editor.isDisabled())return this.editor=null,!1;0!=this.callEvent("onEditCell",[0,this.row.idd,this.cell._cellIndex])&&this.editor.edit?(this._Opera_stop=(new Date).valueOf(),this.editor.edit(),t.className+=" editable",this.callEvent("onEditCell",[1,this.row.idd,this.cell._cellIndex])):this.editor=null}}},this.editStop=function(t){if(_isOpera&&this._Opera_stop){if(1*this._Opera_stop+50>(new Date).valueOf())return;this._Opera_stop=null}if(this.editor&&null!=this.editor){if(this.editor.cell.className=this.editor.cell.className.replace("editable",""),t){var e=this.editor.val;return this.editor.detach(),this.editor.setValue(e),this.editor=null,void this.callEvent("onEditCancel",[this.row.idd,this.cell._cellIndex,e])}this.editor.detach()&&(this.cell.wasChanged=!0);var i=this.editor;if(null==i)return;this.editor=null;var s=this.callEvent("onEditCell",[2,this.row.idd,this.cell._cellIndex,i.getValue(),i.val]);"string"==typeof s||"number"==typeof s?i[i.setImage?"setLabel":"setValue"](s):s||i[i.setImage?"setLabel":"setValue"](i.val),this._ahgr&&this.multiLine&&this.setSizes()}},this._nextRowCell=function(t,e,i){return t=this._nextRow((this._groups?this.rowsCol:this.rowsBuffer)._dhx_find(t),e),t?t.childNodes[t._childIndexes?t._childIndexes[i]:i]:null},this._getNextCell=function(t,e,i){t=t||this.cell;var s=t.parentNode;if(this._tabOrder)i=this._tabOrder[t._cellIndex],"undefined"!=typeof i&&(t=i<0?this._nextRowCell(s,e,Math.abs(i)-1):s.childNodes[i]);else{var i=t._cellIndex+e;i>=0&&i<this._cCount?(s._childIndexes&&(i=s._childIndexes[t._cellIndex]+e),t=s.childNodes[i]):t=this._nextRowCell(s,e,1==e?0:this._cCount-1)}return t?"none"==t.style.display||this.smartTabOrder&&this.cells(t.parentNode.idd,t._cellIndex).isDisabled()?this._getNextCell(t,e):t:(1==e&&this.tabEnd&&(this.tabEnd.focus(),this.tabEnd.focus(),this.setActive(!1)),e==-1&&this.tabStart&&(this.tabStart.focus(),this.tabStart.focus(),this.setActive(!1)),null)},this._nextRow=function(t,e){var i=this.render_row(t+e);return i&&i!=-1?i&&"none"==i.style.display?this._nextRow(t+e,e):i:null},this.scrollPage=function(t){if(this.rowsBuffer.length){var e=this._realfake?this._fake:this,i=Math.floor((e._r_select||this.getRowIndex(this.row.idd)||0)+t*this.objBox.offsetHeight/(this._srdh||20));i<0&&(i=0),i>=this.rowsBuffer.length&&(i=this.rowsBuffer.length-1),this._srnd&&!this.rowsBuffer[i]?(this.objBox.scrollTop+=Math.floor(t*this.objBox.offsetHeight/(this._srdh||20))*(this._srdh||20),this._fake&&(this._fake.objBox.scrollTop=this.objBox.scrollTop),e._r_select=i):(this.selectCell(i,this.cell._cellIndex,!0,!1,!1,this.multiLine||this._srnd),this.multiLine||this._srnd||this._realfake||(this.objBox.scrollTop=this.getRowById(this.getRowId(i)).offsetTop,this._fake&&(this._fake.objBox.scrollTop=this.objBox.scrollTop)),e._r_select=null)}},this.doKey=function(t){if(!t)return!0;if((t.target||t.srcElement).value!==window.undefined){var e=t.target||t.srcElement;if("dhxcombo_input"!=e.className&&(!e.parentNode||e.parentNode.className.indexOf("editable")==-1))return!0}if(globalActiveDHTMLGridObject&&this!=globalActiveDHTMLGridObject)return globalActiveDHTMLGridObject.doKey(t);if(0==this.isActive)return!0;if(this._htkebl)return!0;if(!this.callEvent("onKeyPress",[t.keyCode,t.ctrlKey,t.shiftKey,t]))return!1;var i="k"+t.keyCode+"_"+(t.ctrlKey?1:0)+"_"+(t.shiftKey?1:0);if(this.cell){if(this._key_events[i])return!1===this._key_events[i].call(this)||(t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,!1);this._key_events.k_other&&this._key_events.k_other.call(this,t)}return!0},this.selectRow=function(t,e,i,s){"object"!=typeof t&&(t=this.render_row(t)),this.selectCell(t,0,e,i,!1,s)},this.wasDblClicked=function(t){var e=this.getFirstParentOfType(_isIE?t.srcElement:t.target,"TD");if(e){var i=e.parentNode.idd;return this.callEvent("onRowDblClicked",[i,e._cellIndex,t])}},this._onHeaderClick=function(t,e){var i=this.grid;if(e=e||i.getFirstParentOfType(_isIE?event.srcElement:t.target,"TD"),null==this.grid.resized){if(!this.grid.callEvent("onHeaderClick",[e._cellIndexS,t||window.event]))return!1;i.sortField(e._cellIndexS,!1,e)}this.grid.resized=null},this.deleteSelectedRows=function(){var t=this.selectedRows.length;if(0!=t){var e=this.selectedRows;this.selectedRows=dhtmlxArray();for(var i=t-1;i>=0;i--){var s=e[i];if(this.deleteRow(s.idd,s)){if(s==this.row)var l=i}else this.selectedRows[this.selectedRows.length]=s}if(l)try{l+1>this.rowsCol.length&&l--,this.selectCell(l,0,!0)}catch(t){this.row=null,this.cell=null}}},this.getSelectedRowId=function(){for(var t=new Array(0),e={},i=0;i<this.selectedRows.length;i++){var s=this.selectedRows[i].idd;e[s]||(t[t.length]=s,e[s]=!0)}return 0==t.length?null:t.join(this.delim)},this.getSelectedCellIndex=function(){return null!=this.cell?this.cell._cellIndex:-1},this.getColWidth=function(t){return parseInt(this.cellWidthPX[t])},this.setColWidth=function(t,e){if("*"==e)this.initCellWidth[t]="*";else{if(this._hrrar[t])return;"px"==this.cellWidthType?this.cellWidthPX[t]=parseInt(e):this.cellWidthPC[t]=parseInt(e)}this.setSizes()},this.getRowIndex=function(t){for(var e=0;e<this.rowsBuffer.length;e++)if(this.rowsBuffer[e]&&this.rowsBuffer[e].idd==t)return e;return-1},this.getRowId=function(t){return this.rowsBuffer[t]?this.rowsBuffer[t].idd:this.undefined},this.setRowId=function(t,e){this.changeRowId(this.getRowId(t),e)},this.changeRowId=function(t,e){if(t!=e){var i=this.rowsAr[t];i.idd=e,this.UserData[t]&&(this.UserData[e]=this.UserData[t],this.UserData[t]=null),this._h2&&this._h2.get[t]&&(this._h2.get[e]=this._h2.get[t],this._h2.get[e].id=e,delete this._h2.get[t]),this.rowsAr[t]=null,this.rowsAr[e]=i;for(var s=0;s<i.childNodes.length;s++)i.childNodes[s]._code&&(i.childNodes[s]._code=this._compileSCL(i.childNodes[s]._val,i.childNodes[s]));if(this._mat_links&&this._mat_links[t]){var l=this._mat_links[t];delete this._mat_links[t];for(var n in l)for(var s=0;s<l[n].length;s++)this._compileSCL(l[n][s].original,l[n][s])}this.callEvent("onRowIdChange",[t,e])}},this.setColumnIds=function(t){this.columnIds=t.split(this.delim)},this.setColumnId=function(t,e){this.columnIds[t]=e},this.getColIndexById=function(t){for(var e=0;e<this.columnIds.length;e++)if(this.columnIds[e]==t)return e},this.getColumnId=function(t){return this.columnIds[t]},this.getColumnLabel=function(t,e,i){for(var s=(i||this.hdr).rows[(e||0)+1],l=0;l<s.cells.length;l++)if(s.cells[l]._cellIndexS==t)return _isIE?s.cells[l].innerText:s.cells[l].textContent;return""},this.getColLabel=this.getColumnLabel,this.getFooterLabel=function(t,e){return this.getColumnLabel(t,e,this.ftr)},this.setRowTextBold=function(t){var e=this.getRowById(t);e&&(e.style.fontWeight="bold")},this.setRowTextStyle=function(t,e){var i=this.getRowById(t);if(i)for(var s=0;s<i.childNodes.length;s++){var l=i.childNodes[s]._attrs.style||"";this._hrrar&&this._hrrar[s]&&(l="display:none;"),_isIE?i.childNodes[s].style.cssText=l+"width:"+i.childNodes[s].style.width+";"+e:i.childNodes[s].style.cssText=l+"width:"+i.childNodes[s].style.width+";"+e}},this.setRowColor=function(t,e){for(var i=this.getRowById(t),s=0;s<i.childNodes.length;s++)i.childNodes[s].bgColor=e},this.setCellTextStyle=function(t,e,i){var s=this.getRowById(t);if(s){var l=s.childNodes[s._childIndexes?s._childIndexes[e]:e];if(l){var n="";this._hrrar&&this._hrrar[e]&&(n="display:none;"),_isIE?l.style.cssText=n+"width:"+l.style.width+";"+i:l.style.cssText=n+"width:"+l.style.width+";"+i}}},this.setRowTextNormal=function(t){var e=this.getRowById(t);e&&(e.style.fontWeight="normal")},this.doesRowExist=function(t){return null!=this.getRowById(t)},this.getColumnsNum=function(){return this._cCount},this.moveRowUp=function(t){var e=this.getRowById(t);if(this.isTreeGrid())return this.moveRowUDTG(t,-1);var i=this.rowsCol._dhx_find(e);if(e.previousSibling&&0!=i){e.parentNode.insertBefore(e,e.previousSibling),this.rowsCol._dhx_swapItems(i,i-1),this.setSizes();var s=this.rowsBuffer._dhx_find(e);this.rowsBuffer._dhx_swapItems(s,s-1),this._cssEven&&this._fixAlterCss(i-1)}},this.moveRowDown=function(t){var e=this.getRowById(t);if(this.isTreeGrid())return this.moveRowUDTG(t,1);var i=this.rowsCol._dhx_find(e);if(e.nextSibling){this.rowsCol._dhx_swapItems(i,i+1),e.nextSibling.nextSibling?e.parentNode.insertBefore(e,e.nextSibling.nextSibling):e.parentNode.appendChild(e),this.setSizes();var s=this.rowsBuffer._dhx_find(e);this.rowsBuffer._dhx_swapItems(s,s+1),this._cssEven&&this._fixAlterCss(i)}},this.getCombo=function(t){return this.combos[t]||(this.combos[t]=new dhtmlXGridComboObject),this.combos[t]},this.setUserData=function(t,e,i){t||(t="gridglobaluserdata"),this.UserData[t]||(this.UserData[t]=new Hashtable),this.UserData[t].put(e,i)},this.getUserData=function(t,e){t||(t="gridglobaluserdata"),this.getRowById(t);var i=this.UserData[t];return i?i.get(e):""},this.setEditable=function(t){this.isEditable=dhx4.s2b(t)},this.selectRowById=function(t,e,i,s){s||(s=!1),this.selectCell(this.getRowById(t),0,s,e,!1,i)},this.clearSelection=function(){this.editStop();for(var t=0;t<this.selectedRows.length;t++){var e=this.rowsAr[this.selectedRows[t].idd];e&&(e.className=e.className.replace(/rowselected/g,""))}this.selectedRows=dhtmlxArray(),this.row=null,null!=this.cell&&(this.cell.className=this.cell.className.replace(/cellselected/g,""),this.cell=null),this.callEvent("onSelectionCleared",[])},this.copyRowContent=function(t,e){var i=this.getRowById(t);if(this.isTreeGrid())this._copyTreeGridRowContent(i,t,e);else for(var s=0;s<i.cells.length;s++)this.cells(e,s).setValue(this.cells(t,s).getValue());_isIE||(this.getRowById(t).cells[0].height=i.cells[0].offsetHeight)},this.setFooterLabel=function(t,e,i){return this.setColumnLabel(t,e,i,this.ftr)},this.setColumnLabel=function(t,e,i,s){var l=(s||this.hdr).rows[i||1],n=l._childIndexes?l._childIndexes[t]:t;if(l.cells[n]){if(this.useImagesInHeader){l.cells[n].style.textAlign="left",l.cells[n].innerHTML="<img src='"+e+"'>";var o=new Image;o.src=""+e.replace(/(\.[a-z]+)/,".des$1"),this.preloadImagesAr[this.preloadImagesAr.length]=o;var r=new Image;r.src=""+e.replace(/(\.[a-z]+)/,".asc$1"),this.preloadImagesAr[this.preloadImagesAr.length]=r}else{var h="<div class='hdrcell'>";if(e.indexOf("img:[")!=-1){var a=e.replace(/.*\[([^>]+)\].*/,"$1");e=e.substr(e.indexOf("]")+1,e.length),h+="<img width='18px' height='18px' align='absmiddle' src='"+a+"' hspace='2'>"}h+=e,h+="</div>",l.cells[n].innerHTML=h,this._hstyles[n]&&(l.cells[n].style.cssText=this._hstyles[t])}if((e||"").indexOf("#")!=-1){var d=e.match(/(^|{)#([^}]+)(}|$)/);if(d){var c="_in_header_"+d[2];this[c]&&this[c](this.forceDivInHeader?l.cells[n].firstChild:l.cells[n],n,e.split(d[0]))}}}},this.setColLabel=function(t,e,i,s){return this.setColumnLabel(t,e,(i||0)+1,s)},this.clearAll=function(t){if(this.obj.rows[0]){this._h2&&(this._h2=this._createHierarchy(),this._fake&&(this._realfake?this._h2=this._fake._h2:this._fake._h2=this._h2)),this.limit=this._limitC=0,this.editStop(!0),this._dLoadTimer&&window.clearTimeout(this._dLoadTimer),this._dload&&(this.objBox.scrollTop=0,this.limit=this._limitC||0,this._initDrF=!0);var e=this.rowsCol.length;e=this.obj.rows.length;for(var i=e-1;i>0;i--){var s=this.obj.rows[i];s.parentNode.removeChild(s)}if(t){this._master_row=null,this.obj.rows[0].parentNode.removeChild(this.obj.rows[0]);for(var i=this.hdr.rows.length-1;i>=0;i--){var s=this.hdr.rows[i];s.parentNode.removeChild(s)}this.ftr&&(this.ftr.parentNode.removeChild(this.ftr),this.ftr=null),this._aHead=this.ftr=this.cellWidth=this._aFoot=null,this.cellType=dhtmlxArray(),this._hrrar=[],this.columnIds=[],this.combos=[],this._strangeParams=[],this.defVal=[],this._ivizcol=null}this.row=null,this.cell=null,this.rowsCol=dhtmlxArray(),this.rowsAr={},this._RaSeCol=[],this.rowsBuffer=dhtmlxArray(),this.UserData=[],this.selectedRows=dhtmlxArray(),(this.pagingOn||this._srnd)&&(this.xmlFileUrl=""),this.pagingOn&&this.changePage(1),this._contextCallTimer&&window.clearTimeout(this._contextCallTimer),this._sst&&this.enableStableSorting(!0),this._fillers=this.undefined,this.setSortImgState(!1),this.setSizes(),this.callEvent("onClearAll",[])}},this.sortField=function(t,e,i){if(0==this.getRowsNum())return!1;var s=this.hdr.rows[0].cells[t];if(s&&"TH"==s.tagName&&this.fldSort.length-1>=s._cellIndex&&"na"!=this.fldSort[s._cellIndex]){var l=this.getSortingState(),n=l[0]==t&&"asc"==l[1]?"des":"asc";if(!this.callEvent("onBeforeSorting",[t,this.fldSort[t],n]))return;
if(this.sortImg.className="dhxgrid_sort_"+("asc"==n?"asc":"desc"),this.useImagesInHeader){var o=this.hdr.rows[1].cells[s._cellIndex].firstChild;if(null!=this.fldSorted){var r=this.hdr.rows[1].cells[this.fldSorted._cellIndex].firstChild;r.src=r.src.replace(/(\.asc\.)|(\.des\.)/,".")}o.src=o.src.replace(/(\.[a-z]+)$/,"."+n+"$1")}this.sortRows(s._cellIndex,this.fldSort[s._cellIndex],n),this.fldSorted=s,this.r_fldSorted=i;var h=this.hdr.rows[1],h=i.parentNode;h._childIndexes?h._childIndexes[s._cellIndex]:s._cellIndex;this.setSortImgPos(!1,!1,!1,i)}},this.setCustomSorting=function(func,col){this._customSorts||(this._customSorts=new Array),this._customSorts[col]="string"==typeof func?eval(func):func,this.fldSort[col]="cus"},this.enableHeaderImages=function(t){this.useImagesInHeader=t},this.setHeader=function(t,e,i){if("object"!=typeof t)var s=this._eSplit(t);else s=[].concat(t);for(var l=new Array(0),n=new dhtmlxArray(0),o=new Array(0),r=new Array(0),h=new Array(0),a=0;a<s.length;a++)l[l.length]=Math.round(100/s.length),n[n.length]="ed",o[o.length]="left",r[r.length]="middle",h[h.length]="na";this.splitSign=e||"#cspan",this.hdrLabels=s,this.cellWidth=l,this.initCellWidth.length||this.setInitWidthsP(l.join(this.delim),!0),this.cellType=n,this.cellAlign=o,this.cellVAlign=r,this.fldSort=h,this._hstyles=i||[]},this._eSplit=function(t){if(![].push)return t.split(this.delim);var e="r"+(new Date).valueOf(),i=this.delim.replace(/([\|\+\*\^])/g,"\\$1");return(t||"").replace(RegExp(i,"g"),e).replace(RegExp("\\\\"+e,"g"),this.delim).split(e)},this.getColType=function(t){return this.cellType[t]},this.getColTypeById=function(t){return this.cellType[this.getColIndexById(t)]},this.setColTypes=function(t){this.cellType=dhtmlxArray(t.split(this.delim)),this._strangeParams=new Array;for(var e=0;e<this.cellType.length;e++){if(this.cellType[e].indexOf("[")!=-1){var i=this.cellType[e].split(/[\[\]]+/g);this.cellType[e]=i[0],this.defVal[e]=i[1],0==i[1].indexOf("=")&&(this.cellType[e]="math",this._strangeParams[e]=i[0])}window["eXcell_"+this.cellType[e]]||dhx4.callEvent("onConfigurationError",["Incorrect cell type: "+this.cellType[e],this,this.cellType[e]])}},this.setColSorting=function(t){this.fldSort=t.split(this.delim);for(var e={str:1,int:1,date:1},i=0;i<this.fldSort.length;i++)e[this.fldSort[i]]||"function"!=typeof window[this.fldSort[i]]||(this._customSorts||(this._customSorts=new Array),this._customSorts[i]=window[this.fldSort[i]],this.fldSort[i]="cus")},this.setColAlign=function(t){this.cellAlign=t.split(this.delim);for(var e=0;e<this.cellAlign.length;e++)this.cellAlign[e]=this.cellAlign[e]._dhx_trim()},this.setColVAlign=function(t){this.cellVAlign=t.split(this.delim)},this.setNoHeader=function(t){this.noHeader=dhx4.s2b(t)},this.showRow=function(t){this.getRowById(t),this._h2&&this.openItem(this._h2.get[t].parent.id);for(var e=this.getRowById(t).childNodes[0];e&&"none"==e.style.display;)e=e.nextSibling;e&&this.moveToVisible(e,!0)},this.setStyle=function(t,e,i,s){this.ssModifier=[t,e,i,i,s];for(var l=["#"+this.entBox.id+" table.hdr td","#"+this.entBox.id+" table.obj td","#"+this.entBox.id+" table.obj tr.rowselected td.cellselected","#"+this.entBox.id+" table.obj td.cellselected","#"+this.entBox.id+" table.obj tr.rowselected td"],n=0;!_isIE;){try{document.styleSheets[n].cssRules.length}catch(t){n++;continue}break}for(var o=0;o<l.length;o++)this.ssModifier[o]&&(_isIE?document.styleSheets[0].addRule(l[o],this.ssModifier[o]):document.styleSheets[n].insertRule(l[o]+(" { "+this.ssModifier[o]+" }"),document.styleSheets[n].cssRules.length))},this.setColumnColor=function(t){this.columnColor=t.split(this.delim)},this.enableAlterCss=function(t,e,i,s){(t||e)&&this.attachEvent("onGridReconstructed",function(){this._fixAlterCss(),this._fake&&this._fake._fixAlterCss()}),this._cssSP=i,this._cssSU=s,this._cssEven=t,this._cssUnEven=e},this._fixAlterCss=function(t){if(this._h2&&(this._cssSP||this._cssSU))return this._fixAlterCssTGR(t);if(this._cssEven||this._cssUnEven){t=t||0;for(var e=t,i=t;i<this.rowsCol.length;i++)if(this.rowsCol[i]&&"none"!=this.rowsCol[i].style.display){if(this.rowsCol[i]._cntr){e=1;continue}this.rowsCol[i].className.indexOf("rowselected")!=-1?e%2==1?this.rowsCol[i].className=this._cssUnEven+" rowselected "+(this.rowsCol[i]._css||""):this.rowsCol[i].className=this._cssEven+" rowselected "+(this.rowsCol[i]._css||""):e%2==1?this.rowsCol[i].className=this._cssUnEven+" "+(this.rowsCol[i]._css||""):this.rowsCol[i].className=this._cssEven+" "+(this.rowsCol[i]._css||""),e++}}},this.clearChangedState=function(){for(var t=0;t<this.rowsCol.length;t++){var e=this.rowsCol[t];if(e&&e.childNodes)for(var i=e.childNodes.length,s=0;s<i;s++)e.childNodes[s].wasChanged=!1}},this.getChangedRows=function(t){var e=new Array;return this.forEachRow(function(i){var s=this.rowsAr[i];if("TR"==s.tagName){var l=s.childNodes.length;if(t&&s._added)e[e.length]=s.idd;else for(var n=0;n<l;n++)if(s.childNodes[n].wasChanged){e[e.length]=s.idd;break}}}),e.join(this.delim)},this._sUDa=!1,this._sAll=!1,this.setSerializationLevel=function(t,e,i,s,l,n){this._sUDa=t,this._sAll=e,this._sConfig=i,this._chAttr=s,this._onlChAttr=l,this._asCDATA=n},this.setSerializableColumns=function(t){if(!t)return void(this._srClmn=null);this._srClmn=(t||"").split(",");for(var e=0;e<this._srClmn.length;e++)this._srClmn[e]=dhx4.s2b(this._srClmn[e])},this._serialise=function(t,e,i){this.editStop();var s=[],l="</"+this.xml.s_row+">";if(this.isTreeGrid())this._h2.forEachChildF(0,function(t){var e=this._serializeRow(this.render_row_tree(-1,t.id));return s.push(e),!!e},this,function(){s.push(l)});else for(var n=0;n<this.rowsBuffer.length;n++)if(this.rowsBuffer[n]){if(this._chAttr&&this.rowsBuffer[n]._locator)continue;var o=this._serializeRow(this.render_row(n));s.push(o),o&&s.push(l)}return[s.join("")]},this._serializeRow=function(t,e){var i=[],s=this.xml.row_attrs,l=this.xml.cell_attrs;if(i.push("<"+this.xml.s_row),i.push(" id='"+t.idd+"'"),this._sAll&&this.selectedRows._dhx_find(t)!=-1&&i.push(" selected='1'"),this._h2&&"minus"==this._h2.get[t.idd].state&&i.push(" open='1'"),s.length)for(var e=0;e<s.length;e++)i.push(" "+s[e]+"='"+t._attrs[s[e]]+"'");if(i.push(">"),this._sUDa&&this.UserData[t.idd]){keysAr=this.UserData[t.idd].getKeys();for(var n=0;n<keysAr.length;n++)i.push("<userdata name='"+keysAr[n]+"'>"+(this._asCDATA?"<![CDATA[":"")+this.UserData[t.idd].get(keysAr[n])+(this._asCDATA?"]]>":"")+"</userdata>")}for(var o=!1,r=0;r<this._cCount;r++)if(!this._srClmn||this._srClmn[r]){var h=this.cells3(t,r);if(i.push("<cell"),l.length)for(var e=0;e<l.length;e++)i.push(" "+l[e]+"='"+h.cell._attrs[l[e]]+"'");if(zxVal=h[this._agetm](),this._asCDATA&&(zxVal="<![CDATA["+zxVal+"]]>"),this._ecspn&&h.cell.colSpan&&h.cell.colSpan>1&&i.push(' colspan="'+h.cell.colSpan+'" '),this._chAttr?h.wasChanged()&&(i.push(' changed="1"'),o=!0):this._onlChAttr&&h.wasChanged()&&(o=!0),this._sAll&&"tree"==this.cellType[r]?i.push((this._h2?" image='"+this._h2.get[t.idd].image+"'":"")+">"+zxVal+"</cell>"):i.push(">"+zxVal+"</cell>"),this._ecspn&&h.cell.colSpan)for(var a=0;a<h.cell.colSpan-1;a++)i.push("<cell/>"),r++}return!this._onlChAttr||o||t._added?i.join(""):""},this._serialiseConfig=function(){for(var t="<head>",e=0;e<this.hdr.rows[0].cells.length;e++)if(!this._srClmn||this._srClmn[e]){var i=this.fldSort[e];"cus"==i&&(i=this._customSorts[e].toString(),i=i.replace(/function[\ ]*/,"").replace(/\([^\f]*/,"")),t+="<column width='"+this.getColWidth(e)+"' align='"+this.cellAlign[e]+"' type='"+this.cellType[e]+"' sort='"+(i||"na")+"' color='"+(this.columnColor[e]||"")+"'"+(this.columnIds[e]?" id='"+this.columnIds[e]+"'":"")+">",t+=this._asCDATA?"<![CDATA["+this.getColumnLabel(e)+"]]>":this.getColumnLabel(e);var s=this.getCombo(e);if(s)for(var l=0;l<s.keys.length;l++)t+="<option value='"+s.keys[l]+"'>"+s.values[l]+"</option>";t+="</column>"}return t+="</head>"},this.serialize=function(){var t='<?xml version="1.0"?><rows>';if(this._mathSerialization?this._agetm="getMathValue":this._agetm="getValue",this._sUDa&&this.UserData.gridglobaluserdata)for(var e=this.UserData.gridglobaluserdata.getKeys(),i=0;i<e.length;i++)t+="<userdata name='"+e[i]+"'>"+this.UserData.gridglobaluserdata.get(e[i])+"</userdata>";return this._sConfig&&(t+=this._serialiseConfig()),t+=this._serialise(),t+="</rows>"},this.getPosition=function(t,e){if(!e){var i=dhx4.getOffset(t);return[i.left,i.top]}e=e||document.body;for(var s=t,l=0,n=0;s&&s!=e;)l+=s.offsetLeft-s.scrollLeft,n+=s.offsetTop-s.scrollTop,s=s.offsetParent;return e==document.body&&(_isIE?(n+=document.body.offsetTop||document.documentElement.offsetTop,l+=document.body.offsetLeft||document.documentElement.offsetLeft):_isFF||(l+=document.body.offsetLeft,n+=document.body.offsetTop)),[l,n]},this.getFirstParentOfType=function(t,e){for(;t&&t.tagName!=e&&"BODY"!=t.tagName;)t=t.parentNode;return t},this.objBox.onscroll=function(){this.grid._doOnScroll()},this.hdrBox.onscroll=function(){this._try_header_sync||(this._try_header_sync=!0,Math.abs(this.grid.objBox.scrollLeft-this.scrollLeft)>1&&(this.grid.objBox.scrollLeft=this.scrollLeft),this._try_header_sync=!1)},(!_isOpera||_OperaRv>8.5)&&(this.hdr.onmousemove=function(t){this.grid.changeCursorState(t||window.event)},this.hdr.onmousedown=function(t){return this.grid.startColResize(t||window.event)}),this.obj.onmousemove=this._drawTooltip,this.objBox.onclick=function(t){t=t||event,t.cancelBubble=!0,this.firstChild.grid.setActive(!0),window.dhx4.callEvent("_onGridClick",[t,this.firstChild.grid])},this.obj.onclick=function(t){this.grid._doClick(t||window.event)!==!1&&(this.grid._sclE?this.grid.editCell(t||window.event):this.grid.editStop()),t=t||event,t.cancelBubble=!0,window.dhx4.callEvent("_onGridClick",[t,this.grid])},_isMacOS?this.entBox.oncontextmenu=function(t){t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1;var e=this.grid;return e._realfake&&(e=e._fake),e._doContClick(t||window.event)}:(this.entBox.onmousedown=function(t){return this.grid._doContClick(t||window.event)},this.entBox.oncontextmenu=function(t){return this.grid._ctmndx&&((t||event).cancelBubble=!0),!this.grid._ctmndx}),this.obj.ondblclick=function(t){if(!this.grid.wasDblClicked(t||window.event))return!1;if(this.grid._dclE){var e=this.grid.getFirstParentOfType(_isIE?event.srcElement:t.target,"TR");e==this.grid.row&&this.grid.editCell(t||window.event)}return(t||event).cancelBubble=!0,!_isOpera&&void 0},this.hdr.onclick=this._onHeaderClick,this.sortImg.onclick=function(){self._onHeaderClick.apply({grid:self},[null,self.r_fldSorted])},this.hdr.ondblclick=this._onHeaderDblClick,document.body._dhtmlxgrid_onkeydown||(dhtmlxEvent(document,"keydown",function(t){if(globalActiveDHTMLGridObject)return globalActiveDHTMLGridObject.doKey(t||window.event)}),document.body._dhtmlxgrid_onkeydown=!0),dhtmlxEvent(document.body,"click",function(){self.editStop&&self.editStop(),self.isActive&&self.setActive(!1)}),this.entBox.style.height.toString().indexOf("%")!=-1&&(this._delta_y=this.entBox.style.height),this.entBox.style.width.toString().indexOf("%")!=-1&&(this._delta_x=this.entBox.style.width),(this._delta_x||this._delta_y)&&this._setAutoResize(),this.setColHidden=this.setColumnsVisibility,this.enableCollSpan=this.enableColSpan,this.setMultiselect=this.enableMultiselect,this.setMultiLine=this.enableMultiline,this.deleteSelectedItem=this.deleteSelectedRows,this.getSelectedId=this.getSelectedRowId,this.getHeaderCol=this.getColumnLabel,this.isItemExists=this.doesRowExist,this.getColumnCount=this.getColumnsNum,this.setSelectedRow=this.selectRowById,this.setHeaderCol=this.setColumnLabel,this.preventIECashing=this.preventIECaching,this.enableAutoHeigth=this.enableAutoHeight,this.getUID=this.uid,dhtmlx.image_path&&this.setImagePath(dhtmlx.image_path),dhtmlx.skin&&this.setSkin(dhtmlx.skin),this}function dhtmlXGridCellObject(t){this.destructor=function(){return this.cell.obj=null,this.cell=null,this.grid=null,this.base=null,null},this.cell=t,this.getValue=function(){return this.cell.textContent&&"TEXTAREA"==this.cell.textContent.tagName?this.cell.textContent.value:this.cell.innerHTML._dhx_trim()},this.getMathValue=function(){return this.cell.original?this.cell.original:this.getValue()},this.getFont=function(){return arOut=new Array(3),this.cell.style.fontFamily&&(arOut[0]=this.cell.style.fontFamily),"bold"!=this.cell.style.fontWeight&&"bold"!=this.cell.parentNode.style.fontWeight||(arOut[1]="bold"),"italic"!=this.cell.style.fontStyle&&"italic"!=this.cell.parentNode.style.fontWeight||(arOut[1]+="italic"),this.cell.style.fontSize?arOut[2]=this.cell.style.fontSize:arOut[2]="",arOut.join("-")},this.getTextColor=function(){return this.cell.style.color?this.cell.style.color:"#000000"},this.getBgColor=function(){return this.cell.style.backgroundColor||"#FFFFFF"},this.getHorAlign=function(){return this.cell.style.textAlign?this.cell.style.textAlign:this.cell.style.textAlign?this.cell.style.textAlign:"left"},this.getWidth=function(){return this.cell.scrollWidth},this.setFont=function(t){fntAr=t.split("-"),this.cell.style.fontFamily=fntAr[0],this.cell.style.fontSize=fntAr[fntAr.length-1],3==fntAr.length&&(/bold/.test(fntAr[1])&&(this.cell.style.fontWeight="bold"),/italic/.test(fntAr[1])&&(this.cell.style.fontStyle="italic"),/underline/.test(fntAr[1])&&(this.cell.style.textDecoration="underline"))},this.setTextColor=function(t){this.cell.style.color=t},this.setBgColor=function(t){""==t&&(t=null),this.cell.style.background=t},this.setHorAlign=function(t){1==t.length?"c"==t?this.cell.style.textAlign="center":"l"==t?this.cell.style.textAlign="left":this.cell.style.textAlign="right":this.cell.style.textAlign=t},this.wasChanged=function(){return!!this.cell.wasChanged},this.isCheckbox=function(){var t=this.cell.firstChild;return!(!t||"INPUT"!=t.tagName)&&(type=t.type,"radio"==type||"checkbox"==type)},this.isChecked=function(){if(this.isCheckbox())return this.cell.firstChild.checked},this.isDisabled=function(){return this.cell._disabled},this.setChecked=function(t){this.isCheckbox()&&("true"!=t&&1!=t&&(t=!1),this.cell.firstChild.checked=t)},this.setDisabled=function(t){"true"!=t&&1!=t&&(t=!1),this.isCheckbox()&&(this.cell.firstChild.disabled=t,this.disabledF&&this.disabledF(t)),this.cell._disabled=t}}function eXcell(){this.obj=null,this.val=null,this.changeState=function(){return!1},this.edit=function(){this.val=this.getValue()},this.detach=function(){return!1},this.getPosition=function(t){for(var e=t,i=0,s=0;"BODY"!=e.tagName;)i+=e.offsetLeft,s+=e.offsetTop,e=e.offsetParent;return new Array(i,s)}}function eXcell_ed(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.edit=function(){this.cell.atag=this.grid.multiLine?"TEXTAREA":"INPUT",this.val=this.getValue(),this.obj=document.createElement(this.cell.atag),this.obj.setAttribute("autocomplete","off"),this.obj.style.height=this.cell.offsetHeight-(_isIE,4)+"px",this.obj.className="dhx_combo_edit",this.obj.wrap="soft",this.obj.style.textAlign=this.cell.style.textAlign,this.obj.onclick=function(t){(t||event).cancelBubble=!0},this.obj.onmousedown=function(t){(t||event).cancelBubble=!0},this.obj.value=this.val,this.cell.innerHTML="",this.cell.appendChild(this.obj),this.obj.onselectstart=function(t){return t||(t=event),t.cancelBubble=!0,!0},_isIE&&(this.obj.focus(),this.obj.blur()),this.obj.focus()},this.getValue=function(){return this.cell.firstChild&&this.cell.atag&&this.cell.firstChild.tagName==this.cell.atag?this.cell.firstChild.value:this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()},this.detach=function(){return this.setValue(this.obj.value),this.val!=this.getValue()}}function eXcell_edtxt(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.getValue=function(){return this.cell.firstChild&&this.cell.atag&&this.cell.firstChild.tagName==this.cell.atag?this.cell.firstChild.value:this.cell._clearCell?"":_isIE?this.cell.innerText:this.cell.textContent},this.setValue=function(t){t&&""!=t.toString()._dhx_trim()?this.cell._clearCell=!1:(t=" ",this.cell._clearCell=!0),this.setCTxtValue(t)}}function eXcell_edn(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.getValue=function(){return this.cell.firstChild&&"TEXTAREA"==this.cell.firstChild.tagName?this.cell.firstChild.value:this.cell._clearCell?"":this.cell._orig_value||this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)},this.detach=function(){var t=this.obj.value;return this.setValue(t),this.val!=this.getValue()}}function eXcell_ch(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.disabledF=function(t){1==t||1==t?this.cell.innerHTML=this.cell.innerHTML.replace("item_chk0.","item_chk0_dis.").replace("item_chk1.","item_chk1_dis."):this.cell.innerHTML=this.cell.innerHTML.replace("item_chk0_dis.","item_chk0.").replace("item_chk1_dis.","item_chk1.")},this.changeState=function(t){t!==!0||this.grid.isActive||(null!=window.globalActiveDHTMLGridObject&&window.globalActiveDHTMLGridObject!=this.grid&&window.globalActiveDHTMLGridObject.isActive&&window.globalActiveDHTMLGridObject.setActive(!1),this.grid.setActive(!0)),!this.grid.isEditable||this.cell.parentNode._locked||this.isDisabled()||(this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])?(this.val=this.getValue(),"1"==this.val?this.setValue("0"):this.setValue("1"),this.cell.wasChanged=!0,this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]),this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,"1"!=this.val]),this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,"1"!=this.val])):this.editor=null)},this.getValue=function(){return this.cell.chstate?this.cell.chstate.toString():"0"},this.isCheckbox=function(){return!0},this.isChecked=function(){return"1"==this.getValue()},this.setChecked=function(t){this.setValue(t.toString())},this.detach=function(){return this.val!=this.getValue()},this.edit=null}function eXcell_ra(t){this.base=eXcell_ch,this.base(t),this.grid=t.parentNode.grid,this.disabledF=function(t){1==t||1==t?this.cell.innerHTML=this.cell.innerHTML.replace("radio_chk0.","radio_chk0_dis.").replace("radio_chk1.","radio_chk1_dis."):this.cell.innerHTML=this.cell.innerHTML.replace("radio_chk0_dis.","radio_chk0.").replace("radio_chk1_dis.","radio_chk1.")},this.changeState=function(t){t===!1&&1==this.getValue()||!this.grid.isEditable||this.cell.parentNode._locked||this.isDisabled()||(0!=this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])?(this.val=this.getValue(),"1"==this.val?this.setValue("0"):this.setValue("1"),this.cell.wasChanged=!0,this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]),this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,"1"!=this.val]),this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,"1"!=this.val])):this.editor=null)},this.edit=null}function eXcell_txt(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.edit=function(){this.val=this.getValue(),this.obj=document.createElement("TEXTAREA"),this.obj.className="dhx_textarea",this.obj.onclick=function(t){(t||event).cancelBubble=!0};var t=this.grid.getPosition(this.cell);if(this.obj.value=this.val,this.obj.style.display="",this.obj.style.textAlign=this.cell.style.textAlign,document.body.appendChild(this.obj),_isOpera&&(this.obj.onkeypress=function(t){if(9==t.keyCode||27==t.keyCode)return!1}),this.obj.onkeydown=function(t){var e=t||event;if(9==e.keyCode||27==e.keyCode)return globalActiveDHTMLGridObject.entBox.focus(),globalActiveDHTMLGridObject.doKey({keyCode:e.keyCode,shiftKey:e.shiftKey,srcElement:"0"}),!1},this.obj.style.left=t[0]+"px",this.obj.style.top=t[1]+this.cell.offsetHeight+"px",this.cell.offsetWidth<200)var e=200;else var e=this.cell.offsetWidth;this.obj.style.width=e+16+"px",_isIE&&(this.obj.select(),this.obj.value=this.obj.value),this.obj.focus()},this.detach=function(){var t="";return t=this.obj.value,""==t?this.cell._clearCell=!0:this.cell._clearCell=!1,this.setValue(t),document.body.removeChild(this.obj),this.obj=null,this.val!=this.getValue()},this.getValue=function(){return this.obj?this.obj.value:this.cell._clearCell?"":"undefined"!=typeof this.cell._brval?this.cell._brval:this.grid.multiLine?this.cell._brval||this.cell.innerHTML.replace(/<br[^>]*>/gi,"\n")._dhx_trim():this.cell._brval||this.cell.innerHTML}}function eXcell_txttxt(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.getValue=function(){return this.cell.firstChild&&"TEXTAREA"==this.cell.firstChild.tagName?this.cell.firstChild.value:this.cell._clearCell?"":!this.grid.multiLine&&this.cell._brval?this.cell._brval:_isIE?this.cell.innerText:this.cell.textContent},this.setValue=function(t){this.cell._brval=t,t&&""!=t.toString()._dhx_trim()?this.cell._clearCell=!1:(t=" ",this.cell._clearCell=!0),this.setCTxtValue(t)}}function eXcell_co(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid,this.combo=this.cell._combo||this.grid.getCombo(this.cell._cellIndex),this.editable=!0),this.shiftNext=function(){var t=this.list.options[this.list.selectedIndex+1];return t&&(t.selected=!0),this.obj.value=this.list.options[this.list.selectedIndex].text,!0},this.shiftPrev=function(){if(0!=this.list.selectedIndex){var t=this.list.options[this.list.selectedIndex-1];t&&(t.selected=!0),this.obj.value=this.list.options[this.list.selectedIndex].text}return!0},this.edit=function(){this.val=this.getValue(),this.text=this.getText()._dhx_trim();var t=this.grid.getPosition(this.cell);this.obj=document.createElement("TEXTAREA"),this.obj.className="dhx_combo_edit",this.obj.style.height=this.cell.offsetHeight-(_isIE,4)+"px",this.obj.wrap="soft",this.obj.style.textAlign=this.cell.style.textAlign,this.obj.onclick=function(t){(t||event).cancelBubble=!0},this.obj.onmousedown=function(t){(t||event).cancelBubble=!0},this.obj.value=this.text,this.obj.onselectstart=function(t){return t||(t=event),t.cancelBubble=!0,!0};var e=this;this.obj.onkeyup=function(t){var i=(t||event).keyCode;if(38!=i&&40!=i&&9!=i)for(var s=this.readonly?String.fromCharCode(i):this.value,l=e.list.options,n=0;n<l.length;n++)if(0==l[n].text.indexOf(s))return l[n].selected=!0},this.list=document.createElement("SELECT"),this.list.className="dhx_combo_select",this.list.style.width=this.cell.offsetWidth+"px",this.list.style.left=t[0]+"px",this.list.style.top=t[1]+this.cell.offsetHeight+"px",this.list.onclick=function(t){var i=t||window.event,s=i.target||i.srcElement;"OPTION"==s.tagName&&(s=s.parentNode),e.editable=!1,e.grid.editStop(),i.cancelBubble=!0};for(var i=this.combo.getKeys(),s=!1,l=0,n=0;n<i.length;n++){var o=this.combo.get(i[n]);this.list.options[this.list.options.length]=new Option(o,i[n]),i[n]==this.val&&(l=this.list.options.length-1,s=!0)}0==s&&(this.list.options[this.list.options.length]=new Option(this.text,null===this.val?"":this.val),l=this.list.options.length-1),document.body.appendChild(this.list),this.list.size="6",this.cstate=1,this.editable?this.cell.innerHTML="":(this.obj.style.width="1px",this.obj.style.height="1px"),this.cell.appendChild(this.obj),this.list.options[l].selected=!0,this.editable&&(this.obj.focus(),this.obj.focus()),this.editable||(this.obj.style.visibility="hidden",this.list.focus(),this.list.onkeydown=function(t){if(t=t||window.event,e.grid.setActive(!0),t.keyCode<30)return e.grid.doKey({target:e.cell,keyCode:t.keyCode,shiftKey:t.shiftKey,ctrlKey:t.ctrlKey})})},this.getValue=function(){return this.cell.combo_value==window.undefined?"":this.cell.combo_value},this.detach=function(){if(this.val!=this.getValue()&&(this.cell.wasChanged=!0),null!=this.list.parentNode)if(this.editable){var t=this.list.options[this.list.selectedIndex];if(t&&t.text==this.obj.value)this.setValue(this.list.value);else{var e=this.cell._combo||this.grid.getCombo(this.cell._cellIndex),i=e.values._dhx_find(this.obj.value);i!=-1?this.setValue(e.keys[i]):this.setValue(this.cell.combo_value=this.obj.value)}}else this.setValue(this.list.value);return this.list.parentNode&&this.list.parentNode.removeChild(this.list),this.obj.parentNode&&this.obj.parentNode.removeChild(this.obj),this.val!=this.getValue()}}function eXcell_coro(t){this.base=eXcell_co,this.base(t),this.editable=!1}function eXcell_cotxt(t){this.base=eXcell_co,this.base(t)}function eXcell_corotxt(t){this.base=eXcell_co,this.base(t),this.editable=!1}function eXcell_cp(t){try{this.cell=t,this.grid=this.cell.parentNode.grid}catch(t){}this.edit=function(){this.val=this.getValue(),this.obj=document.createElement("SPAN"),this.obj.style.border="1px solid black",this.obj.style.position="absolute";var t=this.grid.getPosition(this.cell);this.colorPanel(4,this.obj),document.body.appendChild(this.obj),this.obj.style.left=t[0]+"px",this.obj.style.zIndex=1e3,this.obj.style.top=t[1]+this.cell.offsetHeight+"px"},this.toolDNum=function(t){return 1==t.length&&(t="0"+t),t},this.colorPanel=function(t,e){var i=document.createElement("TABLE");e.appendChild(i),i.cellSpacing=0,i.editor_obj=this,i.style.cursor="default",i.onclick=function(t){var e=t||window.event,i=e.target||e.srcElement,s=i.parentNode.parentNode.parentNode.editor_obj;s&&(s.setValue(i._bg),s.grid.editStop())};for(var s=256/t,l=0;l<=256/s;l++)for(var n=i.insertRow(l),o=0;o<=256/s;o++)for(var r=0;r<=256/s;r++){R=new Number(s*l)-(0==l?0:1),G=new Number(s*o)-(0==o?0:1),B=new Number(s*r)-(0==r?0:1);var h=this.toolDNum(R.toString(16))+""+this.toolDNum(G.toString(16))+this.toolDNum(B.toString(16)),a=n.insertCell(o);a.width="10px",a.innerHTML="&nbsp;",a.title=h.toUpperCase(),a.style.backgroundColor="#"+h,a._bg="#"+h,null!=this.val&&"#"+h.toUpperCase()==this.val.toUpperCase()&&(a.style.border="2px solid white")}},this.getValue=function(){return this.cell.firstChild._bg||""},this.getRed=function(){return Number(parseInt(this.getValue().substr(1,2),16))},this.getGreen=function(){return Number(parseInt(this.getValue().substr(3,2),16))},this.getBlue=function(){return Number(parseInt(this.getValue().substr(5,2),16))},this.detach=function(){return null!=this.obj.offsetParent&&document.body.removeChild(this.obj),this.val!=this.getValue()}}function eXcell_img(t){try{this.cell=t,this.grid=this.cell.parentNode.grid}catch(t){}this.getValue=function(){if("IMG"==this.cell.firstChild.tagName)return this.cell.firstChild.src+(null!=this.cell.titFl?"^"+this.cell._brval:"");if("A"==this.cell.firstChild.tagName){var t=this.cell.firstChild.firstChild.src+(null!=this.cell.titFl?"^"+this.cell._brval:"");return t+="^"+this.cell.lnk,this.cell.trg&&(t+="^"+this.cell.trg),t}},this.isDisabled=function(){return!0}}function eXcell_price(t){this.base=eXcell_ed,this.base(t),this.getValue=function(){return this.cell.childNodes.length>1?this.cell.childNodes[1].innerHTML.toString()._dhx_trim():"0"}}function eXcell_dyn(t){this.base=eXcell_ed,this.base(t),this.getValue=function(){return this.cell.firstChild.childNodes[1].innerHTML.toString()._dhx_trim()}}function eXcell_ro(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.edit=function(){},this.isDisabled=function(){return!0},this.getValue=function(){return this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()}}function eXcell_ron(t){this.cell=t,this.grid=this.cell.parentNode.grid,this.edit=function(){},this.isDisabled=function(){return!0},this.getValue=function(){return this.cell._clearCell?"":this.cell._orig_value||this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex).toString()}}function eXcell_rotxt(t){this.cell=t,this.grid=this.cell.parentNode.grid,this.edit=function(){},this.isDisabled=function(){return!0},this.setValue=function(t){t?this.cell._clearCell=!1:(t=" ",this.cell._clearCell=!0),this.setCTxtValue(t)},this.getValue=function(){return this.cell._clearCell?"":_isIE?this.cell.innerText:this.cell.textContent}}function dhtmlXGridComboObject(){return this.keys=new dhtmlxArray,this.values=new dhtmlxArray,this.put=function(t,e){for(var i=0;i<this.keys.length;i++)if(this.keys[i]==t)return this.values[i]=e,!0;this.values[this.values.length]=e,this.keys[this.keys.length]=t},this.get=function(t){for(var e=0;e<this.keys.length;e++)if(this.keys[e]==t)return this.values[e];return null},this.clear=function(){this.keys=new dhtmlxArray,this.values=new dhtmlxArray},this.remove=function(t){for(var e=0;e<this.keys.length;e++)if(this.keys[e]==t)return this.keys._dhx_removeAt(e),this.values._dhx_removeAt(e),!0},this.size=function(){for(var t=0,e=0;e<this.keys.length;e++)null!=this.keys[e]&&t++;return t},this.getKeys=function(){for(var t=new Array(0),e=0;e<this.keys.length;e++)null!=this.keys[e]&&(t[t.length]=this.keys[e]);return t},this.save=function(){this._save=new Array;for(var t=0;t<this.keys.length;t++)this._save[t]=[this.keys[t],this.values[t]]},this.restore=function(){if(this._save){this.keys[t]=new Array,this.values[t]=new Array;for(var t=0;t<this._save.length;t++)this.keys[t]=this._save[t][0],this.values[t]=this._save[t][1]}},this}function Hashtable(){return this.keys=new dhtmlxArray,this.values=new dhtmlxArray,this}function dragContext(t,e,i,s,l,n,o,r,h,a){return this.source=t||"grid",this.target=e||"grid",this.mode=i||"move",this.dropmode=s||"child",this.sid=l||0,this.tid=n,this.sobj=o||null,this.tobj=r||null,this.sExtra=h||null,this.tExtra=a||null,this}function eXcell_stree(t){if(t){if(this.cell=t,this.grid=this.cell.parentNode.grid,!this.grid._sub_trees)return;if(this._sub=this.grid._sub_trees[t._cellIndex],!this._sub)return;this._sub=this._sub[0]}this.getValue=function(){return this.cell._val},this.setValue=function(t){this.cell._val=t,t=this._sub.getItemText(this.cell._val),this.setCValue(t||"&nbsp;",t)},this.edit=function(){this._sub.parentObject.style.display="block";var t=this.grid.getPosition(this.cell);this._sub.parentObject.style.top=t[1]+"px",this._sub.parentObject.style.left=t[0]+"px",this._sub.parentObject.style.position="absolute";var e=this.grid.editStop;this.grid.editStop=function(){},this.grid.editStop=e},this.detach=function(){if(this._sub.parentObject.style.display="none",null!=this.grid._sub_id){var t=this.cell._val;return this.setValue(this._sub.getSelectedItemId()),this.grid._sub_id=null,this.cell._val!=t}}}function eXcell_link(t){this.cell=t,this.grid=this.cell.parentNode.grid,this.isDisabled=function(){return!0},this.edit=function(){},this.getValue=function(){if(this.cell.firstChild.getAttribute){var t=this.cell.firstChild.getAttribute("target");return this.cell.firstChild.innerHTML+"^"+this.cell.firstChild.getAttribute("href")+(t?"^"+t:"")}return""},this.setValue=function(t){if("number"!=typeof t&&(!t||""==t.toString()._dhx_trim()))return this.setCValue("&nbsp;",e),this.cell._clearCell=!0;var e=t.split("^");1==e.length?e[1]="":e.length>1&&(e[1]="href='"+e[1]+"'",3==e.length?e[1]+=" target='"+e[2]+"'":e[1]+=" target='_blank'"),this.setCValue("<a "+e[1]+" onclick='(_isIE?event:arguments[0]).cancelBubble = true;'>"+e[0]+"</a>",e)}}function eXcell_grid(t){if(t){if(this.cell=t,this.grid=this.cell.parentNode.grid,!this.grid._sub_grids)return;if(this._sub=this.grid._sub_grids[t._cellIndex],!this._sub)return;this._sindex=this._sub[1],this._sub=this._sub[0]}this.getValue=function(){return this.cell.val},this.setValue=function(t){this.cell.val=t,this._sub.getRowById(t)&&(t=this._sub.cells(t,this._sindex),t=t?t.getValue():""),this.setCValue(t||"&nbsp;",t)},this.edit=function(){this.val=this.cell.val,this._sub.entBox.style.display="block";var t=this.grid.getPosition(this.cell);this._sub.entBox.style.top=t[1]+"px",this._sub.entBox.style.left=t[0]+"px",this._sub.entBox.style.position="absolute",this._sub.setSizes();var e=this.grid.editStop;this.grid.editStop=function(){},this._sub.getRowById(this.cell.val)&&this._sub.setSelectedRow(this.cell.val),this._sub.setActive(!0),this.grid.editStop=e},this.detach=function(){var t=this.cell.val;return this._sub.entBox.style.display="none",null!==this._sub.getSelectedId()&&(this.setValue(this._sub.getSelectedId()),this.grid.setActive(!0),
this.cell.val!=t)}}function eXcell_dhxCalendar(t){if(t&&(this.cell=t,this.grid=this.cell.parentNode.grid,!this.grid._grid_calendarA)){var e=this.grid._grid_calendarA=new dhtmlxCalendarObject;this.grid.callEvent("onDhxCalendarCreated",[e]);var i=this.grid;e.attachEvent("onClick",function(){return this._last_operation_calendar=!0,window.setTimeout(function(){i.editStop()},1),!0});var s=function(t){(t||event).cancelBubble=!0};dhtmlxEvent(e.base,"click",s),e=null}}function eXcell_dhxCalendarA(t){if(t&&(this.cell=t,this.grid=this.cell.parentNode.grid,!this.grid._grid_calendarA)){var e=this.grid._grid_calendarA=new dhtmlxCalendarObject;this.grid.callEvent("onDhxCalendarCreated",[e]);var i=this.grid;e.attachEvent("onClick",function(){return this._last_operation_calendar=!0,window.setTimeout(function(){i.editStop()},1),!0});var s=function(t){(t||event).cancelBubble=!0};dhtmlxEvent(e.base,"click",s)}}function eXcell_cntr(t){if(this.cell=t,this.grid=this.cell.parentNode.grid,!this.grid._ex_cntr_ready&&!this._realfake){this.grid._ex_cntr_ready=!0,this.grid._h2&&this.grid.attachEvent("onOpenEn",function(e){this.resetCounter(t._cellIndex)});var e=function(){var e=this;return window.setTimeout(function(){e.resetCounter&&(e._fake&&!e._realfake&&t._cellIndex<e._fake._cCount?e._fake.resetCounter(t._cellIndex):e.resetCounter(t._cellIndex))},1),!0};this.grid.attachEvent("onBeforeSorting",e),this.grid.attachEvent("onFilterEnd",e)}this.edit=function(){},this.getValue=function(){return this.cell.innerHTML},this.setValue=function(t){this.cell.style.paddingRight="2px";var e=this.cell;window.setTimeout(function(){if(e.parentNode){var t=e.parentNode.rowIndex;(e.parentNode.grid.currentPage||t<0||e.parentNode.grid._srnd)&&(t=e.parentNode.grid.rowsBuffer._dhx_find(e.parentNode)+1),t<=0||(e.innerHTML=t,e.parentNode.grid._fake&&e._cellIndex<e.parentNode.grid._fake._cCount&&e.parentNode.grid._fake.rowsAr[e.parentNode.idd]&&e.parentNode.grid._fake.cells(e.parentNode.idd,e._cellIndex).setCValue(t),e=null)}},100)}}function eXcell_acheck(t){try{this.cell=t,this.grid=this.cell.parentNode.grid,this.cell.obj=this}catch(t){}this.changeState=function(){!this.grid.isEditable||this.cell.parentNode._locked||this.isDisabled()||(0!=this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])?(this.val=this.getValue(),"1"==this.val?this.setValue("<checkbox state='false'>"):this.setValue("<checkbox state='true'>"),this.cell.wasChanged=!0,this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]),this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,"1"!=this.val]),this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,"1"!=this.val])):this.editor=null)},this.getValue=function(){try{return this.cell.chstate.toString()}catch(t){return null}},this.isCheckbox=function(){return!0},this.isChecked=function(){return"1"==this.getValue()},this.setChecked=function(t){this.setValue(t.toString())},this.detach=function(){return this.val!=this.getValue()},this.drawCurrentState=function(){return 1==this.cell.chstate?"<div  onclick='(new eXcell_acheck(this.parentNode)).changeState(); (arguments[0]||event).cancelBubble=true;'  style='cursor:pointer; font-weight:bold; text-align:center; '><span style='height:8px; width:8px; background:green; display:inline-block;'></span>&nbsp;Yes</div>":"<div  onclick='(new eXcell_acheck(this.parentNode)).changeState(); (arguments[0]||event).cancelBubble=true;' style='cursor:pointer;  text-align:center; '><span style='height:8px; width:8px; background:red; display:inline-block;'></span>&nbsp;No</div>"}}function eXcell_context(t){if(t){if(this.cell=t,this.grid=this.cell.parentNode.grid,!this.grid._sub_context)return;if(this._sub=this.grid._sub_context[t._cellIndex],!this._sub)return;this._sindex=this._sub[1],this._sub=this._sub[0]}this.getValue=function(){return _isIE?this.cell.innerText:this.cell.textContent},this.setValue=function(t){this.cell._val=t;var e=this._sub.itemPull[this._sub.idPrefix+this.cell._val];t=e?e.title:t,this.setCValue(t||"&nbsp;",t)},this.edit=function(){var t=this.grid.getPosition(this.cell);this._sub.showContextMenu(t[0]+this.cell.offsetWidth,t[1]);var e=this.grid.editStop;this.grid.editStop=function(){},this.grid.editStop=e},this.detach=function(){if(null!=this.grid._sub_id){var t=this.cell._val;return this.setValue(this.grid._sub_id),this.grid._sub_id=null,this.cell._val!=t}this._sub.hideContextMenu()}}function dhtmlXGridFromTable(obj,init){"object"!=typeof obj&&(obj=document.getElementById(obj));var w=document.createElement("DIV");w.setAttribute("width",obj.getAttribute("gridWidth")||(obj.offsetWidth?obj.offsetWidth+"px":0)||(window.getComputedStyle?window.getComputedStyle(obj,null).width:obj.currentStyle?obj.currentStyle.width:0)),w.setAttribute("height",obj.getAttribute("gridHeight")||(obj.offsetHeight?obj.offsetHeight+"px":0)||(window.getComputedStyle?window.getComputedStyle(obj,null).height:obj.currentStyle?obj.currentStyle.height:0)),w.className=obj.className,obj.className="",obj.id&&(w.id=obj.id);var mr=obj,drag=obj.getAttribute("dragAndDrop");mr.parentNode.insertBefore(w,mr);var f=mr.getAttribute("name")||"name_"+(new Date).valueOf(),windowf=new dhtmlXGridObject(w);window[f]=windowf;var acs=mr.getAttribute("onbeforeinit"),acs2=mr.getAttribute("oninit");acs&&eval(acs),windowf.setImagePath(windowf.imgURL||mr.getAttribute("imgpath")||mr.getAttribute("image_path")||"");var skin=mr.getAttribute("skin");skin&&windowf.setSkin(skin),init&&init(windowf);for(var hrow=mr.rows[0],za="",zb="",zc="",zd="",ze="",i=0;i<hrow.cells.length;i++){za+=(za?",":"")+hrow.cells[i].innerHTML;var width=hrow.cells[i].getAttribute("width")||hrow.cells[i].offsetWidth||(window.getComputedStyle?window.getComputedStyle(hrow.cells[i],null).width:hrow.cells[i].currentStyle?hrow.cells[i].currentStyle.width:0);zb+=(zb?",":"")+("*"==width?width:parseInt(width)),zc+=(zc?",":"")+(hrow.cells[i].getAttribute("align")||"left"),zd+=(zd?",":"")+(hrow.cells[i].getAttribute("type")||"ed"),ze+=(ze?",":"")+(hrow.cells[i].getAttribute("sort")||"str");var f_a=hrow.cells[i].getAttribute("format");f_a&&(hrow.cells[i].getAttribute("type").toLowerCase().indexOf("calendar")!=-1?windowf._dtmask=f_a:windowf.setNumberFormat(f_a,i))}windowf.setHeader(za),windowf.setInitWidths(zb),windowf.setColAlign(zc),windowf.setColTypes(zd),windowf.setColSorting(ze),"auto"==obj.getAttribute("gridHeight")&&windowf.enableAutoHeigth(!0),obj.getAttribute("multiline")&&windowf.enableMultiline(!0);var lmn=mr.getAttribute("lightnavigation");lmn&&windowf.enableLightMouseNavigation(lmn);var evr=mr.getAttribute("evenrow"),uevr=mr.getAttribute("unevenrow");return(evr||uevr)&&windowf.enableAlterCss(evr,uevr),drag&&windowf.enableDragAndDrop(!0),windowf.init(),obj.getAttribute("split")&&windowf.splitAt(obj.getAttribute("split")),windowf._process_inner_html(mr,1),acs2&&eval(acs2),obj.parentNode&&obj.parentNode.removeChild&&obj.parentNode.removeChild(obj),windowf}"undefined"==typeof window.dhx4&&(window.dhx4={version:"4.6",skin:null,skinDetect:function(t){return{10:"dhx_skyblue",20:"dhx_web",30:"dhx_terrace"}[this.readFromCss(t+"_skin_detect")]||null},readFromCss:function(t,e){var i=document.createElement("DIV");i.className=t,null!=document.body.firstChild?document.body.insertBefore(i,document.body.firstChild):document.body.appendChild(i);var s=i[e||"offsetWidth"];return i.parentNode.removeChild(i),i=null,s},lastId:1,newId:function(){return this.lastId++},zim:{data:{},step:5,first:function(){return 100},last:function(){var t=this.first();for(var e in this.data)t=Math.max(t,this.data[e]);return t},reserve:function(t){return this.data[t]=this.last()+this.step,this.data[t]},clear:function(t){null!=this.data[t]&&(this.data[t]=null,delete this.data[t])}},s2b:function(t){return"string"==typeof t&&(t=t.toLowerCase()),1==t||1==t||"true"==t||"1"==t||"yes"==t||"y"==t||"on"==t},s2j:function(s){var obj=null;dhx4.temp=null;try{eval("dhx4.temp="+s)}catch(t){dhx4.temp=null}return obj=dhx4.temp,dhx4.temp=null,obj},absLeft:function(t){return"string"==typeof t&&(t=document.getElementById(t)),this.getOffset(t).left},absTop:function(t){return"string"==typeof t&&(t=document.getElementById(t)),this.getOffset(t).top},_aOfs:function(t){for(var e=0,i=0;t;)e+=parseInt(t.offsetTop),i+=parseInt(t.offsetLeft),t=t.offsetParent;return{top:e,left:i}},_aOfsRect:function(t){var e=t.getBoundingClientRect(),i=document.body,s=document.documentElement,l=window.pageYOffset||s.scrollTop||i.scrollTop,n=window.pageXOffset||s.scrollLeft||i.scrollLeft,o=s.clientTop||i.clientTop||0,r=s.clientLeft||i.clientLeft||0,h=e.top+l-o,a=e.left+n-r;return{top:Math.round(h),left:Math.round(a)}},getOffset:function(t){return t.getBoundingClientRect?this._aOfsRect(t):this._aOfs(t)},_isObj:function(t){return null!=t&&"object"==typeof t&&"undefined"==typeof t.length},_copyObj:function(t){if(this._isObj(t)){var e={};for(var i in t)"object"==typeof t[i]&&null!=t[i]?e[i]=this._copyObj(t[i]):e[i]=t[i]}else for(var e=[],i=0;i<t.length;i++)"object"==typeof t[i]&&null!=t[i]?e[i]=this._copyObj(t[i]):e[i]=t[i];return e},screenDim:function(){var t=navigator.userAgent.indexOf("MSIE")>=0,e={};return e.left=document.body.scrollLeft,e.right=e.left+(window.innerWidth||document.body.clientWidth),e.top=Math.max((t?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop),e.bottom=e.top+(t?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0):window.innerHeight),e},selectTextRange:function(t,e,i){t="string"==typeof t?document.getElementById(t):t;var s=t.value.length;if(e=Math.max(Math.min(e,s),0),i=Math.min(i,s),t.setSelectionRange)try{t.setSelectionRange(e,i)}catch(t){}else if(t.createTextRange){var l=t.createTextRange();l.moveStart("character",e),l.moveEnd("character",i-s);try{l.select()}catch(t){}}},transData:null,transDetect:function(){if(null==this.transData){this.transData={transProp:!1,transEv:null};var t={MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"transitionend",transition:"transitionend"};for(var e in t)0==this.transData.transProp&&null!=document.documentElement.style[e]&&(this.transData.transProp=e,this.transData.transEv=t[e]);t=null}return this.transData},_xmlNodeValue:function(t){for(var e="",i=0;i<t.childNodes.length;i++)e+=null!=t.childNodes[i].nodeValue?t.childNodes[i].nodeValue.toString().replace(/^[\n\r\s]{0,}/,"").replace(/[\n\r\s]{0,}$/,""):"";return e}},window.dhx4.isIE=navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isIE6=null==window.XMLHttpRequest&&navigator.userAgent.indexOf("MSIE")>=0,window.dhx4.isIE7=navigator.userAgent.indexOf("MSIE 7.0")>=0&&navigator.userAgent.indexOf("Trident")<0,window.dhx4.isIE8=navigator.userAgent.indexOf("MSIE 8.0")>=0&&navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isIE9=navigator.userAgent.indexOf("MSIE 9.0")>=0&&navigator.userAgent.indexOf("Trident")>=0,window.dhx4.isIE10=navigator.userAgent.indexOf("MSIE 10.0")>=0&&navigator.userAgent.indexOf("Trident")>=0&&1!=window.navigator.pointerEnabled,window.dhx4.isIE11=navigator.userAgent.indexOf("Trident")>=0&&1==window.navigator.pointerEnabled,window.dhx4.isEdge=navigator.userAgent.indexOf("Edge")>=0,window.dhx4.isOpera=navigator.userAgent.indexOf("Opera")>=0,window.dhx4.isChrome=navigator.userAgent.indexOf("Chrome")>=0&&!window.dhx4.isEdge,window.dhx4.isKHTML=(navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0)&&!window.dhx4.isEdge,window.dhx4.isFF=navigator.userAgent.indexOf("Firefox")>=0,window.dhx4.isIPad=navigator.userAgent.search(/iPad/gi)>=0,window.dhx4.dnd={evs:{},p_en:(window.dhx4.isIE||window.dhx4.isEdge)&&(window.navigator.pointerEnabled||window.navigator.msPointerEnabled),_mTouch:function(t){return window.dhx4.isIE10&&t.pointerType==t.MSPOINTER_TYPE_MOUSE||window.dhx4.isIE11&&"mouse"==t.pointerType||window.dhx4.isEdge&&"mouse"==t.pointerType},_touchOn:function(t){null==t&&(t=document.body),t.style.touchAction=t.style.msTouchAction="",t=null},_touchOff:function(t){null==t&&(t=document.body),t.style.touchAction=t.style.msTouchAction="none",t=null}},1==window.navigator.pointerEnabled?window.dhx4.dnd.evs={start:"pointerdown",move:"pointermove",end:"pointerup"}:1==window.navigator.msPointerEnabled?window.dhx4.dnd.evs={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:"undefined"!=typeof window.addEventListener&&(window.dhx4.dnd.evs={start:"touchstart",move:"touchmove",end:"touchend"})),"undefined"==typeof window.dhx4.template&&(window.dhx4.trim=function(t){return String(t).replace(/^\s{1,}/,"").replace(/\s{1,}$/,"")},window.dhx4.template=function(t,e,i){return t.replace(/#([a-z0-9_-]{1,})(\|([^#]*))?#/gi,function(){var t=arguments[1],s=window.dhx4.trim(arguments[3]),l=null,n=[e[t]];if(s.length>0){s=s.split(":");for(var o=[],r=0;r<s.length;r++)r>0&&null!=o[o.length-1].match(/\\$/)?o[o.length-1]=o[o.length-1].replace(/\\$/,"")+":"+s[r]:o.push(s[r]);l=o[0];for(var r=1;r<o.length;r++)n.push(o[r])}return"string"==typeof l&&"function"==typeof window.dhx4.template[l]?window.dhx4.template[l].apply(window.dhx4.template,n):t.length>0&&"undefined"!=typeof e[t]?1==i?window.dhx4.trim(e[t]):String(e[t]):""})},window.dhx4.template.date=function(t,e){return null!=t?t instanceof Date?window.dhx4.date2str(t,e):(t=t.toString(),null!=t.match(/^\d*$/)?window.dhx4.date2str(new Date(parseInt(t)),e):t):""},window.dhx4.template.maxlength=function(t,e){return String(t).substr(0,e)},window.dhx4.template.number_format=function(t,e,i,s){var l=window.dhx4.template._parseFmt(e,i,s);return 0==l?t:window.dhx4.template._getFmtValue(t,l)},window.dhx4.template.lowercase=function(t){return"undefined"!=typeof t&&null!=t||(t=""),String(t).toLowerCase()},window.dhx4.template.uppercase=function(t){return"undefined"!=typeof t&&null!=t||(t=""),String(t).toUpperCase()},window.dhx4.template._parseFmt=function(t,e,i){var s=t.match(/^([^\.\,0-9]*)([0\.\,]*)([^\.\,0-9]*)/);if(null==s||4!=s.length)return!1;var l={i_len:!1,i_sep:"string"==typeof e?e:",",d_len:!1,d_sep:"string"==typeof i?i:".",s_bef:"string"==typeof s[1]?s[1]:"",s_aft:"string"==typeof s[3]?s[3]:""},n=s[2].split(".");null!=n[1]&&(l.d_len=n[1].length);var o=n[0].split(",");return o.length>1&&(l.i_len=o[o.length-1].length),l},window.dhx4.template._getFmtValue=function(value,fmt){var r=String(value).match(/^(-)?([0-9]{1,})(\.([0-9]{1,}))?$/);if(null!=r&&5==r.length){var v0="";if(null!=r[1]&&(v0+=r[1]),v0+=fmt.s_bef,fmt.i_len!==!1){for(var i=0,v1="",q=r[2].length-1;q>=0;q--)v1=""+r[2].charAt(q)+v1,++i==fmt.i_len&&q>0&&(v1=fmt.i_sep+v1,i=0);v0+=v1}else v0+=r[2];if(fmt.d_len!==!1){for(null==r[4]&&(r[4]="");r[4].length<fmt.d_len;)r[4]+="0";eval("dhx4.temp = new RegExp(/\\d{"+fmt.d_len+"}/);");var t1=r[4].match(dhx4.temp);null!=t1&&(v0+=fmt.d_sep+t1),dhx4.temp=t1=null}return v0+=fmt.s_aft}return value}),"undefined"==typeof window.dhx4.dateLang&&(window.dhx4.dateLang="en",window.dhx4.dateStrings={en:{monthFullName:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShortName:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFullName:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShortName:["Su","Mo","Tu","We","Th","Fr","Sa"]}},window.dhx4.dateFormat={en:"%Y-%m-%d"},window.dhx4.date2str=function(t,e,i){if(null!=e&&"undefined"!=typeof e||(e=window.dhx4.dateFormat[window.dhx4.dateLang]),null!=i&&"undefined"!=typeof i||(i=window.dhx4.dateStrings[window.dhx4.dateLang]),t instanceof Date)var s=function(t){return 1==String(t).length?"0"+String(t):t},l=function(e){switch(e){case"%d":return s(t.getDate());case"%j":return t.getDate();case"%D":return i.dayShortName[t.getDay()];case"%l":return i.dayFullName[t.getDay()];case"%m":return s(t.getMonth()+1);case"%n":return t.getMonth()+1;case"%M":return i.monthShortName[t.getMonth()];case"%F":return i.monthFullName[t.getMonth()];case"%y":return s(t.getYear()%100);case"%Y":return t.getFullYear();case"%g":return(t.getHours()+11)%12+1;case"%h":return s((t.getHours()+11)%12+1);case"%G":return t.getHours();case"%H":return s(t.getHours());case"%i":return s(t.getMinutes());case"%s":return s(t.getSeconds());case"%a":return t.getHours()>11?"pm":"am";case"%A":return t.getHours()>11?"PM":"AM";case"%%":return"%";case"%u":return t.getMilliseconds();case"%P":if(null!=window.dhx4.temp_calendar&&null!=window.dhx4.temp_calendar.tz)return window.dhx4.temp_calendar.tz;var l=t.getTimezoneOffset(),n=Math.abs(Math.floor(l/60)),o=Math.abs(l)-60*n;return(l>0?"-":"+")+s(n)+":"+s(o);default:return e}},n=String(e||window.dhx4.dateFormat).replace(/%[a-zA-Z]/g,l);return n||String(t)},window.dhx4.str2date=function(t,e,i){null!=e&&"undefined"!=typeof e||(e=window.dhx4.dateFormat[window.dhx4.dateLang]),null!=i&&"undefined"!=typeof i||(i=window.dhx4.dateStrings[window.dhx4.dateLang]),e=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\\:|]/g,"\\$&");var s=[],l=[];e=e.replace(/%[a-z]/gi,function(t){switch(t){case"%d":case"%m":case"%y":case"%h":case"%H":case"%i":case"%s":return l.push(t),"(\\d{2})";case"%D":case"%l":case"%M":case"%F":return l.push(t),"([a-z-]{1,})";case"%j":case"%n":case"%g":case"%G":return l.push(t),"(\\d{1,2})";case"%Y":return l.push(t),"(\\d{4})";case"%a":return l.push(t),"([a|p]m)";case"%A":return l.push(t),"([A|P]M)";case"%u":return l.push(t),"(\\d{1,6})";case"%P":return l.push(t),"([+-]\\d{1,2}:\\d{1,2})"}return t});var n=new RegExp(e,"i"),o=t.match(n);if(null==o||o.length-1!=l.length)return"Invalid Date";for(var r=1;r<o.length;r++)s.push(o[r]);for(var h={"%y":1,"%Y":1,"%n":2,"%m":2,"%M":2,"%F":2,"%d":3,"%j":3,"%a":4,"%A":4,"%H":5,"%G":5,"%h":5,"%g":5,"%i":6,"%s":7,"%u":7,"%P":7},a={},d={},r=0;r<l.length;r++)if("undefined"!=typeof h[l[r]]){var c=h[l[r]];a[c]||(a[c]=[],d[c]=[]),a[c].push(s[r]),d[c].push(l[r])}s=[],l=[];for(var r=1;r<=7;r++)if(null!=a[r])for(var u=0;u<a[r].length;u++)s.push(a[r][u]),l.push(d[r][u]);var f=new Date;f.setDate(1),f.setHours(0),f.setMinutes(0),f.setSeconds(0),f.setMilliseconds(0);for(var _=function(t,e){for(var i=0;i<e.length;i++)if(e[i].toLowerCase()==t)return i;return-1},r=0;r<s.length;r++)switch(l[r]){case"%d":case"%j":case"%n":case"%m":case"%Y":case"%H":case"%G":case"%i":case"%s":case"%u":isNaN(s[r])||f[{"%d":"setDate","%j":"setDate","%n":"setMonth","%m":"setMonth","%Y":"setFullYear","%H":"setHours","%G":"setHours","%i":"setMinutes","%s":"setSeconds","%u":"setMilliseconds"}[l[r]]](Number(s[r])+("%m"==l[r]||"%n"==l[r]?-1:0));break;case"%M":case"%F":var p=_(s[r].toLowerCase(),i[{"%M":"monthShortName","%F":"monthFullName"}[l[r]]]);p>=0&&f.setMonth(p);break;case"%y":if(!isNaN(s[r])){var m=Number(s[r]);f.setFullYear(m+(m>50?1900:2e3))}break;case"%g":case"%h":if(!isNaN(s[r])){var m=Number(s[r]);m<=12&&m>=0&&f.setHours(m+(_("pm",s)>=0?12==m?0:12:12==m?-12:0))}break;case"%P":null!=window.dhx4.temp_calendar&&(window.dhx4.temp_calendar.tz=s[r])}return f}),"undefined"==typeof window.dhx4.ajax&&(window.dhx4.ajax={cache:!1,method:"get",parse:function(t){if("string"!=typeof t)return t;if(t=t.replace(/^[\s]+/,""),window.DOMParser&&!dhx4.isIE)var e=(new window.DOMParser).parseFromString(t,"text/xml");else if(window.ActiveXObject!==window.undefined){var e=new window.ActiveXObject("Microsoft.XMLDOM");e.async="false",e.loadXML(t)}return e},xmltop:function(t,e,i){if(("undefined"==typeof e.status||e.status<400)&&(xml=e.responseXML?e.responseXML||e:dhx4.ajax.parse(e.responseText||e),xml&&null!==xml.documentElement))try{if(!xml.getElementsByTagName("parsererror").length)return xml.getElementsByTagName(t)[0]}catch(t){}return i!==-1&&dhx4.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],i]),document.createElement("DIV")},xpath:function(t,e){if(e.nodeName||(e=e.responseXML||e),!dhx4.isIE){for(var i,s=[],l=(e.ownerDocument||e).evaluate(t,e,null,XPathResult.ANY_TYPE,null);i=l.iterateNext();)s.push(i);return s}try{return e.selectNodes(t)||[]}catch(t){return[]}},query:function(t){dhx4.ajax._call(t.method||"GET",t.url,t.data||"",t.async||!0,t.callback,null,t.headers)},get:function(t,e){return this._call("GET",t,null,!0,e)},getSync:function(t){return this._call("GET",t,null,!1)},put:function(t,e,i){return this._call("PUT",t,e,!0,i)},del:function(t,e,i){return this._call("DELETE",t,e,!0,i)},post:function(t,e,i){return 1==arguments.length?e="":2!=arguments.length||"function"!=typeof e&&"function"!=typeof window[e]?e=String(e):(i=e,e=""),this._call("POST",t,e,!0,i)},postSync:function(t,e){return e=null==e?"":String(e),this._call("POST",t,e,!1)},getLong:function(t,e){this._call("GET",t,null,!0,e,{url:t})},postLong:function(t,e,i){2!=arguments.length||"function"!=typeof e&&(window[e],0)||(i=e,e=""),this._call("POST",t,e,!0,i,{url:t,postData:e})},_call:function(t,e,i,s,l,n,o){var r=window.XMLHttpRequest&&!dhx4.isIE?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),h=null!=navigator.userAgent.match(/AppleWebKit/)&&null!=navigator.userAgent.match(/Qt/)&&null!=navigator.userAgent.match(/Safari/);if(1==s&&(r.onreadystatechange=function(){if(4==r.readyState||1==h&&3==r.readyState){if((200!=r.status||""==r.responseText)&&!dhx4.callEvent("onAjaxError",[{xmlDoc:r,filePath:e,async:s}]))return;window.setTimeout(function(){"function"==typeof l&&l.apply(window,[{xmlDoc:r,filePath:e,async:s}]),null!=n&&("undefined"!=typeof n.postData?dhx4.ajax.postLong(n.url,n.postData,l):dhx4.ajax.getLong(n.url,l)),l=null,r=null},1)}}),"GET"==t&&(e+=this._dhxr(e)),r.open(t,e,s),null!=o)for(var a in o)r.setRequestHeader(a,o[a]);else"POST"==t||"PUT"==t||"DELETE"==t?r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):"GET"==t&&(i=null);return r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.send(i),1!=s&&(4==r.readyState||1==h&&3==r.readyState)&&(200==r.status&&""!=r.responseText||dhx4.callEvent("onAjaxError",[{xmlDoc:r,filePath:e,async:s}])),{xmlDoc:r,filePath:e,async:s}},_dhxr:function(t,e){return 1!=this.cache?(null==t.match(/^[\?\&]$/)&&(t=t.indexOf("?")>=0?"&":"?"),"undefined"==typeof e&&(e=!0),t+"dhxr"+(new Date).getTime()+(1==e?"=1":"")):""}}),"undefined"==typeof window.dhx4._enableDataLoading&&(window.dhx4._enableDataLoading=function(t,e,i,s,l){if("clear"==l){for(var n in t._dhxdataload)t._dhxdataload[n]=null,delete t._dhxdataload[n];return t._loadData=null,t._dhxdataload=null,t.load=null,t.loadStruct=null,void(t=null)}if(t._dhxdataload={initObj:e,xmlToJson:i,xmlRootTag:s,onBeforeXLS:null},t._loadData=function(t,e,i){2==arguments.length&&(i=e,e=null);var s=null;if(3==arguments.length&&(i=arguments[2]),"string"==typeof t){var l=t.replace(/^\s{1,}/,"").replace(/\s{1,}$/,""),n=new RegExp("^<"+this._dhxdataload.xmlRootTag);if(n.test(l.replace(/^<\?xml[^\?]*\?>\s*/,""))&&(s=dhx4.ajax.parse(t),null!=s&&(s=this[this._dhxdataload.xmlToJson].apply(this,[s]))),null!=s||null==l.match(/^[\s\S]*{[.\s\S]*}[\s\S]*$/)&&null==l.match(/^[\s\S]*\[[.\s\S]*\][\s\S]*$/)||(s=dhx4.s2j(l)),null==s){this.callEvent("onXLS",[]);var o=[];if("function"==typeof this._dhxdataload.onBeforeXLS){var l=this._dhxdataload.onBeforeXLS.apply(this,[t]);if(null!=l&&"object"==typeof l&&(null!=l.url&&(t=l.url),null!=l.params))for(var r in l.params)o.push(r+"="+encodeURIComponent(l.params[r]))}var h=this,a=function(e){var s=null;s=(e.xmlDoc.getResponseHeader("Content-Type")||"").search(/xml/gi)>=0||null!=e.xmlDoc.responseText.replace(/^\s{1,}/,"").match(/^</)?h[h._dhxdataload.xmlToJson].apply(h,[e.xmlDoc.responseXML]):dhx4.s2j(e.xmlDoc.responseText),null!=s&&h[h._dhxdataload.initObj].apply(h,[s,t]),h.callEvent("onXLE",[]),null!=i&&("function"==typeof i?i.apply(h,[]):"function"==typeof window[i]&&window[i].apply(h,[])),a=i=null,s=e=h=null};return o=o.join("&")+("string"==typeof e?"&"+e:""),void("post"==dhx4.ajax.method?dhx4.ajax.post(t,o,a):"get"==dhx4.ajax.method&&dhx4.ajax.get(t+(o.length>0?(t.indexOf("?")>0?"&":"?")+o:""),a))}}else s="object"==typeof t.documentElement||"undefined"!=typeof t.tagName&&"undefined"!=typeof t.getElementsByTagName&&t.getElementsByTagName(this._dhxdataload.xmlRootTag).length>0?this[this._dhxdataload.xmlToJson].apply(this,[t]):window.dhx4._copyObj(t);null!=s&&this[this._dhxdataload.initObj].apply(this,[s]),null!=i&&("function"==typeof i?i.apply(this,[]):"function"==typeof window[i]&&window[i].apply(this,[]),i=null)},null!=l){var o={struct:"loadStruct",data:"load"};for(var n in l)1==l[n]&&(t[o[n]]=function(){return this._loadData.apply(this,arguments)})}t=null}),"undefined"==typeof window.dhx4._eventable&&(window.dhx4._eventable=function(t,e){return"clear"==e?(t.detachAllEvents(),t.dhxevs=null,t.attachEvent=null,t.detachEvent=null,t.checkEvent=null,t.callEvent=null,t.detachAllEvents=null,void(t=null)):(t.dhxevs={data:{}},t.attachEvent=function(t,e){t=String(t).toLowerCase(),this.dhxevs.data[t]||(this.dhxevs.data[t]={});var i=window.dhx4.newId();return this.dhxevs.data[t][i]=e,i},t.detachEvent=function(t){for(var e in this.dhxevs.data){var i=0;for(var s in this.dhxevs.data[e])s==t?(this.dhxevs.data[e][s]=null,delete this.dhxevs.data[e][s]):i++;0==i&&(this.dhxevs.data[e]=null,delete this.dhxevs.data[e])}},t.checkEvent=function(t){return t=String(t).toLowerCase(),null!=this.dhxevs.data[t]},t.callEvent=function(t,e){if(t=String(t).toLowerCase(),null==this.dhxevs.data[t])return!0;var i=!0;for(var s in this.dhxevs.data[t])i=this.dhxevs.data[t][s].apply(this,e)&&i;return i},t.detachAllEvents=function(){for(var t in this.dhxevs.data){for(var e in this.dhxevs.data[t])this.dhxevs.data[t][e]=null,delete this.dhxevs.data[t][e];this.dhxevs.data[t]=null,delete this.dhxevs.data[t]}},void(t=null))},dhx4._eventable(dhx4)),window.dhtmlxValidation||(dhtmlxValidation=function(){},dhtmlxValidation.prototype={isEmpty:function(t){return""==t},isNotEmpty:function(t){return t instanceof Array?t.length>0:""==!t},isValidBoolean:function(t){return!!t.toString().match(/^(0|1|true|false)$/)},isValidEmail:function(t){return!!t.toString().match(/(^[a-z0-9]([0-9a-z\-_\.]*)@([0-9a-z_\-\.]*)([.][a-z]{3})$)|(^[a-z]([0-9a-z_\.\-]*)@([0-9a-z_\-\.]*)(\.[a-z]{2,4})$)/i)},isValidInteger:function(t){return!!t.toString().match(/(^-?\d+$)/)},isValidNumeric:function(t){return!!t.toString().match(/(^-?\d\d*[\.|,]\d*$)|(^-?\d\d*$)|(^-?[\.|,]\d\d*$)/)},isValidAplhaNumeric:function(t){return!!t.toString().match(/^[_\-a-z0-9]+$/gi)},isValidDatetime:function(t){var e=t.toString().match(/^(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})$/);return e&&!!(e[1]<=9999&&e[2]<=12&&e[3]<=31&&e[4]<=59&&e[5]<=59&&e[6]<=59)||!1},isValidDate:function(t){var e=t.toString().match(/^(\d{4})-(\d{2})-(\d{2})$/);return e&&!!(e[1]<=9999&&e[2]<=12&&e[3]<=31)||!1},isValidTime:function(t){var e=t.toString().match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/);return e&&!!(e[1]<=24&&e[2]<=59&&e[3]<=59)||!1},isValidIPv4:function(t){var e=t.toString().match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);return e&&!!(e[1]<=255&&e[2]<=255&&e[3]<=255&&e[4]<=255)||!1},isValidCurrency:function(t){return t.toString().match(/^\$?\s?\d+?([\.,\,]?\d+)?\s?\$?$/)&&!0||!1},isValidSSN:function(t){return t.toString().match(/^\d{3}\-?\d{2}\-?\d{4}$/)&&!0||!1},isValidSIN:function(t){return t.toString().match(/^\d{9}$/)&&!0||!1}},dhtmlxValidation=new dhtmlxValidation),"undefined"==typeof window.dhtmlx&&(window.dhtmlx={extend:function(t,e){for(var i in e)t[i]||(t[i]=e[i]);return t},extend_api:function(t,e,i){var s=window[t];s&&(window[t]=function(t){if(t&&"object"==typeof t&&!t.tagName){var i=s.apply(this,e._init?e._init(t):arguments);for(var l in dhtmlx)e[l]&&this[e[l]](dhtmlx[l]);for(var l in t)e[l]?this[e[l]](t[l]):0===l.indexOf("on")&&this.attachEvent(l,t[l])}else var i=s.apply(this,arguments);return e._patch&&e._patch(this),i||this},window[t].prototype=s.prototype,i&&dhtmlx.extend(window[t].prototype,i))},url:function(t){return t.indexOf("?")!=-1?"&":"?"}}),dhtmlDragAndDropObject.prototype.removeDraggableItem=function(t){t.onmousedown=null,t.dragStarter=null,t.dragLanding=null},dhtmlDragAndDropObject.prototype.addDraggableItem=function(t,e){t.onmousedown=this.preCreateDragCopy,t.dragStarter=e,this.addDragLanding(t,e)},dhtmlDragAndDropObject.prototype.addDragLanding=function(t,e){t.dragLanding=e},dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(t){if(!t&&!window.event||2!=(t||event).button)return window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(t),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),!(!t||!t.preventDefault)&&(t.preventDefault(),!1))},dhtmlDragAndDropObject.prototype.callDrag=function(t){if(t||(t=window.event),dragger=window.dhtmlDragAndDrop,!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode){if(!dragger.waitDrag)return dragger.stopDrag(t,!0);if(dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,t),!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return!1},dragger.gldragNode=dragger.dragNode,document.body.appendChild(dragger.dragNode),document.body.onmouseup=dragger.stopDrag,dragger.waitDrag=0,dragger.dragNode.pWindow=window,dragger.initFrameRoute()}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var e=dragger.gldragNode;dragger.gldragNode.old&&(e=dragger.gldragNode.old),e.parentNode.removeChild(e);var i=dragger.dragNode.pWindow;if(e.pWindow&&e.pWindow.dhtmlDragAndDrop.lastLanding&&e.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(e.pWindow.dhtmlDragAndDrop.lastLanding),_isIE){var s=document.createElement("Div");s.innerHTML=dragger.dragNode.outerHTML,dragger.dragNode=s.childNodes[0]}else dragger.dragNode=dragger.dragNode.cloneNode(!0);dragger.dragNode.pWindow=window,dragger.gldragNode.old=dragger.dragNode,document.body.appendChild(dragger.dragNode),i.dhtmlDragAndDrop.dragNode=dragger.dragNode}if(dragger.dragNode.style.left=t.clientX+15+(dragger.fx?dragger.fx*-1:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px",dragger.dragNode.style.top=t.clientY+3+(dragger.fy?dragger.fy*-1:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px",t.srcElement)l=t.srcElement;else var l=t.target;dragger.checkLanding(l,t)}},dhtmlDragAndDropObject.prototype.calculateFramePosition=function(t){if(window.name){for(var e=parent.frames[window.name].frameElement.offsetParent,i=0,s=0;e;)i+=e.offsetLeft,s+=e.offsetTop,e=e.offsetParent;if(parent.dhtmlDragAndDrop){var l=parent.dhtmlDragAndDrop.calculateFramePosition(1);i+=1*l.split("_")[0],s+=1*l.split("_")[1]}if(t)return i+"_"+s;this.fx=i,this.fy=s}return"0_0"},dhtmlDragAndDropObject.prototype.checkLanding=function(t,e){t&&t.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=t,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,e.clientX,e.clientY,e),this.lastLanding_scr=_isIE?e.srcElement:e.target):t&&"BODY"!=t.tagName?this.checkLanding(t.parentNode,e):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,e.clientX,e.clientY,e),this.lastLanding=0,this._onNotFound&&this._onNotFound())},dhtmlDragAndDropObject.prototype.stopDrag=function(t,e){if(dragger=window.dhtmlDragAndDrop,!e){dragger.stopFrameRoute();var i=dragger.lastLanding;dragger.lastLanding=null,i&&i.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,i,_isIE?event.srcElement:t.target)}dragger.lastLanding=null,
dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode),dragger.dragNode=0,dragger.gldragNode=0,dragger.fx=0,dragger.fy=0,dragger.dragStartNode=0,dragger.dragStartObject=0,document.body.onmouseup=dragger.tempDOMU,document.body.onmousemove=dragger.tempDOMM,dragger.tempDOMU=null,dragger.tempDOMM=null,dragger.waitDrag=0},dhtmlDragAndDropObject.prototype.stopFrameRoute=function(t){t&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var e=0;e<window.frames.length;e++)try{window.frames[e]!=t&&window.frames[e].dhtmlDragAndDrop&&window.frames[e].dhtmlDragAndDrop.stopFrameRoute(window)}catch(t){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(t){}},dhtmlDragAndDropObject.prototype.initFrameRoute=function(t,e){t&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=t.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=t.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=t.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=t.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&e&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(t){}for(var i=0;i<window.frames.length;i++)try{window.frames[i]!=t&&window.frames[i].dhtmlDragAndDrop&&window.frames[i].dhtmlDragAndDrop.initFrameRoute(window,!t||e?1:0)}catch(t){}},_isFF=!1,_isIE=!1,_isOpera=!1,_isKHTML=!1,_isMacOS=!1,_isChrome=!1,_FFrv=!1,_KHTMLrv=!1,_OperaRv=!1,navigator.userAgent.indexOf("Macintosh")!=-1&&(_isMacOS=!0),navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0),navigator.userAgent.indexOf("Safari")!=-1||navigator.userAgent.indexOf("Konqueror")!=-1?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):navigator.userAgent.indexOf("Opera")!=-1?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):navigator.appName.indexOf("Microsoft")!=-1?(_isIE=!0,(navigator.appVersion.indexOf("MSIE 8.0")!=-1||navigator.appVersion.indexOf("MSIE 9.0")!=-1||navigator.appVersion.indexOf("MSIE 10.0")!=-1||document.documentMode>7)&&"BackCompat"!=document.compatMode&&(_isIE=8)):"Netscape"==navigator.appName&&navigator.userAgent.indexOf("Trident")!=-1?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])),"undefined"==typeof window.dhtmlxEvent,null==dhtmlxEvent.touchDelay&&(dhtmlxEvent.touchDelay=2e3),"undefined"==typeof dhtmlxEvent.initTouch&&(dhtmlxEvent.initTouch=function(){function t(){if(i){var t=document.createEvent("HTMLEvents");t.initEvent("dblclick",!0,!0),i.dispatchEvent(t),e=i=null}}var e,i,s,l;dhtmlxEvent(document.body,"touchstart",function(n){i=n.touches[0].target,s=n.touches[0].clientX,l=n.touches[0].clientY,e=window.setTimeout(t,dhtmlxEvent.touchDelay)}),dhtmlxEvent(document.body,"touchmove",function(t){e&&(Math.abs(t.touches[0].clientX-s)>50||Math.abs(t.touches[0].clientY-l)>50)&&(window.clearTimeout(e),e=i=!1)}),dhtmlxEvent(document.body,"touchend",function(t){e&&(window.clearTimeout(e),e=i=!1)}),dhtmlxEvent.initTouch=function(){}}),dataProcessor.prototype={setTransactionMode:function(t,e){"object"==typeof t?(this._tMode=t.mode||this._tMode,this._headers=this._headers||t.headers,this._payload=this._payload||t.payload):(this._tMode=t,this._tSend=e),"REST"==this._tMode&&(this._tSend=!1,this._endnm=!0)},escape:function(t){return this._utf?encodeURIComponent(t):escape(t)},enableUTFencoding:function(t){this._utf=dhx4.s2b(t)},setDataColumns:function(t){this._columns="string"==typeof t?t.split(","):t},getSyncState:function(){return!this.updatedRows.length},enableDataNames:function(t){this._endnm=dhx4.s2b(t)},enablePartialDataSend:function(t){this._changed=dhx4.s2b(t)},setUpdateMode:function(t,e){this.autoUpdate="cell"==t,this.updateMode=t,this.dnd=e},ignore:function(t,e){this._silent_mode=!0,t.call(e||window),this._silent_mode=!1},setUpdated:function(t,e,i){if(!this._silent_mode){var s=this.findRow(t);i=i||"updated";var l=this.obj.getUserData(t,this.action_param);l&&"updated"==i&&(i=l),e?(this.set_invalid(t,!1),this.updatedRows[s]=t,this.obj.setUserData(t,this.action_param,i),this._in_progress[t]&&(this._in_progress[t]="wait")):this.is_invalid(t)||(this.updatedRows.splice(s,1),this.obj.setUserData(t,this.action_param,"")),e||this._clearUpdateFlag(t),this.markRow(t,e,i),e&&this.autoUpdate&&this.sendData(t)}},_clearUpdateFlag:function(t){},markRow:function(t,e,i){var s="",l=this.is_invalid(t);if(l&&(s=this.styles[l],e=!0),this.callEvent("onRowMark",[t,e,i,l])&&(s=this.styles[e?i:"clear"]+s,this.obj[this._methods[0]](t,s),l&&l.details)){s+=this.styles[l+"_cell"];for(var n=0;n<l.details.length;n++)l.details[n]&&this.obj[this._methods[1]](t,n,s)}},getState:function(t){return this.obj.getUserData(t,this.action_param)},is_invalid:function(t){return this._invalid[t]},set_invalid:function(t,e,i){i&&(e={value:e,details:i,toString:function(){return this.value.toString()}}),this._invalid[t]=e},checkBeforeUpdate:function(t){return!0},sendData:function(t){if(!this._waitMode||"tree"!=this.obj.mytype&&!this.obj._h2)return this.obj.editStop&&this.obj.editStop(),"undefined"==typeof t||this._tSend?this.sendAllData():!this._in_progress[t]&&(this.messages=[],!("deleted"!==this.getState(t)&&!this.checkBeforeUpdate(t)&&this.callEvent("onValidationError",[t,this.messages]))&&void this._beforeSendData(this._getRowData(t),t))},_beforeSendData:function(t,e){return!!this.callEvent("onBeforeUpdate",[e,this.getState(e),t])&&void this._sendData(t,e)},serialize:function(t,e){if("string"==typeof t)return t;if("undefined"!=typeof e)return this.serialize_one(t,"");var i=[],s=[];for(var l in t)t.hasOwnProperty(l)&&(i.push(this.serialize_one(t[l],l+this.post_delim)),s.push(l));return i.push("ids="+this.escape(s.join(","))),dhtmlx.security_key&&i.push("dhx_security="+dhtmlx.security_key),i.join("&")},serialize_one:function(t,e){if("string"==typeof t)return t;var i=[];for(var s in t)if(t.hasOwnProperty(s)){if(("id"==s||s==this.action_param)&&"REST"==this._tMode)continue;i.push(this.escape((e||"")+s)+"="+this.escape(t[s]))}return i.join("&")},_sendData:function(t,e){if(t){if(!this.callEvent("onBeforeDataSending",e?[e,this.getState(e),t]:[null,null,t]))return!1;e&&(this._in_progress[e]=(new Date).valueOf());var i=this,s=function(s){var l=[];if(e)l.push(e);else if(t)for(var n in t)l.push(n);return i.afterUpdate(i,s,l)},l=this.serverProcessor+(this._user?dhtmlx.url(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.obj.getUserData(0,"version")].join("&"):"");if("GET"==this._tMode)dhx4.ajax.get(l+(l.indexOf("?")!=-1?"&":"?")+this.serialize(t,e),s);else if("POST"==this._tMode)dhx4.ajax.post(l,this.serialize(t,e),s);else if("REST"==this._tMode){var n=this.getState(e),o=l.replace(/(\&|\?)editing\=true/,""),r=o.split("?");r[1]&&(r[1]="?"+r[1]);var h="",a="post";if("inserted"==n?h=this.serialize(t,e):"deleted"==n?(a="DELETE",o=r[0]+e+(r[1]||"")):(a="PUT",h=this.serialize(t,e),o=r[0]+e+(r[1]||"")),this._payload)for(var d in this._payload)o=o+(o.indexOf("?")===-1?"?":"&")+this.escape(d)+"="+this.escape(this._payload[d]);dhx4.ajax.query({url:o,method:a,headers:this._headers,data:h,callback:s})}this._waitMode++}},sendAllData:function(){if(this.updatedRows.length){this.messages=[];for(var t=!0,e=0;e<this.updatedRows.length;e++)"deleted"!==this.getState(this.updatedRows[e])&&(t&=this.checkBeforeUpdate(this.updatedRows[e]));if(!t&&!this.callEvent("onValidationError",["",this.messages]))return!1;if(this._tSend)this._sendData(this._getAllData());else for(var e=0;e<this.updatedRows.length;e++)if(!this._in_progress[this.updatedRows[e]]){if(this.is_invalid(this.updatedRows[e]))continue;if(this._beforeSendData(this._getRowData(this.updatedRows[e]),this.updatedRows[e]),this._waitMode&&("tree"==this.obj.mytype||this.obj._h2))return}}},_getAllData:function(t){for(var e={},i=!1,s=0;s<this.updatedRows.length;s++){var l=this.updatedRows[s];this._in_progress[l]||this.is_invalid(l)||this.callEvent("onBeforeUpdate",[l,this.getState(l),this._getRowData(l)])&&(e[l]=this._getRowData(l,l+this.post_delim),i=!0,this._in_progress[l]=(new Date).valueOf())}return i?e:null},setVerificator:function(t,e){this.mandatoryFields[t]=e||function(t){return""!==t}},clearVerificator:function(t){this.mandatoryFields[t]=!1},findRow:function(t){var e=0;for(e=0;e<this.updatedRows.length&&t!=this.updatedRows[e];e++);return e},defineAction:function(t,e){this._uActions||(this._uActions=[]),this._uActions[t]=e},afterUpdateCallback:function(t,e,i,s){var l=t,n="error"!=i&&"invalid"!=i;if(n||this.set_invalid(t,i),this._uActions&&this._uActions[i]&&!this._uActions[i](s))return delete this._in_progress[l];"wait"!=this._in_progress[l]&&this.setUpdated(t,!1);var o=t;switch(i){case"inserted":case"insert":e!=t&&(this.obj[this._methods[2]](t,e),t=e);break;case"delete":case"deleted":return this.obj.setUserData(t,this.action_param,"true_deleted"),this.obj[this._methods[3]](t),delete this._in_progress[l],this.callEvent("onAfterUpdate",[t,i,e,s])}"wait"!=this._in_progress[l]?(n&&this.obj.setUserData(t,this.action_param,""),delete this._in_progress[l]):(delete this._in_progress[l],this.setUpdated(e,!0,this.obj.getUserData(t,this.action_param))),this.callEvent("onAfterUpdate",[o,i,e,s])},afterUpdate:function(t,e,i){if(window.JSON)try{var s=JSON.parse(e.xmlDoc.responseText),l=s.action||this.getState(i)||"updated",n=s.sid||i[0],o=s.tid||i[0];return t.afterUpdateCallback(n,o,l,s),void t.finalizeUpdate()}catch(t){}var r=dhx4.ajax.xmltop("data",e.xmlDoc);if(!r||"DIV"==r.tagName)return this.cleanUpdate(i);var h=dhx4.ajax.xpath("//data/action",r);if(!h.length)return this.cleanUpdate(i);for(var a=0;a<h.length;a++){var d=h[a],l=d.getAttribute("type"),n=d.getAttribute("sid"),o=d.getAttribute("tid");t.afterUpdateCallback(n,o,l,d)}t.finalizeUpdate()},cleanUpdate:function(t){if(t)for(var e=0;e<t.length;e++)delete this._in_progress[t[e]]},finalizeUpdate:function(){this._waitMode&&this._waitMode--,("tree"==this.obj.mytype||this.obj._h2)&&this.updatedRows.length&&this.sendData(),this.callEvent("onAfterUpdateFinish",[]),this.updatedRows.length||this.callEvent("onFullSync",[])},init:function(t){this.obj=t,t._dp_init&&t._dp_init(this),this.connector_init&&(t._dataprocessor=this)},setOnAfterUpdate:function(t){this.attachEvent("onAfterUpdate",t)},enableDebug:function(t){},setOnBeforeUpdateHandler:function(t){this.attachEvent("onBeforeDataSending",t)},setAutoUpdate:function(t,e){t=t||2e3,this._user=e||(new Date).valueOf(),this._need_update=!1,this._update_busy=!1,this.attachEvent("onAfterUpdate",function(t,e,i,s){this.afterAutoUpdate(t,e,i,s)}),this.attachEvent("onFullSync",function(){this.fullSync()});var i=this;window.setInterval(function(){i.loadUpdate()},t)},afterAutoUpdate:function(t,e,i,s){return"collision"!=e||(this._need_update=!0,!1)},fullSync:function(){return 1==this._need_update&&(this._need_update=!1,this.loadUpdate()),!0},getUpdates:function(t,e){return!this._update_busy&&(this._update_busy=!0,void dhx4.ajax.get(t,e))},_v:function(t){return t.firstChild?t.firstChild.nodeValue:""},_a:function(t){for(var e=[],i=0;i<t.length;i++)e[i]=this._v(t[i]);return e},loadUpdate:function(){var t=this,e=this.obj.getUserData(0,"version"),i=this.serverProcessor+dhtmlx.url(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+e].join("&");i=i.replace("editing=true&",""),this.getUpdates(i,function(e){var i=dhx4.ajax.xmltop("updates",e.xmlDoc),s=dhx4.ajax.xpath("//userdata",i);t.obj.setUserData(0,"version",t._v(s[0]));var l=dhx4.ajax.xpath("//update",i);if(l.length){t._silent_mode=!0;for(var n=0;n<l.length;n++){var o=l[n].getAttribute("status"),r=l[n].getAttribute("id"),h=l[n].getAttribute("parent");switch(o){case"inserted":t.callEvent("insertCallback",[l[n],r,h]);break;case"updated":t.callEvent("updateCallback",[l[n],r,h]);break;case"deleted":t.callEvent("deleteCallback",[l[n],r,h])}}t._silent_mode=!1}t._update_busy=!1,t=null})}},window.dataProcessor&&!dataProcessor.prototype.init_original&&(dataProcessor.prototype.connector_init=!0),dhtmlXCalendarObject.prototype.lang="en",dhtmlXCalendarObject.prototype.langData={en:{dateformat:"%Y-%m-%d",hdrformat:"%F %Y",monthesFNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthesSNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],daysFNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysSNames:["Su","Mo","Tu","We","Th","Fr","Sa"],weekstart:1,weekname:"w"}},dhtmlXCalendarObject.prototype._buildMonthHdr=function(t){var e=this,i=function(t){return 1==String(t).length?"0"+String(t):t},s=function(t,e){return"<span class='dhtmlxcalendar_month_label_"+t+"'>"+e+"</span>"},l=String(this.langData[this.lang].hdrformat||"%F %Y").replace(/%[a-z]/gi,function(l){switch(l){case"%m":return s("month",i(t.getMonth()+1));case"%n":return s("month",t.getMonth()+1);case"%M":return s("month",e.langData[e.lang].monthesSNames[t.getMonth()]);case"%F":return s("month",e.langData[e.lang].monthesFNames[t.getMonth()]);case"%y":return s("year",i(t.getYear()%100));case"%Y":return s("year",t.getFullYear());case"%%":return"%";default:return l}});return e=i=s=null,l},dhtmlXCalendarObject.prototype.enableIframe=function(t){1==t?this._ifr||(this._ifr=document.createElement("IFRAME"),this._ifr.frameBorder=0,this._ifr.border=0,this._ifr.setAttribute("src","javascript:false;"),this._ifr.className="dhtmlxcalendar_ifr",this._ifr.onload=function(){this.onload=null,this.contentWindow.document.open("text/html","replace"),this.contentWindow.document.write("<html><head><style>html,body{width:100%;height:100%;overflow:hidden;margin:0px;}</style></head><body</body></html>")},this.base.parentNode.insertBefore(this._ifr,this.base),this._ifrSize()):this._ifr&&(this._ifr.parentNode.removeChild(this._ifr),this._ifr=null)},dhtmlXCalendarObject.prototype._ifrSize=function(){this._ifr&&(this._ifr.style.left=this.base.style.left,this._ifr.style.top=this.base.style.top,this._ifr.style.width=this.base.offsetWidth+"px",this._ifr.style.height=this.base.offsetHeight+"px")},dhtmlxCalendarObject=dhtmlXCalendarObject,dhtmlXCalendarObject.prototype._dateStrings=function(){var t=this.langData[this.lang];return{monthFullName:t.monthesFNames,monthShortName:t.monthesSNames,dayFullName:t.daysFNames,dayShortName:t.daysSNames}},dhtmlXCalendarObject.prototype._strToDate=function(t,e){return window.dhx4.str2date(t,e||this._dateFormat,this._dateStrings())},dhtmlXCalendarObject.prototype._dateToStr=function(t,e){return window.dhx4.date2str(t,e||this._dateFormat,this._dateStrings())},window.dhtmlxDblCalendarObject=window.dhtmlXDoubleCalendarObject=window.dhtmlXDoubleCalendar=function(t){var e=this;return this.leftCalendar=new dhtmlXCalendarObject(t),this.leftCalendar.hideTime(),this.rightCalendar=new dhtmlXCalendarObject(t),this.rightCalendar.hideTime(),this.leftCalendar.attachEvent("onClick",function(t){e._updateRange("rightCalendar",t,null),e._evOnClick(["left",t])}),this.rightCalendar.attachEvent("onClick",function(t){e._updateRange("leftCalendar",null,t),e._evOnClick(["right",t])}),this.leftCalendar.attachEvent("onBeforeChange",function(t){return e._evOnBeforeChange(["left",t])}),this.rightCalendar.attachEvent("onBeforeChange",function(t){return e._evOnBeforeChange(["right",t])}),this.show=function(){this.leftCalendar.show(),this.rightCalendar.base.style.marginLeft=this.leftCalendar.base.offsetWidth-1+"px",this.rightCalendar.show()},this.hide=function(){this.leftCalendar.hide(),this.rightCalendar.hide()},this.setDateFormat=function(t){this.leftCalendar.setDateFormat(t),this.rightCalendar.setDateFormat(t)},this.setDates=function(t,e){null!=t&&this.leftCalendar.setDate(t),null!=e&&this.rightCalendar.setDate(e),this._updateRange()},this._updateRange=function(t,e,i){3==arguments.length?("leftCalendar"==t?this.leftCalendar:this.rightCalendar).setSensitiveRange(e,i):(this.leftCalendar.setSensitiveRange(null,this.rightCalendar.getDate()),this.rightCalendar.setSensitiveRange(this.leftCalendar.getDate(),null))},this.getFormatedDate=function(){return this.leftCalendar.getFormatedDate.apply(this.leftCalendar,arguments)},this.unload=function(){window.dhx4._eventable(this,"clear"),this.leftCalendar.unload(),this.rightCalendar.unload(),this.leftCalendar=this.rightCalendar=null,this._updateRange=null,this._evOnClick=null,this._evOnBeforeChange=null,this.show=null,this.hide=null,this.setDateFormat=null,this.setDates=null,this.getFormatedDate=null,this.unload=null,e=null},this._evOnClick=function(t){return this.callEvent("onClick",t)},this._evOnBeforeChange=function(t){return this.callEvent("onBeforeChange",t)},window.dhx4._eventable(this),this},dhtmlXCombo.prototype.setName=function(t){this.conf.form_name=t,this.base.childNodes[1].name=t,this.base.childNodes[2].name=t.replace(/(\[.*)?$/,"_new_value$1")},dhtmlXCombo.prototype.readonly=function(t){window.dhx4.s2b(t)?(this.base.firstChild.setAttribute("readOnly","true"),this.conf.ro_mode=!0):(this.base.firstChild.removeAttribute("readOnly"),this.conf.ro_mode=!1)},dhtmlXCombo.prototype.setPlaceholder=function(t){"undefined"!=typeof t&&null!=t||(t=""),this.base.firstChild.setAttribute("placeholder",String(t))},dhtmlXCombo.prototype.setTemplate=function(t){for(var e in t)"undefined"!=typeof this.conf.template[e]&&("header"==e?this.conf.template[e]=window.dhx4.s2b(t[e]):this.conf.template[e]=String(t[e]));null!=t.columns?this._mcMakeTemplate(t.columns):this._mcDetachHeader();for(var e in this.t)this.t[e].obj.setText(this.t[e].item,this.t[e].item._conf.text);this._confirmSelect()},dhtmlXCombo.prototype.setSkin=function(t){t!=this.conf.skin&&(this.conf.skin=t,this.base.className="dhxcombo_"+this.conf.skin+(this.conf.enabled?"":" dhxcombo_disabled"),this.list.className="dhxcombolist_"+this.conf.skin+(null!=this.hdr?" dhxcombolist_multicolumn":""),null!=this.hdr&&(this.hdr.className="dhxcombolist_"+this.conf.skin+" dhxcombolist_hdr"))},dhtmlXCombo.prototype.getInput=function(){return this.base.firstChild},dhtmlXCombo.prototype.getButton=function(){return this.base.childNodes[this.base.childNodes.length-(this.conf.combo_image?2:1)]},dhtmlXCombo.prototype.getList=function(){return this.list},dhtmlXCombo.prototype.getBase=function(){return this.base},dhtmlXCombo.prototype.getParent=function(){return this.DOMParent},dhtmlXCombo.prototype.forEachOption=function(t){for(var e=0;e<this.list.childNodes.length;e++)t.apply(window,[this._getOption(this.list.childNodes[e]._optId,e)])},dhtmlXCombo.prototype.setFocus=function(){this.conf.enabled&&this.base.firstChild.focus()},dhtmlXCombo.prototype.setFontSize=function(t,e){null!=t&&(this.base.firstChild.style.fontSize=t),null!=e&&(this.list.style.fontSize=e)},dhtmlXCombo.prototype.getOption=function(t){for(var e=null,i=null,s=0;s<this.list.childNodes.length;s++)if(null==e){var l=this.list.childNodes[s]._optId;this.t[l].obj.getValue(this.t[l].item)==t&&(e=l,i=s)}return null==e?null:this._getOption(e,i)},dhtmlXCombo.prototype.getOptionByIndex=function(t){return t<0?null:null==this.list.childNodes[t]?null:this._getOption(this.list.childNodes[t]._optId,t)},dhtmlXCombo.prototype.getOptionByLabel=function(t){for(var e=null,i=null,s=0;s<this.list.childNodes.length;s++)if(null==e){var l=this.list.childNodes[s]._optId;this.t[l].obj.getText(this.t[l].item,!0)==t&&(e=l,i=s)}return null==e?null:this._getOption(e,i)},dhtmlXCombo.prototype.getSelectedIndex=function(){return this._getOptionProp(this.conf.last_selected,"index",-1)},dhtmlXCombo.prototype.getSelectedText=function(){return this._getOptionProp(this.conf.last_selected,"text","")},dhtmlXCombo.prototype.getSelectedValue=function(){return this._getOptionProp(this.conf.temp_selected||this.conf.last_selected,"value",null)},dhtmlXCombo.prototype.getActualValue=function(){return this.base.childNodes[1].value},dhtmlXCombo.prototype.getComboText=function(){return this.base.childNodes[0].value},dhtmlXCombo.prototype.getIndexByValue=function(t){var e=this.getOption(t);return null!=e?e.index:-1},dhtmlXCombo.prototype.setComboText=function(t){1==this.conf.allow_free_text&&(this.unSelectOption(),this.conf.last_text=this.base.firstChild.value=t,this.conf.f_server_last=this.base.firstChild.value.toLowerCase())},dhtmlXCombo.prototype.setComboValue=function(t){var e=this.getOption(t);null!=e?this.selectOption(e.index):(this.conf.last_value=t,this.base.childNodes[1].value=this.conf.last_value,this.base.childNodes[2].value="true")},dhtmlXCombo.prototype.selectOption=function(t,e,i){if(!(t<0||t>=this.list.childNodes.length)){var s=this.list.childNodes[t]._optId;this._setSelected(s,this._isListVisible(),!0),this._confirmSelect("script")}},dhtmlXCombo.prototype.unSelectOption=function(){null!=this.conf.last_hover&&(this.t[this.conf.last_hover].obj.setSelected(this.t[this.conf.last_hover].item,!1),this.conf.last_hover=null),this.base.firstChild.value="",0!=this.conf.f_mode&&this._filterOpts(!0),this._hideList(),this._updateTopImage(null),this._confirmSelect("script")},dhtmlXCombo.prototype.confirmValue=function(){this._confirmSelect("script")},dhtmlXCombo.prototype.enable=function(t){t="undefined"==typeof t||window.dhx4.s2b(t),this.conf.enabled!=t&&(this.conf.enabled=t,t?(this.base.className="dhxcombo_"+this.conf.skin,this.base.firstChild.removeAttribute("disabled")):(this._hideList(),this.base.className="dhxcombo_"+this.conf.skin+" dhxcombo_disabled",this.base.firstChild.setAttribute("disabled","true")),this._updateTopImage(this.conf.last_selected))},dhtmlXCombo.prototype.disable=function(t){t="undefined"==typeof t||window.dhx4.s2b(t),this.enable(!t)},dhtmlXCombo.prototype.isEnabled=function(){return 1==this.conf.enabled},dhtmlXCombo.prototype.show=function(t){t="undefined"==typeof t||window.dhx4.s2b(t),this.base.style.display=1==t?"":"none"},dhtmlXCombo.prototype.hide=function(t){"undefined"==typeof t&&(t=!0),this.show(!t)},dhtmlXCombo.prototype.isVisible=function(){return""==this.base.style.display},dhtmlXCombo.prototype.setFilterHandler=function(t){"function"==typeof t?(this.conf.f_func=t,this.conf.f_mode=!0,this.conf.f_dyn=this.conf.f_cache=this.conf.f_url=null):"string"==typeof t&&"function"==typeof window[t]?(this.conf.f_func=window[t],this.conf.f_mode=!0,this.conf.f_dyn=this.conf.f_cache=this.conf.f_url=null):this.conf.f_func=null},dhtmlXCombo.prototype.enableFilteringMode=function(t,e,i,s){1==t||"between"==t?(this.conf.f_mode=1==t?"start":"between",null!=e?(this.conf.f_url=e,this.conf.f_cache=window.dhx4.s2b(i),this.conf.f_dyn=window.dhx4.s2b(s)):(this.conf.f_url=null,this.conf.f_cache=!1,this.conf.f_dyn=!1)):(this.conf.f_mode=!1,this.conf.f_url=null,this.conf.f_cache=!1,this.conf.f_dyn=!1)},dhtmlXCombo.prototype.filter=function(t,e){for(var i=0;i<this.list.childNodes.length;i++){var s=t.apply(window,[this._getOption(this.list.childNodes[i]._optId,i)]);this.list.childNodes[i].style.display=s===!0?"":"none"}"undefined"!=typeof e&&1!=e||this._showList(!0)},dhtmlXCombo.prototype.sort=function(t){for(var e=[],i=0;i<this.list.childNodes.length;i++){var s=this.list.childNodes[i]._optId;e.push([s,this._getOption(s,i)])}for("asc"==t||"desc"==t?(k=!0,e.sort(function(e,i){e=e[1].text_option.toLowerCase(),i=i[1].text_option.toLowerCase();var s="asc"==t?1:-1;return e>i?s:-1*s})):"function"!=typeof t&&"function"!=typeof window[t]||("function"==typeof window[t]&&(t=window[t]),e.sort(function(e,i){return t.apply(window,[e[1],i[1]])}));this.list.childNodes.length>0;)this.list.removeChild(this.list.lastChild);for(var i=0;i<e.length;i++)this.list.appendChild(this.t[e[i][0]].item)},dhtmlXCombo.prototype.enableAutocomplete=function(t){t="undefined"==typeof t||window.dhx4.s2b(t),this.conf.f_ac=t},dhtmlXCombo.prototype.disableAutocomplete=function(t){t="undefined"==typeof t||window.dhx4.s2b(t),this.enableAutocomplete(!t)},dhtmlXCombo.prototype.allowFreeText=function(t,e){this.conf.allow_free_text="undefined"==typeof t||window.dhx4.s2b(t),this.conf.free_text_empty="undefined"!=typeof e&&window.dhx4.s2b(e)},dhtmlXCombo.prototype._checkForMatch=function(t){for(var e=window.dhx4.trim(this.base.firstChild.value).toLowerCase(),i=null,s=this.list.firstChild;null!=s;){if(""==s.style.display&&null!=s._optId){var l=window.dhx4.trim(this.t[s._optId].obj.getText(s,!0)).toLowerCase();e==l&&(i=s._optId,s=null)}null!=s&&(s=s.nextSibling)}null==this.conf.last_match?null!=i?(this._setSelected(i,!0,!0),this.conf.last_match=i):"between"==this.conf.f_mode&&1!=t||(this._setSelected(null,!0,!0),this.conf.last_match=null):null!=i?i!=this.conf.last_match&&(this._setSelected(i,!0,!0),this.conf.last_match=i):(this._setSelected(null,!0,!0),this.conf.last_match=null)},dhtmlXCombo.prototype._selectRange=function(t,e){1==this.conf.combo_focus&&window.dhx4.selectTextRange(this.base.firstChild,t,e)},dhtmlXCombo.prototype.openSelect=function(){this._isListVisible()||this._showList()},dhtmlXCombo.prototype.closeAll=function(){this._hideList()},dhtmlXCombo.prototype._showList=function(t){if(0==this._getListVisibleCount())return void(t&&this._isListVisible()&&this._hideList());if(this._isListVisible())return void this._checkListHeight();this.list.style.zIndex=window.dhx4.zim.reserve(this.conf.list_zi_id),null!=this.hdr&&1==this.conf.template.header&&(this.hdr.style.zIndex=Number(this.list.style.zIndex)+1),this.list.style.visibility="hidden",this.list.style.display="",null!=this.hdr&&1==this.conf.template.header&&(this.hdr.style.visibility=this.list.style.visibility,this.hdr.style.display=this.list.style.display);var e=null!=this.hdr&&1==this.conf.template.header?this.hdr.offsetHeight:0;this.list.style.width=Math.max(this.conf.opts_width||this.conf.col_w||0,this.conf.combo_width)+"px",this.list.style.top=window.dhx4.absTop(this.base)+e+this.base.offsetHeight-1+"px",this.list.style.left=window.dhx4.absLeft(this.base)+"px",null!=this.hdr&&1==this.conf.template.header&&(this.hdr.style.width=this.list.style.width,this.hdr.style.left=this.list.style.left,this.hdr.style.top=parseInt(this.list.style.top)-e+"px"),this._checkListHeight(),this.list.style.visibility="visible",null!=this.hdr&&1==this.conf.template.header&&(this.hdr.style.visibility="visible"),this.callEvent("onOpen",[])},dhtmlXCombo.prototype._hideList=function(){this._isListVisible()&&(window.dhx4.zim.clear(this.conf.list_zi_id),this.list.style.display="none",null!=this.hdr&&1==this.conf.template.header&&(this.hdr.style.display="none"),this.conf.clear_click=!1,this.callEvent("onClose",[]))},dhtmlXCombo.prototype._isListVisible=function(){return""==this.list.style.display},dhtmlXCombo.prototype._getListVisibleCount=function(){for(var t=0,e=0;e<this.list.childNodes.length;e++)t+=""==this.list.childNodes[e].style.display?1:0;return t},dhtmlXCombo.prototype._checkListHeight=function(){if(this._isListVisible()){if(null==this.conf.item_h){for(var t=this.list.firstChild;null!=t;)""==t.style.display?(this.conf.item_h=t.offsetHeight+(null!=this.hdr?-1:0),t=null):t=t.nextSibling;t=null}var e=window.dhx4.screenDim(),i=window.dhx4.absTop(this.base),s=this.base.offsetHeight,l=null!=this.hdr&&1==this.conf.template.header?this.hdr.offsetHeight:0,n=Math.max(0,Math.floor((i+l-e.top)/this.conf.item_h)),o=Math.max(0,Math.floor((e.bottom-(i+s+l))/this.conf.item_h)),r=this._getListVisibleCount();o<Math.min(this.conf.opts_count_min,r)&&n>o&&(o=null);var h=Math.min(null==o?n:o,this.conf.opts_count,r),a=h<r?h*this.conf.item_h+"px":"",d=this.conf.sp[this.conf.skin][null!=this.hdr&&1==this.conf.template.header?"hdr_ofs":"list_ofs"];this.list.style.height=a,this.list.style.top=(null==o?i-this.list.offsetHeight+d:i+s+l-d)+"px",null!=this.hdr&&1==this.conf.template.header&&(this.hdr.style.top=(null==o?i-l-this.list.offsetHeight+d:i+s-d)+"px")}},dhtmlXCombo.prototype._scrollToItem=function(t){var e=this.t[t].item.offsetTop,i=e+this.t[t].item.offsetHeight,s=this.list.scrollTop,l=s+this.list.clientHeight;e<s?this.list.scrollTop=e+(null!=this.hdr&&1==this.conf.template.header?1:0):i>l&&(this.list.scrollTop=i-this.list.clientHeight+(null!=this.hdr&&1==this.conf.template.header?-this.conf.sp[this.conf.skin].scr_ofs:0))},dhtmlXCombo.prototype._setSelected=function(t,e,i,s){return this.conf.temp_selected=null,i&&this._updateTopImage(t),null!=t&&this.conf.last_hover==t?void(e&&this._scrollToItem(t)):(null!=this.conf.last_hover&&(this.t[this.conf.last_hover].obj.setSelected(this.t[this.conf.last_hover].item,!1),this.conf.last_hover=null,null==t&&this.callEvent("onSelectionChange",[])),void(null!=t&&(this.t[t].obj.setSelected(this.t[t].item,!0),this.conf.last_hover=t,1!=s&&(this.conf.temp_selected=t,this.callEvent("onSelectionChange",[])),"select"==this.conf.s_mode&&this.t[t].item==this.t[t].item.parentNode.lastChild&&this._subloadRequest(),e&&this._scrollToItem(t))))},dhtmlXCombo.prototype._subloadRequest=function(){if(null!=this.conf.f_url&&1==this.conf.f_dyn&&0==this.conf.f_dyn_end){var t="mask="+encodeURIComponent(this.conf.f_mask)+"&pos="+this.list.childNodes.length,e=this,i=function(t){e.conf.f_cache&&e.conf.f_cache_data[e.conf.f_mask].data.push(t.xmlDoc.responseXML);var s=e.list.childNodes.length;e.conf.f_loading=!0,e.load(t.xmlDoc.responseXML),e.conf.f_loading=!1,s==e.list.childNodes.length&&(e.conf.f_dyn_end=!0,e.conf.f_cache&&(e.conf.f_cache_data[e.conf.f_mask].dyn_end=!0)),i=e=null};"post"==window.dhx4.ajax.method?window.dhx4.ajax.post(this.conf.f_url,t,i):"get"==window.dhx4.ajax.method&&window.dhx4.ajax.get(this.conf.f_url+(String(this.conf.f_url).indexOf("?")>=0?"&":"?")+t,i)}},dhtmlXCombo.prototype.addOption=function(t,e,i,s,l){var n=null;if(t instanceof Array){for(var o=0;o<t.length;o++)if("undefined"!=typeof t[o])if(t[o]instanceof Array)r=this._renderOption({value:t[o][0],text:t[o][1],css:t[o][2],img:t[o][3]}),null==n&&1==window.dhx4.s2b(t[o][4])&&(n=r);else{var r=this._renderOption(t[o]);null==n&&1==window.dhx4.s2b(t[o].selected)&&(n=r)}}else{var r=this._renderOption({value:t,text:e,css:i,img:s});null==n&&1==window.dhx4.s2b(l)&&(n=r)}null!=n&&(this._setSelected(n,this._isListVisible(),!0),this._confirmSelect("onInit"))},dhtmlXCombo.prototype.updateOption=function(t,e,i,s){var l=this._getOptionId(t);null!=l&&(this.t[l].obj.update(this.t[l].item,{value:e,text:i,css:s}),this.conf.last_selected==l&&(this.conf.last_text=this.base.firstChild.value=this.t[l].obj.getText(this.t[l].item,!0),this.conf.f_server_last=this.base.firstChild.value.toLowerCase()))},dhtmlXCombo.prototype.deleteOption=function(t){for(var e in this.t){var i=this.t[e].obj.getValue(this.t[e].item);i==t&&this._removeOption(e)}this._isListVisible()&&this._showList(!0)},dhtmlXCombo.prototype.clearAll=function(t){t="undefined"==typeof t||window.dhx4.s2b(t);for(var e in this.t)this._removeOption(e);this.conf.tm_hover&&window.clearTimeout(this.conf.tm_hover),this.conf.last_hover=null,this.conf.last_selected=null,this.list.scrollTop=0,1==t&&this._hideList()},dhtmlXCombo.prototype._renderOption=function(t){var e=window.dhx4.newId(),i=document.createElement("DIV");i._optId=e,i._tpl=this.conf.template,"undefined"==typeof t.img&&"undefined"!=typeof t.img_src&&(t.img=t.img_src,delete t.img_src),"undefined"==typeof t.img_dis&&"undefined"!=typeof t.img_src_dis&&(t.img_dis=t.img_src_dis,delete t.img_src_dis),t.img_path=this.conf.img_path,t.img_def=this.conf.img_def,t.img_def_dis=this.conf.img_def_dis,this.list.appendChild(i);var s=this._isListVisible()&&1==window.dhx4.isFF;if(1==s){this.list.scrollTop;this.list.scrollTop-=1}return null!=this.hdr&&(t.multicol=!0),this.t[i._optId]={obj:this.modes[this.conf.opts_type].render(i,t),item:i,conf:{type:this.conf.opts_type}},i=null,1==s&&(this.list.scrollTop+=1),e},dhtmlXCombo.prototype._removeOption=function(t){this.t[t].obj.destruct(this.t[t].item),this.t[t].obj=null,this.t[t].item.parentNode.removeChild(this.t[t].item),
this.t[t].item=null,this.t[t].conf=null,this.t[t]=null,delete this.t[t],this.conf.last_hover==t&&(this.conf.last_hover=null),this.conf.last_selected==t&&(this.conf.last_selected=null,this._confirmSelect("onDelete"))},dhtmlXCombo.prototype._confirmSelect=function(t,e){var i=!1;if("undefined"==typeof e&&(e=!0),this.conf.f_server_tm&&window.clearTimeout(this.conf.f_server_tm),null!=this.conf.last_hover)i=i||this.conf.last_value!=this._getOptionValue(this.conf.last_hover),this.conf.last_match=this.conf.last_selected=this.conf.last_hover,this.conf.last_value=this._getOptionValue(this.conf.last_selected),this.conf.last_text=this.base.firstChild.value=this.t[this.conf.last_selected].obj.getText(this.t[this.conf.last_selected].item,!0),this.conf.f_server_last=this.base.firstChild.value.toLowerCase(),this.base.childNodes[1].value=this.conf.last_value,this.base.childNodes[2].value="false";else{if(!(this.conf.allow_free_text||""==this.base.firstChild.value&&this.conf.allow_empty_value))return this._cancelSelect(!0),void this._updateTopImage(this.conf.last_selected);i=i||this.conf.last_text!=this.base.firstChild.value,this.conf.last_match=this.conf.last_value=this.conf.last_selected=null,this.conf.last_text=this.base.firstChild.value,this.conf.f_server_last=this.base.firstChild.value.toLowerCase(),this.base.childNodes[1].value=this.conf.last_text,this.base.childNodes[2].value="true"}this.conf.f_ac&&"start"==this.conf.f_mode&&(this.conf.f_ac_text="","blur"!=t&&this._selectRange(this.base.firstChild.value.length,this.base.firstChild.value.length)),e&&this._hideList(),1==i&&"onInit"!=t&&"onDelete"!=t&&(this.callEvent("onSelectionChange",[]),this.callEvent("onChange",[this.conf.last_value,this.conf.last_text]))},dhtmlXCombo.prototype._cancelSelect=function(t){this._hideList(),1==t&&0==this.conf.allow_free_text&&1==this.conf.free_text_empty?(this.conf.f_server_last=this.conf.last_match=this.conf.last_value=this.conf.last_selected=null,this.base.childNodes[1].value=this.conf.last_text=this.base.firstChild.value="",this.base.childNodes[2].value="false"):this.base.firstChild.value=this.conf.last_text,0!=this.conf.f_mode&&this._filterOpts(!0)},dhtmlXCombo.prototype._getOption=function(t,e){if(!this.t[t])return null;if("undefined"==typeof e&&(e=-1),e<0)for(var i=0;i<this.list.childNodes.length;i++)e<0&&this.list.childNodes[i]._optId==t&&(e=i);var s={value:this.t[t].obj.getValue(this.t[t].item),text:this.t[t].obj.getText(this.t[t].item),text_input:this.t[t].obj.getText(this.t[t].item,!0),text_option:this.t[t].obj.getText(this.t[t].item,null,!0),css:this.t[t].obj.getCss(this.t[t].item),selected:t==this.conf.last_selected,index:e};if("function"==typeof this.t[t].obj.getExtraData){var l=this.t[t].obj.getExtraData(this.t[t].item);for(var n in l)"undefined"==typeof s[n]&&(s[n]=l[n])}return s},dhtmlXCombo.prototype._getOptionProp=function(t,e,i){if(null!=t){var s=this._getOption(t);if(null!=s)return s[e]}return i},dhtmlXCombo.prototype._getOptionId=function(t){for(var e=null,i=0;i<this.list.childNodes.length;i++)if(null==e){var s=this.list.childNodes[i]._optId;t==this.t[s].obj.getValue(this.t[s].item)&&(e=s)}return e},dhtmlXCombo.prototype._getOptionValue=function(t){return this._getOptionProp(t,"value",null)},dhtmlXCombo.prototype.setSize=function(t){this.conf.combo_width=parseInt(t)-(dhx4.isFF||dhx4.isIE||dhx4.isChrome||dhx4.isOpera?2:0),this.base.style.width=Math.max(0,this.conf.combo_width)+"px",this._adjustBase()},dhtmlXCombo.prototype._adjustBase=function(){this.base.firstChild.style.width=Math.max(0,this.conf.combo_width-24-(this.conf.combo_image?23:0))+"px",this.base.firstChild.style.marginLeft=this.conf.combo_image?"23px":"0px"},dhtmlXCombo.prototype.setOptionWidth=function(t){this.conf.opts_width=parseInt(t)||null},dhtmlXCombo.prototype.setOptionIndex=function(t,e){if(!(isNaN(e)||e<0)){var i=this.getOption(t);if(null!=i&&e!=i.index){var s=this.list.childNodes[i.index];s.parentNode.removeChild(s),null!=this.list.childNodes[e]?this.list.insertBefore(s,this.list.childNodes[e]):this.list.appendChild(s),s=null}}},dhtmlXCombo.prototype.getOptionsCount=function(){return this.list.childNodes.length},dhtmlXCombo.prototype._mcMakeTemplate=function(t){var e="",i="";this.conf.col_w=0;for(var s=0;s<t.length;s++){var l=Number(parseInt(t[s].width)||50),n=t[s].css||"",o=0==s&&1==window.dhx4.isIE6?"_first":"";i+="<div class='dhxcombo_cell"+o+" "+n+"' style='width:"+l+"px;'><div class='dhxcombo_cell_text'>"+(t[s].option||"&nbsp;")+"</div></div>",e+="<div class='dhxcombo_hdrcell"+o+" "+n+"' style='width:"+l+"px;'><div class='dhxcombo_hdrcell_text'>"+(t[s].header||"&nbsp;")+"</div></div>",this.conf.col_w+=l+1}var l=500,r=document.createElement("DIV");r.style.position="absolute",r.style.top="10px",r.style.left=2*-l+"px",r.style.width=l+"px",r.style.height="50px",r.style.overflowY="scroll",r.innerHTML="<div>&nbsp;</div>",document.body.appendChild(r),this.conf.col_w+=l-r.firstChild.offsetWidth+10,r.parentNode.removeChild(r),r=null,this.conf.template.option=i,this._mcAttachHeader(e),this.list.className+=" dhxcombolist_multicolumn"},dhtmlXCombo.prototype._mcAttachHeader=function(t){null==this.hdr&&(this.hdr=document.createElement("DIV"),this.hdr.className="dhxcombolist_"+this.conf.skin+" dhxcombolist_hdr",this.hdr.style.display="none",this.list.parentNode.insertBefore(this.hdr,this.list),"function"==typeof window.addEventListener?this.hdr.addEventListener("mousedown",this._doOnListMouseDown,!1):this.hdr.attachEvent("onmousedown",this._doOnListMouseDown),"checkbox"==this.conf.opts_type&&1==this.conf.combo_image&&(this.conf.combo_image=!1,null!=this.base.lastChild.className.match(/dhxcombo_top_image/)&&this.base.removeChild(this.base.lastChild),this._adjustBase())),this.hdr.innerHTML="<div class='dhxcombo_hdrtext'>"+t+"</div>"},dhtmlXCombo.prototype._mcDetachHeader=function(){null!=this.hdr&&("function"==typeof window.addEventListener?this.hdr.removeEventListener("mousedown",this._doOnListMouseDown,!1):this.hdr.detachEvent("onmousedown",this._doOnListMouseDown),this.hdr.parentNode.removeChild(this.hdr),this.hdr=null),this.conf.col_w=null,this.conf.item_h=null},dhtmlXCombo.prototype.modes={},dhtmlXCombo.prototype.doWithItem=function(t,e,i,s){var l=t>=0&&t<this.list.childNodes.length?this.list.childNodes[t]._optId:null;if(null==l)return null;if("function"!=typeof this.t[l].obj[e])return null;for(var n=[this.t[l].item],o=2;o<arguments.length;o++)n.push(arguments[o]);return this.t[l].obj[e].apply(this.t[l].obj,n)},dhtmlXCombo.prototype.modes.option={image:!1,html:!1,option_css:"dhxcombo_option_text",render:function(t,e){return t._conf={value:e.value,css:""},t.className="dhxcombo_option",t.innerHTML="<div class='"+this.option_css+"'>&nbsp;</div>",null!=e.css&&(t.lastChild.style.cssText=e.css,t._conf.css=e.css),this.setText(t,e.text),this},destruct:function(t){t._conf=null},update:function(t,e){t._conf.value=e.value,t._conf.css=e.css,t.lastChild.style.cssText=e.css,this.setText(t,e.text)},setText:function(t,e){t._conf.text=e;var i="object"==typeof e?window.dhx4.template(t._tpl.option,this.replaceHtml(t._conf.text),!0):window.dhx4.trim(this.replaceHtml(t._conf.text)||"");t.lastChild.innerHTML=0==i.length?"&nbsp;":i},getText:function(t,e,i){return window.dhx4.s2b(e)&&"object"==typeof t._conf.text?window.dhx4.template(t._tpl.input,t._conf.text,!0):window.dhx4.s2b(i)&&"object"==typeof t._conf.text?window.dhx4.template(t._tpl.option,t._conf.text,!0):t._conf.text},getValue:function(t){return t._conf.value},getCss:function(t){return t._conf.css},setSelected:function(t,e){t.className="dhxcombo_option"+(e?" dhxcombo_option_selected":"")},isSelected:function(t){return String(t.className).indexOf("dhxcombo_option_selected")>=0},getExtraData:function(t){return{type:"option"}},replaceHtml:function(t){if(1==this.html)return t;if("object"==typeof t){var e={};for(var i in t)e[i]=this.replaceHtml(t[i])}else var e=t.replace(/[\<\>\&\s]/g,function(t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case" ":return"&nbsp;"}return t});return e}},dhtmlXCombo.prototype.modes.checkbox={image:!0,html:!0,image_css:"dhxcombo_checkbox dhxcombo_chbx_#state#",option_css:"dhxcombo_option_text dhxcombo_option_text_chbx",render:function(t,e){return null==this.image_css_regexp&&(this.image_css_regexp=new RegExp(this.image_css.replace("#state#","\\d*"))),t._conf={value:e.value,css:"",checked:window.dhx4.s2b(e.checked)},t.className="dhxcombo_option",1==e.multicol?(e.text.checkbox="<div class='"+String(this.image_css).replace("#state#",t._conf.checked?"1":"0")+"'></div>&nbsp;",t.innerHTML="<div class='"+dhtmlXCombo.prototype.modes.option.option_css+"'></div>"):t.innerHTML="<div class='"+String(this.image_css).replace("#state#",t._conf.checked?"1":"0")+"'></div><div class='"+this.option_css+"'>&nbsp;</div>",null!=e.css&&(t.lastChild.style.cssText+=e.css,t._conf.css=e.css),this.setText(t,e.text),this},setChecked:function(t,e){t._conf.checked=window.dhx4.s2b(e);var i=String(this.image_css).replace("#state#",t._conf.checked?"1":"0");this._changeChbxCss(t.childNodes,i)},_changeChbxCss:function(t,e){for(var i=0;i<t.length;i++)null!=t[i].tagName&&null!=t[i].className&&null!=t[i].className.match(this.image_css_regexp)?t[i].className=e:t[i].childNodes.length>0&&this._changeChbxCss(t[i].childNodes,e)},isChecked:function(t){return 1==t._conf.checked},getExtraData:function(t){return{type:"checkbox",checked:t._conf.checked}},optionClick:function(t,e,i){for(var s=!0,l=e.target||e.srcElement;1==s&&null!=l&&l!=t&&null!=l.className;)if(null!=l.className.match(this.image_css_regexp)){var n=[t._conf.value,!t._conf.checked];i.callEvent("onBeforeCheck",n)===!0&&(this.setChecked(t,!this.isChecked(t)),i.callEvent("onCheck",n)),s=!1,n=null}else l=l.parentNode;return l=i=t=null,s},getTopImage:function(t,e){return""},topImageClick:function(t,e){return!0}},dhtmlXComboExtend("checkbox","option"),dhtmlXCombo.prototype.setChecked=function(t,e){this.doWithItem(t,"setChecked",e)},dhtmlXCombo.prototype.getChecked=function(t){for(var e=[],i=0;i<this.list.childNodes.length;i++)this.isChecked(i)&&e.push(this._getOptionProp(this.list.childNodes[i]._optId,"value",""));return e},dhtmlXCombo.prototype.isChecked=function(t){return this.doWithItem(t,"isChecked")},dhtmlXCombo.prototype.modes.image={image:!0,html:!0,image_css:"dhxcombo_image",option_css:"dhxcombo_option_text dhxcombo_option_text_image",render:function(t,e){return t._conf={value:e.value,css:""},t.className="dhxcombo_option",t.innerHTML="<div class='"+this.image_css+"'></div><div class='"+this.option_css+"'>&nbsp;</div>",null!=e.css&&(t.lastChild.style.cssText+=e.css,t._conf.css=e.css),this.setText(t,e.text),this.setImage(t,e.img,e.img_dis,e.img_path,e.img_def,e.img_def_dis),this},update:function(t,e){t._conf.value=e.value,t._conf.css=e.css,t.lastChild.style.cssText=e.css,this.setText(t,e.text),this.setImage(t,e.img,e.img_dis,e.img_path,e.img_def,e.img_def_dis)},setImage:function(t,e,i,s,l,n){e=null!=e&&e.length>0?s+e:null!=l&&l.length>0?s+l:null,i=null!=i&&i.length>0?s+i:null!=n&&n.length>0?s+n:1==n?e:null,t._conf.img=e,t._conf.img_dis=i,t.firstChild.style.backgroundImage=null!=e?"url("+e+")":"none"},getExtraData:function(t){return{type:"image"}},getTopImage:function(t,e){var i=e?"img":"img_dis";return null!=t&&null!=t._conf[i]?"<div class='"+this.image_css+"' style='background-image:url("+t._conf[i]+");'></div>":""}},dhtmlXComboExtend("image","option"),dhtmlXCombo.prototype.setDefaultImage=function(t,e){null!=t&&(this.conf.img_def=t),null!=e&&(this.conf.img_def_dis=e)},dhtmlXCombo.prototype.setImagePath=function(t){this.conf.img_path=t},dhtmlXMenuObject.prototype._init=function(){1!=this._isInited&&(this.conf.dload?(this._dhxdataload.onBeforeXLS=function(){var t={params:{}};for(var e in this.conf.dload_params)t.params[e]=this.conf.dload_params[e];return t},this.loadStruct(this.conf.dload_url)):(this._initTopLevelMenu(),this._isInited=!0))},dhtmlXMenuObject.prototype._countVisiblePolygonItems=function(t){var e=0;for(var i in this.itemPull){var s=this.itemPull[i].parent,l=this.itemPull[i].type;null!=this.idPull[i]&&(s!=t||"item"!=l&&"radio"!=l&&"checkbox"!=l||"none"==this.idPull[i].style.display||e++)}return e},dhtmlXMenuObject.prototype._redefineComplexState=function(t){if(this.idPrefix+this.topId!=t&&null!=this.idPull["polygon_"+t]&&null!=this.idPull[t]){var e=this._countVisiblePolygonItems(t);e>0&&!this.itemPull[t].complex&&this._updateItemComplexState(t,!0,!1),0==e&&this.itemPull[t].complex&&this._updateItemComplexState(t,!1,!1)}},dhtmlXMenuObject.prototype._updateItemComplexState=function(t,e,i){if(!this.conf.context&&"TopLevel"==this._getItemLevelType(t.replace(this.idPrefix,"")))return void(this.itemPull[t].complex=e);if(null!=this.idPull[t]&&null!=this.itemPull[t]&&(this.itemPull[t].complex=e,t!=this.idPrefix+this.topId)){var s=null,l=this.idPull[t].childNodes[this.conf.rtl?0:2];if(l.childNodes[0]&&0===String(l.childNodes[0].className).search("complex_arrow")&&(s=l.childNodes[0]),this.itemPull[t].complex){if(null==s){for(s=document.createElement("DIV"),s.className="complex_arrow",s.id="arrow_"+t;l.childNodes.length>0;)l.removeChild(l.childNodes[0]);l.appendChild(s)}return void(this.conf.dload&&"get"==this.itemPull[t].loaded&&this.conf.dload_icon?"complex_arrow_loading"!=s.className&&(s.className="complex_arrow_loading"):s.className="complex_arrow")}this.itemPull[t].complex||null==s||(l.removeChild(s),null!=this.itemPull[t].hotkey_backup&&this.setHotKey&&this.setHotKey(t.replace(this.idPrefix,""),this.itemPull[t].hotkey_backup))}},dhtmlXMenuObject.prototype._getItemLevelType=function(t){return this.itemPull[this.idPrefix+t].parent==this.idPrefix+this.topId?"TopLevel":"SubLevelArea"},dhtmlXMenuObject.prototype.setIconsPath=function(t){this.conf.icons_path=t},dhtmlXMenuObject.prototype._updateItemImage=function(t,e){t=this.idPrefix+t;var i=this.itemPull[t].type;if("checkbox"!=i&&"radio"!=i){var s=this.itemPull[t].parent==this.idPrefix+this.topId&&!this.conf.context,l=null;if(s)for(var n=0;n<this.idPull[t].childNodes.length;n++)try{"dhtmlxMenu_TopLevel_Item_Icon"==this.idPull[t].childNodes[n].className&&(l=this.idPull[t].childNodes[n])}catch(t){}else{try{var l=this.idPull[t].childNodes[this.conf.rtl?2:0].childNodes[0]}catch(t){}null!=l&&"undefined"!=typeof l.className&&"sub_icon"==l.className||(l=null)}var o=this.itemPull[t]["enabled"==this.itemPull[t].state?"imgen":"imgdis"];if(o.length>0)if(null!=l)l.src=this.conf.icons_path+o;else if(s){var l=document.createElement("IMG");l.className="dhtmlxMenu_TopLevel_Item_Icon",l.src=this.conf.icons_path+o,l.border="0",l.id="image_"+t,!this.conf.rtl&&this.idPull[t].childNodes.length>0?this.idPull[t].insertBefore(l,this.idPull[t].childNodes[0]):this.idPull[t].appendChild(l)}else{var l=document.createElement("IMG");l.className="sub_icon",l.src=this.conf.icons_path+o,l.border="0",l.id="image_"+t;for(var r=this.idPull[t].childNodes[this.conf.rtl?2:0];r.childNodes.length>0;)r.removeChild(r.childNodes[0]);r.appendChild(l)}else if(null!=l){var h=l.parentNode;h.removeChild(l),h.innerHTML="&nbsp;",h=l=null}}},dhtmlXMenuObject.prototype._getAllParents=function(t){var e=new Array;for(var i in this.itemPull)if(this.itemPull[i].parent==t&&(e[e.length]=this.itemPull[i].id,this.itemPull[i].complex))for(var s=this._getAllParents(this.itemPull[i].id),l=0;l<s.length;l++)e[e.length]=s[l];return e},dhtmlXMenuObject.prototype._autoDetectVisibleArea=function(){if(!this.conf.v_enabled){var t=window.dhx4.screenDim();this.conf.v.x1=t.left,this.conf.v.x2=t.right,this.conf.v.y1=t.top,this.conf.v.y2=t.bottom}},dhtmlXMenuObject.prototype.getItemPosition=function(t){t=this.idPrefix+t;var e=-1;if(null==this.itemPull[t])return e;for(var i=this.itemPull[t].parent,s=null!=this.idPull["polygon_"+i]?this.idPull["polygon_"+i].tbd:this.cont,l=0;l<s.childNodes.length;l++)s.childNodes[l]!=this.idPull["separator_"+t]&&s.childNodes[l]!=this.idPull[t]||(e=l);return e},dhtmlXMenuObject.prototype.setItemPosition=function(t,e){if(t=this.idPrefix+t,null!=this.idPull[t]){var i=this.itemPull[t].parent==this.idPrefix+this.topId,s=this.idPull[t],l=this.getItemPosition(t.replace(this.idPrefix,"")),n=this.itemPull[t].parent,o=null!=this.idPull["polygon_"+n]?this.idPull["polygon_"+n].tbd:this.cont;o.removeChild(o.childNodes[l]),e<0&&(e=0),i&&e<1&&(e=1),e<o.childNodes.length?o.insertBefore(s,o.childNodes[e]):o.appendChild(s)}},dhtmlXMenuObject.prototype.getParentId=function(t){return t=this.idPrefix+t,null==this.itemPull[t]?null:(null!=this.itemPull[t].parent?this.itemPull[t].parent:this.topId).replace(this.idPrefix,"")},dhtmlXMenuObject.prototype.hide=function(){this._clearAndHide()},dhtmlXMenuObject.prototype.clearAll=function(){this.removeItem(this.idPrefix+this.topId,!0),this._isInited=!1,this.idPrefix=this._genStr(12)+"_",this.itemPull={}},"undefined"==typeof dhtmlXMenuObject.prototype.liveInst&&(dhtmlXMenuObject.prototype.liveInst={}),dhtmlXMenuObject.prototype._redistribTopLevelSelection=function(t,e){var i=this._getSubItemToDeselectByPolygon("parent");this._removeSubItemFromSelected(-1,-1);for(var s=0;s<i.length;s++)i[s]!=t&&this._hidePolygon(i[s]),null!=this.idPull[i[s]]&&i[s]!=t&&(this.idPull[i[s]].className=this.idPull[i[s]].className.replace(/Selected/g,"Normal"));"enabled"==this.itemPull[this.idPrefix+t].state&&(this.idPull[this.idPrefix+t].className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_Selected",this._addSubItemToSelected(this.idPrefix+t,"parent"),this.conf.selected="win"==this.conf.mode?this.conf.selected!=-1?t:this.conf.selected:t,this.itemPull[this.idPrefix+t].complex&&this.conf.selected!=-1&&this._showPolygon(this.idPrefix+t,this.conf.dir_toplv))},dhtmlXMenuObject.prototype._initTopLevelMenu=function(){if(this.conf.dir_toplv="bottom",this.conf.dir_sublv=this.conf.rtl?"left":"right",this.conf.context)this.idPull[this.idPrefix+this.topId]=new Array(0,0),this._addSubMenuPolygon(this.idPrefix+this.topId,this.idPrefix+this.topId);else for(var t=this._getMenuNodes(this.idPrefix+this.topId),e=0;e<t.length;e++)"item"==this.itemPull[t[e]].type&&this._renderToplevelItem(t[e],null),"separator"==this.itemPull[t[e]].type&&this._renderSeparator(t[e],null)},dhtmlXMenuObject.prototype._renderToplevelItem=function(t,e){var i=this,s=document.createElement("DIV");if(s.id=t,"enabled"==this.itemPull[t].state&&null!=this.itemPull[t].cssNormal?s.className=this.itemPull[t].cssNormal:s.className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_"+("enabled"==this.itemPull[t].state?"Normal":"Disabled"),""!=this.itemPull[t].title){var l=document.createElement("DIV");l.className="top_level_text",l.innerHTML=this.itemPull[t].title,s.appendChild(l)}if(this.itemPull[t].tip.length>0&&(s.title=this.itemPull[t].tip),""!=this.itemPull[t].imgen||""!=this.itemPull[t].imgdis){var n=this.itemPull[t]["enabled"==this.itemPull[t].state?"imgen":"imgdis"];if(n){var o=document.createElement("IMG");o.border="0",o.id="image_"+t,o.src=this.conf.icons_path+n,o.className="dhtmlxMenu_TopLevel_Item_Icon",s.childNodes.length>0&&!this.conf.rtl?s.insertBefore(o,s.childNodes[0]):s.appendChild(o)}}s.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},s.oncontextmenu=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},this.cont||(this.cont=document.createElement("DIV"),this.cont.dir="ltr",this.cont.className="right"==this.conf.align?"align_right":"align_left",this.base.appendChild(this.cont)),null!=e&&(e++,e<0&&(e=0),e>this.cont.childNodes.length-1&&(e=null)),null!=e?this.cont.insertBefore(s,this.cont.childNodes[e]):this.cont.appendChild(s),this.idPull[s.id]=s,this.itemPull[t].complex&&!this.conf.dload&&this._addSubMenuPolygon(this.itemPull[t].id,this.itemPull[t].id),s.onmouseover=function(){"web"==i.conf.mode&&window.clearTimeout(i.conf.tm_handler);var t=i._getSubItemToDeselectByPolygon("parent");i._removeSubItemFromSelected(-1,-1);for(var e=0;e<t.length;e++)t[e]!=this.id&&i._hidePolygon(t[e]),null!=i.idPull[t[e]]&&t[e]!=this.id&&(null!=i.itemPull[t[e]].cssNormal?i.idPull[t[e]].className=i.itemPull[t[e]].cssNormal:("sub_item_selected"==i.idPull[t[e]].className&&(i.idPull[t[e]].className="sub_item"),i.idPull[t[e]].className=i.idPull[t[e]].className.replace(/Selected/g,"Normal")));if("enabled"==i.itemPull[this.id].state){if(this.className="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Selected",i._addSubItemToSelected(this.id,"parent"),i.conf.selected="win"==i.conf.mode?i.conf.selected!=-1?this.id:i.conf.selected:this.id,i.conf.dload){if("no"==i.itemPull[this.id].loaded){this._dynLoadTM=(new Date).getTime(),i.itemPull[this.id].loaded="get";var s=this.id.replace(i.idPrefix,"");i._dhxdataload.onBeforeXLS=function(){var t={params:{}};t.params[this.conf.dload_pid]=s;for(var e in this.conf.dload_params)t.params[e]=this.conf.dload_params[e];return t},i.loadStruct(i.conf.dload_url)}i.conf.top_mode&&"web"==i.conf.mode&&!i.conf.context&&(this._mouseOver=!0)}if((!i.conf.dload||i.conf.dload&&(!i.itemPull[this.id].loaded||"yes"==i.itemPull[this.id].loaded))&&i.itemPull[this.id].complex&&i.conf.selected!=-1)if(i.conf.top_mode&&"web"==i.conf.mode&&!i.conf.context){this._mouseOver=!0;var l=this.id;this._menuOpenTM=window.setTimeout(function(){i._showPolygon(l,i.conf.dir_toplv)},i.conf.top_tmtime)}else i._showPolygon(this.id,i.conf.dir_toplv)}i._doOnTouchMenu(this.id.replace(i.idPrefix,""))},s.onmouseout=function(){i.itemPull[this.id].complex&&i.conf.selected!=-1||"enabled"!=i.itemPull[this.id].state||(null!=i.itemPull[this.id].cssNormal?s.className=i.itemPull[this.id].cssNormal:s.className="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Normal"),"web"==i.conf.mode&&(window.clearTimeout(i.conf.tm_handler),i.conf.tm_handler=window.setTimeout(function(){i._clearAndHide()},i.conf.tm_sec,"JavaScript")),i.conf.top_mode&&"web"==i.conf.mode&&!i.conf.context&&(this._mouseOver=!1,window.clearTimeout(this._menuOpenTM))},s.onclick=function(t){if("web"==i.conf.mode&&window.clearTimeout(i.conf.tm_handler),"web"==i.conf.mode||"disabled"!=i.itemPull[this.id].state){if(t=t||event,t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,"win"==i.conf.mode&&i.itemPull[this.id].complex){if(i.conf.selected==this.id){i.conf.selected=-1;var e=!1}else{i.conf.selected=this.id;var e=!0}e?i._showPolygon(this.id,i.conf.dir_toplv):i._hidePolygon(this.id)}var s=i.itemPull[this.id].complex?"c":"-",l="enabled"!=i.itemPull[this.id].state?"d":"-",n={ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey};return i._doOnClick(this.id.replace(i.idPrefix,""),s+l+"t",n),!1}},"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXMenuObject.prototype._addSubMenuPolygon=function(t,e){var i=(this._renderSublevelPolygon(t,e),this._getMenuNodes(e));for(s=0;s<i.length;s++)"separator"==this.itemPull[i[s]].type?this._renderSeparator(i[s],null):this._renderSublevelItem(i[s],null);if(t==e);else;for(var s=0;s<i.length;s++)this.itemPull[i[s]].complex&&this._addSubMenuPolygon(t,this.itemPull[i[s]].id)},dhtmlXMenuObject.prototype._renderSublevelPolygon=function(t,e){var i=document.createElement("DIV");i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_Polygon "+(this.conf.rtl?"dir_right":""),i.dir="ltr",i.oncontextmenu=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1},i.id="polygon_"+e,i.onclick=function(t){t=t||event,t.cancelBubble=!0},i.style.display="none",document.body.insertBefore(i,document.body.firstChild),i.innerHTML='<div style="position:relative;"></div><div style="position: relative; overflow:hidden;"></div><div style="position:relative;"></div>';var s=document.createElement("TABLE");s.className="dhtmlxMebu_SubLevelArea_Tbl",s.cellSpacing=0,s.cellPadding=0,s.border=0;var l=document.createElement("TBODY");return s.appendChild(l),i.childNodes[1].appendChild(s),i.tbl=s,i.tbd=l,this.idPull[i.id]=i,null!=this.sxDacProc&&(this.idPull["sxDac_"+e]=new this.sxDacProc(i,i.className),window.dhx4.isIE?(this.idPull["sxDac_"+e]._setSpeed(this.dacSpeedIE),this.idPull["sxDac_"+e]._setCustomCycle(this.dacCyclesIE)):(this.idPull["sxDac_"+e]._setSpeed(this.dacSpeed),this.idPull["sxDac_"+e]._setCustomCycle(this.dacCycles))),i},dhtmlXMenuObject.prototype._renderSublevelItem=function(t,e){var i=this,s=document.createElement("TR");s.className="enabled"==this.itemPull[t].state?"sub_item":"sub_item_dis";var l=document.createElement("TD");l.className="sub_item_icon";var n=this.itemPull[t]["enabled"==this.itemPull[t].state?"imgen":"imgdis"];if(""!=n){var o=this.itemPull[t].type;if("checkbox"==o||"radio"==o){var r=document.createElement("DIV");r.id="image_"+this.itemPull[t].id,r.className="sub_icon "+n,l.appendChild(r)}if("checkbox"!=o&&"radio"!=o){var r=document.createElement("IMG");r.id="image_"+this.itemPull[t].id,r.className="sub_icon",r.src=this.conf.icons_path+n,l.appendChild(r)}}else l.innerHTML="&nbsp;";var h=document.createElement("TD");if(h.className="sub_item_text",""!=this.itemPull[t].title){var a=document.createElement("DIV");a.className="sub_item_text",a.innerHTML=this.itemPull[t].title,h.appendChild(a)}else h.innerHTML="&nbsp;";var d=document.createElement("TD");if(d.className="sub_item_hk",this.itemPull[t].complex){var c=document.createElement("DIV");c.className="complex_arrow",c.id="arrow_"+this.itemPull[t].id,d.appendChild(c)}else if(this.itemPull[t].hotkey.length>0&&!this.itemPull[t].complex){var u=document.createElement("DIV");u.className="sub_item_hk",u.innerHTML=this.itemPull[t].hotkey,d.appendChild(u)}else d.innerHTML="&nbsp;";s.appendChild(this.conf.rtl?d:l),s.appendChild(h),s.appendChild(this.conf.rtl?l:d),s.id=this.itemPull[t].id,s.parent=this.itemPull[t].parent,this.itemPull[t].tip.length>0&&(s.title=this.itemPull[t].tip),s.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},s.onmouseover=function(t){i.conf.hide_tm[this.id]&&window.clearTimeout(i.conf.hide_tm[this.id]),"web"==i.conf.mode&&window.clearTimeout(i.conf.tm_handler),this._visible||i._redistribSubLevelSelection(this.id,this.parent),this._visible=!0},s.onmouseout=function(){"web"==i.conf.mode&&(i.conf.tm_handler&&window.clearTimeout(i.conf.tm_handler),i.conf.tm_handler=window.setTimeout(function(){i&&i._clearAndHide&&i._clearAndHide()},i.conf.tm_sec,"JavaScript"));var t=this;i.conf.hide_tm[this.id]&&window.clearTimeout(i.conf.hide_tm[this.id]),i.conf.hide_tm[this.id]=window.setTimeout(function(){t._visible=!1},50)},s.onclick=function(t){if(i.checkEvent("onClick")||!i.itemPull[this.id].complex){t=t||event,t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,tc=i.itemPull[this.id].complex?"c":"-",td="enabled"==i.itemPull[this.id].state?"-":"d";var e={ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey};switch(i.itemPull[this.id].type){case"checkbox":i._checkboxOnClickHandler(this.id.replace(i.idPrefix,""),tc+td+"n",e);break;case"radio":i._radioOnClickHandler(this.id.replace(i.idPrefix,""),tc+td+"n",e);break;case"item":i._doOnClick(this.id.replace(i.idPrefix,""),tc+td+"n",e)}return!1}};var f=this.idPull["polygon_"+this.itemPull[t].parent];null!=e&&(e++,e<0&&(e=0),e>f.tbd.childNodes.length-1&&(e=null)),null!=e&&null!=f.tbd.childNodes[e]?f.tbd.insertBefore(s,f.tbd.childNodes[e]):f.tbd.appendChild(s),this.idPull[s.id]=s},dhtmlXMenuObject.prototype._renderSeparator=function(t,e){var i=this.conf.context?"SubLevelArea":this.itemPull[t].parent==this.idPrefix+this.topId?"TopLevel":"SubLevelArea";if("TopLevel"!=i||!this.conf.context){var s=this;if("TopLevel"!=i){var l=document.createElement("TR");l.className="sub_sep";var n=document.createElement("TD");n.colSpan="3",l.appendChild(n)}var o=document.createElement("DIV");if(o.id="separator_"+t,o.className="TopLevel"==i?"top_sep":"sub_sep",o.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},o.onclick=function(t){t=t||event,t.cancelBubble=!0;var e={ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey};s._doOnClick(this.id.replace("separator_"+s.idPrefix,""),"--s",e)},"TopLevel"==i){if(null!=e)e++,e<0&&(e=0),null!=this.cont.childNodes[e]?this.cont.insertBefore(o,this.cont.childNodes[e]):this.cont.appendChild(o);else{var r=this.cont.childNodes[this.cont.childNodes.length-1];String(r).search("TopLevel_Text")==-1?this.cont.appendChild(o):this.cont.insertBefore(o,r)}this.idPull[o.id]=o}else{var h=this.idPull["polygon_"+this.itemPull[t].parent];null!=e&&(e++,e<0&&(e=0),e>h.tbd.childNodes.length-1&&(e=null)),null!=e&&null!=h.tbd.childNodes[e]?h.tbd.insertBefore(l,h.tbd.childNodes[e]):h.tbd.appendChild(l),n.appendChild(o),this.idPull[o.id]=l}}},dhtmlXMenuObject.prototype.addNewSeparator=function(t,e){e=this.idPrefix+(null!=e?e:this._genStr(24));var i=this.idPrefix+this.getParentId(t);this._addItemIntoGlobalStrorage(e,i,"","separator",!1,"",""),this._renderSeparator(e,this.getItemPosition(t))},dhtmlXMenuObject.prototype._initObj=function(t,e,i){t instanceof Array||(i=t.parentId,null!=i&&0!==String(i).indexOf(this.idPrefix)&&(i=this.idPrefix+String(i)),t=t.items);for(var s=0;s<t.length;s++){"undefined"!=typeof t[s].id&&null!=t[s].id||(t[s].id=this._genStr(24)),null==t[s].text&&(t[s].text=""),0!==String(t[s].id).indexOf(this.idPrefix)&&(t[s].id=this.idPrefix+String(t[s].id));var l={type:"item",tip:"",hotkey:"",state:"enabled",imgen:"",imgdis:""};for(var n in l)"undefined"==typeof t[s][n]&&(t[s][n]=l[n]);if(""==t[s].imgen&&null!=t[s].img&&(t[s].imgen=t[s].img),""==t[s].imgdis&&null!=t[s].img_disabled&&(t[s].imgdis=t[s].img_disabled),null==t[s].title&&null!=t[s].text&&(t[s].title=t[s].text),null!=t[s].href&&(null!=t[s].href.link&&(t[s].href_link=t[s].href.link),null!=t[s].href.target&&(t[s].href_target=t[s].href.target)),null!=t[s].userdata)for(var n in t[s].userdata)this.userData[t[s].id+"_"+n]=t[s].userdata[n];"undefined"!=typeof t[s].enabled&&0==window.dhx4.s2b(t[s].enabled)?t[s].state="disabled":"undefined"!=typeof t[s].disabled&&1==window.dhx4.s2b(t[s].disabled)&&(t[s].state="disabled"),"undefined"==typeof t[s].parent&&(t[s].parent=null!=i?i:this.idPrefix+this.topId),"checkbox"==t[s].type&&(t[s].checked=window.dhx4.s2b(t[s].checked),t[s].imgen=t[s].imgdis="chbx_"+(t[s].checked?"1":"0")),"radio"==t[s].type&&(t[s].checked=window.dhx4.s2b(t[s].checked),t[s].imgen=t[s].imgdis="rdbt_"+(t[s].checked?"1":"0"),"undefined"!=typeof t[s].group&&null!=t[s].group||(t[s].group=this._genStr(24)),null==this.radio[t[s].group]&&(this.radio[t[s].group]=[]),this.radio[t[s].group].push(t[s].id)),this.itemPull[t[s].id]=t[s],null!=t[s].items&&t[s].items.length>0?(this.itemPull[t[s].id].complex=!0,this._initObj(t[s].items,!0,t[s].id)):this.conf.dload&&1==t[s].complex&&(this.itemPull[t[s].id].loaded="no"),this.itemPull[t[s].id].items=null}if(e!==!0)if(1==this.conf.dload)if(null==i)this._initTopLevelMenu();else{if(this._addSubMenuPolygon(i,i),this.conf.selected==i){var o=this.itemPull[i].parent==this.idPrefix+this.topId,r=o&&!this.conf.context?this.conf.dir_toplv:this.conf.dir_sublv,h=!1;if(o&&this.conf.top_mode&&"web"==this.conf.mode&&!this.conf.context){var a=this.idPull[i];if(1==a._mouseOver){var d=this.conf.top_tmtime-((new Date).getTime()-a._dynLoadTM);if(d>1){var c=i,u=this;a._menuOpenTM=window.setTimeout(function(){u._showPolygon(c,r),u=c=null},d),h=!0}}}h||this._showPolygon(i,r)}this.itemPull[i].loaded="yes",1==this.conf.dload_icon&&this._updateLoaderIcon(i,!1)}else this._init()},dhtmlXMenuObject.prototype._xmlToJson=function(t,e){var i=[];if(null==e){var s=t.getElementsByTagName(this.conf.tags.root);if(null==s||null!=s&&0==s.length)return{items:[]};s=s[0]}else s=t;null!=s.getAttribute("parentId")&&(e=this.idPrefix+s.getAttribute("parentId"));for(var l=0;l<s.childNodes.length;l++)if("undefined"!=typeof s.childNodes[l].tagName&&String(s.childNodes[l].tagName).toLowerCase()==this.conf.tags.item){var n=s.childNodes[l],o={id:this.idPrefix+(n.getAttribute("id")||this._genStr(24)),title:n.getAttribute("text")||"",imgen:n.getAttribute("img")||"",imgdis:n.getAttribute("imgdis")||"",tip:"",hotkey:"",type:n.getAttribute("type")||"item"
};if(null!=n.getAttribute("cssNormal")&&(o.cssNormal=n.getAttribute("cssNormal")),"checkbox"==o.type&&(o.checked=n.getAttribute("checked")),"radio"==o.type&&(o.checked=n.getAttribute("checked"),o.group=n.getAttribute("group")),o.state="enabled",null!=n.getAttribute("enabled")&&0==window.dhx4.s2b(n.getAttribute("enabled"))?o.state="disabled":null!=n.getAttribute("disabled")&&1==window.dhx4.s2b(n.getAttribute("disabled"))&&(o.state="disabled"),o.parent=null!=e?e:this.idPrefix+this.topId,this.conf.dload)o.complex=null!=n.getAttribute("complex"),o.complex&&(o.loaded="no");else{var r=this._xmlToJson(n,o.id);o.items=r.items,o.complex=o.items.length>0}for(var h=0;h<n.childNodes.length;h++)if("undefined"!=typeof n.childNodes[h].tagName){var a=String(n.childNodes[h].tagName||"").toLowerCase();if(a==this.conf.tags.userdata){var d=n.childNodes[h];null!=d.getAttribute("name")&&(this.userData[o.id+"_"+d.getAttribute("name")]=null!=d.firstChild&&null!=d.firstChild.nodeValue?d.firstChild.nodeValue:"")}a==this.conf.tags.text_ext&&(o.title=n.childNodes[h].firstChild.nodeValue),a==this.conf.tags.tooltip&&(o.tip=n.childNodes[h].firstChild.nodeValue),a==this.conf.tags.hotkey&&(o.hotkey=n.childNodes[h].firstChild.nodeValue),a==this.conf.tags.href&&"item"==o.type&&(o.href_link=n.childNodes[h].firstChild.nodeValue,null!=n.childNodes[h].getAttribute("target")&&(o.href_target=n.childNodes[h].getAttribute("target")))}i.push(o)}var n={parentId:e,items:i};return n},dhtmlXMenuObject.prototype.enableDynamicLoading=function(t,e){this.conf.dload=!0,this.conf.dload_url=t,this.conf.dload_sign=String(this.conf.dload_url).search(/\?/)==-1?"?":"&",this.conf.dload_icon=e,this._init()},dhtmlXMenuObject.prototype._updateLoaderIcon=function(t,e){if(null!=this.idPull[t]&&!(String(this.idPull[t].className).search("TopLevel_Item")>=0)){var i=this.conf.rtl?0:2;if(this.idPull[t].childNodes[i]&&this.idPull[t].childNodes[i].childNodes[0]){var s=this.idPull[t].childNodes[i].childNodes[0];0===String(s.className).search("complex_arrow")&&(s.className="complex_arrow"+(e?"_loading":""))}}},dhtmlXMenuObject.prototype.addNewSibling=function(t,e,i,s,l,n){var o=this.idPrefix+(null!=e?e:this._genStr(24)),r=this.idPrefix+(null!=t?this.getParentId(t):this.topId);this._addItemIntoGlobalStrorage(o,r,i,"item",s,l,n),r!=this.idPrefix+this.topId||this.conf.context?this._renderSublevelItem(o,this.getItemPosition(t)):this._renderToplevelItem(o,this.getItemPosition(t))},dhtmlXMenuObject.prototype.addNewChild=function(t,e,i,s,l,n,o){if(null==t){if(!this.conf.context)return this.addNewSibling(t,i,s,l,n,o),void(null!=e&&this.setItemPosition(i,e));t=this.topId}i=this.idPrefix+(null!=i?i:this._genStr(24)),this.setHotKey&&this.setHotKey(t,""),t=this.idPrefix+t,this._addItemIntoGlobalStrorage(i,t,s,"item",l,n,o),null==this.idPull["polygon_"+t]&&this._renderSublevelPolygon(t,t),this._renderSublevelItem(i,e-1),this._redefineComplexState(t)},dhtmlXMenuObject.prototype.removeItem=function(t,e,i){e||(t=this.idPrefix+t);var s=null;if(t!=this.idPrefix+this.topId){if(null==this.itemPull[t])return;this.idPull["polygon_"+t]&&this.idPull["polygon_"+t]._tmShow&&window.clearTimeout(this.idPull["polygon_"+t]._tmShow);var l=this.itemPull[t].type;if("separator"==l){var n=this.idPull["separator_"+t];this.itemPull[t].parent==this.idPrefix+this.topId?(n.onclick=null,n.onselectstart=null,n.id=null,n.parentNode.removeChild(n)):(n.childNodes[0].childNodes[0].onclick=null,n.childNodes[0].childNodes[0].onselectstart=null,n.childNodes[0].childNodes[0].id=null,n.childNodes[0].removeChild(n.childNodes[0].childNodes[0]),n.removeChild(n.childNodes[0]),n.parentNode.removeChild(n)),this.idPull["separator_"+t]=null,this.itemPull[t]=null,delete this.idPull["separator_"+t],delete this.itemPull[t],n=null}else{s=this.itemPull[t].parent;var n=this.idPull[t];for(n.onclick=null,n.oncontextmenu=null,n.onmouseover=null,n.onmouseout=null,n.onselectstart=null,n.id=null;n.childNodes.length>0;)n.removeChild(n.childNodes[0]);n.parentNode.removeChild(n),this.idPull[t]=null,this.itemPull[t]=null,delete this.idPull[t],delete this.itemPull[t],n=null}l=null}for(var o in this.itemPull)this.itemPull[o].parent==t&&this.removeItem(o,!0,!0);var r=new Array(t);null==s||i||null!=this.idPull["polygon_"+s]&&0==this.idPull["polygon_"+s].tbd.childNodes.length&&(r.push(s),this._updateItemComplexState(s,!1,!1));for(var h=0;h<r.length;h++)if(this.idPull["polygon_"+r[h]]){var a=this.idPull["polygon_"+r[h]];if(a.onclick=null,a.oncontextmenu=null,a.tbl.removeChild(a.tbd),a.tbd=null,a.childNodes[1].removeChild(a.tbl),a.tbl=null,a.id=null,a.parentNode.removeChild(a),a=null,window.dhx4.isIE6){var d="polygon_"+r[h]+"_ie6cover";null!=this.idPull[d]&&(document.body.removeChild(this.idPull[d]),delete this.idPull[d])}null!=this.idPull["arrowup_"+t]&&this._removeArrow&&this._removeArrow("arrowup_"+t),null!=this.idPull["arrowdown_"+t]&&this._removeArrow&&this._removeArrow("arrowdown_"+t),this.idPull["polygon_"+r[h]]=null,delete this.idPull["polygon_"+r[h]]}r=null,"dhx_terrace"==this.conf.skin&&1==arguments.length&&this._improveTerraceSkin()},dhtmlXMenuObject.prototype._addItemIntoGlobalStrorage=function(t,e,i,s,l,n,o){var r={id:t,title:i,imgen:null!=n?n:"",imgdis:null!=o?o:"",type:s,state:1==l?"disabled":"enabled",parent:e,complex:!1,hotkey:"",tip:""};this.itemPull[r.id]=r},dhtmlXMenuObject.prototype.renderAsContextMenu=function(){this.conf.context=!0,1==this.base._autoSkinUpdate&&(this.base.className=this.base.className.replace("dhtmlxMenu_"+this.conf.skin+"_Middle",""),this.base._autoSkinUpdate=!1),null!=this.conf.ctx_baseid&&this.addContextZone(this.conf.ctx_baseid)},dhtmlXMenuObject.prototype.addContextZone=function(t){if(t==document.body){t="document.body."+this.idPrefix;var e=document.body}else if("string"==typeof t)var e=document.getElementById(t);else var e=t;var i=!1;for(var s in this.conf.ctx_zones)i=i||s==t||this.conf.ctx_zones[s]==e;if(1==i)return!1;this.conf.ctx_zones[t]=e;var l=this;window.dhx4.isOpera?(this.operaContext=function(t){l._doOnContextMenuOpera(t,l)},e.addEventListener("mouseup",this.operaContext,!1)):(null==e.oncontextmenu||e._oldContextMenuHandler||(e._oldContextMenuHandler=e.oncontextmenu),e.oncontextmenu=function(t){for(var e in dhtmlXMenuObject.prototype.liveInst)e!=l.conf.live_id&&dhtmlXMenuObject.prototype.liveInst[e].context&&dhtmlXMenuObject.prototype.liveInst[e]._hideContextMenu();return t=t||event,t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,l._doOnContextBeforeCall(t,this),!1})},dhtmlXMenuObject.prototype._doOnContextMenuOpera=function(t,e){for(var i in dhtmlXMenuObject.prototype.liveInst)i!=e.conf.live_id&&dhtmlXMenuObject.prototype.liveInst[i].context&&dhtmlXMenuObject.prototype.liveInst[i]._hideContextMenu();return t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,0==t.button&&1==t.ctrlKey&&e._doOnContextBeforeCall(t,this),!1},dhtmlXMenuObject.prototype.removeContextZone=function(t){if(!this.isContextZone(t))return!1;t==document.body&&(t="document.body."+this.idPrefix);var e=this.conf.ctx_zones[t];window.dhx4.isOpera?e.removeEventListener("mouseup",this.operaContext,!1):(e.oncontextmenu=null!=e._oldContextMenuHandler?e._oldContextMenuHandler:null,e._oldContextMenuHandler=null);try{this.conf.ctx_zones[t]=null,delete this.conf.ctx_zones[t]}catch(t){}return!0},dhtmlXMenuObject.prototype.isContextZone=function(t){if(t==document.body&&null!=this.conf.ctx_zones["document.body."+this.idPrefix])return!0;var e=!1;return null!=this.conf.ctx_zones[t]&&this.conf.ctx_zones[t]==document.getElementById(t)&&(e=!0),e},dhtmlXMenuObject.prototype._isContextMenuVisible=function(){return null!=this.idPull["polygon_"+this.idPrefix+this.topId]&&""==this.idPull["polygon_"+this.idPrefix+this.topId].style.display},dhtmlXMenuObject.prototype._showContextMenu=function(t,e,i){return this._clearAndHide(),null!=this.idPull["polygon_"+this.idPrefix+this.topId]&&(window.clearTimeout(this.conf.tm_handler),this.idPull[this.idPrefix+this.topId]=new Array(t,e),this._showPolygon(this.idPrefix+this.topId,"bottom"),void this.callEvent("onContextMenu",[i]))},dhtmlXMenuObject.prototype._hideContextMenu=function(){return null!=this.idPull["polygon_"+this.idPrefix+this.topId]&&(this._clearAndHide(),void this._hidePolygon(this.idPrefix+this.topId))},dhtmlXMenuObject.prototype._doOnContextBeforeCall=function(t,e){if(this.conf.ctx_zoneid=e.id,this._clearAndHide(),this._hideContextMenu(),1==window.dhx4.isChrome||1==window.dhx4.isEdge||1==window.dhx4.isOpera||1==window.dhx4.isIE11)var i=window.dhx4.absLeft(t.currentTarget)+t.offsetX,s=window.dhx4.absTop(t.currentTarget)+t.offsetY;else if(1==window.dhx4.isIE6||1==window.dhx4.isIE7||1==window.dhx4.isIE)var i=window.dhx4.absLeft(t.srcElement)+t.x||0,s=window.dhx4.absTop(t.srcElement)+t.y||0;else var l=t.srcElement||t.target,n=window.dhx4.isIE||window.dhx4.isKHTML?t.offsetX:t.layerX,o=window.dhx4.isIE||window.dhx4.isKHTML?t.offsetY:t.layerY,i=window.dhx4.absLeft(l)+n,s=window.dhx4.absTop(l)+o;this.checkEvent("onBeforeContextMenu")?this.callEvent("onBeforeContextMenu",[e.id,t])&&this.conf.ctx_autoshow&&(this._showContextMenu(i,s,e.id),this.callEvent("onAfterContextMenu",[e.id,t])):this.conf.ctx_autoshow&&(this._showContextMenu(i,s,e.id),this.callEvent("onAfterContextMenu",[e.id]))},dhtmlXMenuObject.prototype.showContextMenu=function(t,e){this._showContextMenu(t,e,!1)},dhtmlXMenuObject.prototype.hideContextMenu=function(){this._hideContextMenu()},dhtmlXMenuObject.prototype.setAutoShowMode=function(t){this.conf.ctx_autoshow=1==t},dhtmlXMenuObject.prototype.setAutoHideMode=function(t){this.conf.ctx_autohide=1==t},dhtmlXMenuObject.prototype.setContextMenuHideAllMode=function(t){this.conf.ctx_hideall=1==t},dhtmlXMenuObject.prototype.getContextMenuHideAllMode=function(){return this.conf.ctx_hideall},dhtmlXMenuObject.prototype._improveTerraceSkin=function(){for(var t in this.itemPull)if(this.itemPull[t].parent==this.idPrefix+this.topId&&null!=this.idPull[t]){var e=!1,i=!1;this.idPull[t].parentNode.firstChild==this.idPull[t]&&(e=!0),this.idPull[t].parentNode.lastChild==this.idPull[t]&&(i=!0);for(var s in this.itemPull)"separator"==this.itemPull[s].type&&this.itemPull[s].parent==this.idPrefix+this.topId&&(this.idPull[t].nextSibling==this.idPull["separator_"+s]&&(i=!0),this.idPull[t].previousSibling==this.idPull["separator_"+s]&&(e=!0));this.idPull[t].style.borderLeftWidth=e?"1px":"0px",this.idPull[t].style.borderTopLeftRadius=this.idPull[t].style.borderBottomLeftRadius=e?"3px":"0px",this.idPull[t].style.borderTopRightRadius=this.idPull[t].style.borderBottomRightRadius=i?"3px":"0px",this.idPull[t]._bl=e,this.idPull[t]._br=i}},dhtmlXMenuObject.prototype._improveTerraceButton=function(t,e){e?(this.idPull[t].style.borderBottomLeftRadius=this.idPull[t]._bl?"3px":"0px",this.idPull[t].style.borderBottomRightRadius=this.idPull[t]._br?"3px":"0px"):(this.idPull[t].style.borderBottomLeftRadius="0px",this.idPull[t].style.borderBottomRightRadius="0px")},"undefined"!=typeof window.dhtmlXCellObject&&(dhtmlXCellObject.prototype._createNode_menu=function(t,e,i,s,l){return"undefined"!=typeof l?t=l:(t=document.createElement("DIV"),t.className="dhx_cell_menu_"+(this.conf.borders?"def":"no_borders"),t.appendChild(document.createElement("DIV"))),this.cell.insertBefore(t,this.cell.childNodes[this.conf.idx.toolbar||this.conf.idx.cont]),this.conf.ofs_nodes.t.menu=!0,this._updateIdx(),t},dhtmlXCellObject.prototype.attachMenu=function(t){if(!this.dataNodes.menu)return this.callEvent("_onBeforeContentAttach",["menu"]),"undefined"==typeof t&&(t={}),"undefined"==typeof t.skin&&(t.skin=this.conf.skin),t.parent=this._attachObject("menu").firstChild,this.dataNodes.menu=new dhtmlXMenuObject(t),this._adjustCont(this._idd),t.parent=null,t=null,this.callEvent("_onContentAttach",[]),this.dataNodes.menu},dhtmlXCellObject.prototype.detachMenu=function(){this.dataNodes.menu&&(this.dataNodes.menu.unload(),this.dataNodes.menu=null,delete this.dataNodes.menu,this._detachObject("menu"))},dhtmlXCellObject.prototype.showMenu=function(){this._mtbShowHide("menu","")},dhtmlXCellObject.prototype.hideMenu=function(){this._mtbShowHide("menu","none")},dhtmlXCellObject.prototype.getAttachedMenu=function(){return this.dataNodes.menu}),dhtmlXMenuObject.prototype.setItemEnabled=function(t){this._changeItemState(t,"enabled",this._getItemLevelType(t))},dhtmlXMenuObject.prototype.setItemDisabled=function(t){this._changeItemState(t,"disabled",this._getItemLevelType(t))},dhtmlXMenuObject.prototype.isItemEnabled=function(t){return null!=this.itemPull[this.idPrefix+t]&&"enabled"==this.itemPull[this.idPrefix+t].state},dhtmlXMenuObject.prototype._changeItemState=function(t,e,i){var s=!1,l=this.idPrefix+t;return null!=this.itemPull[l]&&null!=this.idPull[l]&&this.itemPull[l].state!=e&&(this.itemPull[l].state=e,this.itemPull[l].parent!=this.idPrefix+this.topId||this.conf.context?this.idPull[l].className="sub_item"+("enabled"==this.itemPull[l].state?"":"_dis"):this.idPull[l].className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_"+("enabled"==this.itemPull[l].state?"Normal":"Disabled"),this._updateItemComplexState(this.idPrefix+t,this.itemPull[this.idPrefix+t].complex,!1),this._updateItemImage(t,i),this.idPrefix+this.conf.last_click==l&&"TopLevel"!=i&&this._redistribSubLevelSelection(l,this.itemPull[l].parent),"TopLevel"==i&&!this.conf.context),s},dhtmlXMenuObject.prototype.getItemText=function(t){return null!=this.itemPull[this.idPrefix+t]?this.itemPull[this.idPrefix+t].title:""},dhtmlXMenuObject.prototype.setItemText=function(t,e){if(t=this.idPrefix+t,null!=this.itemPull[t]&&null!=this.idPull[t])if(this._clearAndHide(),this.itemPull[t].title=e,this.itemPull[t].parent!=this.idPrefix+this.topId||this.conf.context){for(var i=null,s=0;s<this.idPull[t].childNodes[1].childNodes.length;s++)"sub_item_text"==String(this.idPull[t].childNodes[1].childNodes[s].className||"")&&(i=this.idPull[t].childNodes[1].childNodes[s]);""==String(this.itemPull[t].title).length||null==this.itemPull[t].title?i&&(i.parentNode.removeChild(i),i=null,this.idPull[t].childNodes[1].innerHTML="&nbsp;"):(i||(i=document.createElement("DIV"),i.className="sub_item_text",this.idPull[t].childNodes[1].innerHTML="",this.idPull[t].childNodes[1].appendChild(i)),i.innerHTML=this.itemPull[t].title)}else{for(var i=null,s=0;s<this.idPull[t].childNodes.length;s++)try{"top_level_text"==this.idPull[t].childNodes[s].className&&(i=this.idPull[t].childNodes[s])}catch(t){}""==String(this.itemPull[t].title).length||null==this.itemPull[t].title?null!=i&&i.parentNode.removeChild(i):(i||(i=document.createElement("DIV"),i.className="top_level_text",this.conf.rtl&&this.idPull[t].childNodes.length>0?this.idPull[t].insertBefore(i,this.idPull[t].childNodes[0]):this.idPull[t].appendChild(i)),i.innerHTML=this.itemPull[t].title)}},dhtmlXMenuObject.prototype.loadFromHTML=function(t,e,i){var s=this.conf.tags.item;this.conf.tags.item="div";var l="string"==typeof t?document.getElementById(t):t,n=this._xmlToJson(l,this.idPrefix+this.topId);this._initObj(n),this.conf.tags.item=s,e&&l.parentNode.removeChild(l),l=objOd=null,null!=onload&&("function"==typeof i?i():"function"==typeof window[i]&&window[i]())},dhtmlXMenuObject.prototype.hideItem=function(t){this._changeItemVisible(t,!1)},dhtmlXMenuObject.prototype.showItem=function(t){this._changeItemVisible(t,!0)},dhtmlXMenuObject.prototype.isItemHidden=function(t){var e=null;return null!=this.idPull[this.idPrefix+t]&&(e="none"==this.idPull[this.idPrefix+t].style.display),e},dhtmlXMenuObject.prototype._changeItemVisible=function(t,e){var i=this.idPrefix+t;null!=this.itemPull[i]&&("separator"==this.itemPull[i].type&&(i="separator_"+i),null!=this.idPull[i]&&(this.idPull[i].style.display=e?"":"none",this._redefineComplexState(this.itemPull[this.idPrefix+t].parent)))},dhtmlXMenuObject.prototype.setUserData=function(t,e,i){this.userData[this.idPrefix+t+"_"+e]=i},dhtmlXMenuObject.prototype.getUserData=function(t,e){return null!=this.userData[this.idPrefix+t+"_"+e]?this.userData[this.idPrefix+t+"_"+e]:null},dhtmlXMenuObject.prototype.setOpenMode=function(t){this.conf.mode="win"==t?"win":"web"},dhtmlXMenuObject.prototype.setWebModeTimeout=function(t){this.conf.tm_sec=isNaN(t)?400:t},dhtmlXMenuObject.prototype.getItemImage=function(t){var e=new Array(null,null);return t=this.idPrefix+t,"item"==this.itemPull[t].type&&(e[0]=this.itemPull[t].imgen,e[1]=this.itemPull[t].imgdis),e},dhtmlXMenuObject.prototype.setItemImage=function(t,e,i){"item"==this.itemPull[this.idPrefix+t].type&&(this.itemPull[this.idPrefix+t].imgen=e,this.itemPull[this.idPrefix+t].imgdis=i,this._updateItemImage(t,this._getItemLevelType(t)))},dhtmlXMenuObject.prototype.clearItemImage=function(t){this.setItemImage(t,"","")},dhtmlXMenuObject.prototype.setVisibleArea=function(t,e,i,s){this.conf.v_enabled=!0,this.conf.v.x1=t,this.conf.v.x2=e,this.conf.v.y1=i,this.conf.v.y2=s},dhtmlXMenuObject.prototype.setTooltip=function(t,e){t=this.idPrefix+t,null!=this.itemPull[t]&&null!=this.idPull[t]&&(this.idPull[t].title=e.length>0?e:null,this.itemPull[t].tip=e)},dhtmlXMenuObject.prototype.getTooltip=function(t){return null==this.itemPull[this.idPrefix+t]?null:this.itemPull[this.idPrefix+t].tip},dhtmlXMenuObject.prototype.setTopText=function(t){this.conf.context||(null==this._topText&&(this._topText=document.createElement("DIV"),this._topText.className="dhtmlxMenu_TopLevel_Text_"+(this.conf.rtl?"left":"left"==this.conf.align?"right":"left"),this.base.appendChild(this._topText)),this._topText.innerHTML=t)};dhtmlXMenuObject.prototype.setAlign=function(t){this.conf.align!=t&&("left"!=t&&"right"!=t||(this.conf.align=t,this.cont&&(this.cont.className="right"==this.conf.align?"align_right":"align_left"),null!=this._topText&&(this._topText.className="dhtmlxMenu_TopLevel_Text_"+("left"==this.conf.align?"right":"left"))))};dhtmlXMenuObject.prototype.setHref=function(t,e,i){null!=this.itemPull[this.idPrefix+t]&&(this.itemPull[this.idPrefix+t].href_link=e,null!=i&&(this.itemPull[this.idPrefix+t].href_target=i))},dhtmlXMenuObject.prototype.clearHref=function(t){null!=this.itemPull[this.idPrefix+t]&&(delete this.itemPull[this.idPrefix+t].href_link,delete this.itemPull[this.idPrefix+t].href_target)},dhtmlXMenuObject.prototype.getCircuit=function(t){for(var e=new Array(t);this.getParentId(t)!=this.topId;)t=this.getParentId(t),e[e.length]=t;return e.reverse()},dhtmlXMenuObject.prototype._getCheckboxState=function(t){return null==this.itemPull[this.idPrefix+t]?null:this.itemPull[this.idPrefix+t].checked},dhtmlXMenuObject.prototype._setCheckboxState=function(t,e){null!=this.itemPull[this.idPrefix+t]&&(this.itemPull[this.idPrefix+t].checked=e)},dhtmlXMenuObject.prototype._updateCheckboxImage=function(t){if(null!=this.idPull[this.idPrefix+t]){this.itemPull[this.idPrefix+t].imgen="chbx_"+(this._getCheckboxState(t)?"1":"0"),this.itemPull[this.idPrefix+t].imgdis=this.itemPull[this.idPrefix+t].imgen;try{this.idPull[this.idPrefix+t].childNodes[this.conf.rtl?2:0].childNodes[0].className="sub_icon "+this.itemPull[this.idPrefix+t].imgen}catch(t){}}},dhtmlXMenuObject.prototype._checkboxOnClickHandler=function(t,e,i){if("d"!=e.charAt(1)&&null!=this.itemPull[this.idPrefix+t]){var s=this._getCheckboxState(t);this.checkEvent("onCheckboxClick")?this.callEvent("onCheckboxClick",[t,s,this.conf.ctx_zoneid,i])&&this.setCheckboxState(t,!s):this.setCheckboxState(t,!s),this.checkEvent("onClick")&&this.callEvent("onClick",[t])}},dhtmlXMenuObject.prototype.setCheckboxState=function(t,e){this._setCheckboxState(t,e),this._updateCheckboxImage(t)},dhtmlXMenuObject.prototype.getCheckboxState=function(t){return this._getCheckboxState(t)},dhtmlXMenuObject.prototype.addCheckbox=function(t,e,i,s,l,n,o){if(this.conf.context&&e==this.topId);else{if(null==this.itemPull[this.idPrefix+e])return;if("child"==t&&"item"!=this.itemPull[this.idPrefix+e].type)return}var r="chbx_"+(n?"1":"0"),h=r;if("sibling"==t){var a=this.idPrefix+(null!=s?s:this._genStr(24)),d=this.idPrefix+this.getParentId(e);this._addItemIntoGlobalStrorage(a,d,l,"checkbox",o,r,h),this.itemPull[a].checked=n,this._renderSublevelItem(a,this.getItemPosition(e))}else{var a=this.idPrefix+(null!=s?s:this._genStr(24)),d=this.idPrefix+e;this._addItemIntoGlobalStrorage(a,d,l,"checkbox",o,r,h),this.itemPull[a].checked=n,null==this.idPull["polygon_"+d]&&this._renderSublevelPolygon(d,d),this._renderSublevelItem(a,i-1),this._redefineComplexState(d)}},dhtmlXMenuObject.prototype.setHotKey=function(t,e){if(t=this.idPrefix+t,null!=this.itemPull[t]&&null!=this.idPull[t]&&(this.itemPull[t].parent!=this.idPrefix+this.topId||this.conf.context)&&!this.itemPull[t].complex){var i=this.itemPull[t].type;if("item"==i||"checkbox"==i||"radio"==i){var s=null;try{"sub_item_hk"==this.idPull[t].childNodes[this.conf.rtl?0:2].childNodes[0].className&&(s=this.idPull[t].childNodes[this.conf.rtl?0:2].childNodes[0])}catch(t){}if(0==e.length)this.itemPull[t].hotkey_backup=this.itemPull[t].hotkey,this.itemPull[t].hotkey="",null!=s&&s.parentNode.removeChild(s);else{if(this.itemPull[t].hotkey=e,this.itemPull[t].hotkey_backup=null,null==s){s=document.createElement("DIV"),s.className="sub_item_hk";for(var l=this.idPull[t].childNodes[this.conf.rtl?0:2];l.childNodes.length>0;)l.removeChild(l.childNodes[0]);l.appendChild(s)}s.innerHTML=e}}}},dhtmlXMenuObject.prototype.getHotKey=function(t){return null==this.itemPull[this.idPrefix+t]?null:this.itemPull[this.idPrefix+t].hotkey},dhtmlXMenuObject.prototype._clearAllSelectedSubItemsInPolygon=function(t){for(var e=this._getSubItemToDeselectByPolygon(t),i=0;i<this.conf.opened_poly.length;i++)this.conf.opened_poly[i]!=t&&this._hidePolygon(this.conf.opened_poly[i]);for(var i=0;i<e.length;i++)null!=this.idPull[e[i]]&&"enabled"==this.itemPull[e[i]].state&&(this.idPull[e[i]].className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_Item_Normal")},dhtmlXMenuObject.prototype._checkArrowsState=function(t){var e=this.idPull["polygon_"+t].childNodes[1],i=this.idPull["arrowup_"+t],s=this.idPull["arrowdown_"+t];0==e.scrollTop?i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp_Disabled":i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp"+(i.over?"_Over":""),e.scrollTop+e.offsetHeight<e.scrollHeight?s.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown"+(s.over?"_Over":""):s.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown_Disabled",e=i=s=null},dhtmlXMenuObject.prototype._addUpArrow=function(t){var e=this,i=document.createElement("DIV");i.pId=this.idPrefix+t,i.id="arrowup_"+this.idPrefix+t,i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp",i.over=!1,i.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},i.oncontextmenu=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},i.onmouseover=function(){"web"==e.conf.mode&&window.clearTimeout(e.conf.tm_handler),e._clearAllSelectedSubItemsInPolygon(this.pId),this.className!="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp_Disabled"&&(this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp_Over",this.over=!0,e._canScrollUp=!0,e._doScrollUp(this.pId,!0))},i.onmouseout=function(){"web"==e.conf.mode&&(window.clearTimeout(e.conf.tm_handler),e.conf.tm_handler=window.setTimeout(function(){e._clearAndHide()},e.conf.tm_sec,"JavaScript")),this.over=!1,e._canScrollUp=!1,this.className!="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp_Disabled"&&(this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp",window.clearTimeout(e.conf.of_utm))},i.onclick=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1};var s=this.idPull["polygon_"+this.idPrefix+t];s.childNodes[0].appendChild(i),this.idPull[i.id]=i,s=i=null},dhtmlXMenuObject.prototype._addDownArrow=function(t){var e=this,i=document.createElement("DIV");i.pId=this.idPrefix+t,i.id="arrowdown_"+this.idPrefix+t,i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown",i.over=!1,i.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},i.oncontextmenu=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},i.onmouseover=function(){"web"==e.conf.mode&&window.clearTimeout(e.conf.tm_handler),e._clearAllSelectedSubItemsInPolygon(this.pId),this.className!="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown_Disabled"&&(this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown_Over",this.over=!0,e._canScrollDown=!0,e._doScrollDown(this.pId,!0))},i.onmouseout=function(){"web"==e.conf.mode&&(window.clearTimeout(e.conf.tm_handler),e.conf.tm_handler=window.setTimeout(function(){e._clearAndHide()},e.conf.tm_sec,"JavaScript")),this.over=!1,e._canScrollDown=!1,this.className!="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown_Disabled"&&(this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown",window.clearTimeout(e.conf.of_dtm))},i.onclick=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1};var s=this.idPull["polygon_"+this.idPrefix+t];s.childNodes[2].appendChild(i),this.idPull[i.id]=i,s=i=null},dhtmlXMenuObject.prototype._removeUpArrow=function(t){var e="arrowup_"+this.idPrefix+t;this._removeArrow(e)},dhtmlXMenuObject.prototype._removeDownArrow=function(t){var e="arrowdown_"+this.idPrefix+t;this._removeArrow(e)},dhtmlXMenuObject.prototype._removeArrow=function(t){var e=this.idPull[t];e.onselectstart=null,e.oncontextmenu=null,e.onmouseover=null,e.onmouseout=null,e.onclick=null,e.parentNode&&e.parentNode.removeChild(e),e=null,this.idPull[t]=null;try{delete this.idPull[t]}catch(t){}},dhtmlXMenuObject.prototype._isArrowExists=function(t){return null!=this.idPull["arrowup_"+t]&&null!=this.idPull["arrowdown_"+t]},dhtmlXMenuObject.prototype._doScrollUp=function(t,e){var i=this.idPull["polygon_"+t].childNodes[1];if(this._canScrollUp&&i.scrollTop>0){var s=!1,l=i.scrollTop-this.conf.of_ustep;if(l<0&&(s=!0,l=0),i.scrollTop=l,s)e=!0;else{var n=this;this.conf.of_utm=window.setTimeout(function(){n._doScrollUp(t,!1),n=null},this.conf.of_utime)}}else this._canScrollUp=!1,this._checkArrowsState(t);e&&this._checkArrowsState(t)},dhtmlXMenuObject.prototype._doScrollDown=function(t,e){var i=this.idPull["polygon_"+t].childNodes[1];if(this._canScrollDown&&i.scrollTop+i.offsetHeight<=i.scrollHeight){var s=!1,l=i.scrollTop+this.conf.of_dstep;if(l+i.offsetHeight>=i.scrollHeight&&(s=!0,l=i.scrollHeight-i.offsetHeight),i.scrollTop=l,s)e=!0;else{var n=this;this.conf.of_dtm=window.setTimeout(function(){n._doScrollDown(t,!1),n=null},this.conf.of_dtime)}}else this._canScrollDown=!1,this._checkArrowsState(t);e&&this._checkArrowsState(t)},dhtmlXMenuObject.prototype._countPolygonItems=function(t){var e=0;for(var i in this.itemPull){var s=this.itemPull[i].parent,l=this.itemPull[i].type;s!=this.idPrefix+t||"item"!=l&&"radio"!=l&&"checkbox"!=l||e++}return e},dhtmlXMenuObject.prototype.setOverflowHeight=function(t){if("auto"===t)return this.conf.overflow_limit=0,void(this.conf.auto_overflow=!0);if(!(0==this.conf.overflow_limit&&t<=0)){if(this._clearAndHide(),this.conf.overflow_limit>=0&&t>0)return void(this.conf.overflow_limit=t);if(this.conf.overflow_limit>0&&t<=0){for(var e in this.itemPull)if(this._isArrowExists(e)){var i=String(e).replace(this.idPrefix,"");this._removeUpArrow(i),this._removeDownArrow(i),this.idPull["polygon_"+e].childNodes[1].style.height=""}return void(this.conf.overflow_limit=0)}}},dhtmlXMenuObject.prototype._getRadioImgObj=function(t){try{var e=this.idPull[this.idPrefix+t].childNodes[this.conf.rtl?2:0].childNodes[0]}catch(t){var e=null}return e},dhtmlXMenuObject.prototype._setRadioState=function(t,e){var i=this._getRadioImgObj(t);if(null!=i){var s=this.itemPull[this.idPrefix+t];s.checked=e,s.imgen="rdbt_"+(s.checked?"1":"0"),s.imgdis=s.imgen,i.className="sub_icon "+s.imgen}},dhtmlXMenuObject.prototype._radioOnClickHandler=function(t,e,i){if("d"!=e.charAt(1)&&null!=this.itemPull[this.idPrefix+t].group){var s=this.itemPull[this.idPrefix+t].group;this.checkEvent("onRadioClick")?this.callEvent("onRadioClick",[s,this.getRadioChecked(s),t,this.conf.ctx_zoneid,i])&&this.setRadioChecked(s,t):this.setRadioChecked(s,t),this.checkEvent("onClick")&&this.callEvent("onClick",[t])}},dhtmlXMenuObject.prototype.getRadioChecked=function(t){for(var e=null,i=0;i<this.radio[t].length;i++){var s=this.radio[t][i].replace(this.idPrefix,""),l=this._getRadioImgObj(s);if(null!=l){var n=l.className.match(/rdbt_1$/gi);null!=n&&(e=s)}}return e},dhtmlXMenuObject.prototype.setRadioChecked=function(t,e){if(null!=this.radio[t])for(var i=0;i<this.radio[t].length;i++){var s=this.radio[t][i].replace(this.idPrefix,"");this._setRadioState(s,s==e)}},dhtmlXMenuObject.prototype.addRadioButton=function(t,e,i,s,l,n,o,r){if(this.conf.context&&e==this.topId);else{if(null==this.itemPull[this.idPrefix+e])return;if("child"==t&&"item"!=this.itemPull[this.idPrefix+e].type)return}var h=this.idPrefix+(null!=s?s:this._genStr(24)),a="rdbt_"+(o?"1":"0"),d=a;if("sibling"==t){var c=this.idPrefix+this.getParentId(e);this._addItemIntoGlobalStrorage(h,c,l,"radio",r,a,d),this._renderSublevelItem(h,this.getItemPosition(e))}else{var c=this.idPrefix+e;this._addItemIntoGlobalStrorage(h,c,l,"radio",r,a,d),null==this.idPull["polygon_"+c]&&this._renderSublevelPolygon(c,c),this._renderSublevelItem(h,i-1),this._redefineComplexState(c)}var u=null!=n?n:this._genStr(24);this.itemPull[h].group=u,null==this.radio[u]&&(this.radio[u]=new Array),this.radio[u][this.radio[u].length]=h,1==o&&this.setRadioChecked(u,String(h).replace(this.idPrefix,""))},dhtmlXMenuObject.prototype.serialize=function(){var t="<menu>"+this._readLevel(this.idPrefix+this.topId)+"</menu>";return t},dhtmlXMenuObject.prototype._readLevel=function(t){var e="";for(var i in this.itemPull)if(this.itemPull[i].parent==t){var s="",l="",n="",o=String(this.itemPull[i].id).replace(this.idPrefix,""),r="",h=""!=this.itemPull[i].title?' text="'+this.itemPull[i].title+'"':"",a="";"item"==this.itemPull[i].type&&(""!=this.itemPull[i].imgen&&(s=' img="'+this.itemPull[i].imgen+'"'),""!=this.itemPull[i].imgdis&&(l=' imgdis="'+this.itemPull[i].imgdis+'"'),""!=this.itemPull[i].hotkey&&(n="<hotkey>"+this.itemPull[i].hotkey+"</hotkey>")),"separator"==this.itemPull[i].type?r=' type="separator"':"disabled"==this.itemPull[i].state&&(a=' enabled="false"'),"checkbox"==this.itemPull[i].type&&(r=' type="checkbox"'+(this.itemPull[i].checked?' checked="true"':"")),"radio"==this.itemPull[i].type&&(r=' type="radio" group="'+this.itemPull[i].group+'" '+(this.itemPull[i].checked?' checked="true"':"")),e+="<item id='"+o+"'"+h+r+s+l+a+">",e+=n,this.itemPull[i].complex&&(e+=this._readLevel(i)),e+="</item>"}return e},dhtmlXMenuObject.prototype.enableEffect=function(t,e,i){this._menuEffect=("opacity"==t||"slide"==t||"slide+"==t)&&t,this._pOpStyleIE=navigator.userAgent.search(/MSIE\s[678]\.0/gi)>=0;for(var s in this.idPull)0===s.search(/polygon/)&&(this._pOpacityApply(s,this._pOpStyleIE?100:1),this.idPull[s].style.height="");this._pOpMax=("undefined"==typeof e?100:e)/(this._pOpStyleIE?1:100),this._pOpStyleName=this._pOpStyleIE?"filter":"opacity",this._pOpStyleValue=this._pOpStyleIE?"progid:DXImageTransform.Microsoft.Alpha(Opacity=#)":"#",this._pSlSteps=this._pOpStyleIE?10:20,this._pSlTMTimeMax=i||50},dhtmlXMenuObject.prototype._showPolygonEffect=function(t){this._pShowHide(t,!0)},dhtmlXMenuObject.prototype._hidePolygonEffect=function(t){this._pShowHide(t,!1)},dhtmlXMenuObject.prototype._pOpacityApply=function(t,e){this.idPull[t].style[this._pOpStyleName]=String(this._pOpStyleValue).replace("#",e||this.idPull[t]._op)},dhtmlXMenuObject.prototype._pShowHide=function(t,e){if(this.idPull){if(null!=this.idPull[t]._tmShow){if(this.idPull[t]._step_h>0&&1==e||this.idPull[t]._step_h<0&&0==e)return;window.clearTimeout(this.idPull[t]._tmShow),this.idPull[t]._tmShow=null,this.idPull[t]._max_h=null}if(0!=e||"hidden"!=this.idPull[t].style.visibility&&"none"!=this.idPull[t].style.display){
if(1==e&&"none"==this.idPull[t].style.display&&(this.idPull[t].style.visibility="hidden",this.idPull[t].style.display=""),null==this.idPull[t]._max_h){if(this.idPull[t]._max_h=parseInt(this.idPull[t].offsetHeight),this.idPull[t]._h=1==e?0:this.idPull[t]._max_h,this.idPull[t]._step_h=Math.round(this.idPull[t]._max_h/this._pSlSteps)*(1==e?1:-1),0==this.idPull[t]._step_h)return;this.idPull[t]._step_tm=Math.round(this._pSlTMTimeMax/this._pSlSteps),"slide+"==this._menuEffect||"opacity"==this._menuEffect?(this.idPull[t].op_tm=this.idPull[t]._step_tm,this.idPull[t].op_step=this._pOpMax/this._pSlSteps*(1==e?1:-1),this._pOpStyleIE&&(this.idPull[t].op_step=Math.round(this.idPull[t].op_step)),this.idPull[t]._op=1==e?0:this._pOpMax,this._pOpacityApply(t)):(this.idPull[t]._op=this._pOpStyleIE?100:1,this._pOpacityApply(t)),0===this._menuEffect.search(/slide/)&&(this.idPull[t].style.height="0px"),this.idPull[t].style.visibility="visible"}this._pEffectSet(t,this.idPull[t]._h+this.idPull[t]._step_h)}}},dhtmlXMenuObject.prototype._pEffectSet=function(t,e){if(this.idPull)if(this.idPull[t]._tmShow&&window.clearTimeout(this.idPull[t]._tmShow),this.idPull[t]._h=Math.max(0,Math.min(e,this.idPull[t]._max_h)),0===this._menuEffect.search(/slide/)&&(this.idPull[t].style.height=this.idPull[t]._h+"px"),e+=this.idPull[t]._step_h,"slide+"!=this._menuEffect&&"opacity"!=this._menuEffect||(this.idPull[t]._op=Math.max(0,Math.min(this._pOpMax,this.idPull[t]._op+this.idPull[t].op_step)),this._pOpacityApply(t)),this.idPull[t]._step_h>0&&e<=this.idPull[t]._max_h||this.idPull[t]._step_h<0&&e>=0){var i=this;this.idPull[t]._tmShow=window.setTimeout(function(){i._pEffectSet(t,e)},this.idPull[t]._step_tm)}else 0===this._menuEffect.search(/slide/)&&(this.idPull[t].style.height=""),this.idPull[t]._step_h<0&&(this.idPull[t].style.visibility="hidden"),"slide+"!=this._menuEffect&&"opacity"!=this._menuEffect||(this.idPull[t]._op=this.idPull[t]._step_h<0?this._pOpStyleIE?100:1:this._pOpMax,this._pOpacityApply(t)),this.idPull[t]._tmShow=null,this.idPull[t]._h=null,this.idPull[t]._max_h=null,this.idPull[t]._step_tm=null},dhtmlXToolbarObject.prototype.addSpacer=function(t){var e=this.idPrefix+t;if(null!=this._spacer){if(this._spacer.idd==t)return;if(this._spacer==this.objPull[e].obj.parentNode){for(var i=!0;i;){var s=this._spacer.childNodes[0].idd;this.base.appendChild(this._spacer.childNodes[0]),s!=t&&0!=this._spacer.childNodes.length||(null!=this.objPull[e].arw&&this.base.appendChild(this.objPull[e].arw),i=!1)}return this._spacer.idd=t,void this._fixSpacer()}if(this.base==this.objPull[e].obj.parentNode){for(var i=!0,l=null!=this.objPull[e].arw;i;){var n=this.base.childNodes.length-1;1==l&&this.base.childNodes[n]==this.objPull[e].arw&&(i=!1),this.base.childNodes[n].idd==t&&(i=!1),i&&(this._spacer.childNodes.length>0?this._spacer.insertBefore(this.base.childNodes[n],this._spacer.childNodes[0]):this._spacer.appendChild(this.base.childNodes[n]))}return this._spacer.idd=t,void this._fixSpacer()}}else{for(var o=null,n=0;n<this.base.childNodes.length;n++)this.base.childNodes[n]==this.objPull[this.idPrefix+t].obj&&(o=n,null!=this.objPull[this.idPrefix+t].arw&&(o=n+1));if(null!=o){for(this._spacer=document.createElement("DIV"),this._spacer.className="right"==this.conf.align?" dhxtoolbar_float_left":" dhxtoolbar_float_right",this._spacer.dir="ltr",this._spacer.idd=t;this.base.childNodes.length>o+1;)this._spacer.appendChild(this.base.childNodes[o+1]);this.cont.appendChild(this._spacer),this._fixSpacer()}}"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype.removeSpacer=function(){if(this._spacer){for(;this._spacer.childNodes.length>0;)this.base.appendChild(this._spacer.childNodes[0]);this._spacer.parentNode.removeChild(this._spacer),this._spacer=null,"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()}},dhtmlXToolbarObject.prototype._fixSpacer=function(){if("undefined"==typeof window.addEventListener&&null!=this._spacer){this._spacer.style.borderLeft="1px solid #a4bed4";var t=this._spacer;window.setTimeout(function(){t.style.borderLeft="0px solid #a4bed4",t=null},1)}},dhtmlXToolbarObject.prototype.getType=function(t){var e=this.getParentId(t);if(null!=e){var i=null,s=this.objPull[this.idPrefix+e]._listOptions[t];return null!=s&&(i=null!=s.sep?"buttonSelectSeparator":"buttonSelectButton"),i}return null==this.objPull[this.idPrefix+t]?null:this.objPull[this.idPrefix+t].type},dhtmlXToolbarObject.prototype.getTypeExt=function(t){var e=this.getType(t);return"buttonSelectButton"==e||"buttonSelectSeparator"==e?e="buttonSelectButton"==e?"button":"separator":null},dhtmlXToolbarObject.prototype.inArray=function(t,e){for(var i=0;i<t.length;i++)if(t[i]==e)return!0;return!1},dhtmlXToolbarObject.prototype.getParentId=function(t){var e=null;for(var i in this.objPull)if(this.objPull[i]._listOptions)for(var s in this.objPull[i]._listOptions)s==t&&(e=String(i).replace(this.idPrefix,""));return e},dhtmlXToolbarObject.prototype._addItem=function(t,e){"string"==typeof t.text&&(t.text=window.dhx4.trim(t.text),0==t.text.length&&(t.text=null)),this._addItemToStorage(t,e),"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype.addButton=function(t,e,i,s,l){this._addItem({id:t,type:"button",text:i,img:s,imgdis:l},e)},dhtmlXToolbarObject.prototype.addText=function(t,e,i){this._addItem({id:t,type:"text",text:i},e)},dhtmlXToolbarObject.prototype.addButtonSelect=function(t,e,i,s,l,n,o,r,h,a){for(var d=[],c=0;c<s.length;c++){var u={};s[c]instanceof Array?(u.id=s[c][0],u.type="obj"==s[c][1]?"button":"separator",u.text=s[c][2]||null,u.img=s[c][3]||null):s[c]instanceof Object&&null!=s[c]&&"undefined"!=typeof s[c].id&&"undefined"!=typeof s[c].type&&(u.id=s[c].id,u.type="obj"==s[c].type?"button":"separator",u.text=s[c].text,u.img=s[c].img),d.push(u)}this._addItem({id:t,type:"buttonSelect",text:i,img:l,imgdis:n,renderSelect:o,openAll:r,options:d,maxOpen:h,mode:a},e)},dhtmlXToolbarObject.prototype.addButtonTwoState=function(t,e,i,s,l){this._addItem({id:t,type:"buttonTwoState",img:s,imgdis:l,text:i},e)},dhtmlXToolbarObject.prototype.addSeparator=function(t,e){this._addItem({id:t,type:"separator"},e)},dhtmlXToolbarObject.prototype.addSlider=function(t,e,i,s,l,n,o,r,h){this._addItem({id:t,type:"slider",length:i,valueMin:s,valueMax:l,valueNow:n,textMin:o,textMax:r,toolTip:h},e)},dhtmlXToolbarObject.prototype.addInput=function(t,e,i,s){this._addItem({id:t,type:"buttonInput",value:i,width:s},e)},dhtmlXToolbarObject.prototype.forEachItem=function(t){for(var e in this.objPull)this.inArray(this.rootTypes,this.objPull[e].type)&&t(this.objPull[e].id.replace(this.idPrefix,""))},function(){for(var t="isVisible,enableItem,disableItem,isEnabled,setItemText,getItemText,setItemToolTip,getItemToolTip,getInput,setItemImage,setItemImageDis,clearItemImage,clearItemImageDis,setItemState,getItemState,setItemToolTipTemplate,getItemToolTipTemplate,setValue,getValue,setMinValue,getMinValue,setMaxValue,getMaxValue,setWidth,getWidth,setMaxOpen".split(","),e=[!1,"","",!1,"","","","","","","","","",!1,"","","",null,"",[null,null],"",[null,null],"",null],i=function(t,e){return function(i,s,l){return i=this.idPrefix+i,null!=this.objPull[i][t]?this.objPull[i][t].call(this.objPull[i],s,l):e}},s=0;s<t.length;s++){var l=t[s],n=e[s];dhtmlXToolbarObject.prototype[l]=i(l,n)}}(),dhtmlXToolbarObject.prototype.showItem=function(t){t=this.idPrefix+t,null!=this.objPull[t]&&null!=this.objPull[t].showItem&&(this.objPull[t].showItem(),"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin())},dhtmlXToolbarObject.prototype.hideItem=function(t){t=this.idPrefix+t,null!=this.objPull[t]&&null!=this.objPull[t].hideItem&&(this.objPull[t].hideItem(),"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin())},dhtmlXToolbarObject.prototype.getPosition=function(t){return this._getPosition(t)},dhtmlXToolbarObject.prototype._getPosition=function(t,e){if(null==this.objPull[this.idPrefix+t])return null;for(var i=null,s=0,l=0;l<this.base.childNodes.length;l++)null!=this.base.childNodes[l].idd&&(this.base.childNodes[l].idd==t&&(i=s),s++);if(!i&&null!=this._spacer)for(var l=0;l<this._spacer.childNodes.length;l++)null!=this._spacer.childNodes[l].idd&&(this._spacer.childNodes[l].idd==t&&(i=s),s++);return i},dhtmlXToolbarObject.prototype.setPosition=function(t,e){this._setPosition(t,e)},dhtmlXToolbarObject.prototype._setPosition=function(t,e){if(null!=this.objPull[this.idPrefix+t]){var i=null;this._spacer&&(i=this._spacer.idd,this.removeSpacer()),isNaN(e)&&(e=this.base.childNodes.length),e<0&&(e=0);var s=this.objPull[this.idPrefix+t];this.base.removeChild(s.obj),s.arw&&this.base.removeChild(s.arw);var l=this._getIdByPosition(e,!0);null==l[0]?(this.base.appendChild(s.obj),s.arw&&this.base.appendChild(s.arw)):(this.base.insertBefore(s.obj,this.base.childNodes[l[1]]),s.arw&&this.base.insertBefore(s.arw,this.base.childNodes[l[1]+1])),null!=i&&this.addSpacer(i)}},dhtmlXToolbarObject.prototype._getIdByPosition=function(t,e){for(var i=null,s=0,l=0,n=0;n<this.base.childNodes.length;n++)null!=this.base.childNodes[n].idd&&null==i&&s++==t&&(i=this.base.childNodes[n].idd),null==i&&l++;return l=null==i?null:l,1==e?new Array(i,l):i},dhtmlXToolbarObject.prototype.removeItem=function(t){this._removeItem(t),"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype._removeItem=function(t){var e=this.getType(t);t=this.idPrefix+t;var i=this.objPull[t];if("button"==e&&(i.obj._doOnMouseOver=null,i.obj._doOnMouseOut=null,i.obj._doOnMouseUp=null,i.obj._doOnMouseUpOnceAnywhere=null,i.obj.onclick=null,i.obj.onmouseover=null,i.obj.onmouseout=null,i.obj.onmouseup=null,i.obj.onmousedown=null,i.obj.onselectstart=null,i.obj.renderAs=null,i.obj.idd=null,i.obj.parentNode.removeChild(i.obj),i.obj=null,i.id=null,i.state=null,i.img=null,i.imgEn=null,i.imgDis=null,i.type=null,i.enableItem=null,i.disableItem=null,i.isEnabled=null,i.showItem=null,i.hideItem=null,i.isVisible=null,i.setItemText=null,i.getItemText=null,i.setItemImage=null,i.clearItemImage=null,i.setItemImageDis=null,i.clearItemImageDis=null,i.setItemToolTip=null,i.getItemToolTip=null),"buttonTwoState"==e&&(i.obj._doOnMouseOver=null,i.obj._doOnMouseOut=null,i.obj.onmouseover=null,i.obj.onmouseout=null,i.obj.onmousedown=null,i.obj.onselectstart=null,i.obj.renderAs=null,i.obj.idd=null,i.obj.parentNode.removeChild(i.obj),i.obj=null,i.id=null,i.state=null,i.img=null,i.imgEn=null,i.imgDis=null,i.type=null,i.enableItem=null,i.disableItem=null,i.isEnabled=null,i.showItem=null,i.hideItem=null,i.isVisible=null,i.setItemText=null,i.getItemText=null,i.setItemImage=null,i.clearItemImage=null,i.setItemImageDis=null,i.clearItemImageDis=null,i.setItemToolTip=null,i.getItemToolTip=null,i.setItemState=null,i.getItemState=null),"buttonSelect"==e){for(var s in i._listOptions)this.removeListOption(t,s);i._listOptions=null,i.polygon._ie6cover&&(document.body.removeChild(i.polygon._ie6cover),i.polygon._ie6cover=null),i.p_tbl.removeChild(i.p_tbody),i.polygon.removeChild(i.p_tbl),i.polygon.onselectstart=null,document.body.removeChild(i.polygon),i.p_tbody=null,i.p_tbl=null,i.polygon=null,i.obj.onclick=null,i.obj.onmouseover=null,i.obj.onmouseout=null,i.obj.onmouseup=null,i.obj.onmousedown=null,i.obj.onselectstart=null,i.obj.idd=null,i.obj.iddPrefix=null,i.obj.parentNode.removeChild(i.obj),i.obj=null,i.arw.onclick=null,i.arw.onmouseover=null,i.arw.onmouseout=null,i.arw.onmouseup=null,i.arw.onmousedown=null,i.arw.onselectstart=null,i.arw.parentNode.removeChild(i.arw),i.arw=null,i.renderSelect=null,i.state=null,i.type=null,i.id=null,i.img=null,i.imgEn=null,i.imgDis=null,i.openAll=null,i._isListButton=null,i._separatorButtonSelectObject=null,i._buttonButtonSelectObject=null,i.setWidth=null,i.enableItem=null,i.disableItem=null,i.isEnabled=null,i.showItem=null,i.hideItem=null,i.isVisible=null,i.setItemText=null,i.getItemText=null,i.setItemImage=null,i.clearItemImage=null,i.setItemImageDis=null,i.clearItemImageDis=null,i.setItemToolTip=null,i.getItemToolTip=null,i.addListOption=null,i.removeListOption=null,i.showListOption=null,i.hideListOption=null,i.isListOptionVisible=null,i.enableListOption=null,i.disableListOption=null,i.isListOptionEnabled=null,i.setListOptionPosition=null,i.getListOptionPosition=null,i.setListOptionImage=null,i.getListOptionImage=null,i.clearListOptionImage=null,i.setListOptionText=null,i.getListOptionText=null,i.setListOptionToolTip=null,i.getListOptionToolTip=null,i.forEachListOption=null,i.getAllListOptions=null,i.setListOptionSelected=null,i.getListOptionSelected=null}if("buttonInput"==e&&(i.obj.childNodes[0].onkeydown=null,i.obj.removeChild(i.obj.childNodes[0]),i.obj.w=null,i.obj.idd=null,i.obj.parentNode.removeChild(i.obj),i.obj=null,i.id=null,i.type=null,i.enableItem=null,i.disableItem=null,i.isEnabled=null,i.showItem=null,i.hideItem=null,i.isVisible=null,i.setItemToolTip=null,i.getItemToolTip=null,i.setWidth=null,i.getWidth=null,i.setValue=null,i.getValue=null,i.setItemText=null,i.getItemText=null),"slider"==e){for(window.dhx4.isIPad?(document.removeEventListener("touchmove",pen._doOnMouseMoveStart,!1),document.removeEventListener("touchend",pen._doOnMouseMoveEnd,!1)):"function"==typeof window.addEventListener?(window.removeEventListener("mousemove",i.pen._doOnMouseMoveStart,!1),window.removeEventListener("mouseup",i.pen._doOnMouseMoveEnd,!1)):(document.body.detachEvent("onmousemove",i.pen._doOnMouseMoveStart),document.body.detachEvent("onmouseup",i.pen._doOnMouseMoveEnd)),i.pen.allowMove=null,i.pen.initXY=null,i.pen.maxX=null,i.pen.minX=null,i.pen.nowX=null,i.pen.newNowX=null,i.pen.valueMax=null,i.pen.valueMin=null,i.pen.valueNow=null,i.pen._definePos=null,i.pen._detectLimits=null,i.pen._doOnMouseMoveStart=null,i.pen._doOnMouseMoveEnd=null,i.pen.onmousedown=null,i.obj.removeChild(i.pen),i.pen=null,i.label.tip=null,document.body.removeChild(i.label),i.label=null,i.obj.onselectstart=null,i.obj.idd=null;i.obj.childNodes.length>0;)i.obj.removeChild(i.obj.childNodes[0]);i.obj.parentNode.removeChild(i.obj),i.obj=null,i.id=null,i.type=null,i.state=null,i.enableItem=null,i.disableItem=null,i.isEnabled=null,i.setItemToolTipTemplate=null,i.getItemToolTipTemplate=null,i.setMaxValue=null,i.setMinValue=null,i.getMaxValue=null,i.getMinValue=null,i.setValue=null,i.getValue=null,i.showItem=null,i.hideItem=null,i.isVisible=null}"separator"==e&&(i.obj.onselectstart=null,i.obj.idd=null,i.obj.parentNode.removeChild(i.obj),i.obj=null,i.id=null,i.type=null,i.showItem=null,i.hideItem=null,i.isVisible=null),"text"==e&&(i.obj.onselectstart=null,i.obj.idd=null,i.obj.parentNode.removeChild(i.obj),i.obj=null,i.id=null,i.type=null,i.showItem=null,i.hideItem=null,i.isVisible=null,i.setWidth=null,i.setItemText=null,i.getItemText=null),e=null,i=null,this.objPull[this.idPrefix+t]=null,delete this.objPull[this.idPrefix+t]},function(){for(var t="addListOption,removeListOption,showListOption,hideListOption,isListOptionVisible,enableListOption,disableListOption,isListOptionEnabled,setListOptionPosition,getListOptionPosition,setListOptionText,getListOptionText,setListOptionToolTip,getListOptionToolTip,setListOptionImage,getListOptionImage,clearListOptionImage,forEachListOption,getAllListOptions,setListOptionSelected,getListOptionSelected".split(","),e=function(t){return function(e,i,s,l,n,o){if(e=this.idPrefix+e,null!=this.objPull[e]&&"buttonSelect"==this.objPull[e].type)return this.objPull[e][t].call(this.objPull[e],i,s,l,n,o)}},i=0;i<t.length;i++){var s=t[i];dhtmlXToolbarObject.prototype[s]=e(s)}}(),dhtmlXToolbarObject.prototype._rtlParseBtn=function(t,e){return t+e},dhtmlXToolbarObject.prototype._separatorObject=function(t,e,i){return this.id=t.idPrefix+e,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_sep",this.obj.style.display=null!=i.hidden?"none":"",this.obj.idd=String(e),this.obj.title=i.title||"",this.obj.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},this.obj.ontouchstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1},t.base.appendChild(this.obj),this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this},dhtmlXToolbarObject.prototype._textObject=function(t,e,i){return this.id=t.idPrefix+e,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_text",this.obj.style.display=null!=i.hidden?"none":"",this.obj.idd=String(e),this.obj.title=i.title||"",this.obj.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},this.obj.ontouchstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,t.cancelBubble=!0,!1},this.obj.innerHTML=i.text||"",t.base.appendChild(this.obj),this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(t){this.obj.innerHTML=t},this.getItemText=function(){return this.obj.innerHTML},this.setWidth=function(t){this.obj.style.width=t+"px"},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this},dhtmlXToolbarObject.prototype._buttonObject=function(t,e,i){this.id=t.idPrefix+e,this.state=null==i.enabled,this.imgEn=i.img||"",this.imgDis=i.imgdis||"",this.img=this.state?""!=this.imgEn?this.imgEn:"":""!=this.imgDis?this.imgDis:"",this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis"),this.obj.style.display=null!=i.hidden?"none":"",this.obj.allowClick=!1,this.obj.extAction=i.action||null,this.obj.renderAs=this.obj.className,this.obj.idd=String(e),this.obj.title=i.title||"",this.obj.pressed=!1,this.obj.innerHTML=t._rtlParseBtn(""!=this.img?"<img src='"+t.conf.icons_path+this.img+"'>":"",null!=i.text?"<div class='dhxtoolbar_text'>"+i.text+"</div>":"");var s=this;return this.obj.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},this.obj.onmouseover=function(){this._doOnMouseOver()},this.obj.onmouseout=function(){this._doOnMouseOut()},this.obj._doOnMouseOver=function(){this.allowClick=!0,0!=s.state&&"none"==t.anyUsed&&(this.className="dhx_toolbar_btn dhxtoolbar_btn_over",this.renderAs=this.className)},this.obj._doOnMouseOut=function(){this.allowClick=!1,0!=s.state&&"none"==t.anyUsed&&(this.className="dhx_toolbar_btn dhxtoolbar_btn_def",this.renderAs=this.renderAs)},this.obj.onclick=function(e){if(0!=s.state&&0!=this.allowClick){e=e||event;var i=this.idd.replace(t.idPrefix,"");if(this.extAction)try{window[this.extAction](i)}catch(t){}t&&t.callEvent&&t.callEvent("onClick",[i])}},this.obj[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(e){if(0==s.state)return e=e||event,e.preventDefault?e.preventDefault():e.returnValue=!1,e.cancelBubble=!0,!1;if("none"==t.anyUsed)return t.anyUsed=this.idd,this.className="dhx_toolbar_btn dhxtoolbar_btn_pres",this.pressed=!0,this.onmouseover=function(){this._doOnMouseOver()},this.onmouseout=function(){t.anyUsed="none",this._doOnMouseOut()},!1},this.obj[window.dhx4.isIPad?"ontouchend":"onmouseup"]=function(i){if(0!=s.state&&("none"==t.anyUsed||t.anyUsed==this.idd)){var l=t.anyUsed;if(this._doOnMouseUp(),window.dhx4.isIPad&&"none"!=l){if(this.extAction){var n=this;window.setTimeout(function(){try{window[n.extAction](e)}catch(t){}n=null},1)}t.callEvent("onClick",[this.idd.replace(t.idPrefix,"")])}}},window.dhx4.isIPad&&(this.obj.ontouchmove=function(t){this._doOnMouseUp()}),this.obj._doOnMouseUp=function(){t.anyUsed="none",this.className=this.renderAs,this.pressed=!1},this.obj._doOnMouseUpOnceAnywhere=function(){this._doOnMouseUp(),this.onmouseover=function(){this._doOnMouseOver()},this.onmouseout=function(){this._doOnMouseOut()}},t.base.appendChild(this.obj),this.enableItem=function(){t._enableItem(this)},this.disableItem=function(){t._disableItem(this)},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(e){t._setItemText(this,e)},this.getItemText=function(){return t._getItemText(this)},this.setItemImage=function(e){t._setItemImage(this,e,!0)},this.clearItemImage=function(){t._clearItemImage(this,!0)},this.setItemImageDis=function(e){t._setItemImage(this,e,!1)},this.clearItemImageDis=function(){t._clearItemImage(this,!1)},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this},dhtmlXToolbarObject.prototype._buttonSelectObject=function(t,e,i){this.id=t.idPrefix+e,this.state=null==i.enabled||"true"==i.enabled,this.imgEn=i.img||"",this.imgDis=i.imgdis||"",this.img=this.state?""!=this.imgEn?this.imgEn:"":""!=this.imgDis?this.imgDis:"",this.mode=i.mode||"button","select"==this.mode?(this.openAll=!0,this.renderSelect=!1,i.text&&0!=i.text.length||(i.text="&nbsp;")):(this.openAll=1==window.dhx4.s2b(i.openAll),this.renderSelect=null==i.renderSelect||window.dhx4.s2b(i.renderSelect)),this.maxOpen=isNaN(i.maxOpen?i.maxOpen:"")?null:i.maxOpen,this._maxOpenTest=function(){if(!isNaN(this.maxOpen)&&!t._sbw){var e=document.createElement("DIV");e.className="dhxtoolbar_maxopen_test",document.body.appendChild(e);var i=document.createElement("DIV");i.className="dhxtoolbar_maxopen_test2",e.appendChild(i),t._sbw=e.offsetWidth-i.offsetWidth,e.removeChild(i),i=null,document.body.removeChild(e),e=null}},this._maxOpenTest(),this.obj=document.createElement("DIV"),this.obj.allowClick=!1,this.obj.extAction=i.action||null,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis"),this.obj.style.display=null!=i.hidden?"none":"",this.obj.renderAs=this.obj.className,this.obj.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},this.obj.idd=String(e),this.obj.title=i.title||"",this.obj.pressed=!1,this.callEvent=!1,this.obj.innerHTML=t._rtlParseBtn(""!=this.img?"<img src='"+t.conf.icons_path+this.img+"'>":"",null!=i.text?"<div class='dhxtoolbar_text'>"+i.text+"</div>":""),t.base.appendChild(this.obj),this.arw=document.createElement("DIV"),this.arw.className="dhx_toolbar_arw dhxtoolbar_btn_"+(this.state?"def":"dis"),this.arw.style.display=this.obj.style.display,this.arw.innerHTML="<div class='arwimg'>&nbsp;</div>",this.arw.title=this.obj.title,this.arw.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},t.base.appendChild(this.arw);var s=this;if(this.obj.onmouseover=function(e){e=e||event,"none"==t.anyUsed&&s.state&&(s.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over",s.obj.className=s.obj.renderAs,s.arw.className=String(s.obj.renderAs).replace("btn","arw"))},this.obj.onmouseout=function(){s.obj.allowClick=!1,"none"==t.anyUsed&&s.state&&(s.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",s.obj.className=s.obj.renderAs,s.arw.className=String(s.obj.renderAs).replace("btn","arw"),s.callEvent=!1)},this.arw.onmouseover=this.obj.onmouseover,this.arw.onmouseout=this.obj.onmouseout,1==this.openAll||(this.obj.onclick=function(e){if(e=e||event,s.obj.allowClick&&s.state&&"none"==t.anyUsed){var i=s.obj.idd.replace(t.idPrefix,"");if(s.obj.extAction)try{window[s.obj.extAction](i)}catch(t){}t.callEvent("onClick",[i])}},this.obj[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(e){e=e||event,"none"==t.anyUsed&&s.state&&(s.obj.allowClick=!0,s.obj.className="dhx_toolbar_btn dhxtoolbar_btn_pres",s.arw.className="dhx_toolbar_arw dhxtoolbar_btn_pres",s.callEvent=!0)},this.obj[window.dhx4.isIPad?"ontouchend":"onmouseup"]=function(e){if(e=e||event,e.cancelBubble=!0,"none"==t.anyUsed&&s.state&&(s.obj.className=s.obj.renderAs,s.arw.className=String(s.obj.renderAs).replace("btn","arw"),window.dhx4.isIPad)){if(this.extAction){var i=this;window.setTimeout(function(){try{window[i.extAction](l)}catch(t){}i=null},1)}if(s.callEvent){var l=s.obj.idd.replace(t.idPrefix,"");t.callEvent("onClick",[l])}}}),window.dhx4.isIPad&&(this.obj.ontouchmove=this.obj.onmouseout),this.arw[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(e){e=e||event;var i=0===this.className.indexOf("dhx_toolbar_arw")?this:this.nextSibling;if(i._skip?(e=e||event,e.cancelBubble=!0):i._skip=!0,i=null,s.state){if(t.anyUsed==s.obj.idd)s.obj.className=s.obj.renderAs,s.arw.className=String(s.obj.renderAs).replace("btn","arw"),t.anyUsed="none",window.dhx4.zim.clear(s.polygon._idd),s.polygon.style.display="none",s.polygon._ie6cover&&(s.polygon._ie6cover.style.display="none"),"dhx_terrace"==t.conf.skin&&t._improveTerraceButtonSelect(s.id,!0),t.callEvent("onButtonSelectHide",[s.obj.idd]);else{if("none"!=t.anyUsed&&"buttonSelect"==t.objPull[t.idPrefix+t.anyUsed].type){var l=t.objPull[t.idPrefix+t.anyUsed];"none"!=l.polygon.style.display&&(l.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",l.obj.className=l.obj.renderAs,l.arw.className=String(s.obj.renderAs).replace("btn","arw"),window.dhx4.zim.clear(l.polygon._idd),l.polygon.style.display="none",l.polygon._ie6cover&&(l.polygon._ie6cover.style.display="none"),"dhx_terrace"==t.conf.skin&&t._improveTerraceButtonSelect(l.id,!0),t.callEvent("onButtonSelectHide",[l.obj.idd]))}s.obj.className="dhx_toolbar_btn dhxtoolbar_btn_over",s.arw.className="dhx_toolbar_arw dhxtoolbar_btn_pres",t.anyUsed=s.obj.idd,s.polygon.style.top="0px",s.polygon.style.visibility="hidden",s.polygon.style.zIndex=window.dhx4.zim.reserve(s.polygon._idd),s.polygon.style.display="","dhx_terrace"==t.conf.skin&&t._improveTerraceButtonSelect(s.id,!1),s._fixMaxOpenHeight(s.maxOpen||null),t._autoDetectVisibleArea();var n=window.dhx4.absTop(s.obj)+s.obj.offsetHeight+t.conf.sel_ofs_y,o=s.polygon.offsetHeight;if(n+o>t.tY2){var r=null!=s.maxOpen?Math.floor((t.tY2-n)/22):0;r>=1?s._fixMaxOpenHeight(r):(n=window.dhx4.absTop(s.obj)-o-t.conf.sel_ofs_y,n<0&&(n=0))}if(s.polygon.style.top=n+"px",t.rtl)s.polygon.style.left=window.dhx4.absLeft(s.obj)+s.obj.offsetWidth-s.polygon.offsetWidth+t.conf.sel_ofs_x+"px";else{var h=document.body.scrollLeft,a=h+(window.innerWidth||document.body.clientWidth),d=window.dhx4.absLeft(s.obj)+t.conf.sel_ofs_x;d+s.polygon.offsetWidth>a&&(d=window.dhx4.absLeft(s.arw)+s.arw.offsetWidth-s.polygon.offsetWidth),s.polygon.style.left=Math.max(d,5)+"px"}s.polygon.style.visibility="visible",s.polygon._ie6cover&&(s.polygon._ie6cover.style.left=s.polygon.style.left,s.polygon._ie6cover.style.top=s.polygon.style.top,s.polygon._ie6cover.style.width=s.polygon.offsetWidth+"px",s.polygon._ie6cover.style.height=s.polygon.offsetHeight+"px",s.polygon._ie6cover.style.display=""),t.callEvent("onButtonSelectShow",[s.obj.idd])}return!1}},this.arw.onclick=function(t){t=t||event,t.cancelBubble=!0},this.arw[window.dhx4.isIPad?"ontouchend":"onmouseup"]=function(t){t=t||event,t.cancelBubble=!0},this.openAll===!0&&(this.obj.onclick=this.arw.onclick,this.obj.onmousedown=this.arw.onmousedown,this.obj.onmouseup=this.arw.onmouseup,window.dhx4.isIPad&&(this.obj.ontouchstart=this.arw.ontouchstart,this.obj.ontouchend=this.arw.ontouchend)),this.obj.iddPrefix=t.idPrefix,this._listOptions={},this._fixMaxOpenHeight=function(e){var i="auto",l=!1;if(null!==e){var n=0;for(var o in this._listOptions)n++;n>e?(this._ph=22*e,i=this._ph+"px"):l=!0}this.polygon.style.width="auto",this.polygon.style.height="auto",l||null==s.maxOpen||(this.polygon.style.width=this.p_tbl.offsetWidth+t._sbw+"px",this.polygon.style.height=i)},this._separatorButtonSelectObject=function(t,e,i){return this.obj={},this.obj.tr=document.createElement("TR"),this.obj.tr.className="tr_sep",this.obj.tr.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},this.obj.td=document.createElement("TD"),this.obj.td.colSpan="2",this.obj.td.className="td_btn_sep",this.obj.td.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},isNaN(i)?i=s.p_tbody.childNodes.length+1:i<1&&(i=1),i>s.p_tbody.childNodes.length?s.p_tbody.appendChild(this.obj.tr):s.p_tbody.insertBefore(this.obj.tr,s.p_tbody.childNodes[i-1]),this.obj.tr.appendChild(this.obj.td),this.obj.sep=document.createElement("DIV"),this.obj.sep.className="btn_sep",this.obj.sep.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},this.obj.td.appendChild(this.obj.sep),s._listOptions[t]=this.obj,this},this._buttonButtonSelectObject=function(e,i,l){var n=!0;"undefined"!=typeof i.enabled?n=window.dhx4.s2b(i.enabled):"undefined"!=typeof i.disabled&&(n=window.dhx4.s2b(i.disabled)),this.obj={},this.obj.tr=document.createElement("TR"),this.obj.tr.en=n,this.obj.tr.extAction=i.action||null,this.obj.tr._selected=null!=i.selected,this.obj.tr.className="tr_btn"+(this.obj.tr.en?this.obj.tr._selected&&s.renderSelect?" tr_btn_selected":"":" tr_btn_disabled"),this.obj.tr.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},this.obj.tr.idd=String(e),isNaN(l)?l=s.p_tbody.childNodes.length+1:l<1&&(l=1),l>s.p_tbody.childNodes.length?s.p_tbody.appendChild(this.obj.tr):s.p_tbody.insertBefore(this.obj.tr,s.p_tbody.childNodes[l-1]),this.obj.td_a=document.createElement("TD"),this.obj.td_a.className="td_btn_img",this.obj.td_a.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},this.obj.td_b=document.createElement("TD"),this.obj.td_b.className="td_btn_txt",this.obj.td_b.onselectstart=function(t){return t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1,!1},t.rtl?(this.obj.tr.appendChild(this.obj.td_b),this.obj.tr.appendChild(this.obj.td_a)):(this.obj.tr.appendChild(this.obj.td_a),this.obj.tr.appendChild(this.obj.td_b)),null!=i.img?(this.obj.td_a.innerHTML="<img class='btn_sel_img' src='"+t.conf.icons_path+i.img+"' border='0'>",this.obj.tr._img=i.img):this.obj.td_a.innerHTML="&nbsp;";var o=null!=i.text?i.text:i.itemText||"";return this.obj.td_b.innerHTML="<div class='btn_sel_text'>"+o+"</div>",this.obj.tr.onmouseover=function(t){t=t||event,null==t.type.match(/touch/)&&(!this.en||this._selected&&s.renderSelect||(this.className="tr_btn tr_btn_over"))},this.obj.tr.onmouseout=function(t){t=t||event,null==t.type.match(/touch/)&&this.en&&(this._selected&&s.renderSelect?String(this.className).search("tr_btn_selected")==-1&&(this.className="tr_btn tr_btn_selected"):this.className="tr_btn")},this.obj.tr.ontouchstart=this.obj.tr.onmousedown=function(t){t=t||event,null==this._etype&&(this._etype=t.type)},this.obj.tr.onclick=function(e){if(e=e||event,e.cancelBubble=!0,this.en){if(s.setListOptionSelected(this.idd.replace(t.idPrefix,"")),s.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def",s.obj.className=s.obj.renderAs,s.arw.className=String(s.obj.renderAs).replace("btn","arw"),null!=this._etype&&null==this._etype.match(/touch/))window.dhx4.zim.clear(s.polygon._idd),s.polygon.style.display="none",s.polygon._ie6cover&&(s.polygon._ie6cover.style.display="none");else{var i=s.polygon;window.setTimeout(function(){window.dhx4.zim.clear(i._idd),i.style.display="none",i=null},500)}this._etype=null,"dhx_terrace"==t.conf.skin&&t._improveTerraceButtonSelect(s.id,!0),t.anyUsed="none",t.callEvent("onButtonSelectHide",[s.obj.idd]);var l=this.idd.replace(t.idPrefix,"");if(this.extAction)try{window[this.extAction](l)}catch(t){}t.callEvent("onClick",[l])}},s._listOptions[e]=this.obj,this},this.polygon=document.createElement("DIV"),this.polygon.dir="ltr",this.polygon.style.display="none",this.polygon.className="dhx_toolbar_poly_"+t.conf.skin+" dhxtoolbar_icons_"+t.conf.iconSize,this.polygon.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},this.polygon.onmousedown=function(t){t=t||event,t.cancelBubble=!0},this.polygon.style.overflowY="auto",this.polygon._idd=window.dhx4.newId(),this.polygon.ontouchstart=function(t){t=t||event,t.cancelBubble=!0},this.polygon.ontouchend=function(t){
t=t||event,t.cancelBubble=!0},this.p_tbl=document.createElement("TABLE"),this.p_tbl.className="buttons_cont",this.p_tbl.cellSpacing="0",this.p_tbl.cellPadding="0",this.p_tbl.border="0",this.polygon.appendChild(this.p_tbl),this.p_tbody=document.createElement("TBODY"),this.p_tbl.appendChild(this.p_tbody),null!=i.options)for(var l=0;l<i.options.length;l++){var n="_"+(i.options[l].type||"")+"ButtonSelectObject";null==i.options[l].id&&(i.options[l].id=t._genStr(24)),"function"==typeof this[n]&&new this[n](i.options[l].id,i.options[l])}return document.body.appendChild(this.polygon),window.dhx4.isIE6&&(this.polygon._ie6cover=document.createElement("IFRAME"),this.polygon._ie6cover.frameBorder=0,this.polygon._ie6cover.style.position="absolute",this.polygon._ie6cover.style.border="none",this.polygon._ie6cover.style.backgroundColor="#000000",this.polygon._ie6cover.style.filter="alpha(opacity=100)",this.polygon._ie6cover.style.display="none",this.polygon._ie6cover.setAttribute("src","javascript:false;"),document.body.appendChild(this.polygon._ie6cover)),this.setWidth=function(t){this.obj.style.width=t-this.arw.offsetWidth+"px",this.polygon.style.width=this.obj.offsetWidth+this.arw.offsetWidth-2+"px",this.p_tbl.style.width=this.polygon.style.width},this.enableItem=function(){t._enableItem(this)},this.disableItem=function(){t._disableItem(this)},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display="",this.arw.style.display=""},this.hideItem=function(){this.obj.style.display="none",this.arw.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(e){t._setItemText(this,e)},this.getItemText=function(){return t._getItemText(this)},this.setItemImage=function(e){t._setItemImage(this,e,!0)},this.clearItemImage=function(){t._clearItemImage(this,!0)},this.setItemImageDis=function(e){t._setItemImage(this,e,!1)},this.clearItemImageDis=function(){t._clearItemImage(this,!1)},this.setItemToolTip=function(t){this.obj.title=t,this.arw.title=t},this.getItemToolTip=function(){return this.obj.title},this.addListOption=function(t,e,i,s,l){if("button"==i||"separator"==i){var n={id:t,type:i,text:s,img:l};new this["_"+i+"ButtonSelectObject"](t,n,e)}},this.removeListOption=function(t){if(this._isListButton(t,!0)){var e=this._listOptions[t];if(null!=e.td_a&&null!=e.td_b){for(e.td_a.onselectstart=null,e.td_b.onselectstart=null;e.td_a.childNodes.length>0;)e.td_a.removeChild(e.td_a.childNodes[0]);for(;e.td_b.childNodes.length>0;)e.td_b.removeChild(e.td_b.childNodes[0]);for(e.tr.onselectstart=null,e.tr.onmouseover=null,e.tr.onmouseout=null,e.tr.onclick=null,e.tr.ontouchstart=null,e.tr.onmousedown=null;e.tr.childNodes.length>0;)e.tr.removeChild(e.tr.childNodes[0]);e.tr.parentNode.removeChild(e.tr),e.td_a=null,e.td_b=null,e.tr=null}else{for(e.sep.onselectstart=null,e.td.onselectstart=null,e.tr.onselectstart=null;e.td.childNodes.length>0;)e.td.removeChild(e.td.childNodes[0]);for(;e.tr.childNodes.length>0;)e.tr.removeChild(e.tr.childNodes[0]);e.tr.parentNode.removeChild(e.tr),e.sep=null,e.td=null,e.tr=null}e=null,this._listOptions[t]=null;try{delete this._listOptions[t]}catch(t){}}},this.showListOption=function(t){this._isListButton(t,!0)&&(this._listOptions[t].tr.style.display="")},this.hideListOption=function(t){this._isListButton(t,!0)&&(this._listOptions[t].tr.style.display="none")},this.isListOptionVisible=function(t){if(this._isListButton(t,!0))return"none"!=this._listOptions[t].tr.style.display},this.enableListOption=function(e){this._isListButton(e)&&(this._listOptions[e].tr.en=!0,this._listOptions[e].tr.className="tr_btn"+(this._listOptions[e].tr._selected&&t.renderSelect?" tr_btn_selected":""))},this.disableListOption=function(t){this._isListButton(t)&&(this._listOptions[t].tr.en=!1,this._listOptions[t].tr.className="tr_btn tr_btn_disabled")},this.isListOptionEnabled=function(t){if(this._isListButton(t))return this._listOptions[t].tr.en},this.setListOptionPosition=function(t,e){if(this._listOptions[t]&&this.getListOptionPosition(t)!=e&&!isNaN(e)){e<1&&(e=1);var i=this._listOptions[t].tr;this.p_tbody.removeChild(i),e>this.p_tbody.childNodes.length?this.p_tbody.appendChild(i):this.p_tbody.insertBefore(i,this.p_tbody.childNodes[e-1]),i=null}},this.getListOptionPosition=function(t){var e=-1;if(!this._listOptions[t])return e;for(var i=0;i<this.p_tbody.childNodes.length;i++)this.p_tbody.childNodes[i]==this._listOptions[t].tr&&(e=i+1);return e},this.setListOptionImage=function(e,i){if(this._isListButton(e)){var s=this._listOptions[e].tr.childNodes[t.rtl?1:0];s.innerHTML="<img src='"+t.conf.icons_path+i+"' class='btn_sel_img'>",s=null}},this.getListOptionImage=function(e){if(this._isListButton(e)){var i=this._listOptions[e].tr.childNodes[t.rtl?1:0],s=null;return i.childNodes.length>0&&(s=i.childNodes[0].src),i=null,s}},this.clearListOptionImage=function(e){if(this._isListButton(e)){for(var i=this._listOptions[e].tr.childNodes[t.rtl?1:0];i.childNodes.length>0;)i.removeChild(i.childNodes[0]);i.innerHTML="&nbsp;",i=null}},this.setListOptionText=function(e,i){this._isListButton(e)&&(this._listOptions[e].tr.childNodes[t.rtl?0:1].childNodes[0].innerHTML=i)},this.getListOptionText=function(e){if(this._isListButton(e))return this._listOptions[e].tr.childNodes[t.rtl?0:1].childNodes[0].innerHTML},this.setListOptionToolTip=function(t,e){this._isListButton(t)&&(this._listOptions[t].tr.title=e)},this.getListOptionToolTip=function(t){if(this._isListButton(t))return this._listOptions[t].tr.title},this.forEachListOption=function(t){for(var e in this._listOptions)t(e)},this.getAllListOptions=function(){var t=new Array;for(var e in this._listOptions)t[t.length]=e;return t},this.setListOptionSelected=function(t){for(var e in this._listOptions){var i=this._listOptions[e];null!=i.td_a&&null!=i.td_b&&i.tr.en&&(e==t?(i.tr._selected=!0,i.tr.className="tr_btn"+(this.renderSelect?" tr_btn_selected":""),"select"==this.mode&&(i.tr._img?this.setItemImage(i.tr._img):this.clearItemImage(),this.setItemText(this.getListOptionText(t)))):(i.tr._selected=!1,i.tr.className="tr_btn")),i=null}},this.getListOptionSelected=function(){var t=null;for(var e in this._listOptions)1==this._listOptions[e].tr._selected&&(t=e);return t},this._isListButton=function(t,e){return null!=this._listOptions[t]&&!(!e&&"tr_sep"==this._listOptions[t].tr.className)},this.setMaxOpen=function(t){return this._ph=null,"number"==typeof t?(this.maxOpen=t,void this._maxOpenTest()):void(this.maxOpen=null)},i.width&&this.setWidth(i.width),"select"==this.mode&&"undefined"!=typeof i.selected&&this.setListOptionSelected(i.selected),this},dhtmlXToolbarObject.prototype._buttonInputObject=function(t,e,i){this.id=t.idPrefix+e,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def",this.obj.style.display=null!=i.hidden?"none":"",this.obj.idd=String(e),this.obj.w=null!=i.width?i.width:100,this.obj.title=null!=i.title?i.title:"",this.obj.innerHTML="<input class='dhxtoolbar_input' type='text' style='width:"+this.obj.w+"px;'"+(null!=i.value?" value='"+i.value+"'":"")+">";var s=t,l=this;return this.obj.childNodes[0].onkeydown=function(t){t=t||event,13==t.keyCode&&s.callEvent("onEnter",[l.obj.idd,this.value])},t.base.appendChild(this.obj),this.enableItem=function(){this.obj.childNodes[0].disabled=!1},this.disableItem=function(){this.obj.childNodes[0].disabled=!0},this.isEnabled=function(){return!this.obj.childNodes[0].disabled},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return"none"!=this.obj.style.display},this.setValue=function(t){this.obj.childNodes[0].value=t},this.getValue=function(){return this.obj.childNodes[0].value},this.setWidth=function(t){this.obj.w=t,this.obj.childNodes[0].style.width=this.obj.w+"px"},this.getWidth=function(){return this.obj.w},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this.getInput=function(){return this.obj.firstChild},"undefined"!=typeof i.enabled&&0==window.dhx4.s2b(i.enabled)&&this.disableItem(),this},dhtmlXToolbarObject.prototype._buttonTwoStateObject=function(t,e,i){this.id=t.idPrefix+e,this.state=null==i.enabled,this.imgEn=null!=i.img?i.img:"",this.imgDis=null!=i.imgdis?i.imgdis:"",this.img=this.state?""!=this.imgEn?this.imgEn:"":""!=this.imgDis?this.imgDis:"",this.obj=document.createElement("DIV"),this.obj.pressed=null!=i.selected,this.obj.extAction=i.action||null,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.obj.pressed?"pres"+(this.state?"":"_dis"):this.state?"def":"dis"),this.obj.style.display=null!=i.hidden?"none":"",this.obj.renderAs=this.obj.className,this.obj.idd=String(e),this.obj.title=i.title||"",this.obj.pressed&&(this.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over"),this.obj.innerHTML=t._rtlParseBtn(""!=this.img?"<img src='"+t.conf.icons_path+this.img+"'>":"",null!=i.text?"<div class='dhxtoolbar_text'>"+i.text+"</div>":""),t.base.appendChild(this.obj);var s=this;return this.obj.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},this.obj.onmouseover=function(){this._doOnMouseOver()},this.obj.onmouseout=function(){this._doOnMouseOut()},this.obj._doOnMouseOver=function(){if(0!=s.state&&"none"==t.anyUsed){if(this.pressed)return void(this.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over");this.className="dhx_toolbar_btn dhxtoolbar_btn_over",this.renderAs=this.className}},this.obj._doOnMouseOut=function(){if(0!=s.state&&"none"==t.anyUsed){if(this.pressed)return void(this.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def");this.className="dhx_toolbar_btn dhxtoolbar_btn_def",this.renderAs=this.className}},this.obj[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(e){if((!t.checkEvent("onBeforeStateChange")||t.callEvent("onBeforeStateChange",[this.idd.replace(t.idPrefix,""),this.pressed]))&&0!=s.state&&"none"==t.anyUsed){this.pressed=!this.pressed,this.className=this.pressed?"dhx_toolbar_btn dhxtoolbar_btn_pres":this.renderAs;var i=this.idd.replace(t.idPrefix,"");if(this.extAction)try{window[this.extAction](i,this.pressed)}catch(t){}return t.callEvent("onStateChange",[i,this.pressed]),!1}},this.setItemState=function(e,i){if(this.obj.pressed!=e&&(1==e?(this.obj.pressed=!0,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_pres"+(this.state?"":"_dis"),this.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over"):(this.obj.pressed=!1,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis"),this.obj.renderAs=this.obj.className),1==i)){var s=this.obj.idd.replace(t.idPrefix,"");if(this.obj.extAction)try{window[this.obj.extAction](s,this.obj.pressed)}catch(t){}t.callEvent("onStateChange",[s,this.obj.pressed])}},this.getItemState=function(){return this.obj.pressed},this.enableItem=function(){t._enableItem(this)},this.disableItem=function(){t._disableItem(this)},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(e){t._setItemText(this,e)},this.getItemText=function(){return t._getItemText(this)},this.setItemImage=function(e){t._setItemImage(this,e,!0)},this.clearItemImage=function(){t._clearItemImage(this,!0)},this.setItemImageDis=function(e){t._setItemImage(this,e,!1)},this.clearItemImageDis=function(){t._clearItemImage(this,!1)},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this},dhtmlXToolbarObject.prototype._sliderObject=function(t,e,i){this.id=t.idPrefix+e,this.state=null==i.enabled||"true"==i.enabled,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis"),this.obj.style.display=null!=i.hidden?"none":"",this.obj.onselectstart=function(t){t=t||event,t.preventDefault?t.preventDefault():t.returnValue=!1},this.obj.idd=String(e),this.obj.len=null!=i.length?Number(i.length):50,this.obj.innerHTML="<div class='dhxtoolbar_text'>"+(i.textMin||"")+"</div><div class='dhxtoolbar_sl_bg_l'></div><div class='dhxtoolbar_sl_bg_m' style='width:"+this.obj.len+"px;'></div><div class='dhxtoolbar_sl_bg_r'></div><div class='dhxtoolbar_text'>"+(i.textMax||"")+"</div>",t.base.appendChild(this.obj);var s=this;this.pen=document.createElement("DIV"),this.pen.className="dhxtoolbar_sl_pen",this.obj.appendChild(this.pen);var l=this.pen;this.label=document.createElement("DIV"),this.label.dir="ltr",this.label.className="dhx_toolbar_slider_label_"+t.conf.skin+(t.rtl?"_rtl":""),this.label.style.display="none",this.label.tip=i.toolTip||"%v",this.label._zi=window.dhx4.newId(),document.body.appendChild(this.label);var n=this.label;return this.pen.valueMin=null!=i.valueMin?Number(i.valueMin):0,this.pen.valueMax=null!=i.valueMax?Number(i.valueMax):100,this.pen.valueMin>this.pen.valueMax&&(this.pen.valueMin=this.pen.valueMax),this.pen.valueNow=null!=i.valueNow?Number(i.valueNow):this.pen.valueMax,this.pen.valueNow>this.pen.valueMax&&(this.pen.valueNow=this.pen.valueMax),this.pen.valueNow<this.pen.valueMin&&(this.pen.valueNow=this.pen.valueMin),this.pen._detectLimits=function(){this.minX=s.obj.childNodes[1].offsetLeft+2,this.maxX=s.obj.childNodes[3].offsetLeft-this.offsetWidth+1},this.pen._detectLimits(),this.pen._definePos=function(){this.nowX=Math.round((this.valueNow-this.valueMin)*(this.maxX-this.minX)/(this.valueMax-this.valueMin)+this.minX),this.style.left=this.nowX+"px",this.newNowX=this.nowX},this.pen._definePos(),this.pen.initXY=0,this.pen.allowMove=!1,this.pen[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(t){0!=s.state&&(t=t||event,this.initXY=window.dhx4.isIPad?t.touches[0].clientX:t.clientX,this.newValueNow=this.valueNow,this.allowMove=!0,this.className="dhxtoolbar_sl_pen dhxtoolbar_over",""!=n.tip&&(n.style.visibility="hidden",n.style.display="",n.innerHTML=n.tip.replace("%v",this.valueNow),n.style.left=Math.round(window.dhx4.absLeft(this)+this.offsetWidth/2-n.offsetWidth/2)+"px",n.style.top=window.dhx4.absTop(this)-n.offsetHeight-3+"px",n.style.visibility="",n.style.zIndex=window.dhx4.zim.reserve(n._zi)))},this.pen._doOnMouseMoveStart=function(t){if(t=t||event,l.allowMove){var e=window.dhx4.isIPad?t.touches[0].clientX:t.clientX,i=e-l.initXY;if(!(e<window.dhx4.absLeft(l)+Math.round(l.offsetWidth/2)&&l.nowX==l.minX||e>window.dhx4.absLeft(l)+Math.round(l.offsetWidth/2)&&l.nowX==l.maxX))return l.newNowX=l.nowX+i,l.newNowX<l.minX&&(l.newNowX=l.minX),l.newNowX>l.maxX&&(l.newNowX=l.maxX),l.nowX=l.newNowX,l.style.left=l.nowX+"px",l.initXY=e,l.newValueNow=Math.round((l.valueMax-l.valueMin)*(l.newNowX-l.minX)/(l.maxX-l.minX)+l.valueMin),""!=n.tip&&(n.innerHTML=n.tip.replace(/%v/gi,l.newValueNow),n.style.left=Math.round(window.dhx4.absLeft(l)+l.offsetWidth/2-n.offsetWidth/2)+"px",n.style.top=window.dhx4.absTop(l)-n.offsetHeight-3+"px"),t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,!1}},this.pen._doOnMouseMoveEnd=function(){l.allowMove&&(l.className="dhxtoolbar_sl_pen",l.allowMove=!1,l.nowX=l.newNowX,l.valueNow=l.newValueNow,""!=n.tip&&(n.style.display="none",window.dhx4.zim.clear(n._zi)),t.callEvent("onValueChange",[s.obj.idd.replace(t.idPrefix,""),l.valueNow]))},window.dhx4.isIPad?(document.addEventListener("touchmove",l._doOnMouseMoveStart,!1),document.addEventListener("touchend",l._doOnMouseMoveEnd,!1)):"undefined"!=typeof window.addEventListener?(window.addEventListener("mousemove",l._doOnMouseMoveStart,!1),window.addEventListener("mouseup",l._doOnMouseMoveEnd,!1)):(document.body.attachEvent("onmousemove",l._doOnMouseMoveStart),document.body.attachEvent("onmouseup",l._doOnMouseMoveEnd)),this.enableItem=function(){this.state||(this.state=!0,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def")},this.disableItem=function(){this.state&&(this.state=!1,this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_dis")},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setValue=function(e,i){e=Number(e),e<this.pen.valueMin&&(e=this.pen.valueMin),e>this.pen.valueMax&&(e=this.pen.valueMax),this.pen.valueNow=e,this.pen._definePos(),1==i&&t.callEvent("onValueChange",[this.obj.idd.replace(t.idPrefix,""),this.pen.valueNow])},this.getValue=function(){return this.pen.valueNow},this.setMinValue=function(t,e){t=Number(t),t>this.pen.valueMax||(this.obj.childNodes[0].innerHTML=e,this.obj.childNodes[0].style.display=e.length>0?"":"none",this.pen.valueMin=t,this.pen.valueNow<this.pen.valueMin&&(this.pen.valueNow=this.pen.valueMin),this.pen._detectLimits(),this.pen._definePos())},this.setMaxValue=function(t,e){t=Number(t),t<this.pen.valueMin||(this.obj.childNodes[4].innerHTML=e,this.obj.childNodes[4].style.display=e.length>0?"":"none",this.pen.valueMax=t,this.pen.valueNow>this.pen.valueMax&&(this.pen.valueNow=this.pen.valueMax),this.pen._detectLimits(),this.pen._definePos())},this.getMinValue=function(){var t=this.obj.childNodes[0].innerHTML,e=this.pen.valueMin;return new Array(e,t)},this.getMaxValue=function(){var t=this.obj.childNodes[4].innerHTML,e=this.pen.valueMax;return new Array(e,t)},this.setItemToolTipTemplate=function(t){this.label.tip=t},this.getItemToolTipTemplate=function(){return this.label.tip},this},dhtmlXToolbarObject.prototype.unload=function(){for("function"==typeof window.addEventListener?(window.removeEventListener("mousedown",this._doOnClick,!1),window.removeEventListener("touchstart",this._doOnClick,!1)):document.body.detachEvent("onmousedown",this._doOnClick),this._doOnClick=null,this.clearAll(),this.objPull=null,this._xmlLoader&&(this._xmlLoader.destructor(),this._xmlLoader=null);this.base.childNodes.length>0;)this.base.removeChild(this.base.childNodes[0]);for(this.cont.removeChild(this.base),this.base=null;this.cont.childNodes.length>0;)this.cont.removeChild(this.cont.childNodes[0]);this.cont.className="",this.cont=null,window.dhx4._enableDataLoading(this,null,null,null,"clear"),window.dhx4._eventable(this,"clear"),this.tX1=null,this.tX2=null,this.tY1=null,this.tY2=null,this.anyUsed=null,this.idPrefix=null,this.rootTypes=null,this._rtl=null,this._rtlParseBtn=null,this.setRTL=null,this._sbw=null,this._getObj=null,this._addImgObj=null,this._setItemImage=null,this._clearItemImage=null,this._setItemText=null,this._getItemText=null,this._enableItem=null,this._disableItem=null,this._xmlParser=null,this._addItemToStorage=null,this._genStr=null,this._addItem=null,this._getPosition=null,this._setPosition=null,this._getIdByPosition=null,this._separatorObject=null,this._textObject=null,this._buttonObject=null,this._buttonSelectObject=null,this._buttonInputObject=null,this._buttonTwoStateObject=null,this._sliderObject=null,this._autoDetectVisibleArea=null,this._removeItem=null,this.setAlign=null,this.setSkin=null,this.setIconsPath=null,this.setIconPath=null,this.loadXML=null,this.loadXMLString=null,this.clearAll=null,this.addSpacer=null,this.removeSpacer=null,this.getType=null,this.getTypeExt=null,this.inArray=null,this.getParentId=null,this.addButton=null,this.addText=null,this.addButtonSelect=null,this.addButtonTwoState=null,this.addSeparator=null,this.addSlider=null,this.addInput=null,this.forEachItem=null,this.showItem=null,this.hideItem=null,this.isVisible=null,this.enableItem=null,this.disableItem=null,this.isEnabled=null,this.setItemText=null,this.getItemText=null,this.setItemToolTip=null,this.getItemToolTip=null,this.setItemImage=null,this.setItemImageDis=null,this.clearItemImage=null,this.clearItemImageDis=null,this.setItemState=null,this.getItemState=null,this.setItemToolTipTemplate=null,this.getItemToolTipTemplate=null,this.setValue=null,this.getValue=null,this.setMinValue=null,this.getMinValue=null,this.setMaxValue=null,this.getMaxValue=null,this.setWidth=null,this.getWidth=null,this.getPosition=null,this.setPosition=null,this.removeItem=null,this.addListOption=null,this.removeListOption=null,this.showListOption=null,this.hideListOption=null,this.isListOptionVisible=null,this.enableListOption=null,this.disableListOption=null,this.isListOptionEnabled=null,this.setListOptionPosition=null,this.getListOptionPosition=null,this.setListOptionText=null,this.getListOptionText=null,this.setListOptionToolTip=null,this.getListOptionToolTip=null,this.setListOptionImage=null,this.getListOptionImage=null,this.clearListOptionImage=null,this.forEachListOption=null,this.getAllListOptions=null,this.setListOptionSelected=null,this.getListOptionSelected=null,this.unload=null,this.setUserData=null,this.getUserData=null,this.setMaxOpen=null,this.items=null,this.conf=null},dhtmlXToolbarObject.prototype._autoDetectVisibleArea=function(){var t=window.dhx4.screenDim();this.tX1=t.left,this.tX2=t.right,this.tY1=t.top,this.tY2=t.bottom},dhtmlXToolbarObject.prototype._initObj=function(t){for(var e=0;e<t.length;e++)this._addItemToStorage(t[e]);"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype._xmlToJson=function(t){var e=[],i=t.getElementsByTagName("toolbar");if(null!=i&&null!=i[0]){i=i[0];for(var s=function(t){for(var e=null,i=0;i<t.childNodes.length;i++)if(null==e&&"itemText"==t.childNodes[i].tagName){e=window.dhx4._xmlNodeValue(t.childNodes[i]);break}return e},l=["id","type","hidden","title","text","enabled","img","imgdis","action","openAll","renderSelect","mode","maxOpen","width","value","selected","length","textMin","textMax","toolTip","valueMin","valueMax","valueNow"],n=["id","type","enabled","disabled","action","selected","img","text"],o=0;o<i.childNodes.length;o++)if("item"==i.childNodes[o].tagName){for(var r={},h=0;h<l.length;h++){var a=i.childNodes[o].getAttribute(l[h]);null!=a&&(r[l[h]]=a)}for(var d=0;d<i.childNodes[o].childNodes.length;d++){if("item"==i.childNodes[o].childNodes[d].tagName&&"buttonSelect"==r.type){for(var c={},h=0;h<n.length;h++){var a=i.childNodes[o].childNodes[d].getAttribute(n[h]);null!=a&&(c[n[h]]=a)}for(var u=i.childNodes[o].childNodes[d].getElementsByTagName("userdata"),h=0;h<u.length;h++){c.userdata||(c.userdata={});var f={};try{f.name=u[h].getAttribute("name")}catch(t){f.name=null}try{f.value=u[h].firstChild.nodeValue}catch(t){f.value=""}null!=f.name&&(c.userdata[f.name]=f.value)}c.text=s(i.childNodes[o].childNodes[d])||c.text,null==r.options&&(r.options=[]),r.options.push(c)}if("userdata"==i.childNodes[o].childNodes[d].tagName){null==r.userdata&&(r.userdata={});var c={};try{c.name=i.childNodes[o].childNodes[d].getAttribute("name")}catch(t){c.name=null}try{c.value=i.childNodes[o].childNodes[d].firstChild.nodeValue}catch(t){c.value=""}null!=c.name&&(r.userdata[c.name]=c.value)}}r.text=s(i.childNodes[o])||r.text,e.push(r)}s=null}return e},dhtmlXToolbarObject.prototype._addItemToStorage=function(t,e){var i=t.id||this._genStr(24),s=t.type||"";if("spacer"==s?this.addSpacer(this._lastId):this._lastId=i,""!=s&&null!=this["_"+s+"Object"]){if("buttonSelect"==s&&null!=t.options)for(var l=0;l<t.options.length;l++)"obj"==t.options[l].type&&(t.options[l].type="button"),"sep"==t.options[l].type&&(t.options[l].type="separator");if("slider"==s){var n={tip_template:"toolTip",value_min:"valueMin",value_max:"valueMax",value_now:"valueNow",text_min:"textMin",text_max:"textMax"};for(var o in n)null==t[n[o]]&&null!=t[o]&&(t[n[o]]=t[o])}"buttonInput"==s&&null==t.value&&null!=t.text&&(t.value=t.text),"buttonTwoState"==s&&"undefined"==typeof t.selected&&"undefined"!=typeof t.pressed&&window.dhx4.s2b(t.pressed)&&(t.selected=!0),"undefined"==typeof t.enabled&&"undefined"!=typeof t.disabled&&window.dhx4.s2b(t.disabled)&&(t.enabled=!1),null==t.imgDis&&null!=t.img_disabled&&(t.imgdis=t.img_disabled),"undefined"!=typeof t.openAll&&null!=t.openAll||"dhx_terrace"!=this.conf.skin||(t.openAll=!0),this.objPull[this.idPrefix+i]=new this["_"+s+"Object"](this,i,t),this.objPull[this.idPrefix+i].type=s,this.setPosition(i,e)}if(null!=t.userdata)for(var o in t.userdata)this.setUserData(i,o,t.userdata[o]);if(null!=t.options)for(var l=0;l<t.options.length;l++)if(null!=t.options[l].userdata)for(var o in t.options[l].userdata)this.setListOptionUserData(t.id,t.options[l].id,o,t.options[l].userdata[o])},dhtmlXToolbarObject.prototype.setSkin=function(t,e){e===!0?this.cont.className=this.cont.className.replace(/dhxtoolbar_icons_\d{1,}/,"dhxtoolbar_icons_"+this.conf.iconSize):(this.conf.skin=t,"dhx_skyblue"==this.conf.skin&&(this.conf.sel_ofs_y=1),"dhx_web"==this.conf.skin&&(this.conf.sel_ofs_y=1,this.conf.sel_ofs_x=1),"dhx_terrace"==this.conf.skin&&(this.conf.sel_ofs_y=-1,this.conf.sel_ofs_x=0),this.cont.className="dhx_toolbar_"+this.conf.skin+" dhxtoolbar_icons_"+this.conf.iconSize);for(var i in this.objPull){var s=this.objPull[i];"slider"==s.type&&(s.pen._detectLimits(),s.pen._definePos(),s.label.className="dhx_toolbar_slider_label_"+this.conf.skin),"buttonSelect"==s.type&&(s.polygon.className="dhx_toolbar_poly_"+this.conf.skin+" dhxtoolbar_icons_"+this.conf.iconSize)}"dhx_terrace"==t&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype.setAlign=function(t){this.conf.align="right"==t?"right":"left",this.base.className="right"==t?"dhxtoolbar_float_right":"dhxtoolbar_float_left",this._spacer&&(this._spacer.className="right"==t?" dhxtoolbar_float_left":" dhxtoolbar_float_right")},dhtmlXToolbarObject.prototype.setIconSize=function(t){this.conf.iconSize={18:!0,24:!0,32:!0,48:!0}[t]?t:18,this.setSkin(this.conf.skin,!0),this.callEvent("_onIconSizeChange",[this.conf.iconSize])},dhtmlXToolbarObject.prototype.setIconsPath=function(t){this.conf.icons_path=t},dhtmlXToolbarObject.prototype.setUserData=function(t,e,i){t=this.idPrefix+t,null!=this.objPull[t]&&(null==this.objPull[t].userData&&(this.objPull[t].userData={}),this.objPull[t].userData[e]=i)},dhtmlXToolbarObject.prototype.getUserData=function(t,e){return t=this.idPrefix+t,null!=this.objPull[t]&&null!=this.objPull[t].userData?this.objPull[t].userData[e]||null:null},dhtmlXToolbarObject.prototype._isListOptionExists=function(t,e){if(null==this.objPull[this.idPrefix+t])return!1;var i=this.objPull[this.idPrefix+t];return"buttonSelect"==i.type&&null!=i._listOptions[e]},dhtmlXToolbarObject.prototype.setListOptionUserData=function(t,e,i,s){if(this._isListOptionExists(t,e)){var l=this.objPull[this.idPrefix+t]._listOptions[e];null==l.userData&&(l.userData={}),l.userData[i]=s}},dhtmlXToolbarObject.prototype.getListOptionUserData=function(t,e,i){if(!this._isListOptionExists(t,e))return null;var s=this.objPull[this.idPrefix+t]._listOptions[e];return s.userData&&s.userData[i]?s.userData[i]:null},dhtmlXToolbarObject.prototype._improveTerraceSkin=function(){null==this.conf.terrace_radius&&(this.conf.terrace_radius="3px");var t=[],e={separator:!0,text:!0},i=[this.base];null!=this._spacer&&i.push(this._spacer);for(var s=0;s<i.length;s++){t[s]=[];for(var l=0;l<i[s].childNodes.length;l++)if(null!=i[s].childNodes[l].idd&&"none"!=i[s].childNodes[l].style.display){var n=this.idPrefix+i[s].childNodes[l].idd;null!=this.objPull[n]&&this.objPull[n].obj==i[s].childNodes[l]&&t[s].push({a:n,type:this.objPull[n].type,node:this.objPull[n]["buttonSelect"==this.objPull[n].type?"arw":"obj"]})}i[s]=null}for(var s=0;s<t.length;s++)for(var l=0;l<t[s].length;l++){var o=t[s][l],r=!1,h=!1;e[o.type]||((l==t[s].length-1||null!=t[s][l+1]&&e[t[s][l+1].type])&&(r=!0),(0==l||l-1>=0&&null!=t[s][l-1]&&e[t[s][l-1].type])&&(h=!0)),o.node.style.borderRightWidth=r?"1px":"0px",o.node.style.borderTopRightRadius=o.node.style.borderBottomRightRadius=r?this.conf.terrace_radius:"0px","buttonSelect"==o.type?(o.node.previousSibling.style.borderTopLeftRadius=o.node.previousSibling.style.borderBottomLeftRadius=h?this.conf.terrace_radius:"0px",o.node.previousSibling._br=r,o.node.previousSibling._bl=h):o.node.style.borderTopLeftRadius=o.node.style.borderBottomLeftRadius=h?this.conf.terrace_radius:"0px",o.node._br=r,o.node._bl=h}for(var s=0;s<t.length;s++){for(var l=0;l<t[s].length;l++){for(var n in t[s][l])t[s][l][n]=null;t[s][l]=null}t[s]=null}t=i=null},dhtmlXToolbarObject.prototype._improveTerraceButtonSelect=function(t,e){var i=this.objPull[t];1==e?(i.obj.style.borderBottomLeftRadius=i.obj._bl?this.conf.terrace_radius:"0px",i.arw.style.borderBottomRightRadius=i.obj._br?this.conf.terrace_radius:"0px"):(i.obj.style.borderBottomLeftRadius="0px",i.arw.style.borderBottomRightRadius="0px"),i=null},"undefined"!=typeof window.dhtmlXCellObject&&(dhtmlXCellObject.prototype._createNode_toolbar=function(t,e,i,s,l){return"undefined"!=typeof l?t=l:(t=document.createElement("DIV"),t.className="dhx_cell_toolbar_"+(this.conf.borders?"def":"no_borders"),t.appendChild(document.createElement("DIV")),t.firstChild.className="dhx_toolbar_base_18_dhx_skyblue"),this.cell.insertBefore(t,this.cell.childNodes[this.conf.idx.cont]),this.conf.ofs_nodes.t.toolbar=!0,this._updateIdx(),t},dhtmlXCellObject.prototype.attachToolbar=function(t){if(null==this.dataNodes.ribbon&&null==this.dataNodes.toolbar)return this.callEvent("_onBeforeContentAttach",["toolbar"]),"undefined"==typeof t?t={}:"string"==typeof t&&(t={skin:t}),"undefined"==typeof t.skin&&(t.skin=this.conf.skin),t.parent=this._attachObject("toolbar").firstChild,this.dataNodes.toolbar=new dhtmlXToolbarObject(t),this._adjustCont(this._idd),this.dataNodes.toolbar._masterCell=this,this.dataNodes.toolbar.attachEvent("_onIconSizeChange",function(){this._masterCell._adjustCont()}),t.parent=null,t=null,this.callEvent("_onContentAttach",[]),this.dataNodes.toolbar},dhtmlXCellObject.prototype.detachToolbar=function(){this.dataNodes.toolbar&&(this.dataNodes.toolbar._masterCell=null,this.dataNodes.toolbar.unload(),this.dataNodes.toolbar=null,delete this.dataNodes.toolbar,this._detachObject("toolbar"))},dhtmlXCellObject.prototype.showToolbar=function(){this._mtbShowHide("toolbar","")},dhtmlXCellObject.prototype.hideToolbar=function(){this._mtbShowHide("toolbar","none")},dhtmlXCellObject.prototype.getAttachedToolbar=function(){return this.dataNodes.toolbar});var globalActiveDHTMLGridObject;String.prototype._dhx_trim=function(){return this.replace(/&nbsp;/g," ").replace(/(^[ \t]*)|([ \t]*$)/g,"")},dhtmlxArray._master={_dhx_find:function(t){for(var e=0;e<this.length;e++)if(t==this[e])return e;return-1},_dhx_insertAt:function(t,e){this[this.length]=null;for(var i=this.length-1;i>=t;i--)this[i]=this[i-1];this[t]=e},_dhx_removeAt:function(t){this.splice(t,1)},_dhx_swapItems:function(t,e){var i=this[t];this[t]=this[e],this[e]=i}},dhtmlXGridObject.prototype={getRowAttribute:function(t,e){return this.getRowById(t)._attrs[e]},setRowAttribute:function(t,e,i){this.getRowById(t)._attrs[e]=i},isTreeGrid:function(){return this.cellType._dhx_find("tree")!=-1},setRowHidden:function(t,e){var i=(dhx4.s2b(e),this.getRowById(t));if(i){if(""===i.expand&&this.collapseKids(i),e&&"none"!=i.style.display){i.style.display="none";var s=this.selectedRows._dhx_find(i);if(s!=-1){i.className=i.className.replace("rowselected","");for(var l=0;l<i.childNodes.length;l++)i.childNodes[l].className=i.childNodes[l].className.replace(/cellselected/g,"");this.selectedRows._dhx_removeAt(s)}this.callEvent("onGridReconstructed",[])}e||"none"!=i.style.display||(i.style.display="",this.callEvent("onGridReconstructed",[])),this.callEvent("onRowHide",[t,e]),this.setSizes()}},setColumnHidden:function(t,e){if(!this.hdr.rows.length)return this._ivizcol||(this._ivizcol=[]),this._ivizcol[t]=e;this.fldSorted&&this.fldSorted.cellIndex==t&&e&&(this.sortImg.style.display="none");var i=dhx4.s2b(e);if(i){if(this._hrrar){if(this._hrrar[t])return}else this._hrrar=new Array;this._hrrar[t]="display:none;",this._hideShowColumn(t,"none")}else{if(!this._hrrar||!this._hrrar[t])return;this._hrrar[t]="",this._hideShowColumn(t,"")}this.fldSorted&&this.fldSorted.cellIndex==t&&!e&&(this.sortImg.style.display="inline"),this.setSortImgPos(),this.callEvent("onColumnHidden",[t,e])},isColumnHidden:function(t){return!(!this._hrrar||!this._hrrar[t]);
},setColumnsVisibility:function(t){if(t&&(this._ivizcol=t.split(this.delim)),this.hdr.rows.length&&this._ivizcol)for(var e=0;e<this._ivizcol.length;e++)this.setColumnHidden(e,this._ivizcol[e])},_fixHiddenRowsAll:function(t,e,i,s,l){l=l||"_cellIndex";for(var n=t.rows.length,o=0;o<n;o++){var r=t.rows[o].childNodes;if(r.length!=this._cCount){for(var h=0;h<r.length;h++)if(r[h][l]==e){r[h].style[i]=s;break}}else r[e].style[i]=s}},_hideShowColumn:function(t,e){var i=t;if(this.hdr.rows[1]&&this.hdr.rows[1]._childIndexes&&this.hdr.rows[1]._childIndexes[t]!=t&&(i=this.hdr.rows[1]._childIndexes[t]),"none"==e){this.hdr.rows[0].cells[t]._oldWidth=this.hdr.rows[0].cells[t].style.width||this.initCellWidth[t]+"px",this.hdr.rows[0].cells[t]._oldWidthP=this.cellWidthPC[t],this.obj.rows[0].cells[t].style.width="0px";var s={rows:[this.obj.rows[0]]};this.forEachRow(function(t){"TR"==this.rowsAr[t].tagName&&s.rows.push(this.rowsAr[t])}),this._fixHiddenRowsAll(s,t,"display","none"),this.isTreeGrid()&&this._fixHiddenRowsAllTG(t,"none"),(_isOpera&&_OperaRv<9||_isKHTML||_isFF)&&this._fixHiddenRowsAll(this.hdr,t,"display","none","_cellIndexS"),this.ftr&&this._fixHiddenRowsAll(this.ftr.childNodes[0],t,"display","none"),this._fixHiddenRowsAll(this.hdr,t,"whiteSpace","nowrap","_cellIndexS"),this.cellWidthPX.length||this.cellWidthPC.length||(this.cellWidthPX=[].concat(this.initCellWidth)),this.cellWidthPX[t]&&(this.cellWidthPX[t]=0),this.cellWidthPC[t]&&(this.cellWidthPC[t]=0)}else if(this.hdr.rows[0].cells[t]._oldWidth){var l=this.hdr.rows[0].cells[t];(_isOpera||_isKHTML||_isFF)&&this._fixHiddenRowsAll(this.hdr,t,"display","","_cellIndexS"),this.ftr&&this._fixHiddenRowsAll(this.ftr.childNodes[0],t,"display","");var s={rows:[this.obj.rows[0]]};this.forEachRow(function(t){"TR"==this.rowsAr[t].tagName&&s.rows.push(this.rowsAr[t])}),this._fixHiddenRowsAll(s,t,"display",""),this.isTreeGrid()&&this._fixHiddenRowsAllTG(t,""),this._fixHiddenRowsAll(this.hdr,t,"whiteSpace","normal","_cellIndexS"),l._oldWidthP&&(this.cellWidthPC[t]=l._oldWidthP),l._oldWidth&&(this.cellWidthPX[t]=parseInt(l._oldWidth))}this.setSizes(),_isIE||_isFF||(this.obj.border=1,this.obj.border=0)},enableColSpan:function(t){this._ecspn=dhx4.s2b(t)},enableRowsHover:function(t,e){this._unsetRowHover(!1,!0),this._hvrCss=e,dhx4.s2b(t)?this._elmnh||(this.obj._honmousemove=this.obj.onmousemove,this.obj.onmousemove=this._setRowHover,_isIE?this.obj.onmouseleave=this._unsetRowHover:this.obj.onmouseout=this._unsetRowHover,this._elmnh=!0):this._elmnh&&(this.obj.onmousemove=this.obj._honmousemove,_isIE?this.obj.onmouseleave=null:this.obj.onmouseout=null,this._elmnh=!1)},enableEditEvents:function(t,e,i){this._sclE=dhx4.s2b(t),this._dclE=dhx4.s2b(e),this._f2kE=dhx4.s2b(i)},enableLightMouseNavigation:function(t){dhx4.s2b(t)?this._elmn||(this.entBox._onclick=this.entBox.onclick,this.entBox.onclick=function(){return!0},this.obj._onclick=this.obj.onclick,this.obj.onclick=function(t){var e=this.grid.getFirstParentOfType(t?t.target:event.srcElement,"TD");e&&(this.grid.editStop(),this.grid.doClick(e),this.grid.editCell(),(t||event).cancelBubble=!0)},this.obj._onmousemove=this.obj.onmousemove,this.obj.onmousemove=this._autoMoveSelect,this._elmn=!0):this._elmn&&(this.entBox.onclick=this.entBox._onclick,this.obj.onclick=this.obj._onclick,this.obj.onmousemove=this.obj._onmousemove,this._elmn=!1)},_unsetRowHover:function(t,e){if(e?that=this:that=this.grid,that._lahRw&&that._lahRw!=e){for(var i=0;i<that._lahRw.childNodes.length;i++)that._lahRw.childNodes[i].className=that._lahRw.childNodes[i].className.replace(that._hvrCss,"");that._lahRw=null}},_setRowHover:function(t){var e=this.grid.getFirstParentOfType(t?t.target:event.srcElement,"TD");if(e&&e.parentNode!=this.grid._lahRw){if(this.grid._unsetRowHover(0,e),e=e.parentNode,!e.idd||"__filler__"==e.idd)return;for(var i=0;i<e.childNodes.length;i++)e.childNodes[i].className+=" "+this.grid._hvrCss;this.grid._lahRw=e}this._honmousemove(t)},_autoMoveSelect:function(t){if(!this.grid.editor){var e=this.grid.getFirstParentOfType(t?t.target:event.srcElement,"TD");e.parentNode.idd&&this.grid.doClick(e,!0,0)}this._onmousemove(t)},enableDistributedParsing:function(t,e,i){dhx4.s2b(t)?(this._ads_count=e||10,this._ads_time=i||250):this._ads_count=0},destructor:function(){if(this.editStop(!0),this._sizeTime&&(this._sizeTime=window.clearTimeout(this._sizeTime)),this.entBox.className=(this.entBox.className||"").replace(/gridbox.*/,""),this.formInputs)for(var t=0;t<this.formInputs.length;t++)this.parentForm.removeChild(this.formInputs[t]);for(var e,t=0;t<this.rowsCol.length;t++)this.rowsCol[t]&&(this.rowsCol[t].grid=null);for(t in this.rowsAr)this.rowsAr[t]&&(this.rowsAr[t]=null);this.rowsCol=new dhtmlxArray,this.rowsAr={},this.entBox.innerHTML="";var i=function(){};this.entBox.onclick=this.entBox.onmousedown=this.entBox.onbeforeactivate=this.entBox.onbeforedeactivate=this.entBox.onbeforedeactivate=this.entBox.onselectstart=i,this.setSizes=this._update_srnd_view=this.callEvent=i,this.entBox.grid=this.objBox.grid=this.hdrBox.grid=this.obj.grid=this.hdr.grid=null,this._fake&&(this.globalBox.innerHTML="",this._fake.setSizes=this._fake._update_srnd_view=this._fake.callEvent=i,this.globalBox.onclick=this.globalBox.onmousedown=this.globalBox.onbeforeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onselectstart=i);for(e in this)this[e]&&this[e].m_obj&&(this[e].m_obj=null),this[e]=null;return this==globalActiveDHTMLGridObject&&(globalActiveDHTMLGridObject=null),null},getSortingState:function(){var t=new Array;return this.fldSorted&&(t[0]=this.fldSorted._cellIndex,t[1]="dhxgrid_sort_desc"==this.sortImg.className?"des":"asc"),t},enableAutoHeight:function(t,e,i){this._ahgr=dhx4.s2b(t),this._ahgrF=dhx4.s2b(i),this._ahgrM=e||null,1==arguments.length&&(this.objBox.style.overflowY=t?"hidden":"auto"),"auto"==e&&(this._ahgrM=null,this._ahgrMA=!0,this._setAutoResize())},enableStableSorting:function(t){this._sst=dhx4.s2b(t),this.rowsCol.stablesort=function(t){for(var e=this.length-1,i=0;i<this.length-1;i++){for(var s=0;s<e;s++)if(t(this[s],this[s+1])>0){var l=this[s];this[s]=this[s+1],this[s+1]=l}e--}}},enableKeyboardSupport:function(t){this._htkebl=!dhx4.s2b(t)},enableContextMenu:function(t){this._ctmndx=t},setScrollbarWidthCorrection:function(t){},enableTooltips:function(t){this._enbTts=t.split(",");for(var e=0;e<this._enbTts.length;e++)this._enbTts[e]=dhx4.s2b(this._enbTts[e])},enableResizing:function(t){this._drsclmn=t.split(",");for(var e=0;e<this._drsclmn.length;e++)this._drsclmn[e]=dhx4.s2b(this._drsclmn[e])},setColumnMinWidth:function(t,e){2==arguments.length?(this._drsclmW||(this._drsclmW=new Array),this._drsclmW[e]=t):this._drsclmW=t.split(",")},enableCellIds:function(t){this._enbCid=dhx4.s2b(t)},lockRow:function(t,e){var i=this.getRowById(t);i&&(i._locked=dhx4.s2b(e),this.cell&&this.cell.parentNode.idd==t&&this.editStop())},_getRowArray:function(t){for(var e=new Array,i=0;i<t.childNodes.length;i++){var s=this.cells3(t,i);e[i]=s.getValue()}return e},setDateFormat:function(t,e){this._dtmask=t,this._dtmask_inc=e},setNumberFormat:function(t,e,i,s){var l=t.replace(/[^0\,\.]*/g,""),n=l.indexOf(".");n>-1&&(n=l.length-n-1);var o=l.indexOf(",");o>-1&&(o=l.length-n-2-o),"string"!=typeof i&&(i=this.i18n.decimal_separator),"string"!=typeof s&&(s=this.i18n.group_separator);var r=t.split(l)[0],h=t.split(l)[1];this._maskArr[e]=[n,o,r,h,i,s]},_aplNFb:function(t,e){var i=this._maskArr[e];if(!i)return t;var s=parseFloat(t.toString().replace(/[^0-9]*/g,""));return"-"==t.toString().substr(0,1)&&(s*=-1),i[0]>0&&(s/=Math.pow(10,i[0])),s},_aplNF:function(t,e){var i=this._maskArr[e];if(!i)return t;var s=(parseFloat(t)<0?"-":"")+i[2];if(t=Math.abs(Math.round(parseFloat(t)*Math.pow(10,i[0]>0?i[0]:0))).toString(),t=(t.length<i[0]?Math.pow(10,i[0]+1-t.length).toString().substr(1,i[0]+1)+t.toString():t).split("").reverse(),t[i[0]]=(t[i[0]]||"0")+i[4],i[1]>0)for(var l=(i[0]>0?0:1)+i[0]+i[1];l<t.length;l+=i[1])t[l]+=i[5];return s+t.reverse().join("")+i[3]},_launchCommands:function(t){for(var e=0;e<t.length;e++){for(var i=new Array,s=0;s<t[e].childNodes.length;s++)1==t[e].childNodes[s].nodeType&&(i[i.length]=t[e].childNodes[s].firstChild.data);this[t[e].getAttribute("command")].apply(this,i)}},_parseHead:function(t){var e=dhx4.ajax.xpath("./head",t);if(e.length){var i=dhx4.ajax.xpath("./column",e[0]),s=dhx4.ajax.xpath("./settings",e[0]),l="setInitWidths",n=!1;if(s[0])for(var o=0;o<s[0].childNodes.length;o++)switch(s[0].childNodes[o].tagName){case"colwidth":s[0].childNodes[o].firstChild&&"%"==s[0].childNodes[o].firstChild.data&&(l="setInitWidthsP");break;case"splitat":n=!!s[0].childNodes[o].firstChild&&s[0].childNodes[o].firstChild.data}if(this._launchCommands(dhx4.ajax.xpath("./beforeInit/call",e[0])),i.length>0){this.hdr.rows.length>0&&this.clearAll(!0);for(var r=[[],[],[],[],[],[],[],[],[]],h=["","width","type","align","sort","color","format","hidden","id"],a=["",l,"setColTypes","setColAlign","setColSorting","setColumnColor","","","setColumnIds"],d=0;d<i.length;d++){for(var c=1;c<h.length;c++)r[c].push(i[d].getAttribute(h[c]));r[0].push((i[d].firstChild?i[d].firstChild.data:"").replace(/^\s*((\s\S)*.+)\s*$/gi,"$1"))}this.setHeader(r[0]);for(var d=0;d<a.length;d++)a[d]&&this[a[d]](r[d].join(this.delim));for(var d=0;d<i.length;d++)if(0==this.cellType[d].indexOf("co")||"clist"==this.cellType[d]){var u=dhx4.ajax.xpath("./option",i[d]);if(u.length){var f=new Array;if("clist"==this.cellType[d]){for(var c=0;c<u.length;c++)f[f.length]=u[c].firstChild?u[c].firstChild.data:"";this.registerCList(d,f)}else for(var _=this.getCombo(d),c=0;c<u.length;c++)_.put(u[c].getAttribute("value"),u[c].firstChild?u[c].firstChild.data:"")}}else r[6][d]&&(this.cellType[d].toLowerCase().indexOf("calendar")!=-1||"date"==this.fldSort[d]?this.setDateFormat(r[6][d]):this.setNumberFormat(r[6][d],d));this.init();var p=r[7].join(this.delim);this.setColHidden&&""!=p.replace(/,/g,"")&&this.setColHidden(p),n&&this.splitAt&&this.splitAt(n)}this._launchCommands(dhx4.ajax.xpath("./afterInit/call",e[0]))}var m=dhx4.ajax.xpath("//rows/userdata",t);if(m.length>0){this.UserData.gridglobaluserdata||(this.UserData.gridglobaluserdata=new Hashtable);for(var c=0;c<m.length;c++){for(var g="",b=0;b<m[c].childNodes.length;b++)g+=m[c].childNodes[b].nodeValue;this.UserData.gridglobaluserdata.put(m[c].getAttribute("name"),g)}}},getCheckedRows:function(t){var e=new Array;return this.forEachRowA(function(i){var s=this.cells(i,t);s.changeState&&0!=s.getValue()&&e.push(i)},!0),e.join(",")},checkAll:function(){for(var t=arguments.length?arguments[0]:1,e=0;e<this.getColumnsNum();e++)"ch"==this.getColType(e)&&this.setCheckedRows(e,t)},uncheckAll:function(){this.checkAll(0)},setCheckedRows:function(t,e){this.forEachRowA(function(i){this.cells(i,t).isCheckbox()&&this.cells(i,t).setValue(e)})},_drawTooltip:function(t){var e=this.grid.getFirstParentOfType(t?t.target:event.srcElement,"TD");if(!e||this.grid.editor&&this.grid.editor.cell==e)return!0;var i=e.parentNode;if(i.idd&&"__filler__"!=i.idd){var s=t?t.target:event.srcElement;if(i.idd==window.unknown)return!0;if(!this.grid.callEvent("onMouseOver",[i.idd,e._cellIndex,t||window.event]))return!0;if(this.grid._enbTts&&!this.grid._enbTts[e._cellIndex])return s.title&&(s.title=""),!0;if(!(e._cellIndex>=this.grid._cCount)){var l=this.grid.cells3(i,e._cellIndex);if(l&&l.cell&&l.cell._attrs)return s._title&&(l.cell.title=""),l.cell._attrs.title||(s._title=!0),l&&(s.title=l.cell._attrs.title||(l.getTitle?l.getTitle():(l.getValue()||"").toString().replace(/<[^>]*>/gi,""))),!0}}},enableCellWidthCorrection:function(t){_isFF&&(this._wcorr=parseInt(t))},getAllRowIds:function(t){for(var e=[],i=0;i<this.rowsBuffer.length;i++)this.rowsBuffer[i]&&e.push(this.rowsBuffer[i].idd);return e.join(t||this.delim)},getAllItemIds:function(){return this.getAllRowIds()},setColspan:function(t,e,i){if(this._ecspn){var s=this.getRowById(t);if(s._childIndexes&&s.childNodes[s._childIndexes[e]]){var l=s._childIndexes[e],n=s.childNodes[l],o=n.colSpan;if(n.colSpan=1,o&&1!=o)for(var r=1;r<o;r++){var h=document.createElement("TD");n.nextSibling?s.insertBefore(h,n.nextSibling):s.appendChild(h),s._childIndexes[e+r]=l+r,h._cellIndex=e+r,h.style.textAlign=this.cellAlign[r],h.style.verticalAlign=this.cellVAlign[r],n=h,this.cells3(s,e+r).setValue("")}for(var a=1*e+1*o;a<s._childIndexes.length;a++)s._childIndexes[a]+=1*(o-1)}if(i&&i>1){if(s._childIndexes)var l=s._childIndexes[e];else{var l=e;s._childIndexes=new Array;for(var a=0;a<s.childNodes.length;a++)s._childIndexes[a]=a}s.childNodes[l].colSpan=i;for(var a=1;a<i;a++)s._childIndexes[s.childNodes[l+1]._cellIndex]=l,s.removeChild(s.childNodes[l+1]);for(var d=s.childNodes[s._childIndexes[e]]._cellIndex,a=1*d+1*i;a<s._childIndexes.length;a++)s._childIndexes[a]-=i-1}}},preventIECaching:function(t){dhx4.ajax.cache=!t},enableColumnAutoSize:function(t){this._eCAS=dhx4.s2b(t)},_onHeaderDblClick:function(t){var e=this.grid,i=e.getFirstParentOfType(_isIE?event.srcElement:t.target,"TD");return!!e._eCAS&&void e.adjustColumnSize(i._cellIndexS)},adjustColumnSize:function(t,e){if(!this._hrrar||!this._hrrar[t]){this._notresize=!0;var i=0;this._setColumnSizeR(t,20);for(var s=1;s<this.hdr.rows.length;s++){var l=this.hdr.rows[s];l=l.childNodes[l._childIndexes?l._childIndexes[t]:t],l&&(!l.colSpan||l.colSpan<2)&&l._cellIndex==t&&(l.childNodes[0]&&"hdrcell"==l.childNodes[0].className&&(l=l.childNodes[0]),i=Math.max(i,l.scrollWidth))}for(var n=this.obj.rows.length,o=0,r=this.cellType._dhx_find("tree"),h=1;h<n;h++){var a=this.obj.rows[h];this.rowsAr[a.idd]&&(a._childIndexes&&a._childIndexes[t]!=t||!a.childNodes[t]||(o=(a.childNodes[t].innerText||a.childNodes[t].textContent||"").length*this.fontWidth,this._h2&&t==r&&(o+=22*this._h2.get[a.idd].level),o>i&&(i=o)))}i+=20+(e||0),this._setColumnSizeR(t,i),this._notresize=!1,this.setSizes()}},detachHeader:function(t,e){e=e||this.hdr;var i=e.rows[t+1];i&&i.parentNode.removeChild(i),this.setSizes()},detachFooter:function(t){this.detachHeader(t,this.ftr)},attachHeader:function(t,e,i){if("string"==typeof t&&(t=this._eSplit(t)),"string"==typeof e&&(e=e.split(this.delim)),i=i||"_aHead",this.hdr.rows.length){if(t)this._createHRow([t,e],this["_aHead"==i?"hdr":"ftr"]);else if(this[i])for(var s=0;s<this[i].length;s++)this.attachHeader.apply(this,this[i][s])}else this[i]||(this[i]=new Array),this[i][this[i].length]=[t,e,i]},_createHRow:function(t,e){if(!e){"absolute"!=this.entBox.style.position&&(this.entBox.style.position="relative");var i=document.createElement("DIV");i.className="c_ftr".substr(2),this.entBox.appendChild(i);var s=document.createElement("TABLE");s.cellPadding=s.cellSpacing=0,_isIE&&8!=_isIE||(s.width="100%",s.style.paddingRight="20px"),s.style.marginRight="20px",s.style.tableLayout="fixed",i.appendChild(s),s.appendChild(document.createElement("TBODY")),this.ftr=e=s;for(var l=s.insertRow(0),n=this.hdrLabels.length<=1?t[0].length:this.hdrLabels.length,o=0;o<n;o++)l.appendChild(document.createElement("TH")),l.childNodes[o]._cellIndex=o;_isIE&&_isIE<8?l.style.position="absolute":l.style.height="auto"}var r=t[1],i=document.createElement("TR");e.rows[0].parentNode.appendChild(i);for(var o=0;o<t[0].length;o++)if("#cspan"!=t[0][o])if("#rspan"==t[0][o]&&e.rows.length>1){for(var h=e.rows.length-2,a=!1,d=null;!a;){for(var d=e.rows[h],c=0;c<d.cells.length;c++)if(d.cells[c]._cellIndex==o){a=c+1;break}h--}d=d.cells[a-1],d.rowSpan=(d.rowSpan||1)+1}else{var u=document.createElement("TD");if(u._cellIndex=u._cellIndexS=o,this._hrrar&&this._hrrar[o]&&!_isIE&&(u.style.display="none"),"object"==typeof t[0][o])u.appendChild(t[0][o]);else if(this.forceDivInHeader?u.innerHTML="<div class='hdrcell'>"+(t[0][o]||"&nbsp;")+"</div>":u.innerHTML=t[0][o]||"&nbsp;",(t[0][o]||"").indexOf("#")!=-1){var s=t[0][o].match(/(^|{)#([^}]+)(}|$)/);if(s){var f="_in_header_"+s[2];this[f]&&this[f](this.forceDivInHeader?u.firstChild:u,o,t[0][o].split(s[0]))}}r&&(u.style.cssText=r[o]),i.appendChild(u)}else{var d=i.cells[i.cells.length-1];d.colSpan=(d.colSpan||1)+1}_isKHTML&&(e._kTimer&&window.clearTimeout(e._kTimer),e._kTimer=window.setTimeout(function(){e.rows[1].style.display="none",window.setTimeout(function(){e.rows[1].style.display=""},1)},500))},attachFooter:function(t,e){this.attachHeader(t,e,"_aFoot")},setCellExcellType:function(t,e,i){this.changeCellType(this.getRowById(t),e,i)},changeCellType:function(t,e,i){i=i||this.cellType[e];var s=this.cells3(t,e),l=s.getValue();s.cell._cellType=i;var s=this.cells3(t,e);s.setValue(l)},setRowExcellType:function(t,e){for(var i=this.rowsAr[t],s=0;s<i.childNodes.length;s++)this.changeCellType(i,s,e)},setColumnExcellType:function(t,e){for(var i=0;i<this.rowsBuffer.length;i++)this.rowsBuffer[i]&&"TR"==this.rowsBuffer[i].tagName&&this.changeCellType(this.rowsBuffer[i],t,e);"math"==this.cellType[t]?this._strangeParams[i]=e:this.cellType[t]=e},forEachRow:function(t){for(var e in this.rowsAr)this.rowsAr[e]&&this.rowsAr[e].idd&&t.apply(this,[this.rowsAr[e].idd])},forEachRowA:function(t){for(var e=0;e<this.rowsBuffer.length;e++)this.rowsBuffer[e]&&t.call(this,this.render_row(e).idd)},forEachCell:function(t,e){var i=this.getRowById(t);if(i)for(var s=0;s<this._cCount;s++)e(this.cells3(i,s),s)},enableAutoWidth:function(t,e,i){this._awdth=[dhx4.s2b(t),parseInt(e||99999),parseInt(i||0)],1==arguments.length&&(this.objBox.style.overflowX=t?"hidden":"auto")},updateFromXML:function(t,e,i,s){"undefined"==typeof e&&(e=!0),this._refresh_mode=[!0,e,i],this.load(t,s)},_refreshFromXML:function(t){this._f_rowsBuffer&&this.filterBy(0,""),reset=!1,window.eXcell_tree&&(eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue,eXcell_tree.prototype.setValue=function(t){var e=this.grid._h2.get[this.cell.parentNode.idd];e&&this.cell.parentNode.valTag?this.setLabel(t):this.setValueX(t)});var e=this.cellType._dhx_find("tree"),i=dhx4.ajax.xmltop("rows",t),s=i.getAttribute("parent")||0,l={};this._refresh_mode[2]&&(e!=-1?this._h2.forEachChild(s,function(t){l[t.id]=!0},this):this.forEachRow(function(t){l[t]=!0}));for(var n=dhx4.ajax.xpath("//row",i),o=0;o<n.length;o++){var r=n[o],h=r.getAttribute("id");l[h]=!1;var s=r.parentNode.getAttribute("id")||s;if(this.rowsAr[h]&&"TR"!=this.rowsAr[h].tagName)this._h2?this._h2.get[h].buff.data=r:this.rowsBuffer[this.getRowIndex(h)].data=r,this.rowsAr[h]=r;else if(this.rowsAr[h])this._process_xml_row(this.rowsAr[h],r,-1),this._postRowProcessing(this.rowsAr[h],!0),this._fake&&this._fake.rowsAr[h]&&this._fake._process_xml_row(this._fake.rowsAr[h],r,-1);else if(this._refresh_mode[1]){var a={idd:h,data:r,_parser:this._process_xml_row,_locator:this._get_xml_data},d=this.rowsBuffer.length;"top"==this._refresh_mode[1]?(this.rowsBuffer.unshift(a),d=0):this.rowsBuffer.push(a),this._h2?(reset=!0,this._h2.add(h,r.parentNode.getAttribute("id")||r.parentNode.getAttribute("parent")).buff=this.rowsBuffer[this.rowsBuffer.length-1]):this._srnd&&(reset=!0),this.rowsAr[h]=r,r=this.render_row(d),this._insertRowAt(r,d?-1:0)}}if(this._refresh_mode[2])for(h in l)l[h]&&this.rowsAr[h]&&this.deleteRow(h);this._refresh_mode=null,window.eXcell_tree&&(eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX),reset&&(this._h2?this._renderSort():this.render_dataset()),this._f_rowsBuffer&&(this._f_rowsBuffer=null,this.filterByAll())},getCustomCombo:function(t,e){var i=this.cells(t,e).cell;return i._combo||(i._combo=new dhtmlXGridComboObject),i._combo},setTabOrder:function(t){var e=t.split(this.delim);this._tabOrder=[];for(var i=this._cCount||t.length,s=0;s<i;s++)e[s]={c:parseInt(e[s]),ind:s};e.sort(function(t,e){return t.c>e.c?1:-1});for(var s=0;s<i;s++)e[s+1]&&"undefined"!=typeof e[s].c?this._tabOrder[e[s].ind]=e[s+1].ind:this._tabOrder[e[s].ind]=(e[0].ind+1)*-1},i18n:{loading:"Loading",decimal_separator:".",group_separator:","},_key_events:{k13_1_0:function(){var t=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[t+1],this.cell._cellIndex,!0)},k13_0_1:function(){var t=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[t-1],this.cell._cellIndex,!0)},k13_0_0:function(){this.editStop(),this.callEvent("onEnter",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]),this._still_active=!0},k9_0_0:function(){if(this.editStop(),!this.callEvent("onTab",[!0]))return!0;var t=this._getNextCell(null,1);t&&(this.selectCell(t.parentNode,t._cellIndex,this.row!=t.parentNode,!1,!0),this._still_active=!0)},k9_0_1:function(){if(this.editStop(),!this.callEvent("onTab",[!1]))return!1;var t=this._getNextCell(null,-1);t&&(this.selectCell(t.parentNode,t._cellIndex,this.row!=t.parentNode,!1,!0),this._still_active=!0)},k113_0_0:function(){this._f2kE&&this.editCell()},k32_0_0:function(){var t=this.cells4(this.cell);if(!t.changeState||t.changeState()===!1)return!1},k27_0_0:function(){this.editStop(!0)},k33_0_0:function(){this.pagingOn?this.changePage(this.currentPage-1):this.scrollPage(-1)},k34_0_0:function(){this.pagingOn?this.changePage(this.currentPage+1):this.scrollPage(1)},k37_0_0:function(){return!(this.editor||!this.isTreeGrid())&&void this.collapseKids(this.row)},k39_0_0:function(){return!(this.editor||!this.isTreeGrid())&&void this.expandKids(this.row)},k40_0_0:function(){var t=this._realfake?this._fake:this;if(this.editor&&this.editor.combo)this.editor.shiftNext();else{if(!this.row.idd)return;var e=Math.max(t._r_select||0,this.getRowIndex(this.row.idd)),i=this._nextRow(e,1);if(i)t._r_select=null,this.selectCell(i,this.cell._cellIndex,!0),t.pagingOn&&t.showRow(i.idd);else{if(!this.callEvent("onLastRow",[]))return!1;this._key_events.k34_0_0.apply(this,[]),this.pagingOn&&this.rowsCol[e+1]&&this.selectCell(e+1,0,!0)}}this._still_active=!0},k38_0_0:function(){var t=this._realfake?this._fake:this;if(this.editor&&this.editor.combo)this.editor.shiftPrev();else{if(!this.row.idd)return;var e=this.getRowIndex(this.row.idd)+1;if(e==-1||this.pagingOn&&1==e)this._key_events.k33_0_0.apply(this,[]);else{var i=this._nextRow(e-1,-1);this.selectCell(i,this.cell._cellIndex,!0),t.pagingOn&&i&&t.showRow(i.idd)}}this._still_active=!0}},_build_master_row:function(){for(var t=document.createElement("DIV"),e=["<table><tr>"],i=0;i<this._cCount;i++)e.push("<td></td>");e.push("</tr></table>"),t.innerHTML=e.join(""),this._master_row=t.firstChild.rows[0]},_prepareRow:function(t){this._master_row||this._build_master_row();for(var e=this._master_row.cloneNode(!0),i=0;i<e.childNodes.length;i++)e.childNodes[i]._cellIndex=i,this._enbCid&&(e.childNodes[i].id="c_"+t+"_"+i),this.dragAndDropOff&&this.dragger.addDraggableItem(e.childNodes[i],this);return e.idd=t,e.grid=this,e},_process_jsarray_row:function(t,e){t._attrs={};for(var i=0;i<t.childNodes.length;i++)t.childNodes[i]._attrs={};return this._fillRow(t,this._c_order?this._swapColumns(e):e),t},_get_jsarray_data:function(t,e){return t[e]},_process_json_row:function(t,e){return e=this._c_order?this._swapColumns(e.data):e.data,this._process_some_row(t,e)},_process_some_row:function(t,e){t._attrs={};for(var i=0;i<t.childNodes.length;i++)t.childNodes[i]._attrs={};return this._fillRow(t,e),t},_get_json_data:function(t,e){return t.data[e]},_process_js_row:function(t,e){for(var i=[],s=0;s<this.columnIds.length;s++)i[s]=e[this.columnIds[s]],i[s]||0===i[s]||(i[s]="");return this._process_some_row(t,i),t._attrs=e,t},_get_js_data:function(t,e){return t[this.columnIds[e]]},_process_csv_row:function(t,e){t._attrs={};for(var i=0;i<t.childNodes.length;i++)t.childNodes[i]._attrs={};return this._fillRow(t,this._c_order?this._swapColumns(e.split(this.csv.cell)):e.split(this.csv.cell)),t},_get_csv_data:function(t,e){return t.split(this.csv.cell)[e]},_process_store_row:function(t,e){for(var i=[],s=0;s<this.columnIds.length;s++)i[s]=e[this.columnIds[s]];for(var l=0;l<t.childNodes.length;l++)t.childNodes[l]._attrs={};t._attrs=e,this._fillRow(t,i)},_process_xml_row:function(t,e){var i=dhx4.ajax.xpath(this.xml.cell,e),s=[];if(t._attrs=this._xml_attrs(e),this._ud_enabled)for(var l=dhx4.ajax.xpath("./userdata",e),n=l.length-1;n>=0;n--){for(var o="",r=0;r<l[n].childNodes.length;r++)o+=l[n].childNodes[r].nodeValue;this.setUserData(t.idd,l[n].getAttribute("name"),o)}for(var r=0;r<i.length;r++){var h=i[this._c_order?this._c_order[r]:r];if(h){var a=t._childIndexes?t._childIndexes[r]:r,d=h.getAttribute("type");t.childNodes[a]&&(d&&(t.childNodes[a]._cellType=d),t.childNodes[a]._attrs=this._xml_attrs(h)),h.getAttribute("xmlcontent")||(h=h.firstChild?h.firstChild.wholeText||h.firstChild.data:""),s.push(h)}}for(r<i.length;r<t.childNodes.length;r++)t.childNodes[r]._attrs={};return t.parentNode&&"row"==t.parentNode.tagName&&(t._attrs.parent=t.parentNode.getAttribute("idd")),this._fillRow(t,s),t},_get_xml_data:function(t,e){for(t=t.firstChild;;){if(!t)return"";if("cell"==t.tagName&&e--,e<0)break;t=t.nextSibling}return t.firstChild?t.firstChild.data:""},_fillRow:function(t,e){this.editor&&this.editor.parentNode&&this.editor.parentNode.idd==t.idd&&this.editStop();for(var i=0;i<t.childNodes.length;i++)if(i<e.length||this.defVal[i]){var s=t.childNodes[i]._cellIndex,l=e[s],n=this.cells4(t.childNodes[i]);!this.defVal[s]||""!=l&&"undefined"!=typeof l||(l=this.defVal[s]),n&&n.setValue(l)}else t.childNodes[i].innerHTML="&nbsp;",t.childNodes[i]._clearCell=!0;return t},_postRowProcessing:function(t,e){t._attrs.class&&(t._css=t.className=t._attrs.class),t._attrs.locked&&(t._locked=!0),t._attrs.bgColor&&(t.bgColor=t._attrs.bgColor);for(var i=0,s=0;s<t.childNodes.length;s++){var l=t.childNodes[s],n=l._cellIndex,o=l._attrs.style||t._attrs.style;o&&(l.style.cssText+=";"+o),l._attrs.class&&(l.className=l._attrs.class),o=l._attrs.align||this.cellAlign[n],o&&(l.align=o),l.vAlign=l._attrs.valign||this.cellVAlign[n];var r=l._attrs.bgColor||this.columnColor[n];r&&(l.bgColor=r),l._attrs.colspan&&!e&&(this.setColspan(t.idd,s+i,l._attrs.colspan),i+=l._attrs.colspan-1),this._hrrar&&this._hrrar[n]&&!e&&(l.style.display="none")}this.callEvent("onRowCreated",[t.idd,t,null])},load:function(t,e,i){this.callEvent("onXLS",[this]),2==arguments.length&&"function"!=typeof e&&(i=e,e=null),i=i||"xml",this.xmlFileUrl||(this.xmlFileUrl=t),this._data_type=i,this.xmlLoader=this.doLoadDetails;var s=this;return this.xmlLoader=function(t){s.callEvent&&(s["_process_"+i](t.xmlDoc),s._contextCallTimer||s.callEvent("onXLE",[s,0,0,t.xmlDoc]),e&&(e(),e=null))},dhx4.ajax.get(t,this.xmlLoader)},loadXMLString:function(t,e){window.console&&window.console.info&&window.console.info("loadXMLString was deprecated","http://docs.dhtmlx.com/migration__index.html#migrationfrom43to44"),this.parse({responseXML:dhx4.ajax.parse(t)},e,"xml")},loadXML:function(t,e){window.console&&window.console.info&&window.console.info("loadXML was deprecated","http://docs.dhtmlx.com/migration__index.html#migrationfrom43to44"),this.load(t,e,"xml")},parse:function(t,e,i){2==arguments.length&&"function"!=typeof e&&(i=e,e=null),i=i||"xml",this._data_type=i,"xml"==i&&"string"==typeof t&&(t={responseXML:dhx4.ajax.parse(t)}),this["_process_"+i](t),this._contextCallTimer||this.callEvent("onXLE",[this,0,0,t]),e&&e()},xml:{top:"rows",row:"./row",cell:"./cell",s_row:"row",s_cell:"cell",row_attrs:[],cell_attrs:[]},csv:{row:"\n",cell:","},_xml_attrs:function(t){var e={};if(t.attributes.length)for(var i=0;i<t.attributes.length;i++)e[t.attributes[i].name]=t.attributes[i].value;return e},_process_xml:function(t){if(this._refresh_mode)return this._refreshFromXML(t);this._parsing=!0;var e=dhx4.ajax.xmltop(this.xml.top,t);if(e.tagName==this.xml.top){var i=e.getAttribute("dhx_security");i&&(dhtmlx.security_key=i),this._parseHead(e);var s=dhx4.ajax.xpath(this.xml.row,e),l=parseInt(e.getAttribute("pos")||0),n=parseInt(e.getAttribute("total_count")||0);if(!this.pagingOn)var n=Math.min(n,32e6/this._srdh);var o=!1;if(n&&n!=this.rowsBuffer.length&&(this.rowsBuffer[n-1]||(this.rowsBuffer.length&&(o=!0),this.rowsBuffer[n-1]=null),n<this.rowsBuffer.length&&(this.rowsBuffer.splice(n,this.rowsBuffer.length-n),o=!0)),this.isTreeGrid())return this._process_tree_xml(e);for(var r=0;r<s.length;r++)if(!this.rowsBuffer[r+l]){var h=s[r].getAttribute("id")||r+l+1;this.rowsBuffer[r+l]={idd:h,data:s[r],_parser:this._process_xml_row,_locator:this._get_xml_data},this.rowsAr[h]=s[r]}if(this.callEvent("onDataReady",[]),o&&this._srnd){var a=this.objBox.scrollTop;this._reset_view(),this.objBox.scrollTop=a}else this.render_dataset();this._parsing=!1}},_process_jsarray:function(data){this._parsing=!0,data=data.responseText||data,"string"==typeof data&&(eval("dhtmlx.temp="+data+";"),data=dhtmlx.temp);for(var i=0;i<data.length;i++){var id=i+1;this.rowsBuffer.push({idd:id,data:data[i],_parser:this._process_jsarray_row,_locator:this._get_jsarray_data}),this.rowsAr[id]=data[i]}this.render_dataset(),this._parsing=!1},_process_csv:function(t){if(this._parsing=!0,t=t.responseText||t,t=t.replace(/\r/g,""),t=t.split(this.csv.row),this._csvHdr){this.clearAll();var e=t.splice(0,1)[0].split(this.csv.cell);this._csvAID||e.splice(0,1),this.setHeader(e.join(this.delim)),this.init()}for(var i=0;i<t.length;i++)if(t[i]||i!=t.length-1){if(this._csvAID){var s=i+1;this.rowsBuffer.push({idd:s,data:t[i],_parser:this._process_csv_row,_locator:this._get_csv_data})}else{var l=t[i].split(this.csv.cell),s=l.splice(0,1)[0];this.rowsBuffer.push({idd:s,data:l,_parser:this._process_jsarray_row,_locator:this._get_jsarray_data})}this.rowsAr[s]=t[i]}this.render_dataset(),this._parsing=!1},_process_js:function(t){return this._process_json(t,"js")},_process_json:function(data,mode){this._parsing=!0;var data=data.responseText||data;if("string"==typeof data&&(eval("dhtmlx.temp="+data+";"),data=dhtmlx.temp),"js"==mode){data.data&&(data=data.data);for(var i=0;i<data.length;i++){var row=data[i],id=row.id||i+1;this.rowsBuffer.push({idd:id,data:row,_parser:this._process_js_row,_locator:this._get_js_data}),this.rowsAr[id]=data[i]}}else if(data.rows)for(var i=0;i<data.rows.length;i++){var id=data.rows[i].id;this.rowsBuffer.push({idd:id,data:data.rows[i],_parser:this._process_json_row,_locator:this._get_json_data}),this.rowsAr[id]=data.rows[i]}data.dhx_security&&(dhtmlx.security_key=data.dhx_security),this.callEvent("onDataReady",[]),this.render_dataset(),this._parsing=!1},render_dataset:function(t,e){if(this._srnd){if(this._fillers)return this._update_srnd_view();e=Math.min(this._get_view_size()+(this._srnd_pr||0),this.rowsBuffer.length)}this.pagingOn?(t=Math.max(t||0,(this.currentPage-1)*this.rowsBufferOutSize),e=Math.min(this.currentPage*this.rowsBufferOutSize,this.rowsBuffer.length)):(t=t||0,e=e||this.rowsBuffer.length);for(var i=t;i<e;i++){var s=this.render_row(i);if(s==-1){this.xmlFileUrl&&this.callEvent("onDynXLS",[i,this._dpref?this._dpref:e-i])&&this.load(this.xmlFileUrl+dhtmlx.url(this.xmlFileUrl)+"posStart="+i+"&count="+(this._dpref?this._dpref:e-i),this._data_type),e=i;break}if(s.parentNode&&s.parentNode.tagName||(this._insertRowAt(s,i),(s._attrs.selected||s._attrs.select)&&(this.selectRow(s,!!s._attrs.call,!0),s._attrs.selected=s._attrs.select=null)),this._ads_count&&i-t==this._ads_count){var l=this;return this._context_parsing=this._context_parsing||this._parsing,this._contextCallTimer=window.setTimeout(function(){l._contextCallTimer=null,l.render_dataset(i,e),l._contextCallTimer||(l._context_parsing?l.callEvent("onXLE",[]):l._fixAlterCss(),l._context_parsing=!1)},this._ads_time)}}if(this._ads_count&&i==e&&this.callEvent("onDistributedEnd",[]),this._srnd&&!this._fillers){var n=this.rowsBuffer.length-e;for(this._fillers=[],this._fake&&!this._realfake&&(this._fake._fillers=[]);n>0;){var o=_isIE||window._FFrv?Math.min(n,3e4):n,r=this._add_filler(e,o);r&&this._fillers.push(r),n-=o,e+=o}}this.setSizes()},render_row:function(t){if(!this.rowsBuffer[t])return-1;if(this.rowsBuffer[t]._parser){var e=this.rowsBuffer[t];if(this.rowsAr[e.idd]&&"TR"==this.rowsAr[e.idd].tagName)return this.rowsBuffer[t]=this.rowsAr[e.idd];var i=this._prepareRow(e.idd);return this.rowsBuffer[t]=i,this.rowsAr[e.idd]=i,e._parser.call(this,i,e.data),
this._postRowProcessing(i),i}return this.rowsBuffer[t]},_get_cell_value:function(t,e,i){return t._locator?(this._c_order&&(e=this._c_order[e]),t._locator.call(this,t.data,e)):this.cells3(t,e)[i?i:"getValue"]()},sortRows:function(t,e,i){if(this.editStop(),i=(i||"asc").toLowerCase(),e=e||this.fldSort[t],t=t||0,this.isTreeGrid())this.sortTreeRows(t,e,i);else{var s={},l=this.cellType[t],n="getValue";"link"==l&&(n="getContent"),"dhxCalendar"!=l&&"dhxCalendarA"!=l||(n="getDate");for(var o=0;o<this.rowsBuffer.length;o++)s[this.rowsBuffer[o].idd]=this._get_cell_value(this.rowsBuffer[o],t,n);this._sortRows(t,e,i,s)}this.callEvent("onAfterSorting",[t,e,i])},_sortCore:function(t,e,i,s,l){var n="sort";if(this._sst&&(l.stablesort=this.rowsCol.stablesort,n="stablesort"),e.length>4&&(e=window[e]),"cus"==e){var o=this._customSorts[t];l[n](function(t,e){return o(s[t.idd],s[e.idd],i,t.idd,e.idd)})}else"function"==typeof e?l[n](function(t,l){return e(s[t.idd],s[l.idd],i,t.idd,l.idd)}):"str"==e?l[n](function(t,e){return"asc"==i?s[t.idd]>s[e.idd]?1:s[t.idd]<s[e.idd]?-1:0:s[t.idd]<s[e.idd]?1:s[t.idd]>s[e.idd]?-1:0}):"int"==e?l[n](function(t,e){var l=parseFloat(s[t.idd]);l=isNaN(l)?-99999999999999:l;var n=parseFloat(s[e.idd]);return n=isNaN(n)?-99999999999999:n,"asc"==i?l-n:n-l}):"date"==e&&l[n](function(t,e){var l=Date.parse(s[t.idd])||Date.parse("01/01/1900"),n=Date.parse(s[e.idd])||Date.parse("01/01/1900");return"asc"==i?l-n:n-l})},_sortRows:function(t,e,i,s){this._sortCore(t,e,i,s,this.rowsBuffer),this._reset_view(),this.callEvent("onGridReconstructed",[])},_reset_view:function(t){if(this.obj.rows[0]){this._lahRw&&this._unsetRowHover(0,!0),this.callEvent("onResetView",[]);var e=this.obj.rows[0].parentNode,i=e.removeChild(e.childNodes[0],!0);if(_isKHTML)for(var s=e.parentNode.childNodes.length-1;s>=0;s--)"TR"==e.parentNode.childNodes[s].tagName&&e.parentNode.removeChild(e.parentNode.childNodes[s],!0);else if(_isIE)for(var s=e.childNodes.length-1;s>=0;s--)e.childNodes[s].removeNode(!0);else e.innerHTML="";e.appendChild(i),this.rowsCol=dhtmlxArray(),this._sst&&this.enableStableSorting(!0),this._fillers=this.undefined,t||(_isIE&&this._srnd?this.render_dataset():this.render_dataset())}},deleteRow:function(t,e){if(e||(e=this.getRowById(t)),e){if(this.editStop(),!this._realfake&&0==this.callEvent("onBeforeRowDeleted",[t]))return!1;var i=0;if(this.cellType._dhx_find("tree")==-1||this._realfake){e.parentNode&&e.parentNode.removeChild(e);var s=this.rowsCol._dhx_find(e);s!=-1&&this.rowsCol._dhx_removeAt(s);for(var l=0;l<this.rowsBuffer.length;l++)if(this.rowsBuffer[l]&&this.rowsBuffer[l].idd==t){this.rowsBuffer._dhx_removeAt(l),s=l;break}}else i=this._h2.get[t].parent.id,this._removeTrGrRow(e);this.rowsAr[t]=null;for(var l=0;l<this.selectedRows.length;l++)this.selectedRows[l].idd==t&&this.selectedRows._dhx_removeAt(l);if(this._srnd){for(var l=0;l<this._fillers.length;l++){var n=this._fillers[l];n&&(n[0]>=s?this._update_fillers(l,0,-1):n[0]+n[1]>s&&this._update_fillers(l,-1,0))}this._update_srnd_view()}return this.pagingOn&&this.changePage(),this._realfake||this.callEvent("onAfterRowDeleted",[t,i]),this.callEvent("onGridReconstructed",[]),this._ahgr&&this.setSizes(),!0}},_addRow:function(t,e,i){i!=-1&&"undefined"!=typeof i||(i=this.rowsBuffer.length),"string"==typeof e&&(e=e.split(this.delim));var s=this._prepareRow(t);s._attrs={};for(var l=0;l<s.childNodes.length;l++)s.childNodes[l]._attrs={};if(this.rowsAr[s.idd]=s,this._h2&&(this._h2.get[s.idd].buff=s),this._fillRow(s,e),this._postRowProcessing(s),this._skipInsert)return this._skipInsert=!1,this.rowsAr[s.idd]=s;if(this.pagingOn)return this.rowsBuffer._dhx_insertAt(i,s),this.rowsAr[s.idd]=s,s;if(this._fillers){this.rowsCol._dhx_insertAt(i,null),this.rowsBuffer._dhx_insertAt(i,s),this._fake&&this._fake.rowsCol._dhx_insertAt(i,null),this.rowsAr[s.idd]=s;for(var n=!1,o=0;o<this._fillers.length;o++){var r=this._fillers[o];if(r&&r[0]<=i&&r[0]+r[1]>=i){r[1]=r[1]+1;var h=r[2].firstChild.style.height=parseInt(r[2].firstChild.style.height)+this._srdh+"px";n=!0,this._fake&&(this._fake._fillers[o][1]++,this._fake._fillers[o][2].firstChild.style.height=h)}r&&r[0]>i&&(r[0]=r[0]+1,this._fake&&this._fake._fillers[o][0]++)}return n||this._fillers.push(this._add_filler(i,1,0==i?{parentNode:this.obj.rows[0].parentNode,nextSibling:this.rowsCol[1]}:this.rowsCol[i-1])),s}return this.rowsBuffer._dhx_insertAt(i,s),this._insertRowAt(s,i)},addRow:function(t,e,i){var s=this._addRow(t,e,i);return this.dragContext||this.callEvent("onRowAdded",[t]),this.pagingOn&&this.changePage(this.currentPage),this._srnd&&this._update_srnd_view(),s._added=!0,this._srnd&&!this._fillers&&(this._fillers=[]),this._ahgr&&this.setSizes(),this.callEvent("onGridReconstructed",[]),s},_insertRowAt:function(t,e,i){if(this.rowsAr[t.idd]=t,this._skipInsert)return this._skipInsert=!1,t;if(e<0||!e&&0!==parseInt(e)?e=this.rowsCol.length:e>this.rowsCol.length&&(e=this.rowsCol.length),this._cssEven){var s=t.className.replace(this._cssUnEven,"");(this._cssSP?this.getLevel(t.idd):e)%2==1?t.className=s+" "+this._cssUnEven+(this._cssSU?" "+this._cssUnEven+"_"+this.getLevel(t.idd):""):t.className=s+" "+this._cssEven+(this._cssSU?" "+this._cssEven+"_"+this.getLevel(t.idd):"")}return i||(e!=this.obj.rows.length-1&&this.rowsCol[e]?this.rowsCol[e].parentNode.insertBefore(t,this.rowsCol[e]):_isKHTML?this.obj.appendChild(t):this.obj.firstChild.appendChild(t)),this.rowsCol._dhx_insertAt(e,t),this.callEvent("onRowInserted",[t,e]),t},getRowById:function(t){var e=this.rowsAr[t];if(e){if("TR"!=e.tagName){for(var i=0;i<this.rowsBuffer.length;i++)if(this.rowsBuffer[i]&&this.rowsBuffer[i].idd==t)return this.render_row(i);if(this._h2)return this.render_row(null,e.idd)}return e}return null},cellById:function(t,e){return this.cells(t,e)},cells:function(t,e){if(0==arguments.length)return this.cells4(this.cell);var i=this.getRowById(t),s=i._childIndexes?i.childNodes[i._childIndexes[e]]:i.childNodes[e];return!s&&i._childIndexes&&(s=i.firstChild||{}),this.cells4(s)},cellByIndex:function(t,e){return this.cells2(t,e)},cells2:function(t,e){var i=this.render_row(t),s=i._childIndexes?i.childNodes[i._childIndexes[e]]:i.childNodes[e];return!s&&i._childIndexes&&(s=i.firstChild||{}),this.cells4(s)},cells3:function(t,e){var i=t._childIndexes?t.childNodes[t._childIndexes[e]]:t.childNodes[e];return this.cells4(i)},cells4:function(t){var e=window["eXcell_"+(t._cellType||this.cellType[t._cellIndex])];if(e)return new e(t)},cells5:function(t,e){var e=e||t._cellType||this.cellType[t._cellIndex];if(!this._ecache[e]){if(window["eXcell_"+e])var i=window["eXcell_"+e];else var i=eXcell_ro;this._ecache[e]=new i(t)}return this._ecache[e].cell=t,this._ecache[e]},dma:function(t){this._ecache||(this._ecache={}),t&&!this._dma?(this._dma=this.cells4,this.cells4=this.cells5):!t&&this._dma&&(this.cells4=this._dma,this._dma=null)},getRowsNum:function(){return this.rowsBuffer.length},enableEditTabOnly:function(t){arguments.length>0?this.smartTabOrder=dhx4.s2b(t):this.smartTabOrder=!0},setExternalTabOrder:function(t,e){var i=this;this.tabStart="object"==typeof t?t:document.getElementById(t);var s=this.tabStart.onkeydown;this.tabStart.onkeydown=function(t){s&&s.call(this,t);var e=t||window.event;if(9==e.keyCode&&!e.shiftKey)return e.cancelBubble=!0,i.selectCell(0,0,0,0,1),i.smartTabOrder&&i.cells2(0,0).isDisabled()&&i._key_events.k9_0_0.call(i),this.blur(),!1},_isOpera&&(this.tabStart.onkeypress=this.tabStart.onkeydown),this.tabEnd="object"==typeof e?e:document.getElementById(e);var l=this.tabEnd.onkeydown;this.tabEnd.onkeydown=this.tabEnd.onkeypress=function(t){l&&l.call(this,t);var e=t||window.event;if(9==e.keyCode&&e.shiftKey)return e.cancelBubble=!0,i.selectCell(i.getRowsNum()-1,i.getColumnCount()-1,0,0,1),i.smartTabOrder&&i.cells2(i.getRowsNum()-1,i.getColumnCount()-1).isDisabled()&&i._key_events.k9_0_1.call(i),this.blur(),!1},_isOpera&&(this.tabEnd.onkeypress=this.tabEnd.onkeydown)},uid:function(){return this._ui_seed||(this._ui_seed=(new Date).valueOf()),this._ui_seed++},clearAndLoad:function(){if(this._last_load_request){var t=this._last_load_request.xmlDoc;if(4!=t.readyState)try{t.onreadystatechange=function(){},t.abort()}catch(t){}}var e=this._pgn_skin;this._pgn_skin=null,this.clearAll(),this._pgn_skin=e,this._last_load_request=this.load.apply(this,arguments)},getStateOfView:function(){if(this.pagingOn){var t=(this.currentPage-1)*this.rowsBufferOutSize;return[this.currentPage,t,Math.min(t+this.rowsBufferOutSize,this.rowsBuffer.length),this.rowsBuffer.length]}return[Math.floor(this.objBox.scrollTop/this._srdh),Math.ceil(parseInt(this.objBox.offsetHeight)/this._srdh),this.rowsBuffer.length]}},function(){function t(t,e){this[t]=e}function e(t,e){this[t].call(this,e)}function i(t,e){this[t].call(this,e.join(this.delim))}function s(t,e){for(var i=0;i<e.length;i++)if("object"==typeof e[i]){var s=this.getCombo(i);for(var l in e[i])s.put(l,e[i][l])}}function l(t,e,i){function s(t,e,i){l[e]||(l[e]=[]),"object"==typeof i&&(i.toString=function(){return this.text}),l[e][t]=i}for(var l=[],n=0;n<e.length;n++)if("object"==typeof e[n]&&e[n].length)for(var o=0;o<e[n].length;o++)s(n,o,e[n][o]);else s(n,0,e[n]);for(var n=0;n<l.length;n++)for(var o=0;o<l[0].length;o++){var r=l[n][o];if(l[n][o]=(r||"").toString()||"&nbsp;",r&&r.colspan)for(var h=1;h<r.colspan;h++)s(o+h,n,"#cspan");if(r&&r.rowspan)for(var h=1;h<r.rowspan;h++)s(o,n+h,"#rspan")}this.setHeader(l[0]);for(var n=1;n<l.length;n++)this.attachHeader(l[n])}var n=[{name:"label",def:"&nbsp;",operation:"setHeader",type:l},{name:"id",def:"",operation:"columnIds",type:t},{name:"width",def:"*",operation:"setInitWidths",type:i},{name:"align",def:"left",operation:"cellAlign",type:t},{name:"valign",def:"middle",operation:"cellVAlign",type:t},{name:"sort",def:"na",operation:"fldSort",type:t},{name:"type",def:"ro",operation:"setColTypes",type:i},{name:"options",def:"",operation:"",type:s}];dhtmlx.extend_api("dhtmlXGridObject",{_init:function(t){return[t.parent]},image_path:"setImagePath",columns:"columns",rows:"rows",headers:"headers",skin:"setSkin",smart_rendering:"enableSmartRendering",css:"enableAlterCss",auto_height:"enableAutoHeight",save_hidden:"enableAutoHiddenColumnsSaving",save_cookie:"enableAutoSaving",save_size:"enableAutoSizeSaving",auto_width:"enableAutoWidth",block_selection:"enableBlockSelection",csv_id:"enableCSVAutoID",csv_header:"enableCSVHeader",cell_ids:"enableCellIds",colspan:"enableColSpan",column_move:"enableColumnMove",context_menu:"enableContextMenu",distributed:"enableDistributedParsing",drag:"enableDragAndDrop",drag_order:"enableDragOrder",tabulation:"enableEditTabOnly",header_images:"enableHeaderImages",header_menu:"enableHeaderMenu",keymap:"enableKeyboardSupport",mouse_navigation:"enableLightMouseNavigation",markers:"enableMarkedCells",math_editing:"enableMathEditing",math_serialization:"enableMathSerialization",drag_copy:"enableMercyDrag",multiline:"enableMultiline",multiselect:"enableMultiselect",save_column_order:"enableOrderSaving",hover:"enableRowsHover",rowspan:"enableRowspan",smart:"enableSmartRendering",save_sorting:"enableSortingSaving",stable_sorting:"enableStableSorting",undo:"enableUndoRedo",csv_cell:"setCSVDelimiter",date_format:"setDateFormat",drag_behavior:"setDragBehavior",editable:"setEditable",without_header:"setNoHeader",submit_changed:"submitOnlyChanged",submit_serialization:"submitSerialization",submit_selected:"submitOnlySelected",submit_id:"submitOnlyRowID",xml:"load"},{columns:function(t){for(var i=0;i<n.length;i++){for(var s=[],l=0;l<t.length;l++)s[l]=t[l][n[i].name]||n[i].def;var o=n[i].type||e;o.call(this,n[i].operation,s,t)}this.init()},rows:function(t){},headers:function(t){for(var e=0;e<t.length;e++)this.attachHeader(t[e])}})}(),dhtmlXGridObject.prototype._dp_init=function(t){t.attachEvent("insertCallback",function(t,e){this.obj._h2?this.obj.addRow(e,i,null,parent):this.obj.addRow(e,[],0);var i=this.obj.getRowById(e);i&&(this.obj._process_xml_row(i,t.firstChild),this.obj._postRowProcessing(i))}),t.attachEvent("updateCallback",function(t,e){var i=this.obj.getRowById(e);i&&(this.obj._process_xml_row(i,t.firstChild),this.obj._postRowProcessing(i))}),t.attachEvent("deleteCallback",function(t,e){this.obj.setUserData(e,this.action_param,"true_deleted"),this.obj.deleteRow(e)}),t._methods=["setRowTextStyle","setCellTextStyle","changeRowId","deleteRow"],this.attachEvent("onEditCell",function(e,i,s){if(t._columns&&!t._columns[s])return!0;var l=this.cells(i,s);return 1==e?l.isCheckbox()&&t.setUpdated(i,!0):2==e&&l.wasChanged()&&t.setUpdated(i,!0),!0}),this.attachEvent("onRowPaste",function(e){t.setUpdated(e,!0)}),this.attachEvent("onUndo",function(e){t.setUpdated(e,!0)}),this.attachEvent("onRowIdChange",function(e,i){var s=t.findRow(e);s<t.updatedRows.length&&(t.updatedRows[s]=i)}),this.attachEvent("onSelectStateChanged",function(e){return"row"==t.updateMode&&t.sendData(),!0}),this.attachEvent("onEnter",function(e,i){return"row"==t.updateMode&&t.sendData(),!0}),this.attachEvent("onBeforeRowDeleted",function(e){if(t._silent_mode||!this.rowsAr[e])return!0;if(this.dragContext&&t.dnd)return window.setTimeout(function(){t.setUpdated(e,!0)},1),!0;var i=t.getState(e);return this._h2&&this._h2.forEachChild(e,function(e){t.setUpdated(e.id,!1),t.markRow(e.id,!0,"deleted")},this),"inserted"==i?(t.set_invalid(e,!1),t.setUpdated(e,!1),!0):"deleted"!=i&&("true_deleted"==i?(t.setUpdated(e,!1),!0):(t.setUpdated(e,!0,"deleted"),!1))}),this.attachEvent("onBindUpdate",function(e){"object"==typeof e&&(e=e.id),t.setUpdated(e,!0)}),this.attachEvent("onRowAdded",function(e){return!(!this.dragContext||!t.dnd)||(t.setUpdated(e,!0,"inserted"),!0)}),t._getRowData=function(t,e){var i=[];i.gr_id=t,this.obj.isTreeGrid()&&(i.gr_pid=this.obj.getParentId(t));for(var s=this.obj.getRowById(t),l=0;l<this.obj._cCount;l++){if(this.obj._c_order)var n=this.obj._c_order[l];else var n=l;var o=this.obj.cells(s.idd,l);this._changed&&!o.wasChanged()||(this._endnm?i[this.obj.getColumnId(l)]=o.getValue():i["c"+n]=o.getValue())}var r=this.obj.UserData[t];if(r)for(var h=0;h<r.keys.length;h++)r.keys[h]&&0!=r.keys[h].indexOf("__")&&(i[r.keys[h]]=r.values[h]);var r=this.obj.UserData.gridglobaluserdata;if(r)for(var h=0;h<r.keys.length;h++)i[r.keys[h]]=r.values[h];return i},t._clearUpdateFlag=function(t){var e=this.obj.getRowById(t);if(e)for(var i=0;i<this.obj._cCount;i++)this.obj.cells(t,i).cell.wasChanged=!1},t.checkBeforeUpdate=function(t){for(var e=!0,i=[],s=0;s<this.obj._cCount;s++)if(this.mandatoryFields[s]){var l=this.mandatoryFields[s].call(this.obj,this.obj.cells(t,s).getValue(),t,s);"string"==typeof l?(this.messages.push(l),e=!1):(e&=l,i[s]=!l)}return e||(this.set_invalid(t,"invalid",i),this.setUpdated(t,!1)),e}},dhx4.attachEvent("onGridCreated",function(t){t._con_f_used=[].concat(t._con_f_used),dhtmlXGridObject.prototype._con_f_used=[];var e=function(t){return t=t.replace(/(\?|\&)connector[^\f]*/g,""),t+(t.indexOf("?")!=-1?"&":"?")+"connector=true"+(this.hdr.rows.length>0?"&dhx_no_header=1":"")},i=function(t){return e.call(this,t)+(this._connector_sorting||"")+(this._connector_filter||"")},s=function(t,e,s){return this._connector_sorting="&dhx_sort["+e+"]="+s,i.call(this,t)},l=function(t,e,s){for(var l=[],n=0;n<e.length;n++)l[n]="dhx_filter["+e[n]+"]="+encodeURIComponent(s[n]);return this._connector_filter="&"+l.join("&"),i.call(this,t)};t.attachEvent("onCollectValues",function(t){return!this._con_f_used[t]||"object"==typeof this._con_f_used[t]&&this._con_f_used[t]}),t.attachEvent("onDynXLS",function(){return this.xmlFileUrl&&(this.xmlFileUrl=i.call(this,this.xmlFileUrl)),!0}),t.attachEvent("onBeforeSorting",function(t,e,i){if("connector"==e){var l=this;return this.clearAndLoad(s.call(this,this.xmlFileUrl,t,i),function(){l.setSortImgState(!0,t,i)}),!1}return!0}),t.attachEvent("onFilterStart",function(t,e){if(this._con_f_used.length){var i=this.getSortingState(),s=this;return this.clearAndLoad(l.call(this,this.xmlFileUrl,t,e)),i.length&&s.setSortImgState(!0,i[0],i[1]),!1}return!0})}),dhtmlXGridObject.prototype._con_f_used=[],dhtmlXGridObject.prototype._in_header_connector_text_filter=function(t,e){return this._con_f_used[e]||(this._con_f_used[e]=1),this._in_header_text_filter(t,e)},dhtmlXGridObject.prototype._in_header_connector_select_filter=function(t,e){return this._con_f_used[e]||(this._con_f_used[e]=2),this._in_header_select_filter(t,e)},dhtmlXGridObject.prototype.load_connector||(dhtmlXGridObject.prototype.load_connector=dhtmlXGridObject.prototype.load,dhtmlXGridObject.prototype.load=function(t,e,i){if(!this._colls_loaded&&this.cellType){for(var s=[],l=0;l<this.cellType.length;l++)0!=this.cellType[l].indexOf("co")&&0!=this.cellType[l].indexOf("clist")&&2!=this._con_f_used[l]||s.push(l);s.length&&(arguments[0]+=(arguments[0].indexOf("?")!=-1?"&":"?")+"connector=true&dhx_colls="+s.join(","))}return this.load_connector.apply(this,arguments)},dhtmlXGridObject.prototype._parseHead_connector=dhtmlXGridObject.prototype._parseHead,dhtmlXGridObject.prototype._parseHead=function(t,e,i){if(this._parseHead_connector.apply(this,arguments),!this._colls_loaded){for(var s=dhx4.ajax.xpath("./coll_options",arguments[0]),l=0;l<s.length;l++){var n=s[l].getAttribute("for"),o=[],r=null;"combo"==this.cellType[n]?r=this.getColumnCombo(n):0==this.cellType[n].indexOf("co")&&(r=this.getCombo(n));for(var h=dhx4.ajax.xpath("./item",s[l]),a=[],d=0;d<h.length;d++){var c=h[d].getAttribute("value");if(r){var u=h[d].getAttribute("label")||c;r.addOption?a.push([c,u]):r.put(c,u),o[o.length]=u}else o[o.length]=c}a.length?r&&r.addOption(a):o.length&&!r&&this.registerCList&&this.registerCList(1*n,o),this._con_f_used[1*n]&&(this._con_f_used[1*n]=o)}this._colls_loaded=!0}}),dhtmlXGridCellObject.prototype={getAttribute:function(t){return this.cell._attrs[t]},setAttribute:function(t,e){this.cell._attrs[t]=e},getInput:function(){if(this.obj&&("INPUT"==this.obj.tagName||"TEXTAREA"==this.obj.tagName))return this.obj;var t=(this.obj||this.cell).getElementsByTagName("TEXTAREA");return t.length||(t=(this.obj||this.cell).getElementsByTagName("INPUT")),t[0]}},dhtmlXGridCellObject.prototype.setValue=function(t){"number"==typeof t||t&&""!=t.toString()._dhx_trim()?this.cell._clearCell=!1:(t="&nbsp;",this.cell._clearCell=!0),this.setCValue(t)},dhtmlXGridCellObject.prototype.getTitle=function(){return _isIE?this.cell.innerText:this.cell.textContent},dhtmlXGridCellObject.prototype.setCValue=function(t,e){this.cell.innerHTML=t,this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,arguments.length>1?e:t])},dhtmlXGridCellObject.prototype.setCTxtValue=function(t){this.cell.innerHTML="",this.cell.appendChild(document.createTextNode(t)),this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,t])},dhtmlXGridCellObject.prototype.setLabel=function(t){this.cell.innerHTML=t},dhtmlXGridCellObject.prototype.getMath=function(){return this._val?this.val:this.getValue()},eXcell.prototype=new dhtmlXGridCellObject,eXcell_ed.prototype=new eXcell,eXcell_edtxt.prototype=new eXcell_ed,eXcell_edn.prototype=new eXcell_ed,eXcell_edn.prototype.setValue=function(t){return t&&""!=t.toString()._dhx_trim()?(this.cell._clearCell=!1,this.cell._orig_value=t,void this.setCValue(this.grid._aplNF(t,this.cell._cellIndex),t)):(this.cell._clearCell=!0,this.setCValue("&nbsp;",0))},eXcell_ch.prototype=new eXcell,eXcell_ch.prototype.setValue=function(t){this.cell.style.verticalAlign="middle",t&&(t=t.toString()._dhx_trim(),"false"!=t&&"0"!=t||(t="")),t?(t="1",this.cell.chstate="1"):(t="0",this.cell.chstate="0");this.setCValue("<img src='"+this.grid.imgURL+"item_chk"+t+".gif' onclick='new eXcell_ch(this.parentNode).changeState(true); (arguments[0]||event).cancelBubble=true; '>",this.cell.chstate)},eXcell_ra.prototype=new eXcell_ch,eXcell_ra.prototype.setValue=function(t){if(this.cell.style.verticalAlign="middle",t&&(t=t.toString()._dhx_trim(),"false"!=t&&"0"!=t||(t="")),t){if(this.grid._RaSeCol||(this.grid._RaSeCol=[]),this.grid._RaSeCol[this.cell._cellIndex]){var e=this.grid.cells4(this.grid._RaSeCol[this.cell._cellIndex]);e.setValue("0"),this.grid.rowsAr[e.cell.parentNode.idd]&&this.grid.callEvent("onEditCell",[1,e.cell.parentNode.idd,e.cell._cellIndex])}this.grid._RaSeCol[this.cell._cellIndex]=this.cell,t="1",this.cell.chstate="1"}else t="0",this.cell.chstate="0";this.setCValue("<img src='"+this.grid.imgURL+"radio_chk"+t+".gif' onclick='new eXcell_ra(this.parentNode).changeState(false);'>",this.cell.chstate)},eXcell_txt.prototype=new eXcell,eXcell_txttxt.prototype=new eXcell_txt,eXcell_txt.prototype.setValue=function(t){this.cell._brval=t,t&&""!=t.toString()._dhx_trim()?this.cell._clearCell=!1:(t="&nbsp;",this.cell._clearCell=!0),!this.grid.multiLine||this.cell._clearCell?this.setCValue(t,this.cell._brval):this.setCValue(t.replace(/\n/g,"<br/>"),t)},eXcell_co.prototype=new eXcell,eXcell_co.prototype.getText=function(){return this.cell.innerHTML},eXcell_co.prototype.setValue=function(t){if("object"==typeof t){var e=dhx4.ajax.xpath("./option",t);e.length&&(this.cell._combo=new dhtmlXGridComboObject);for(var i=0;i<e.length;i++)this.cell._combo.put(e[i].getAttribute("value"),e[i].firstChild?e[i].firstChild.data:"");t=t.firstChild.data}if(""==(t||"").toString()._dhx_trim()&&(t=null),this.cell.combo_value=t,null!==t){var s=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(t);this.setCValue(null===s?t:s,t)}else this.setCValue("&nbsp;",t)},eXcell_coro.prototype=new eXcell_co,eXcell_cotxt.prototype=new eXcell_co,eXcell_cotxt.prototype.getText=function(){return _isIE?this.cell.innerText:this.cell.textContent},eXcell_cotxt.prototype.setValue=function(t){if("object"==typeof t){var e=dhx4.ajax.xpath("./option",t);e.length&&(this.cell._combo=new dhtmlXGridComboObject);for(var i=0;i<e.length;i++)this.cell._combo.put(e[i].getAttribute("value"),e[i].firstChild?e[i].firstChild.data:"");t=t.firstChild.data}""==(t||"").toString()._dhx_trim()&&(t=null),null!==t?this.setCTxtValue((this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(t)||t,t):this.setCTxtValue(" ",t),this.cell.combo_value=t},eXcell_corotxt.prototype=new eXcell_cotxt,eXcell_cp.prototype=new eXcell,eXcell_cp.prototype.setValue=function(t){this.setCValue("<div style='width:100%;height:"+(this.grid.multiLine?"100%":23)+";background-color:"+(t||"")+";border:0px;'>&nbsp;</div>",t),this.cell.firstChild._bg=t},eXcell_img.prototype=new eXcell,eXcell_img.prototype.getTitle=function(){return this.cell._brval},eXcell_img.prototype.setValue=function(t){var e=t;if((t||"").indexOf("^")!=-1){var i=t.split("^");t=i[0],e=this.cell._attrs.title||i[1],i.length>2&&(this.cell.lnk=i[2],i[3]&&(this.cell.trg=i[3])),this.cell.titFl="1"}this.grid.multiLine?this.setCValue("<img src='"+this.grid.iconURL+(t||"")._dhx_trim()+"' border='0'>",t):this.setCValue("<img src='"+this.grid.iconURL+(t||"")._dhx_trim()+"' border='0' style='max-height:"+(this.grid._srdh-4)+"px'>",t),this.cell.lnk&&(this.cell.innerHTML="<a href='"+this.cell.lnk+"' target='"+this.cell.trg+"'>"+this.cell.innerHTML+"</a>"),this.cell._brval=e},eXcell_price.prototype=new eXcell_ed,eXcell_price.prototype.setValue=function(t){isNaN(parseFloat(t))&&(t=this.val||0);var e="green";t<0&&(e="red"),this.setCValue("<span>$</span><span style='padding-right:2px;color:"+e+";'>"+t+"</span>",t)},eXcell_dyn.prototype=new eXcell_ed,eXcell_dyn.prototype.setValue=function(t){if(t&&!isNaN(Number(t))||""!==t&&(t=0),t>0)var e="green",i="dyn_up.gif";else if(0==t)var e="black",i="dyn_.gif";else var e="red",i="dyn_down.gif";this.setCValue("<div style='position:relative;padding-right:2px; width:100%;overflow:hidden; white-space:nowrap;'><img src='"+this.grid.imgURL+i+"' height='15' style='position:absolute;top:0px;left:0px;'><span style=' padding-left:20px; width:100%;color:"+e+";'>"+t+"</span></div>",t)},eXcell_ro.prototype=new eXcell,window.eXcell_hidden=function(t){t&&(this.cell=t,this.grid=this.cell.parentNode.grid),this.edit=function(){},this.isDisabled=function(){return!0},this.getValue=function(){return this.cell.val}},eXcell_hidden.prototype=new eXcell,eXcell_hidden.prototype.setValue=function(t){this.cell.val=t},eXcell_ron.prototype=new eXcell,eXcell_ron.prototype.setValue=function(t){if(0===t);else if(!t||""==t.toString()._dhx_trim())return this.setCValue("&nbsp;"),this.cell._clearCell=!0;this.cell._orig_value=t,this.cell._clearCell=!1,this.setCValue(t?this.grid._aplNF(t,this.cell._cellIndex):"0")},eXcell_rotxt.prototype=new eXcell,Hashtable.prototype=new dhtmlXGridComboObject,"undefined"!=typeof window.dhtmlXCellObject&&(dhtmlXCellObject.prototype.attachGrid=function(){this.callEvent("_onBeforeContentAttach",["grid"]);var t=document.createElement("DIV");return t.style.width="100%",t.style.height="100%",t.style.position="relative",t.style.overflow="hidden",this._attachObject(t),this.dataType="grid",this.dataObj=new dhtmlXGridObject(t),this.dataObj.setSkin(this.conf.skin),"function"==typeof window.dhtmlXTabBarCell&&this instanceof window.dhtmlXTabBarCell&&null!=navigator.userAgent.match(/7[\.\d]* mobile/gi)&&null!=navigator.userAgent.match(/AppleWebKit/gi)&&(this.dataObj.objBox.style.webkitOverflowScrolling="auto"),"dhx_skyblue"==this.conf.skin&&"function"==typeof window.dhtmlXWindowsCell&&this instanceof window.dhtmlXWindowsCell?(this.dataObj.entBox.style.border="1px solid #a4bed4",this.dataObj._sizeFix=0):(this.dataObj.entBox.style.border="0px solid white",this.dataObj._sizeFix=2),t=null,this.callEvent("_onContentAttach",[]),this.dataObj}),dhtmlXGridObject.prototype.enableDragAndDrop=function(t){"temporary_disabled"==t?(this.dADTempOff=!1,t=!0):this.dADTempOff=!0,this.dragAndDropOff=dhx4.s2b(t),this._drag_validate=!0,t&&(this.objBox.ondragstart=function(t){return(t||event).cancelBubble=!0,!1})},dhtmlXGridObject.prototype.setDragBehavior=function(t){switch(this.dadmodec=this.dadmodefix=0,t){case"child":this.dadmode=0,this._sbmod=!1;break;case"sibling":this.dadmode=1,this._sbmod=!1;break;case"sibling-next":this.dadmode=1,this._sbmod=!0;break;case"complex":this.dadmode=2,this._sbmod=!1;break;case"complex-next":this.dadmode=2,this._sbmod=!0}},dhtmlXGridObject.prototype.enableDragOrder=function(t){this._dndorder=dhx4.s2b(t)},dhtmlXGridObject.prototype._checkParent=function(t,e){var i=this._h2.get[t.idd].parent;if(i.parent){for(var s=0;s<e.length;s++)if(e[s]==i.id)return!0;return this._checkParent(this.rowsAr[i.id],e)}},dhtmlXGridObject.prototype._createDragNode=function(t,e){if(this.editStop(),window.dhtmlDragAndDrop.dragNode)return null;if(!this.dADTempOff)return null;t.parentObject=new Object,t.parentObject.treeNod=this;var i=this.callEvent("onBeforeDrag",[t.parentNode.idd,t._cellIndex,e]);if(!i)return null;var s=new Array;s=this.getSelectedId(),s=s&&""!=s?s.split(this.delim):[];for(var l=!1,n=0;n<s.length;n++)s[n]==t.parentNode.idd&&(l=!0);if(l||(this.selectRow(this.rowsAr[t.parentNode.idd],!1,e.ctrlKey,!1),e.ctrlKey||(s=[]),s[this.selMultiRows?s.length:0]=t.parentNode.idd),this.isTreeGrid())for(var n=s.length-1;n>=0;n--)this._checkParent(this.rowsAr[s[n]],s)&&s.splice(n,1);var o=this;s.length&&this._dndorder&&s.sort(function(t,e){return o.rowsAr[t].rowIndex>o.rowsAr[e].rowIndex?1:-1});var r=this.getFirstParentOfType(_isIE?e.srcElement:e.target,"TD");r&&(this._dndExtra=r._cellIndex),this._dragged=new Array;for(var n=0;n<s.length;n++)this.rowsAr[s[n]]&&(this._dragged[this._dragged.length]=this.rowsAr[s[n]],this.rowsAr[s[n]].treeNod=this);t.parentObject.parentNode=t.parentNode;var h=document.createElement("div");return h.innerHTML=i!==!0?i:this.rowToDragElement(t.parentNode.idd),h.style.position="absolute",h.className="dragSpanDiv",h},dhtmlXGridObject.prototype._createSdrgc=function(){this._sdrgc=document.createElement("DIV"),this._sdrgc.innerHTML="&nbsp;",this._sdrgc.className="gridDragLine",this.objBox.appendChild(this._sdrgc)},dragContext.prototype.valid=function(){if(this.sobj!=this.tobj)return!0;if(this.sid==this.tid)return!1;if("treeGrid"==this.target)for(var t=this.tid;t=this.tobj.getParentId(t);)if(this.sid==t)return!1;return!0},dragContext.prototype.close=function(){this.sobj=null,this.tobj=null},dragContext.prototype.copy=function(){return new dragContext(this.source,this.target,this.mode,this.dropmode,this.sid,this.tid,this.sobj,this.tobj,this.sExtra,this.tExtra)},dragContext.prototype.set=function(t,e){return this[t]=e,this},dragContext.prototype.uid=function(t,e){for(this.nid=this.sid;this.tobj.rowsAr[this.nid];)this.nid=this.nid+(new Date).valueOf();return this},dragContext.prototype.data=function(){return this.sobj==this.tobj?this.sobj._getRowArray(this.sobj.rowsAr[this.sid]):"tree"==this.source?this.tobj.treeToGridElement(this.sobj,this.sid,this.tid):this.tobj.gridToGrid(this.sid,this.sobj,this.tobj)},dragContext.prototype.attrs=function(){return"tree"==this.source?{}:this.sobj.rowsAr[this.sid]._attrs},dragContext.prototype.childs=function(){return"treeGrid"==this.source&&this.sobj._h2.get[this.sid]._xml_await?this.sobj._h2.get[this.sid].has_kids:null},dragContext.prototype.pid=function(){if(!this.tid)return 0;if(!this.tobj._h2)return 0;if("treeGrid"==this.target){if("child"==this.dropmode)return this.tid;var t=this.tobj.rowsAr[this.tid],e=this.tobj._h2.get[t.idd].parent.id;if(this.alfa&&this.tobj._sbmod&&t.nextSibling){var i=this.tobj._h2.get[t.nextSibling.idd].parent.id;if(i==this.tid)return this.tid;if(i!=e)return i}return e}},dragContext.prototype.ind=function(){if(this.tid==window.unknown)return this.tobj.rowsBuffer.length;"treeGrid"==this.target&&("child"==this.dropmode?this.tobj.openItem(this.tid):this.tobj.openItem(this.tobj.getParentId(this.tid)));var t=this.tobj.rowsBuffer._dhx_find(this.tobj.rowsAr[this.tid]);if(this.alfa&&this.tobj._sbmod&&"sibling"==this.dropmode){var e=this.tobj.rowsAr[this.tid];if(e.nextSibling&&this._h2.get[e.nextSibling.idd].parent.id==this.tid)return t+1}return t+1+("treeGrid"==this.target&&t>=0&&"minus"==this.tobj._h2.get[this.tobj.rowsBuffer[t].idd].state?this.tobj._getOpenLenght(this.tobj.rowsBuffer[t].idd,0):0)},dragContext.prototype.img=function(){return"grid"!=this.target&&this.sobj._h2?this.sobj.getItemImage(this.sid):null},dragContext.prototype.slist=function(){for(var t=new Array,e=0;e<this.sid.length;e++)t[t.length]=this.sid[e]["tree"==this.source?"id":"idd"];return t.join(",")},dhtmlXGridObject.prototype._drag=function(t,e,i,s){if(this._realfake)return this._fake._drag();this.lastLanding;this._autoOpenTimer&&window.clearTimeout(this._autoOpenTimer);var l=i.parentNode,n=t.parentObject;l.idd||(l.grid=this,this.dadmodefix=0);var o=new dragContext(0,0,0,1==l.grid.dadmode||l.grid.dadmodec?"sibling":"child");if(n&&n.childNodes)o.set("source","tree").set("sobj",n.treeNod).set("sid",o.sobj._dragged);else{if(!n)return!0;n.treeNod.isTreeGrid&&n.treeNod.isTreeGrid()&&o.set("source","treeGrid"),o.set("sobj",n.treeNod).set("sid",o.sobj._dragged)}l.grid.isTreeGrid()?o.set("target","treeGrid"):o.set("dropmode","sibling"),o.set("tobj",l.grid).set("tid",l.idd),2==o.tobj.dadmode&&1==o.tobj.dadmodec&&o.tobj.dadmodefix<0&&(o.tobj.obj.rows[1].idd!=o.tid?o.tid=l.previousSibling.idd:o.tid=0);var r=this.getFirstParentOfType(s,"TD");if(r&&o.set("tExtra",r._cellIndex),r&&o.set("sExtra",o.sobj._dndExtra),o.sobj.dpcpy&&o.set("mode","copy"),o.tobj._realfake&&(o.tobj=o.tobj._fake),o.sobj._realfake&&(o.sobj=o.sobj._fake),o.tobj._clearMove(),n&&n.treeNod&&n.treeNod._nonTrivialRow)n.treeNod._nonTrivialRow(this,o.tid,o.dropmode,n);else{if(o.tobj.dragContext=o,!o.tobj.callEvent("onDrag",[o.slist(),o.tid,o.sobj,o.tobj,o.sExtra,o.tExtra]))return o.tobj.dragContext=null;var h=new Array;if("object"==typeof o.sid){for(var a=o.copy(),d=0;d<o.sid.length;d++)a.set("alfa",!d).set("sid",o.sid[d]["tree"==o.source?"id":"idd"]).valid()&&(a.tobj._dragRoutine(a),"treeGrid"==a.target&&"child"==a.dropmode&&a.tobj.openItem(a.tid),h[h.length]=a.nid,a.set("dropmode","sibling").set("tid",a.nid));a.close()}else o.tobj._dragRoutine(o);o.tobj.laterLink&&o.tobj.laterLink(),o.tobj.callEvent("onDrop",[o.slist(),o.tid,h.join(","),o.sobj,o.tobj,o.sExtra,o.tExtra]);
}o.tobj.dragContext=null,o.close()},dhtmlXGridObject.prototype._dragRoutine=function(t){if(t.sobj==t.tobj&&"grid"==t.source&&"move"==t.mode&&!this._fake){if(t.sobj._dndProblematic)return;var e=t.sobj.rowsAr[t.sid],i=t.sobj.rowsCol._dhx_find(e);if(t.sobj.rowsCol._dhx_removeAt(t.sobj.rowsCol._dhx_find(e)),t.sobj.rowsBuffer._dhx_removeAt(t.sobj.rowsBuffer._dhx_find(e)),t.sobj.rowsBuffer._dhx_insertAt(t.ind(),e),t.tobj._fake){t.tobj._fake.rowsCol._dhx_removeAt(i);var s=t.tobj._fake.rowsAr[t.sid];s.parentNode.removeChild(s)}return t.sobj._insertRowAt(e,t.ind()-(this.pagingOn?(this.currentPage-1)*this.rowsBufferOutSize:0)),t.nid=t.sid,void t.sobj.callEvent("onGridReconstructed",[])}var l;if(this._h2&&"undefined"!=typeof t.tid&&"sibling"==t.dropmode&&(this._sbmod||t.tid)?t.alfa&&this._sbmod&&this._h2.get[t.tid].childs.length?(this.openItem(t.tid),l=t.uid().tobj.addRowBefore(t.nid,t.data(),this._h2.get[t.tid].childs[0].id,t.img(),t.childs())):l=t.uid().tobj.addRowAfter(t.nid,t.data(),t.tid,t.img(),t.childs()):l=t.uid().tobj.addRow(t.nid,t.data(),t.ind(),t.pid(),t.img(),t.childs()),l._attrs=t.attrs(),"tree"==t.source){this.callEvent("onRowAdded",[t.nid]);var n=t.sobj._globalIdStorageFind(t.sid);if(n.childsCount){for(var o=t.copy().set("tid",t.nid).set("dropmode","grid"==t.target?"sibling":"child"),r=0;r<n.childsCount;r++)t.tobj._dragRoutine(o.set("sid",n.childNodes[r].id)),"move"==t.mode&&r--;o.close()}}else if(t.tobj._copyUserData(t),this.callEvent("onRowAdded",[t.nid]),"treeGrid"==t.source){t.sobj==t.tobj&&(l._xml=t.sobj.rowsAr[t.sid]._xml);var h=t.sobj._h2.get[t.sid];if(h&&h.childs.length){var o=t.copy().set("tid",t.nid);"grid"==t.target?o.set("dropmode","sibling"):(o.tobj.kidsXmlFile||o.tobj.openItem(t.tid),o.set("dropmode","child"));var a=h.childs.length;if(!o.tobj.kidsXmlFile)for(var r=0;r<a;r++)t.sobj.render_row_tree(null,h.childs[r].id),t.tobj._dragRoutine(o.set("sid",h.childs[r].id)),a!=h.childs.length&&(r--,a=h.childs.length);o.close()}}"move"==t.mode&&(t.sobj["tree"==t.source?"deleteItem":"deleteRow"](t.sid),t.sobj!=t.tobj||t.tobj.rowsAr[t.sid]||(t.tobj.changeRowId(t.nid,t.sid),t.nid=t.sid))},dhtmlXGridObject.prototype.gridToGrid=function(t,e,i){for(var s=new Array,l=0;l<e.hdr.rows[0].cells.length;l++)s[l]=e.cells(t,l).getValue();return s},dhtmlXGridObject.prototype.checkParentLine=function(t,e){return!!(this._h2&&e&&t)&&(t.id==e||this.checkParentLine(t.parent,e))},dhtmlXGridObject.prototype._dragIn=function(t,e,i,s){if(!this.dADTempOff)return 0;var l=this.isTreeGrid(),n=e.parentNode.idd?e.parentNode:e.parentObject;if(this._drag_validate){if(t.parentNode==e.parentNode)return 0;if(l&&this==n.grid&&this.checkParentLine(this._h2.get[t.parentNode.idd],e.parentNode.idd))return 0}if(!this.callEvent("onDragIn",[n.idd||n.id,t.parentNode.idd,n.grid||n.treeNod,t.grid||t.parentNode.grid]))return this._setMove(t,i,s,!0);if(this._setMove(t,i,s),l&&""!=t.parentNode.expand){var o=this;this._autoOpenTimer=window.setTimeout(function(){o._autoOpenItem(null,o),o=null},1e3),this._autoOpenId=t.parentNode.idd}else this._autoOpenTimer&&window.clearTimeout(this._autoOpenTimer);return t},dhtmlXGridObject.prototype._autoOpenItem=function(t,e){e.openItem(e._autoOpenId)},dhtmlXGridObject.prototype._dragOut=function(t){this._clearMove();var e=t.parentNode.parentObject?t.parentObject.id:t.parentNode.idd;this.callEvent("onDragOut",[e]),this._autoOpenTimer&&window.clearTimeout(this._autoOpenTimer)},dhtmlXGridObject.prototype._setMove=function(t,e,i,s){if(t.parentNode.idd){var l=dhx4.absTop(t),n=dhx4.absTop(this.objBox);if(l-n>parseInt(this.objBox.offsetHeight)-50&&(this.objBox.scrollTop=parseInt(this.objBox.scrollTop)+20),l-n+parseInt(this.objBox.scrollTop)<parseInt(this.objBox.scrollTop)+30&&(this.objBox.scrollTop=parseInt(this.objBox.scrollTop)-20),s)return 0;if(2==this.dadmode){var o=i-l+(document.body.scrollTop||document.documentElement.scrollTop)-2-t.offsetHeight/2;Math.abs(o)-t.offsetHeight/6>0?(this.dadmodec=1,o<0?this.dadmodefix=-1:this.dadmodefix=1):this.dadmodec=0}else this.dadmodec=this.dadmode;if(this.dadmodec)this._sdrgc||this._createSdrgc(),this._sdrgc.style.display="block",this._sdrgc.style.top=l-n+parseInt(this.objBox.scrollTop)+(this.dadmodefix>=0?t.offsetHeight:0)+"px";else if(this._llSelD=t,"TR"==t.parentNode.tagName)for(var r=0;r<t.parentNode.childNodes.length;r++){var o=t.parentNode.childNodes[r];o._bgCol=o.style.backgroundColor,o.style.backgroundColor="#FFCCCC"}}},dhtmlXGridObject.prototype._clearMove=function(){if(this._sdrgc&&(this._sdrgc.style.display="none"),this._llSelD&&"TR"==this._llSelD.parentNode.tagName)for(var t=this._llSelD.parentNode.childNodes,e=0;e<t.length;e++)t[e].style.backgroundColor=t[e]._bgCol;this._llSelD=null},dhtmlXGridObject.prototype.rowToDragElement=function(t){var e=this.cells(t,0).getValue();return e},dhtmlXGridObject.prototype._copyUserData=function(t){if(!t.tobj.UserData[t.nid]||t.tobj!=t.sobj){t.tobj.UserData[t.nid]=new Hashtable;var e=t.sobj.UserData[t.sid],i=t.tobj.UserData[t.nid];e&&(i.keys=i.keys.concat(e.keys),i.values=i.values.concat(e.values))}},dhtmlXGridObject.prototype.moveRow=function(t,e,i,s){switch(e){case"row_sibling":this.moveRowTo(t,i,"move","sibling",this,s);break;case"up":this.moveRowUp(t);break;case"down":this.moveRowDown(t)}},dhtmlXGridObject.prototype._nonTrivialNode=function(t,e,i,s,l){if(t.callEvent&&!l&&!t.callEvent("onDrag",[s.idd,e.id,i?i.id:null,this,t]))return!1;for(var n=s.idd,o=n;t._idpull[o];)o+=(new Date).getMilliseconds().toString();var r=this.isTreeGrid()?this.getItemImage(n):"";if(i){for(d=0;d<e.childsCount&&e.childNodes[d]!=i;d++);0!=d?i=e.childNodes[d-1]:(st="TOP",i="")}var h=t._attachChildNode(e,o,this.gridToTreeElement(t,o,n),"",r,r,r,"","",i);if(this._h2){var a=this._h2.get[n];if(a.childs.length)for(var d=0;d<a.childs.length;d++)this._nonTrivialNode(t,h,0,this.rowsAr[a.childs[d].id],1),this.dpcpy||d--}this.dpcpy||this.deleteRow(n),t.callEvent&&!l&&t.callEvent("onDrop",[o,e.id,i?i.id:null,this,t])},dhtmlXGridObject.prototype.gridToTreeElement=function(t,e,i){return this.cells(i,0).getValue()},dhtmlXGridObject.prototype.treeToGridElement=function(t,e,i){var s=new Array,l=this.cellType._dhx_find("tree");l==-1&&(l=0);for(var n=0;n<this.getColumnCount();n++)s[s.length]=n!=l?t.getUserData(e,this.getColumnId(n))||"":t.getItemText(e);return s},dhtmlXGridObject.prototype.moveRowTo=function(t,e,i,s,l,n){var o=new dragContext((l||this).isTreeGrid()?"treeGrid":"grid",(n||this).isTreeGrid()?"treeGrid":"grid",i,s||"sibling",t,e,l||this,n||this);return o.tobj._dragRoutine(o),o.close(),o.nid},dhtmlXGridObject.prototype.enableMercyDrag=function(t){this.dpcpy=dhx4.s2b(t)},dhtmlXGridObject.prototype.toPDF=function(t,e,i,s,l,n){function o(t){for(var e=[],l=1;l<m.hdr.rows.length;l++){e[l]=[];for(var n=0;n<m._cCount;n++){var o=m.hdr.rows[l].childNodes[n];e[l][n]||(e[l][n]=[0,0]),o&&(e[l][o._cellIndexS]=[o.colSpan,o.rowSpan])}}var r="<rows profile='"+t+"'";i&&(r+=" header='"+i+"'"),s&&(r+=" footer='"+s+"'"),r+="><head>"+m._serialiseExportConfig(e).replace(/^<head/,"<columns").replace(/head>$/,"columns>");for(var l=2;l<m.hdr.rows.length;l++){for(var a=0,d=m.hdr.rows[l],c="",n=0;n<m._cCount;n++)if(m._srClmn&&!m._srClmn[n]||m._hrrar[n]&&(!m._fake||n>=m._fake.hdrLabels.length))a++;else{var u=e[l][n],f=u[0]&&u[0]>1?' colspan="'+u[0]+'" ':"";u[1]&&u[1]>1&&(f+=' rowspan="'+u[1]+'" ',a=-1);var _="",p=d;m._fake&&n<m._fake._cCount&&(p=m._fake.hdr.rows[l]);for(var g=0;g<p.cells.length;g++)if(p.cells[g]._cellIndexS==n){_=p.cells[g].getElementsByTagName("SELECT").length?"":_isIE?p.cells[g].innerText:p.cells[g].textContent,_=_.replace(/[ \n\r\t\xA0]+/," ");break}_&&" "!=_||a++,c+="<column"+f+"><![CDATA["+_+"]]></column>"}a!=m._cCount&&(r+="\n<columns>"+c+"</columns>")}return r+="</head>\n",r+=h()}function r(){var t=[];if(l)for(var e=0;e<l.length;e++)t.push(d(m.getRowIndex(l[e])));else for(var e=0;e<m.getRowsNum();e++)t.push(d(e));return t.join("\n")}function h(){var t=["<foot>"];if(!m.ftr)return"";for(var e=1;e<m.ftr.rows.length;e++){t.push("<columns>");for(var i=m.ftr.rows[e],s=0;s<m._cCount;s++)if((!m._srClmn||m._srClmn[s])&&(!m._hrrar[s]||m._fake&&!(s>=m._fake.hdrLabels.length))){for(var l=0;l<i.cells.length;l++){var n="",o="";if(i.cells[l]._cellIndexS==s){n=_isIE?i.cells[l].innerText:i.cells[l].textContent,n=n.replace(/[ \n\r\t\xA0]+/," "),i.cells[l].colSpan&&1!=i.cells[l].colSpan&&(o=" colspan='"+i.cells[l].colSpan+"' "),i.cells[l].rowSpan&&1!=i.cells[l].rowSpan&&(o=" rowspan='"+i.cells[l].rowSpan+"' ");break}}t.push("<column"+o+"><![CDATA["+n+"]]></column>")}t.push("</columns>")}return t.push("</foot>"),t.join("\n")}function a(t,e){return(window.getComputedStyle?window.getComputedStyle(t,null)[e]:t.currentStyle?t.currentStyle[e]:null)||""}function d(t){if(!m.rowsBuffer[t])return"";var e=m.render_row(t);if("none"==e.style.display)return"";for(var i=m.isTreeGrid()?' level="'+m.getLevel(e.idd)+'"':"",s="<row"+i+">",l=0;l<m._cCount;l++)if((!m._srClmn||m._srClmn[l])&&(!m._hrrar[l]||m._fake&&l<m._fake.hdrLabels.length)){var n=m.cells(e.idd,l);if(p){var o=a(n.cell,"color"),r=a(n.cell,"backgroundColor"),h=a(n.cell,"font-weight")||a(n.cell,"fontWeight"),d=a(n.cell,"font-style")||a(n.cell,"fontStyle"),c=a(n.cell,"text-align")||a(n.cell,"textAlign"),u=a(n.cell,"font-family")||a(n.cell,"fontFamily");"transparent"!=r&&"rgba(0, 0, 0, 0)"!=r||(r="rgb(255,255,255)"),s+="<cell bgColor='"+r+"' textColor='"+o+"' bold='"+h+"' italic='"+d+"' align='"+c+"' font='"+u+"'>"}else s+="<cell>";s+="<![CDATA["+(n.getContent?n.getContent():n.getTitle())+"]]></cell>"}return s+"</row>"}function c(){var t="</rows>";return t}var u={row:(this.getSelectedRowId()||"").split(this.delim),col:this.getSelectedCellIndex()};if(null===u.row||u.col===-1)u=!1;else if(u.row){for(var f=0;f<u.row.length;f++)if(u.row[f]){var _=this.cells(u.row[f],u.col).cell;_.parentNode.className=_.parentNode.className.replace(" rowselected",""),_.className=_.className.replace(" cellselected",""),u.row[f]=_}}else u=!1;e=e||"color";var p="full_color"==e,m=this;m._asCDATA=!0,"undefined"==typeof n?this.target=' target="_blank"':this.target=n,eXcell_ch.prototype.getContent=function(){return this.getValue()},eXcell_ra.prototype.getContent=function(){return this.getValue()};var g=document.createElement("div");g.style.display="none",document.body.appendChild(g);var b="form_"+m.uid();if(g.innerHTML='<form id="'+b+'" method="post" action="'+t+'" accept-charset="utf-8"  enctype="application/x-www-form-urlencoded"'+this.target+'><input type="hidden" name="grid_xml" id="grid_xml"/> </form>',document.getElementById(b).firstChild.value=encodeURIComponent(o(e).replace("","-")+r()+c()),document.getElementById(b).submit(),g.parentNode.removeChild(g),m=null,u&&u.row.length)for(var f=0;f<u.row.length;f++)u.row[f].parentNode.className+=" rowselected",1==u.row.length&&(u.row[f].className+=" cellselected");u=null},dhtmlXGridObject.prototype._serialiseExportConfig=function(t){function e(t){return"string"!=typeof t?t:(t=t.replace(/&/g,"&amp;"),t=t.replace(/"/g,"&quot;"),t=t.replace(/'/g,"&apos;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"))}for(var i="<head>",s=0;s<this.hdr.rows[0].cells.length;s++)if((!this._srClmn||this._srClmn[s])&&(!this._hrrar[s]||this._fake&&!(s>=this._fake.hdrLabels.length))){var l=this.fldSort[s];"cus"==l&&(l=this._customSorts[s].toString(),l=l.replace(/function[\ ]*/,"").replace(/\([^\f]*/,""));var n=t[1][s],o=(n[1]&&n[1]>1?' rowspan="'+n[1]+'" ':"")+(n[0]&&n[0]>1?' colspan="'+n[0]+'" ':"");i+="<column "+o+" width='"+this.getColWidth(s)+"' align='"+this.cellAlign[s]+"' type='"+this.cellType[s]+"' hidden='"+(this.isColumnHidden&&this.isColumnHidden(s)?"true":"false")+"' sort='"+(l||"na")+"' color='"+(this.columnColor[s]||"")+"'"+(this.columnIds[s]?" id='"+this.columnIds[s]+"'":"")+">",i+=this._asCDATA?"<![CDATA["+this.getColumnLabel(s)+"]]>":this.getColumnLabel(s);var r=this.combos[s]?this.getCombo(s):null;if(r)for(var h=0;h<r.keys.length;h++)i+="<option value='"+e(r.keys[h])+"'><![CDATA["+r.values[h]+"]]></option>";i+="</column>"}return i+="</head>"},window.eXcell_sub_row_grid&&(window.eXcell_sub_row_grid.prototype.getContent=function(){return""}),dhtmlXGridObject.prototype.toExcel=function(t,e,i,s,l){if(!document.getElementById("ifr")){var n=document.createElement("iframe");n.style.display="none",n.setAttribute("name","dhx_export_iframe"),n.setAttribute("src",""),n.setAttribute("id","dhx_export_iframe"),document.body.appendChild(n)}var o=' target="dhx_export_iframe"';this.toPDF(t,e,i,s,l,o)},dhtmlXGridObject.prototype.filterBy=function(t,e,i){if(this.isTreeGrid())return this.filterTreeBy(t,e,i);if(this._f_rowsBuffer?i||(this.rowsBuffer=dhtmlxArray([].concat(this._f_rowsBuffer)),this._fake&&(this._fake.rowsBuffer=this.rowsBuffer)):this._f_rowsBuffer=[].concat(this.rowsBuffer),this.rowsBuffer.length){if(this.dma(!0),"object"==typeof t)for(var s=0;s<e.length;s++)this._filterA(t[s],e[s]);else this._filterA(t,e);this.dma(!1),this.pagingOn&&this.rowsBuffer.length/this.rowsBufferOutSize<this.currentPage-1&&this.changePage(0),this._reset_view(),this.callEvent("onGridReconstructed",[])}},dhtmlXGridObject.prototype._filterA=function(t,e){if(""!=e){var i=!0;if("function"==typeof e?i=!1:e=(e||"").toString().toLowerCase(),this.rowsBuffer.length)for(var s=this.rowsBuffer.length-1;s>=0;s--)(i?this._get_cell_value(this.rowsBuffer[s],t).toString().toLowerCase().indexOf(e)!=-1:e.call(this,this._get_cell_value(this.rowsBuffer[s],t),this.rowsBuffer[s].idd))||this.rowsBuffer.splice(s,1)}},dhtmlXGridObject.prototype.getFilterElement=function(t){if(this.filters){for(var e=0;e<this.filters.length;e++)if(this.filters[e][1]==t)return this.filters[e][0].combo||this.filters[e][0];return null}},dhtmlXGridObject.prototype.collectValues=function(t){var e=this.dhxevs.data.oncollectvalues;if(e){var i=!0;for(var s in e){var l=e[s].call(this,t);l!==!0&&(i=l||i)}if(i!==!0)return i}if(this.isTreeGrid())return this.collectTreeValues(t);this.dma(!0),this._build_m_order(),t=this._m_order?this._m_order[t]:t;for(var n={},o=[],r=this._f_rowsBuffer||this.rowsBuffer,h=0;h<r.length;h++){var a=this._get_cell_value(r[h],t);!a||r[h]._childIndexes&&r[h]._childIndexes[t]==r[h]._childIndexes[t-1]||(n[a]=!0)}this.dma(!1);var d=this.combos[t]||!!this._col_combos&&this._col_combos[t];for(var c in n)n[c]===!0&&(d&&(d.get&&d.get(c)?c=d.get(c):d.getOption&&d.getOption(c)&&(c=d.getOption(c).text)),o.push(c));return o.sort()},dhtmlXGridObject.prototype._build_m_order=function(){if(this._c_order){this._m_order=[];for(var t=0;t<this._c_order.length;t++)this._m_order[this._c_order[t]]=t}},dhtmlXGridObject.prototype.filterByAll=function(){var t=[],e=[];this._build_m_order();for(var i=0;i<this.filters.length;i++){var s=this._m_order?this._m_order[this.filters[i][1]]:this.filters[i][1];if(!(s>=this._cCount)){e.push(s);var l=this.filters[i][0].old_value=this.filters[i][0].value;this.filters[i][0]._filter&&(l=this.filters[i][0]._filter());var n;"function"!=typeof l&&(n=this.combos[s]||!!this._col_combos&&this._col_combos[s])&&(n.values?(s=n.values._dhx_find(l),l=s==-1?l:n.keys[s]):n.getOptionByLabel&&(l=n.getOptionByLabel(l)?n.getOptionByLabel(l).value:l)),t.push(l)}}this.callEvent("onFilterStart",[e,t])&&(this.filterBy(e,t),this._cssEven&&this._fixAlterCss(),this.callEvent("onFilterEnd",[this.filters]),this._f_rowsBuffer&&this.rowsBuffer.length==this._f_rowsBuffer.length&&(this._f_rowsBuffer=null))},dhtmlXGridObject.prototype.makeFilter=function(t,e,i){if(this.filters||(this.filters=[]),"object"!=typeof t&&(t=document.getElementById(t)),t){var s=this;if(t.style.width||(t.style.width="90%"),"SELECT"==t.tagName)this.filters.push([t,e]),this._loadSelectOptins(t,e),t.onchange=function(){s.filterByAll()},_isIE&&(t.style.marginTop="1px"),this.attachEvent("onEditCell",function(i,s,l){return this._build_m_order(),2==i&&this.filters&&(this._m_order?l==this._m_order[e]:l==e)&&this._loadSelectOptins(t,e),!0});else if("INPUT"==t.tagName)this.filters.push([t,e]),t.old_value=t.value="",t.onkeydown=function(){this._timer&&window.clearTimeout(this._timer),this._timer=window.setTimeout(function(){t.value!=t.old_value&&(s.filterByAll(),t.old_value=t.value)},500)};else if("DIV"==t.tagName){this.filters.push([t,e]),t.style.padding="0px",t.style.margin="0px",window.dhx_globalImgPath||(window.dhx_globalImgPath=this.imgURL);var l=new dhtmlXCombo(t,"_filter","90%");l.filterSelfA=l.filterSelf,l.filterSelf=function(){0==this.getSelectedIndex()&&this.setComboText(""),this.filterSelfA.apply(this,arguments),this.optionsArr[0].hide(!1)},l.enableFilteringMode(!0),t.combo=l,t.value="",this._loadComboOptins(t,e),l.attachEvent("onChange",function(){t.value=l.getSelectedValue(),null===t.value&&(t.value=""),s.filterByAll()})}t.parentNode&&(t.parentNode.className+=" filter"),this._filters_ready()}},dhtmlXGridObject.prototype.findCell=function(t,e,i,s){var s=s||function(t,e){return e.toString().toLowerCase().indexOf(t)!=-1};s===!0&&(s=function(t,e){return e.toString().toLowerCase()==t});var l=new Array;if(t=t.toString().toLowerCase(),"number"!=typeof i&&(i=i?1:0),!this.rowsBuffer.length)return l;for(var n=e||0;n<this._cCount;n++){if(this._h2)this._h2.forEachChild(0,function(e){return i&&l.length==i?l:void(s(t,this._get_cell_value(e.buff,n))&&l.push([e.id,n]))},this);else for(var o=0;o<this.rowsBuffer.length;o++)if(s(t,this._get_cell_value(this.rowsBuffer[o],n))&&(l.push([this.rowsBuffer[o].idd,n]),i&&l.length==i))return l;if("undefined"!=typeof e)return l}return l},dhtmlXGridObject.prototype.makeSearch=function(t,e,i){if("object"!=typeof t&&(t=document.getElementById(t)),t){var s=this;"INPUT"==t.tagName&&(t.onkeypress=function(){this._timer&&window.clearTimeout(this._timer),this._timer=window.setTimeout(function(){if(""!=t.value){var l=s.findCell(t.value,e,!0,i);l.length&&(s._h2&&s.openItem(l[0][0]),s.selectCell(s.getRowIndex(l[0][0]),e||0))}},500)}),t.parentNode&&(t.parentNode.className+=" filter")}},dhtmlXGridObject.prototype._loadSelectOptins=function(t,e){var i=this.collectValues(e),s=t.value;t.innerHTML="",t.options[0]=new Option("","");for(var l=this._filter_tr?this._filter_tr[e]:null,n=0;n<i.length;n++)t.options[t.options.length]=new Option(l?l(i[n]):i[n],i[n]);t.value=s},dhtmlXGridObject.prototype.setSelectFilterLabel=function(t,e){this._filter_tr||(this._filter_tr=[]),this._filter_tr[t]=e},dhtmlXGridObject.prototype._loadComboOptins=function(t,e){if(t.combo){var i=this.collectValues(e);t.combo.clearAll();for(var s=[["",""]],l=0;l<i.length;l++)s.push([i[l],i[l]]);t.combo.addOption(s)}},dhtmlXGridObject.prototype.refreshFilters=function(){if(this.filters)for(var t=0;t<this.filters.length;t++)switch(this.filters[t][0].tagName.toLowerCase()){case"input":break;case"select":this._loadSelectOptins.apply(this,this.filters[t]);break;case"div":this._loadComboOptins.apply(this,this.filters[t])}},dhtmlXGridObject.prototype._filters_ready=function(t,e){this.attachEvent("onXLE",this.refreshFilters),this.attachEvent("onRowCreated",function(t,e){if(this._f_rowsBuffer)for(var i=0;i<this._f_rowsBuffer.length;i++)if(this._f_rowsBuffer[i].idd==t)return this._f_rowsBuffer[i]=e}),this.attachEvent("onClearAll",function(){this._f_rowsBuffer=null,this.hdr.rows.length||(this.filters=[])}),this.attachEvent("onSetSizes",this._filters_resize_combo),this.attachEvent("onResize",this._filters_resize_combo),this._filters_ready=function(){}},dhtmlXGridObject.prototype._filters_resize_combo=function(){if(this.filters){for(var t=0;t<this.filters.length;t++)null!=this.filters[t][0].combo&&this.filters[t][0].combo.setSize(Math.round(90*this.filters[t][0].offsetWidth/100));return!0}},dhtmlXGridObject.prototype._in_header_text_filter=function(t,e){t.innerHTML="<input type='text'>",t.onclick=t.onmousedown=function(t){return(t||event).cancelBubble=!0,!0},t.onselectstart=function(){return event.cancelBubble=!0},this.makeFilter(t.firstChild,e)},dhtmlXGridObject.prototype._in_header_text_filter_inc=function(t,e){t.innerHTML="<input type='text'>",t.onclick=t.onmousedown=function(t){return(t||event).cancelBubble=!0,!0},t.onselectstart=function(){return event.cancelBubble=!0},this.makeFilter(t.firstChild,e),t.firstChild._filter=function(){return""==t.firstChild.value?"":function(e){return 0==e.toString().toLowerCase().indexOf(t.firstChild.value.toLowerCase())}},this._filters_ready()},dhtmlXGridObject.prototype._in_header_select_filter=function(t,e){t.innerHTML="<select></select>",t.onclick=function(t){return(t||event).cancelBubble=!0,!1},this.makeFilter(t.firstChild,e)},dhtmlXGridObject.prototype._in_header_select_filter_strict=function(t,e){t.innerHTML="<select style='width:90%; font-size:8pt; font-family:Tahoma;'></select>",t.onclick=function(t){return(t||event).cancelBubble=!0,!1},this.makeFilter(t.firstChild,e);var i=this.combos;t.firstChild._filter=function(){var s=t.firstChild.value;return s?(i[e]&&(s=i[e].keys[i[e].values._dhx_find(s)]),s=s.toLowerCase(),function(t){return t.toString().toLowerCase()==s}):""},this._filters_ready()},dhtmlXGridObject.prototype._in_header_combo_filter=function(t,e){t.innerHTML="<div style='width:100%; padding-left:2px; overflow:hidden; ' class='combo'></div>",t.onselectstart=function(){return event.cancelBubble=!0},t.onclick=t.onmousedown=function(t){return(t||event).cancelBubble=!0,!0},this.makeFilter(t.firstChild,e)},dhtmlXGridObject.prototype._search_common=function(t,e){t.innerHTML="<input type='text' style='width:90%; '>",t.onclick=t.onmousedown=function(t){return(t||event).cancelBubble=!0,!0},t.onselectstart=function(){return event.cancelBubble=!0}},dhtmlXGridObject.prototype._in_header_text_search=function(t,e,i){this._search_common(t,e),this.makeSearch(t.firstChild,e)},dhtmlXGridObject.prototype._in_header_text_search_strict=function(t,e){this._search_common(t,e),this.makeSearch(t.firstChild,e,!0)},dhtmlXGridObject.prototype._in_header_numeric_filter=function(t,e){this._in_header_text_filter.call(this,t,e),t.firstChild._filter=function(){var t,e=this.value,i="==",s=parseFloat(e.replace("=","")),l=null;return e?e.indexOf("..")!=-1?(e=e.split(".."),s=parseFloat(e[0]),l=parseFloat(e[1]),function(t){return t>=s&&t<=l}):(t=e.match(/>=|<=|>|</),t&&(i=t[0],s=parseFloat(e.replace(i,""))),Function("v"," if (v "+i+" "+s+" ) return true; return false;")):""}},dhtmlXGridObject.prototype._in_header_master_checkbox=function(t,e,i){t.innerHTML=i[0]+"<input type='checkbox' />"+i[1];var s=this;t.getElementsByTagName("input")[0].onclick=function(t){s._build_m_order();var i=s._m_order?s._m_order[e]:e,l=this.checked?1:0;s.forEachRowA(function(t){var e=this.cells(t,i);e.isCheckbox()&&(e.setValue(l),e.cell.wasChanged=!0),this.callEvent("onEditCell",[1,t,i,l]),this.callEvent("onCheckbox",[t,i,l])}),(t||event).cancelBubble=!0}},dhtmlXGridObject.prototype._in_header_stat_total=function(t,e,i){var s=function(){var t=0;this._build_m_order();for(var i=this._m_order?this._m_order[e]:e,s=0;s<this.rowsBuffer.length;s++){var l=parseFloat(this._get_cell_value(this.rowsBuffer[s],i));t+=isNaN(l)?0:l}return this._maskArr[i]?this._aplNF(t,i):Math.round(100*t)/100};this._stat_in_header(t,s,e,i,i)},dhtmlXGridObject.prototype._in_header_stat_multi_total=function(t,e,i){var s=i[1].split(":");i[1]="";for(var l=0;l<s.length;l++)s[l]=parseInt(s[l]);for(var n=function(){for(var t=0,i=0;i<this.rowsBuffer.length;i++){for(var l=1,n=0;n<s.length;n++)l*=parseFloat(this._get_cell_value(this.rowsBuffer[i],s[n]));t+=isNaN(l)?0:l}return this._maskArr[e]?this._aplNF(t,e):Math.round(100*t)/100},o=[],r=0;r<s.length;r++)o[s[r]]=!0;this._stat_in_header(t,n,o,i,i)},dhtmlXGridObject.prototype._in_header_stat_max=function(t,e,i){var s=function(){this._build_m_order();var t=this._m_order?this._m_order[e]:e,i=-999999999;if(0==this.getRowsNum())return"&nbsp;";for(var s=0;s<this.rowsBuffer.length;s++)i=Math.max(i,parseFloat(this._get_cell_value(this.rowsBuffer[s],t)));return this._maskArr[e]?this._aplNF(i,e):i};this._stat_in_header(t,s,e,i)},dhtmlXGridObject.prototype._in_header_stat_min=function(t,e,i){var s=function(){this._build_m_order();var t=this._m_order?this._m_order[e]:e,i=999999999;if(0==this.getRowsNum())return"&nbsp;";for(var s=0;s<this.rowsBuffer.length;s++)i=Math.min(i,parseFloat(this._get_cell_value(this.rowsBuffer[s],t)));return this._maskArr[e]?this._aplNF(i,e):i};this._stat_in_header(t,s,e,i)},dhtmlXGridObject.prototype._in_header_stat_average=function(t,e,i){var s=function(){this._build_m_order();var t=this._m_order?this._m_order[e]:e,i=0,s=0;if(0==this.getRowsNum())return"&nbsp;";for(var l=0;l<this.rowsBuffer.length;l++){var n=parseFloat(this._get_cell_value(this.rowsBuffer[l],t));isNaN(n)||(i+=n,s++)}return this._maskArr[e]?this._aplNF(i/s,e):Math.round(i/s*100)/100};this._stat_in_header(t,s,e,i)},dhtmlXGridObject.prototype._in_header_stat_count=function(t,e,i){var s=function(){return this.getRowsNum()};this._stat_in_header(t,s,e,i)},dhtmlXGridObject.prototype._stat_in_header=function(t,e,i,s){var l=function(){this.dma(!0),t.innerHTML=(s[0]?s[0]:"")+e.call(this)+(s[1]?s[1]:""),this.dma(!1),this.callEvent("onStatReady",[])};this._stat_events||(this._stat_events=[],this.attachEvent("onClearAll",function(){if(!this.hdr.rows[1]){for(var t=0;t<this._stat_events.length;t++)for(var e=0;e<4;e++)this.detachEvent(this._stat_events[t][e]);this._stat_events=[]}})),this._stat_events.push([this.attachEvent("onGridReconstructed",l),this.attachEvent("onXLE",l),this.attachEvent("onFilterEnd",l),this.attachEvent("onEditCell",function(t,e,s){return 2==t&&(s==i||i&&i[s])&&l.call(this),!0})]),t.innerHTML=""},dhtmlXGridObject.prototype.loadCSVFile=function(t,e){this.load(t,e,"csv")},dhtmlXGridObject.prototype.enableCSVAutoID=function(t){this._csvAID=dhx4.s2b(t)},dhtmlXGridObject.prototype.enableCSVHeader=function(t){this._csvHdr=dhx4.s2b(t)},dhtmlXGridObject.prototype.setCSVDelimiter=function(t){this.csv.cell=t},dhtmlXGridObject.prototype._csvAID=!0,dhtmlXGridObject.prototype.loadCSVString=function(t){this.parse(t,"csv")},dhtmlXGridObject.prototype.serializeToCSV=function(t){this.editStop(),this._mathSerialization?this._agetm="getMathValue":this._strictText||t?this._agetm="getTitle":this._agetm="getValue";var e=[];if(this._csvHdr)for(var i=1;i<this.hdr.rows.length;i++){for(var s=[],l=0;l<this._cCount;l++)this._srClmn&&!this._srClmn[l]||s.push(this.getColumnLabel(l,i-1));e.push(this.csvParser.str(s,this.csv.cell,this.csv.row))}var l=0,n=this.rowsBuffer.length;for(l;l<n;l++){var o=this._serializeRowToCVS(null,l);""!=o&&e.push(o)}return this.csvParser.block(e,this.csv.row)},dhtmlXGridObject.prototype._serializeRowToCVS=function(t,e,i,s){var l=new Array;t||(t=this.render_row(e),this._fake&&!this._fake.rowsAr[t.idd]&&this._fake.render_row(e)),this._csvAID||(l[l.length]=t.idd),i=i||0,s=s||this._cCount;for(var n=!1,o=i;t.childNodes[i]._cellIndex>o&&i;)i--;for(var r=i;o<s&&t.childNodes[r];r++){var h=t.childNodes[r]._cellIndex;if(this._srClmn&&!this._srClmn[h]||this._serialize_visible&&this._hrrar[h])o++;else{for(var a=t.childNodes[r],d=this.cells(t.idd,h);o!=h&&(o++,l.push(""),!(o>=s)););if(o>=s)break;if(o++,d.cell?zxVal=d[this._agetm]():zxVal="",this._chAttr&&d.wasChanged()&&(n=!0),l[l.length]=null===zxVal?"":zxVal,this._ecspn&&a.colSpan&&a.colSpan>1){a=a.colSpan-1;for(var c=0;c<a;c++)l[l.length]="",o++}}}return this._onlChAttr&&!n?"":this.csvParser.str(l,this.csv.cell,this.csv.row)},dhtmlXGridObject.prototype.toClipBoard=function(t){window.clipboardData?window.clipboardData.setData("Text",t):(new Clipboard).copy(t)},dhtmlXGridObject.prototype.fromClipBoard=function(){return window.clipboardData?window.clipboardData.getData("Text"):(new Clipboard).paste()},dhtmlXGridObject.prototype.cellToClipboard=function(t,e){if(!t||!e&&0!==e){if(!this.selectedRows[0])return;t=this.selectedRows[0].idd,e=this.cell._cellIndex}var i=this.cells(t,e);this.toClipBoard(((i.getLabel?i.getLabel():i.getValue())||"").toString())},dhtmlXGridObject.prototype.updateCellFromClipboard=function(t,e){if(!t||!e){if(!this.selectedRows[0])return;t=this.selectedRows[0].idd,e=this.cell._cellIndex}var i=this.cells(t,e);i[i.setImage?"setLabel":"setValue"](this.fromClipBoard())},dhtmlXGridObject.prototype.rowToClipboard=function(t){var e="";if(this._mathSerialization?this._agetm="getMathValue":this._strictText?this._agetm="getTitle":this._agetm="getValue",this._serialize_visible=!this._fake,t)e=this._serializeRowToCVS(this.getRowById(t));else for(var i=[],s=0;s<this.selectedRows.length;s++)i[i.length]=this._serializeRowToCVS(this.selectedRows[s]),e=this.csvParser.block(i,this.csv.row);this._serialize_visible=!1,this.toClipBoard(e)},dhtmlXGridObject.prototype.updateRowFromClipboard=function(t){var e=this.fromClipBoard();if(e){if(t)var i=this.getRowById(t);else var i=this.selectedRows[0];if(i){var s=this.csvParser;e=s.unblock(e,this.csv.cell,this.csv.row)[0],this._csvAID||e.splice(0,1);for(var l=0;l<e.length;l++){var n=this.cells3(i,l);n[n.setImage?"setLabel":"setValue"](e[l])}}}},dhtmlXGridObject.prototype.csvParser={block:function(t,e){return t.join(e)},unblock:function(t,e,i){for(var s=(t||"").split(i),l=0;l<s.length;l++)s[l]=(s[l]||"").split(e);var n=s.length-1;return 1==s[n].length&&""==s[n][0]&&s.splice(n,1),s},str:function(t,e,i){return t.join(e)}},dhtmlXGridObject.prototype.csvExtParser={_quote:RegExp('"',"g"),_quote_esc:RegExp('\\\\"',"g"),block:function(t,e){return t.join(e)},unblock:function(t,e,i){var s=[[]],l=0;if(!t)return s;for(var n=/^[ ]*"/,o=/"[ ]*$/,r=new RegExp(".*"+i+".*$"),h=t.split(e),a=0;a<h.length;a++)if(h[a].match(n)){for(var d=h[a].replace(n,"");!h[a].match(o);)a++,d+=h[a];s[l].push(d.replace(o,"").replace(this._quote_esc,'"'))}else if(h[a].match(r)){var c=h[a].indexOf(i);s[l].push(h[a].substr(0,c)),l++,s[l]=[],h[a]=h[a].substr(c+1),a--}else(h[a]||a!=h.length-1)&&s[l].push(h[a]);var u=s.length-1;return u>0&&!s[u].length&&s.splice(u,1),s},str:function(t,e,i){for(var s=0;s<t.length;s++)t[s]='"'+t[s].replace(this._quote,'\\"')+'"';return t.join(e)}},dhtmlXGridObject.prototype.addRowFromClipboard=function(){var t=this.fromClipBoard();if(t)for(var e=this.csvParser.unblock(t,this.csv.cell,this.csv.row),i=0;i<e.length;i++)if(e[i]){if(t=e[i],!t.length)continue;this._csvAID?this.addRow(this.getRowsNum()+2,t):(this.rowsAr[t[0]]&&(t[0]=this.uid()),this.addRow(t[0],t.slice(1)))}},dhtmlXGridObject.prototype.gridToClipboard=function(){this.toClipBoard(this.serializeToCSV())},dhtmlXGridObject.prototype.gridFromClipboard=function(){var t=this.fromClipBoard();t&&this.loadCSVString(t)},dhtmlXGridObject.prototype.getXLS=function(t){if(!this.xslform){this.xslform=document.createElement("FORM"),this.xslform.action=(t||"")+"xls.php",this.xslform.method="post",this.xslform.target=_isIE?"_blank":"",document.body.appendChild(this.xslform);var e=document.createElement("INPUT");e.type="hidden",e.name="csv",this.xslform.appendChild(e);var i=document.createElement("INPUT");i.type="hidden",i.name="csv_header",this.xslform.appendChild(i)}var s=this.serializeToCSV();this.xslform.childNodes[0].value=s;for(var l=[],n=this._cCount,o=0;o<n;o++)l.push(this.getHeaderCol(o));l=l.join(","),this.xslform.childNodes[1].value=l,this.xslform.submit()},dhtmlXGridObject.prototype.printView=function(t,e){var i="<style>TD { font-family:Arial; text-align:center; padding-left:2px;padding-right:2px; } \n td.filter input, td.filter select { display:none; }\t\n  </style>",s=null;if(this._fake){s=[].concat(this._hrrar);for(var l=0;l<this._fake._cCount;l++)this._hrrar[l]=null}var n=document.location.port,o=document.location.hostname;i+="<base  href='"+(document.location.protocol+"//"+o+(n?":"+n:"")+document.location.pathname)+"'></base>",this.parentGrid||(i+=t||""),i+='<table width="100%" border="2px" cellpadding="0" cellspacing="0">';var r=Math.max(this.rowsBuffer.length,this.rowsCol.length),h=this._cCount,a=this._printWidth();i+='<tr class="header_row_1">';for(var l=0;l<h;l++)if(!this._hrrar||!this._hrrar[l]){for(var d=this.hdr.rows[1].cells[this.hdr.rows[1]._childIndexes?this.hdr.rows[1]._childIndexes[parseInt(l)]:l],c=d.colSpan||1,u=d.rowSpan||1,f=1;f<c;f++)a[l]+=a[f];
i+='<td rowspan="'+u+'" width="'+a[l]+'%" style="background-color:lightgrey;" colspan="'+c+'">'+this.getHeaderCol(l)+"</td>",l+=c-1}i+="</tr>";for(var l=2;l<this.hdr.rows.length;l++)if(_isIE){i+="<tr style='background-color:lightgrey' class='header_row_"+l+"'>";for(var _=this.hdr.rows[l].childNodes,f=0;f<_.length;f++)this._hrrar&&this._hrrar[_[f]._cellIndex]||(i+=_[f].outerHTML);i+="</tr>"}else i+="<tr class='header_row_"+l+"' style='background-color:lightgrey'>"+(this._fake?this._fake.hdr.rows[l].innerHTML:"")+this.hdr.rows[l].innerHTML+"</tr>";for(var l=0;l<r;l++)if(i+="<tr>",this.rowsCol[l]&&this.rowsCol[l]._cntr)i+=this.rowsCol[l].innerHTML.replace(/<img[^>]*>/gi,"")+"</tr>";else if(!this.rowsCol[l]||"none"!=this.rowsCol[l].style.display){var p;if(this.rowsCol[l])p=this.rowsCol[l].idd;else{if(!this.rowsBuffer[l])continue;p=this.rowsBuffer[l].idd}for(var f=0;f<h;f++)if(!this._hrrar||!this._hrrar[f]){if(this.rowsAr[p]&&"TR"==this.rowsAr[p].tagName){var m=this.cells(p,f);if(m._setState)var g="";else if(m.getContent)g=m.getContent();else if(m.getImage||m.combo)var g=m.cell.innerHTML;else var g=m.getValue()}else var g=this._get_cell_value(this.rowsBuffer[l],f);var b=this.columnColor[f]?"background-color:"+this.columnColor[f]+";":"",v=this.cellAlign[f]?"text-align:"+this.cellAlign[f]+";":"",w=m.getAttribute("colspan");i+='<td style="'+b+v+'" '+(w?'colSpan="'+w+'"':"")+">"+(""===g?"&nbsp;":g)+"</td>",w&&(f+=w-1)}if(i+="</tr>",this.rowsCol[l]&&this.rowsCol[l]._expanded){var x=this.cells4(this.rowsCol[l]._expanded.ctrl);i+=x.getSubGrid?'<tr><td colspan="'+h+'">'+x.getSubGrid().printView()+"</td></tr>":'<tr><td colspan="'+h+'">'+this.rowsCol[l]._expanded.innerHTML+"</td></tr>"}}if(this.ftr)for(var l=1;l<this.ftr.childNodes[0].rows.length;l++)i+="<tr style='background-color:lightgrey'>"+(this._fake?this._fake.ftr.childNodes[0].rows[l].innerHTML:"")+this.ftr.childNodes[0].rows[l].innerHTML+"</tr>";if(i+="</table>",this.parentGrid)return i;i+=e||"";var y=window.open("","_blank");y.document.write(i),y.document.write("<script>window.onerror=function(){return true;}</script>"),y.document.close(),this._fake&&(this._hrrar=s)},dhtmlXGridObject.prototype._printWidth=function(){for(var t=[],e=0,i=0;i<this._cCount;i++){var s=this.getColWidth(i);t.push(s),e+=s}for(var l=[],n=0,i=0;i<t.length;i++){var o=Math.floor(t[i]/e*100);n+=o,l.push(o)}return l[l.length-1]+=100-n,l},dhtmlXGridObject.prototype.enableBlockSelection=function(t){if("undefined"==typeof this._bs_mode){var e=this;this.obj.onmousedown=function(t){return e._bs_mode&&e._OnSelectionStart(t||event,this),!0},this._CSVRowDelimiter=this.csv.row,this.attachEvent("onResize",function(){return e._HideSelection(),!0}),this.attachEvent("onGridReconstructed",function(){return e._HideSelection(),!0}),this.attachEvent("onFilterEnd",this._HideSelection)}if(t===!1)return this._bs_mode=!1,this._HideSelection();if(this._bs_mode=!0,!window.dhx4.isIPad){var i=this._clip_area=document.createElement("textarea");i.style.cssText="position:absolute; width:1px; height:1px; overflow:hidden; color:transparent; background-color:transparent; bottom:1px; right:1px; border:none;",i.onkeydown=function(t){t=t||event,86==t.keyCode&&(t.ctrlKey||t.metaKey)&&e.pasteBlockFromClipboard()},document.body.insertBefore(this._clip_area,document.body.firstChild),dhtmlxEvent(this.entBox,"click",function(){!e.editor&&e._clip_area&&e._clip_area.select()})}},dhtmlXGridObject.prototype.forceLabelSelection=function(t){this._strictText=dhx4.s2b(t)},dhtmlXGridObject.prototype._OnSelectionStart=function(t,e){var i=this;if(2!=t.button){var s=t.srcElement||t.target;if(this.editor){if(s.tagName&&("INPUT"==s.tagName||"TEXTAREA"==s.tagName))return;this.editStop()}i.setActive(!0);var l=this.getPosition(this.obj),n=t.clientX-l[0]+(document.body.scrollLeft||(document.documentElement?document.documentElement.scrollLeft:0)),o=t.clientY-l[1]+(document.body.scrollTop||(document.documentElement?document.documentElement.scrollTop:0));if(this._CreateSelection(n-4,o-4),s==this._selectionObj)this._HideSelection(),this._startSelectionCell=null;else{for(;s&&(!s.tagName||"td"!=s.tagName.toLowerCase());)s=s.parentNode;this._startSelectionCell=s}if(this._startSelectionCell&&!this.callEvent("onBeforeBlockSelected",[this._startSelectionCell.parentNode.idd,this._startSelectionCell._cellIndex]))return this._startSelectionCell=null;this.obj.onmousedown=null,this.obj[_isIE?"onmouseleave":"onmouseout"]=function(t){i._blsTimer&&window.clearTimeout(i._blsTimer)},this.obj.onmmold=this.obj.onmousemove,this._init_pos=[n,o],this._selectionObj.onmousemove=this.obj.onmousemove=function(e){e=e||t,e.preventDefault?e.preventDefault():e.returnValue=!1,i._OnSelectionMove(e)},this._oldDMP=document.body.onmouseup,document.body.onmouseup=function(e){return e=e||t,i._OnSelectionStop(e,this),!0},this.callEvent("onBeforeBlockSelection",[]),document.body.onselectstart=function(){return!1}}},dhtmlXGridObject.prototype._getCellByPos=function(t,e){t=t,this._fake&&(t+=this._fake.objBox.scrollWidth),e=e;for(var i=0,s=0;s<this.obj.rows.length;s++)if(e-=this.obj.rows[s].offsetHeight,e<=0){i=this.obj.rows[s];break}if(!i||!i.idd)return null;for(var s=0;s<this._cCount;s++)if(t-=this.getColWidth(s),t<=0)for(;;){if(!i._childIndexes||i._childIndexes[s+1]!=i._childIndexes[s])return this.cells(i.idd,s).cell;i=i.previousSibling}return null},dhtmlXGridObject.prototype._OnSelectionMove=function(t){var e=this;this._ShowSelection();var i=this.getPosition(this.obj),s=t.clientX-i[0]+(document.body.scrollLeft||(document.documentElement?document.documentElement.scrollLeft:0)),l=t.clientY-i[1]+(document.body.scrollTop||(document.documentElement?document.documentElement.scrollTop:0));if(Math.abs(this._init_pos[0]-s)<5&&Math.abs(this._init_pos[1]-l)<5)return this._HideSelection();var n=this._endSelectionCell;if(null==this._startSelectionCell)this._endSelectionCell=this._startSelectionCell=this.getFirstParentOfType(t.srcElement||t.target,"TD");else if(t.srcElement||t.target)if("dhtmlxGrid_selection"==(t.srcElement||t.target).className)this._endSelectionCell=this._getCellByPos(s,l)||this._endSelectionCell;else{var o=this.getFirstParentOfType(t.srcElement||t.target,"TD");o.parentNode.idd&&(this._endSelectionCell=o)}this._endSelectionCell&&(this.callEvent("onBeforeBlockSelected",[this._endSelectionCell.parentNode.idd,this._endSelectionCell._cellIndex])||(this._endSelectionCell=n));var r=this.objBox.scrollLeft+this.objBox.clientWidth,h=this.objBox.scrollTop+this.objBox.clientHeight,a=this.objBox.scrollLeft,d=this.objBox.scrollTop,c=!1;if(this._blsTimer&&window.clearTimeout(this._blsTimer),s+20>=r?(this.objBox.scrollLeft=this.objBox.scrollLeft+20,c=!0):s-20<a&&(this.objBox.scrollLeft=this.objBox.scrollLeft-20,c=!0),l+20>=h&&!this._realfake?(this.objBox.scrollTop=this.objBox.scrollTop+20,c=!0):l-20<d&&!this._realfake&&(this.objBox.scrollTop=this.objBox.scrollTop-20,c=!0),this._selectionArea=this._RedrawSelectionPos(this._startSelectionCell,this._endSelectionCell),c){var u=t.clientX,f=t.clientY;this._blsTimer=window.setTimeout(function(){e._OnSelectionMove({clientX:u,clientY:f})},100)}},dhtmlXGridObject.prototype._OnSelectionStop=function(t){var e=this;if(this._blsTimer&&window.clearTimeout(this._blsTimer),this.obj.onmousedown=function(i){return e._bs_mode&&e._OnSelectionStart(i||t,this),!0},this.obj.onmousemove=this.obj.onmmold||null,this._selectionObj.onmousemove=null,document.body.onmouseup=this._oldDMP||null,parseInt(this._selectionObj.style.width)<2&&parseInt(this._selectionObj.style.height)<2)this._HideSelection();else{var i=this.getFirstParentOfType(t.srcElement||t.target,"TD");for(i&&i.parentNode.idd||(i=this._endSelectionCell);i&&(!i.tagName||"td"!=i.tagName.toLowerCase());)i=i.parentNode;if(!i)return this._HideSelection();this._stopSelectionCell=i,this._selectionArea=this._RedrawSelectionPos(this._startSelectionCell,this._stopSelectionCell),this.callEvent("onBlockSelected",[])}document.body.onselectstart=function(){}},dhtmlXGridObject.prototype._RedrawSelectionPos=function(t,e){if(t.parentNode.grid!=e.parentNode.grid)return this._selectionArea;var i={};i.LeftTopCol=t._cellIndex,i.LeftTopRow=this.getRowIndex(t.parentNode.idd),i.RightBottomCol=e._cellIndex,i.RightBottomRow=this.getRowIndex(e.parentNode.idd);var s=t.offsetWidth,l=t.offsetHeight;t=this.getPosition(t,this.obj);var n=e.offsetWidth,o=e.offsetHeight;if(e=this.getPosition(e,this.obj),t[0]<e[0])var r=t[0],h=e[0]+n;else{var a=i.RightBottomCol;i.RightBottomCol=i.LeftTopCol,i.LeftTopCol=a;var r=e[0],h=t[0]+s}if(t[1]<e[1])var d=t[1],c=e[1]+o;else{var a=i.RightBottomRow;i.RightBottomRow=i.LeftTopRow,i.LeftTopRow=a;var d=e[1],c=t[1]+l}var u=h-r,f=c-d;return this._selectionObj.style.left=r+"px",this._selectionObj.style.top=d+"px",this._selectionObj.style.width=u+"px",this._selectionObj.style.height=f+"px",i},dhtmlXGridObject.prototype._CreateSelection=function(t,e){if(null==this._selectionObj){var i=document.createElement("div");i.style.position="absolute",i.style.display="none",i.className="dhtmlxGrid_selection",this._selectionObj=i,this._selectionObj.onmousedown=function(t){if(t=t||event,2==t.button||_isMacOS&&t.ctrlKey)return this.parentNode.grid.callEvent("onBlockRightClick",["BLOCK",t])},this._selectionObj.oncontextmenu=function(t){return(t||event).cancelBubble=!0,!1},this.objBox.appendChild(this._selectionObj)}this._selectionObj.style.width="0px",this._selectionObj.style.height="0px",this._selectionObj.style.left=t+"px",this._selectionObj.style.top=e+"px",this._selectionObj.startX=t,this._selectionObj.startY=e},dhtmlXGridObject.prototype._ShowSelection=function(){this._selectionObj&&(this._selectionObj.style.display="")},dhtmlXGridObject.prototype._HideSelection=function(){this._selectionObj&&(this._selectionObj.style.display="none"),this._selectionArea=null,this._clip_area&&(this._clip_area.value="",this._clip_area.blur())},dhtmlXGridObject.prototype.copyBlockToClipboard=function(){if(this._clip_area&&null!=this._selectionArea){var t=new Array;this._mathSerialization?this._agetm="getMathValue":this._strictText?this._agetm="getTitle":this._agetm="getValue",this._serialize_visible=!0;for(var e=this._selectionArea.LeftTopRow;e<=this._selectionArea.RightBottomRow;e++){var i=this._serializeRowToCVS(this.rowsBuffer[e],null,this._selectionArea.LeftTopCol,this._selectionArea.RightBottomCol+1);this._csvAID?t[t.length]=i:t[t.length]=i.substr(i.indexOf(this.csv.cell)+1)}t=t.join(this._CSVRowDelimiter),this._clip_area.value=t,this._clip_area.select(),this._serialize_visible=!1}},dhtmlXGridObject.prototype.pasteBlockFromClipboard=function(){if(this._clip_area){this._clip_area.select();var t=this;window.setTimeout(function(){t._pasteBlockFromClipboard(),t=null},1)}},dhtmlXGridObject.prototype._pasteBlockFromClipboard=function(){var t=this._clip_area.value;if(t){if(null!=this._selectionArea)var e=this._selectionArea.LeftTopRow,i=this._selectionArea.LeftTopCol;else{if(null==this.cell||this.editor)return!1;var e=this.getRowIndex(this.cell.parentNode.idd),i=this.cell._cellIndex}t=this.csvParser.unblock(t,this.csv.cell,this.csv.row);var s=e+t.length,l=i+t[0].length;l>this._cCount&&(l=this._cCount);for(var n=0,o=e;o<s;o++){var r=this.render_row(o);if(r!=-1){for(var h=0,a=i;a<l;a++)if(!this._hrrar[a]||this._fake){var d=this.cells3(r,a);if(d.isDisabled())h++;else{if(this._onEditUndoRedo&&this._onEditUndoRedo(2,r.idd,a,t[n][h],d.getValue()),d.combo){for(var c=d.combo.values,u=0;u<c.length;u++)if(t[n][h]==c[u]){d.setValue(d.combo.keys[u]),c=null;break}null!=c&&d.editable?d.setValue(t[n][h++]):h++}else d[d.setImage?"setLabel":"setValue"](t[n][h++]);d.cell.wasChanged=!0}}else l=Math.min(l+1,this._cCount);this.callEvent("onRowPaste",[r.idd]),n++}}}},dhtmlXGridObject.prototype.getSelectedBlock=function(){return this._selectionArea?this._selectionArea:null!==this.getSelectedRowId()?{LeftTopRow:this.getSelectedRowId(),LeftTopCol:this.getSelectedCellIndex(),RightBottomRow:this.getSelectedRowId(),RightBottomCol:this.getSelectedCellIndex()}:null},dhtmlXGridObject.prototype.enableSmartRendering=function(t,e,i){arguments.length>2&&(e&&!this.rowsBuffer[e-1]&&(this.rowsBuffer[e-1]=0),e=i),this._srnd=dhx4.s2b(t),this._srdh=this._srdh||20,this._dpref=e||0},dhtmlXGridObject.prototype.enablePreRendering=function(t){this._srnd_pr=parseInt(t||50)},dhtmlXGridObject.prototype.forceFullLoading=function(t,e){for(var i=0;i<this.rowsBuffer.length;i++)if(!this.rowsBuffer[i]){var s=t||this.rowsBuffer.length-i;if(this.callEvent("onDynXLS",[i,s])){var l=this;this.load(this.xmlFileUrl+dhtmlx.url(this.xmlFileUrl)+"posStart="+i+"&count="+s,function(){window.setTimeout(function(){l.forceFullLoading(t,e)},100)},this._data_type)}return}e&&e.call(this)},dhtmlXGridObject.prototype.setAwaitedRowHeight=function(t){this._srdh=parseInt(t)},dhtmlXGridObject.prototype._get_view_size=function(){return Math.floor(parseInt(this.entBox.offsetHeight)/this._srdh)+2},dhtmlXGridObject.prototype._add_filler=function(t,e,i,s){if(!e)return null;var l="__filler__",n=this._prepareRow(l);n.firstChild.style.width="1px",n.firstChild.style.borderWidth=n.firstChild.style.padding=n.firstChild.style.margin="0px";for(var o=1;o<n.childNodes.length;o++)n.childNodes[o].style.display="none";return n.firstChild.style.height=e*this._srdh+"px",i=i||this.rowsCol[t],i&&i.nextSibling?i.parentNode.insertBefore(n,i.nextSibling):_isKHTML?this.obj.appendChild(n):this.obj.rows[0].parentNode.appendChild(n),this.callEvent("onAddFiller",[t,e,n,i,s]),[t,e,n]},dhtmlXGridObject.prototype._update_srnd_view=function(){var t=Math.floor(this.objBox.scrollTop/this._srdh),e=t+this._get_view_size();if(this.multiLine){var i=this.objBox.scrollTop;for(t=0;i>0;)i-=this.rowsCol[t]?this.rowsCol[t].offsetHeight:this._srdh,t++;e=t+this._get_view_size(),t>0&&t--}e+=this._srnd_pr||0,e>this.rowsBuffer.length&&(e=this.rowsBuffer.length);for(var s=t;s<e;s++)if(!this.rowsCol[s]){var l=this._add_from_buffer(s);if(l==-1){if(this.xmlFileUrl){if(this._dpref&&this.rowsBuffer[e-1]){var n=(this._dpref?this._dpref:e-s,Math.max(0,Math.min(s,e-this._dpref)));this._current_load=[n,e-n]}else this._current_load=[s,this._dpref?this._dpref:e-s];this.callEvent("onDynXLS",this._current_load)&&this.load(this.xmlFileUrl+dhtmlx.url(this.xmlFileUrl)+"posStart="+this._current_load[0]+"&count="+this._current_load[1],this._data_type)}return}this._tgle&&(this._updateLine(this._h2.get[this.rowsBuffer[s].idd],this.rowsBuffer[s]),this._updateParentLine(this._h2.get[this.rowsBuffer[s].idd],this.rowsBuffer[s])),s&&s==(this._realfake?this._fake:this)._r_select&&this.selectCell(s,this.cell?this.cell._cellIndex:0,!0)}this._fake&&!this._realfake&&this.multiLine&&(this._fake.objBox.scrollTop=this.objBox.scrollTop)},dhtmlXGridObject.prototype._add_from_buffer=function(t){var e=this.render_row(t);if(e==-1)return-1;if((e._attrs.selected||e._attrs.select)&&(this.selectRow(e,!1,!0),e._attrs.selected=e._attrs.select=null),this._cssSP){if(this._h2){var i=this._h2.get[e.idd];e.className+=" "+(i.level%2?this._cssUnEven+" "+this._cssUnEven:this._cssEven+" "+this._cssEven)+"_"+i.level+(this.rowsAr[i.id]._css||"")}}else this._cssEven&&t%2==0?e.className=this._cssEven+(e.className.indexOf("rowselected")!=-1?" rowselected ":" ")+(e._css||""):this._cssUnEven&&t%2==1&&(e.className=this._cssUnEven+(e.className.indexOf("rowselected")!=-1?" rowselected ":" ")+(e._css||""));for(var s=0;s<this._fillers.length;s++){var l=this._fillers[s];if(l&&l[0]<=t&&l[0]+l[1]>t){var n=t-l[0];return void(0==n?(this._insert_before(t,e,l[2]),this._update_fillers(s,-1,1)):n==l[1]-1?(this._insert_after(t,e,l[2]),this._update_fillers(s,-1,0)):(this._fillers.push(this._add_filler(t+1,l[1]-n-1,l[2],1)),this._insert_after(t,e,l[2]),this._update_fillers(s,-l[1]+n,0)))}}},dhtmlXGridObject.prototype._update_fillers=function(t,e,i){var s=this._fillers[t];s[1]=s[1]+e,s[0]=s[0]+i,s[1]?(s[2].firstChild.style.height=parseFloat(s[2].firstChild.style.height)+e*this._srdh+"px",this.callEvent("onUpdateFiller",[s[2]])):(this.callEvent("onRemoveFiller",[s[2]]),s[2].parentNode.removeChild(s[2]),this._fillers.splice(t,1))},dhtmlXGridObject.prototype._insert_before=function(t,e,i){i.parentNode.insertBefore(e,i),this.rowsCol[t]=e,this.callEvent("onRowInserted",[e,null,i,"before"])},dhtmlXGridObject.prototype._insert_after=function(t,e,i){i.nextSibling?i.parentNode.insertBefore(e,i.nextSibling):i.parentNode.appendChild(e),this.rowsCol[t]=e,this.callEvent("onRowInserted",[e,null,i,"after"])},"undefined"!=typeof window.dhtmlxValidation&&(dhtmlxValidation.trackInput=function(t,e,i,s){dhtmlxEvent(t,"keyup",function(l){dhtmlxValidation._timer&&(window.clearTimeout(dhtmlxValidation._timer),dhtmlxValidation._timer=null),dhtmlxValidation._timer=window.setTimeout(function(){dhtmlxValidation.checkInput(t,e)?(t.className=t.className.replace(/[ ]*dhtmlx_live_validation_error/g,""),s&&s(t,t.value,e)):i&&!i(t,t.value,e)||(t.className+=" dhtmlx_live_validation_error")},250)})},dhtmlxValidation.checkInput=function(t,e){return dhtmlxValidation.checkValue(t.value,e)},dhtmlxValidation.checkValue=function(t,e){"string"==typeof e&&(e=e.split(","));for(var i=!0,s=0;s<e.length;s++)this["is"+e[s]]?i=i&&this["is"+e[s]](t):alert("Incorrect validation rule: "+e[s]);return i}),dhtmlXGridObject.prototype.enableValidation=function(t,e){t=dhx4.s2b(t),t?this._validators={data:[]}:this._validators=!1,arguments.length>1&&(this._validators._live=e),this._validators._event||(this._validators._event=this.attachEvent("onEditCell",this.validationEvent))},dhtmlXGridObject.prototype.setColValidators=function(t){this._validators||this.enableValidation(!0),"string"==typeof t&&(t=t.split(this.delim)),this._validators.data=t},dhtmlXGridObject.prototype.validationEvent=function(t,e,i,s,l){var n=this._validators;if(!n)return!0;var o=n.data[i]||this.cells(e,i).getAttribute("validate")||"";if(1==t&&o){var r=this.editor||(this._fake||{}).editor;if(!r)return!0;if(r.cell.className=r.cell.className.replace(/[ ]*dhtmlx_validation_error/g,""),n._live){var h=this;dhtmlxValidation.trackInput(r.getInput(),o,function(t,s,l){return h.callEvent("onLiveValidationError",[e,i,s,t,l])},function(t,s,l){return h.callEvent("onLiveValidationCorrect",[e,i,s,t,l])})}}return 2==t&&this.validateCell(e,i,o,s),!0},dhtmlXGridObject.prototype.validateCell=function(t,e,i,s){if(i=i||this._validators.data[e]||this.cells(t,e).getAttribute("validate"),s=s||this.cells(t,e).getValue(),i){var l=this.cells(t,e).cell,n=!0;"string"==typeof i&&(i=i.split(this.delim));for(var o=0;o<i.length;o++)dhtmlxValidation.checkValue(s,i[o])||(this.callEvent("onValidationError",[t,e,s,i[o]])&&(l.className+=" dhtmlx_validation_error"),n=!1);return n&&(this.callEvent("onValidationCorrect",[t,e,s,i]),l.className=l.className.replace(/[ ]*dhtmlx_validation_error/g,"")),n}},eXcell_stree.prototype=new eXcell,dhtmlXGridObject.prototype.setSubTree=function(t,e){this._sub_trees||(this._sub_trees=[]),this._sub_trees[e]=[t],t.parentObject.style.display="none";var i=this;t.parentObject.onclick=function(t){return(t||window.event).cancelBubble=!0,!1},t.ev_onDblClick=null,t.attachEvent("onDblClick",function(t){return i._sub_id=t,i.editStop(),!0}),t._chRRS=!0},eXcell_link.prototype=new eXcell,eXcell_link.prototype.getTitle=function(){var t=this.cell.firstChild;return t&&t.tagName?t.getAttribute("href"):""},eXcell_link.prototype.getContent=function(){var t=this.cell.firstChild;return t&&t.tagName?t.innerHTML:""},eXcell_grid.prototype=new eXcell,dhtmlXGridObject.prototype.setSubGrid=function(t,e,i){this._sub_grids||(this._sub_grids=[]),this._sub_grids[e]=[t,i],t.entBox.style.display="none";var s=this;t.entBox.onclick=function(t){return(t||window.event).cancelBubble=!0,!1},t.attachEvent("onRowSelect",function(t){return s.editStop(),!0}),t._chRRS=!1},eXcell_dhxCalendar.prototype=new eXcell,eXcell_dhxCalendar.prototype.edit=function(){var t=this.grid.getPosition(this.cell);this.grid._grid_calendarA._show(!1,!1),this.grid._grid_calendarA.setPosition(t[0],t[1]+this.cell.offsetHeight),this.grid._grid_calendarA._last_operation_calendar=!1,this.grid.callEvent("onCalendarShow",[this.grid._grid_calendarA,this.cell.parentNode.idd,this.cell._cellIndex]),this.cell._cediton=!0,this.val=this.cell.val,this._val=this.cell.innerHTML;var e=this.grid._grid_calendarA.draw;this.grid._grid_calendarA.draw=function(){},this.grid._grid_calendarA.setDateFormat(this.grid._dtmask||"%d/%m/%Y"),this.grid._grid_calendarA.setDate(this.val||new Date),this.grid._grid_calendarA.draw=e},eXcell_dhxCalendar.prototype.getDate=function(){return this.cell.val?this.cell.val:null},eXcell_dhxCalendar.prototype.getValue=function(){return this.cell._clearCell?"":this.grid._dtmask_inc&&this.cell.val?this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc,this.cell.val).toString():this.cell.innerHTML.toString()._dhx_trim()},eXcell_dhxCalendar.prototype.detach=function(){if(this.grid._grid_calendarA&&(this.grid._grid_calendarA.hide(),this.cell._cediton)){if(this.cell._cediton=!1,this.grid._grid_calendarA._last_operation_calendar){var t=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y"),e=this.grid._grid_calendarA.getDate();this.cell.val=new Date(e),this.setCValue(t,e),this.cell._clearCell=!t;var i=this.val;return this.val=this._val,this.cell.val.valueOf()!=(i||"").valueOf()}return!1}},eXcell_dhxCalendar.prototype.setValue=function(t){return t&&"object"==typeof t?(this.cell.val=t,this.cell._clearCell=!1,void this.setCValue(this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",t).toString(),this.cell.val)):(t&&""!=t.toString()._dhx_trim()?(this.cell._clearCell=!1,this.cell.val=new Date(this.grid._grid_calendarA.setFormatedDate(this.grid._dtmask_inc||this.grid._dtmask||"%d/%m/%Y",t.toString(),null,!0)),this.grid._dtmask_inc&&(t=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",this.cell.val))):(t="&nbsp",this.cell._clearCell=!0,this.cell.val=""),void("NaN"==this.cell.val||"Invalid Date"==this.cell.val?(this.cell._clearCell=!0,this.cell.val=new Date,this.setCValue("&nbsp;",0)):this.setCValue((t||"").toString(),this.cell.val)))},eXcell_dhxCalendarA.prototype=new eXcell,eXcell_dhxCalendarA.prototype.edit=function(){var t=this.grid.getPosition(this.cell);this.grid._grid_calendarA._show(!1,!1),this.grid._grid_calendarA.setPosition(1*t[0]+this.cell.offsetWidth,1*t[1]),this.grid.callEvent("onCalendarShow",[this.grid._grid_calendarA,this.cell.parentNode.idd,this.cell._cellIndex]),this.grid._grid_calendarA._last_operation_calendar=!1,this.cell._cediton=!0,this.val=this.cell.val,this._val=this.cell.innerHTML;var e=this.grid._grid_calendarA.draw;this.grid._grid_calendarA.draw=function(){},this.grid._grid_calendarA.setDateFormat(this.grid._dtmask||"%d/%m/%Y"),this.grid._grid_calendarA.setDate(this.val),this.grid._grid_calendarA.draw=e,this.cell.atag=!this.grid.multiLine&&(_isKHTML||_isMacOS||_isFF)?"INPUT":"TEXTAREA",this.obj=document.createElement(this.cell.atag),this.obj.style.height=this.cell.offsetHeight-4+"px",this.obj.className="dhx_combo_edit",this.obj.wrap="soft",this.obj.style.textAlign=this.cell.align,this.obj.onclick=function(t){(t||event).cancelBubble=!0},this.obj.onmousedown=function(t){(t||event).cancelBubble=!0},this.obj.value=this.getValue(),this.cell.innerHTML="",this.cell.appendChild(this.obj),window.dhx4.isIE&&(this.obj.style.overflow="visible",this.grid.multiLine&&this.obj.offsetHeight>=18&&this.obj.offsetHeight<40&&(this.obj.style.height="36px",this.obj.style.overflow="scroll")),this.obj.onselectstart=function(t){return t||(t=event),t.cancelBubble=!0,!0},this.obj.focus(),this.obj.focus()},eXcell_dhxCalendarA.prototype.getDate=function(){return this.cell.val?this.cell.val:null},eXcell_dhxCalendarA.prototype.getValue=function(){return this.cell._clearCell?"":this.grid._dtmask_inc&&this.cell.val?this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc,this.cell.val).toString():this.cell.innerHTML.toString()._dhx_trim()},eXcell_dhxCalendarA.prototype.detach=function(){if(this.grid._grid_calendarA&&(this.grid._grid_calendarA.hide(),this.cell._cediton)){if(this.cell._cediton=!1,this.grid._grid_calendarA._last_operation_calendar){this.grid._grid_calendarA._last_operation_calendar=!1;var t=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y"),e=this.grid._grid_calendarA.getDate();this.cell.val=new Date(e),this.setCValue(t,e),this.cell._clearCell=!t;var i=this.val;return this.val=this._val,this.cell.val.valueOf()!=(i||"").valueOf()}this.setValue(this.obj.value);var i=this.val;return this.val=this._val,this.cell.val.valueOf()!=(i||"").valueOf()}},eXcell_dhxCalendarA.prototype.setValue=function(t){return t&&"object"==typeof t?(this.cell.val=t,this.cell._clearCell=!1,void this.setCValue(this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",t).toString(),this.cell.val)):(t&&""!=t.toString()._dhx_trim()?(this.cell._clearCell=!1,this.cell.val=new Date(this.grid._grid_calendarA.setFormatedDate(this.grid._dtmask_inc||this.grid._dtmask||"%d/%m/%Y",t.toString(),null,!0)),this.grid._dtmask_inc&&(t=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",this.cell.val))):(t="&nbsp",this.cell._clearCell=!0,this.cell.val=""),void("NaN"==this.cell.val||"Invalid Date"==this.cell.val?(this.cell.val=new Date,this.cell._clearCell=!0,this.setCValue("&nbsp;",0)):this.setCValue((t||"").toString(),this.cell.val)))},dhtmlXGridObject.prototype.resetCounter=function(t){this._fake&&!this._realfake&&t<this._fake._cCount&&this._fake.resetCounter(t,this.currentPage);var e=arguments[0]||0;for(this.currentPage&&(e=(this.currentPage-1)*this.rowsBufferOutSize),e=0;e<this.rowsBuffer.length;e++)this.rowsBuffer[e]&&"TR"==this.rowsBuffer[e].tagName&&this.rowsAr[this.rowsBuffer[e].idd]&&(this.rowsAr[this.rowsBuffer[e].idd].childNodes[t].innerHTML=e+1)},eXcell_cntr.prototype=new eXcell,eXcell_acheck.prototype=new eXcell;eXcell_acheck.prototype.setValue=function(t){t=(t||"").toString(),t.indexOf("1")!=-1||t.indexOf("true")!=-1?(t="1",this.cell.chstate="1"):(t="0",this.cell.chstate="0");this.setCValue(this.drawCurrentState(),this.cell.chstate)};eXcell_context.prototype=new eXcell,dhtmlXGridObject.prototype.setSubContext=function(t,e,i){var s=this;t.attachEvent("onClick",function(e,i){return s._sub_id=e,s.editStop(),t.hideContextMenu(),!0}),this._sub_context||(this._sub_context=[]),this._sub_context[e]=[t,i],t.hideContextMenu()},dhtmlXGridObject.prototype._process_html=function(t){if(t.tagName&&"TABLE"==t.tagName)return this._process_inner_html(t,0);var e=document.createElement("DIV");e.innerHTML=t.xmlDoc.responseText;var i=e.getElementsByTagName("TABLE")[0];this._process_inner_html(i,0)},dhtmlXGridObject.prototype._process_inner_html=function(t,e){for(var i=t.rows.length,s=e;s<i;s++){var l=t.rows[s].getAttribute("id")||s;this.rowsBuffer.push({idd:l,data:t.rows[s],_parser:this._process_html_row,_locator:this._get_html_data})}this.render_dataset(),this.setSizes()},dhtmlXGridObject.prototype._process_html_row=function(t,e){var i=e.getElementsByTagName("TD"),s=[];t._attrs=this._xml_attrs(e);for(var l=0;l<i.length;l++){var n=i[l],o=n.getAttribute("type");if(t.childNodes[l]&&(o&&(t.childNodes[l]._cellType=o),t.childNodes[l]._attrs=this._xml_attrs(i[l])),n.firstChild?s.push(n.innerHTML):s.push(""),n.colSpan>1){t.childNodes[l]._attrs.colspan=n.colSpan;for(var r=1;r<n.colSpan;r++)s.push("")}}for(l<i.length;l<t.childNodes.length;l++)t.childNodes[l]._attrs={};return this._fillRow(t,this._c_order?this._swapColumns(s):s),t},dhtmlXGridObject.prototype._get_html_data=function(t,e){for(t=t.firstChild;;){if(!t)return"";if("TD"==t.tagName&&e--,e<0)break;t=t.nextSibling}return t.firstChild?t.firstChild.data:""},dhtmlxEvent(window,"load",function(){for(var t=document.getElementsByTagName("table"),e=0;e<t.length;e++)"dhtmlxGrid"==t[e].className&&dhtmlXGridFromTable(t[e])}),window.dhtmlx||(window.dhtmlx={}),function(){function t(t,e){var s=t.callback;i(!1),t.box.parentNode.removeChild(t.box),u=t.box=null,s&&s(e)}function e(e){if(u){e=e||event;var i=e.which||event.keyCode;return dhtmlx.message.keyboard&&(13!=i&&32!=i||t(u,!0),27==i&&t(u,!1)),e.preventDefault&&e.preventDefault(),!(e.cancelBubble=!0)}}function i(t){i.cover||(i.cover=document.createElement("DIV"),i.cover.onkeydown=e,i.cover.className="dhx_modal_cover",document.body.appendChild(i.cover));document.body.scrollHeight;i.cover.style.display=t?"inline-block":"none"}function s(t,e){return"<div class='dhtmlx_popup_button' result='"+e+"' ><div>"+t+"</div></div>"}function l(t){f.area||(f.area=document.createElement("DIV"),f.area.className="dhtmlx_message_area",f.area.style[f.position]="5px",document.body.appendChild(f.area)),f.hide(t.id);var e=document.createElement("DIV");return e.innerHTML="<div>"+t.text+"</div>",e.className="dhtmlx-info dhtmlx-"+t.type,e.onclick=function(){t&&f.hide(t.id),t=null},"bottom"==f.position&&f.area.firstChild?f.area.insertBefore(e,f.area.firstChild):f.area.appendChild(e),t.expire>0&&(f.timers[t.id]=window.setTimeout(function(){f.hide(t.id)},t.expire)),f.pull[t.id]=e,e=null,t.id}function n(e,i,l){var n=document.createElement("DIV");n.className=" dhtmlx_modal_box dhtmlx-"+e.type,n.setAttribute("dhxbox",1);var o="";if(e.width&&(n.style.width=e.width),e.height&&(n.style.height=e.height),e.title&&(o+='<div class="dhtmlx_popup_title">'+e.title+"</div>"),o+='<div class="dhtmlx_popup_text"><span>'+(e.content?"":e.text)+'</span></div><div  class="dhtmlx_popup_controls">',i&&(o+=s(e.ok||"OK",!0)),l&&(o+=s(e.cancel||"Cancel",!1)),e.buttons)for(var r=0;r<e.buttons.length;r++)o+=s(e.buttons[r],r);if(o+="</div>",n.innerHTML=o,e.content){var h=e.content;"string"==typeof h&&(h=document.getElementById(h)),"none"==h.style.display&&(h.style.display=""),n.childNodes[e.title?1:0].appendChild(h)}return n.onclick=function(i){i=i||event;var s=i.target||i.srcElement;if(s.className||(s=s.parentNode),"dhtmlx_popup_button"==s.className){var l=s.getAttribute("result");l="true"==l||"false"!=l&&l,t(e,l)}},e.box=n,(i||l)&&(u=e),n}function o(t,s,l){var o=t.tagName?t:n(t,s,l);t.hidden||i(!0),document.body.appendChild(o);var r=t.left||Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-o.offsetWidth)/2)),h=t.top||Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-o.offsetHeight)/2));return"top"==t.position?o.style.top="-3px":o.style.top=h+"px",o.style.left=r+"px",o.onkeydown=e,o.focus(),t.hidden&&dhtmlx.modalbox.hide(o),o}function r(t){return o(t,!0,!1)}function h(t){return o(t,!0,!0)}function a(t){return o(t)}function d(t,e,i){return"object"!=typeof t&&("function"==typeof e&&(i=e,e=""),t={text:t,type:e,callback:i}),t}function c(t,e,i,s){return"object"==typeof t&&t||(t={text:t,type:e,expire:i,id:s}),t.id=t.id||f.uid(),t.expire=t.expire||f.expire,t}var u=null;document.attachEvent?document.attachEvent("onkeydown",e):document.addEventListener("keydown",e,!0),dhtmlx.alert=function(){var t=d.apply(this,arguments);return t.type=t.type||"confirm",r(t)},dhtmlx.confirm=function(){var t=d.apply(this,arguments);return t.type=t.type||"alert",h(t)},dhtmlx.modalbox=function(){var t=d.apply(this,arguments);return t.type=t.type||"alert",a(t)},dhtmlx.modalbox.hide=function(t){for(;t&&t.getAttribute&&!t.getAttribute("dhxbox");)t=t.parentNode;t&&(t.parentNode.removeChild(t),i(!1),u=null)};var f=dhtmlx.message=function(t,e,i,s){t=c.apply(this,arguments),t.type=t.type||"info";var n=t.type.split("-")[0];switch(n){case"alert":return r(t);case"confirm":return h(t);case"modalbox":return a(t);default:return l(t)}};f.seed=(new Date).valueOf(),f.uid=function(){return f.seed++},f.expire=4e3,f.keyboard=!0,f.position="top",f.pull={},f.timers={},f.hideAll=function(){for(var t in f.pull)f.hide(t)},f.hide=function(t){var e=f.pull[t];e&&e.parentNode&&(window.setTimeout(function(){e.parentNode.removeChild(e),e=null},2e3),e.className+=" hidden",f.timers[t]&&window.clearTimeout(f.timers[t]),delete f.pull[t])}}();